"use strict";(self.webpackChunkdf_portfolio_site=self.webpackChunkdf_portfolio_site||[]).push([[179],{7498:(Vt,Be,U)=>{U.r(Be),U.d(Be,{AboutMePageModule:()=>Ct});var C=U(6895),O=U(7340),Y=U(4304),Q=U(5447);const we=(0,O.oB)({right:"calc(50% - 5rem)",width:"50%"}),je=(0,O.oB)({right:"5rem",width:"70%"}),Ye=(0,O.jt)("500ms ease-out",je),wt=(0,O.jt)("500ms ease-out",we),it=(0,O.X$)("routeAnimations",[(0,O.eR)("void => about-me, void => summary",[Y.I,(0,O.ru)([(0,O.IO)("#main-info",[we,Q.vF]),(0,O.IO)("#presentation-card",Q.TR)]),(0,O.ru)([(0,O.IO)("section",Q.hg)])]),(0,O.eR)("void => history",[(0,O.ru)([(0,O.IO)("#main-info",[je,Q.TR]),(0,O.IO)("#presentation-card",Q.vF)]),(0,O.ru)([(0,O.IO)("section",Q.hg)])]),(0,O.eR)("about-me => void, summary => void",[(0,O.IO)("section",Q.ht),(0,O.ru)([(0,O.IO)("#main-info",Q.FM),(0,O.IO)("#presentation-card",Q._G)])]),(0,O.eR)("history => void",[(0,O.IO)("section",Q.ht),(0,O.ru)([(0,O.IO)("#main-info",Q._G),(0,O.IO)("#presentation-card",Q.FM)])]),(0,O.eR)("about-me => history, summary => history",(0,O.ru)([(0,O.IO)("#presentation-card",[(0,O.oB)({right:"5rem"})]),(0,O.IO)("#main-info",[we,Ye]),(0,O.IO)("#presentation-card",(0,O.jt)(700,(0,O.F4)([Q.ht,Q.TR,(0,O.oB)({right:"auto"}),Q.vF,Q.ht])))])),(0,O.eR)("history => summary",(0,O.ru)([(0,O.IO)("#presentation-card",[(0,O.oB)({right:"auto"})]),(0,O.IO)("#main-info",[je,wt]),(0,O.IO)("#presentation-card",(0,O.jt)(700,(0,O.F4)([Q.ht,Q.vF,(0,O.oB)({right:"5rem"}),Q.TR,Q.ht])))]))]);var ae=U(8256),be=U(1962),oe=U(521);const Xe=[{path:"",component:(()=>{class ot{constructor(Kt){this.currentRoute=Kt}}return ot.\u0275fac=function(Kt){return new(Kt||ot)(ae.Y36(be.V))},ot.\u0275cmp=ae.Xpm({type:ot,selectors:[["app-about-me-page"]],decls:10,vars:3,consts:[["id","wrapper"],["id","presentation-card"],["id","main-info"]],template:function(Kt,Pn){1&Kt&&(ae.TgZ(0,"div",0)(1,"section",1)(2,"h3"),ae._uU(3,"DAVID FUENTES"),ae.qZA(),ae.TgZ(4,"p"),ae._uU(5,"Colombia"),ae.qZA(),ae.TgZ(6,"p"),ae._uU(7,"Software developer / Graphic designer"),ae.qZA()(),ae.TgZ(8,"section",2),ae._UZ(9,"router-outlet"),ae.qZA()()),2&Kt&&(ae.Tol(Pn.currentRoute.segment),ae.Q6J("@routeAnimations",Pn.currentRoute.segment))},dependencies:[oe.lC],styles:['#wrapper[_ngcontent-%COMP%]{padding:var(--main-content-padding)}#wrapper.history[_ngcontent-%COMP%]   #main-info[_ngcontent-%COMP%]{width:70%;right:var(--main-content-padding)}#wrapper.history[_ngcontent-%COMP%]   #presentation-card[_ngcontent-%COMP%]{right:auto}#main-info[_ngcontent-%COMP%]{position:fixed;width:50%}#presentation-card[_ngcontent-%COMP%]{position:fixed;bottom:15rem;background-color:var(--card-bg);-webkit-backdrop-filter:var(--bg-blur);backdrop-filter:var(--bg-blur);padding:3rem;z-index:0;overflow:hidden;right:var(--main-content-padding)}#presentation-card[_ngcontent-%COMP%]:after, #presentation-card[_ngcontent-%COMP%]:before{content:"";display:block;width:2rem;height:2rem;position:absolute;border:1rem solid var(--accent-color);border-bottom-color:transparent;border-right-color:transparent;z-index:2}#presentation-card[_ngcontent-%COMP%]:before{top:0;left:0}#presentation-card[_ngcontent-%COMP%]:after{bottom:0;right:0;transform:rotate(180deg)}#presentation-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-transform:uppercase;color:var(--accent-color);margin-bottom:.5rem;white-space:nowrap}#presentation-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0;line-height:1.2;font-size:1.6rem;white-space:nowrap}'],data:{animation:[it]}}),ot})(),children:[{path:"",pathMatch:"full",redirectTo:"summary"},{path:"summary",loadChildren:()=>Promise.all([U.e(592),U.e(299)]).then(U.bind(U,6299)).then(ot=>ot.SummaryPageModule)},{path:"history",loadChildren:()=>Promise.all([U.e(592),U.e(464)]).then(U.bind(U,5464)).then(ot=>ot.HistoryPageModule)}]}];let Ct=(()=>{class ot{}return ot.\u0275fac=function(Kt){return new(Kt||ot)},ot.\u0275mod=ae.oAB({type:ot}),ot.\u0275inj=ae.cJS({imports:[C.ez,oe.Bz.forChild(Xe)]}),ot})()},7320:(Vt,Be,U)=>{U.r(Be),U.d(Be,{HomePageModule:()=>it});var C=U(6895),O=U(3266),Y=U(8256),Q=U(8026),we=U(521);const je=function(ae){return{"floating-link":!0,visible:ae}},wt=[{path:"",component:(()=>{class ae{get angle(){return this.camAngleService.angle}constructor(oe){this.camAngleService=oe,this.links=[...O.N],this.visibilityConditions={"about-me":()=>this.angle>1.8&&this.angle<2.5,skillset:()=>this.angle>2.8||this.angle<-3,"work-experience":()=>this.angle>-2.8&&this.angle<-2}}getVisibilityCondition(oe){}}return ae.\u0275fac=function(oe){return new(oe||ae)(Y.Y36(Q.B))},ae.\u0275cmp=Y.Xpm({type:ae,selectors:[["app-home-page"]],decls:12,vars:9,consts:[["routerLink","/about-me",3,"ngClass"],["routerLink","/skillset",3,"ngClass"],["routerLink","/work-experience",3,"ngClass"]],template:function(oe,Lt){1&oe&&(Y.TgZ(0,"a",0)(1,"span"),Y._uU(2,"Go to"),Y.qZA(),Y._uU(3," About me\n"),Y.qZA(),Y.TgZ(4,"a",1)(5,"span"),Y._uU(6,"Go to"),Y.qZA(),Y._uU(7," Skillset\n"),Y.qZA(),Y.TgZ(8,"a",2)(9,"span"),Y._uU(10,"Go to"),Y.qZA(),Y._uU(11," About me\n"),Y.qZA()),2&oe&&(Y.Q6J("ngClass",Y.VKq(3,je,Lt.visibilityConditions["about-me"]())),Y.xp6(4),Y.Q6J("ngClass",Y.VKq(5,je,Lt.visibilityConditions.skillset())),Y.xp6(4),Y.Q6J("ngClass",Y.VKq(7,je,Lt.visibilityConditions["work-experience"]())))},dependencies:[C.mk,we.rH],styles:[".floating-link[_ngcontent-%COMP%]{display:block;color:#fff;font-size:2rem;text-align:center;position:fixed;left:50%;bottom:4rem;transform:translate(-50%);z-index:2;opacity:0;background:var(--accent-color);padding:1rem 2rem}.floating-link.visible[_ngcontent-%COMP%]{opacity:1}.floating-link.visible[_ngcontent-%COMP%]:hover{opacity:1;transform:translate(-50%) scale(1.15)}"]}),ae})()}];let it=(()=>{class ae{}return ae.\u0275fac=function(oe){return new(oe||ae)},ae.\u0275mod=Y.oAB({type:ae}),ae.\u0275inj=Y.cJS({imports:[C.ez,we.Bz.forChild(wt),we.Bz]}),ae})()},7747:(Vt,Be,U)=>{U.r(Be),U.d(Be,{PortfolioPageModule:()=>je});var C=U(6895),O=U(8256);let Y=(()=>{class Ye{}return Ye.\u0275fac=function(it){return new(it||Ye)},Ye.\u0275cmp=O.Xpm({type:Ye,selectors:[["app-portfolio-page"]],decls:2,vars:0,template:function(it,ae){1&it&&(O.TgZ(0,"p"),O._uU(1,"portfolio-page works!"),O.qZA())}}),Ye})();var Q=U(521);const we=[{path:"",component:Y}];let je=(()=>{class Ye{}return Ye.\u0275fac=function(it){return new(it||Ye)},Ye.\u0275mod=O.oAB({type:Ye}),Ye.\u0275inj=O.cJS({imports:[C.ez,Q.Bz.forChild(we)]}),Ye})()},59:(Vt,Be,U)=>{U.d(Be,{l:()=>wt,s:()=>Ye});var C=U(7340),O=U(4304),Y=U(5447);const Q=(0,C.ru)([(0,C.IO)("#development-link",[Y.vF,Y.hg],{optional:!0}),(0,C.IO)("#design-link",[Y.TR,Y.hg],{optional:!0})]),we=(0,C.ru)([(0,C.IO)("#development-link",[Y.ht,Y.FM],{optional:!0}),(0,C.IO)("#design-link",[Y.ht,Y._G],{optional:!0})]),je=(0,C.ru)([(0,C.IO)(":enter @header,\n    :leave @header,\n    :enter @skillsetGridAnim,\n    :leave @skillsetGridAnim",(0,C.pV)(),{optional:!0})]),Ye=(0,C.X$)("routeAnimations",[(0,C.eR)(":leave, skillset => *",[O.I,we,je]),(0,C.eR)("* => skillset",[O.I,(0,C.IO)("#development-link",Y.vF,{optional:!0}),(0,C.IO)("#design-link",Y.TR,{optional:!0}),je,Q])]),wt=(0,C.X$)("header",[(0,C.eR)(":enter",[(0,C.ru)([(0,C.IO)("h2",[Y.vF,Y.hg]),(0,C.IO)("arrow-button",[Y.vF,Y.hg])])]),(0,C.eR)(":leave",[(0,C.ru)([(0,C.IO)("h2",[Y.ht,Y.FM]),(0,C.IO)("arrow-button",[Y.ht,Y.FM]),Y.vF])])])},1278:(Vt,Be,U)=>{U.r(Be),U.d(Be,{SkillsetPageModule:()=>it});var C=U(6895),O=U(59),Y=U(8256),Q=U(1962),we=U(521);function je(ae,be){1&ae&&(Y.ynx(0),Y.TgZ(1,"div",3)(2,"h3",4)(3,"span"),Y._uU(4,"Software"),Y.qZA(),Y.TgZ(5,"span",5),Y._uU(6,"Development"),Y.qZA()()(),Y.TgZ(7,"div",6)(8,"h3",7)(9,"span",5),Y._uU(10,"Graphic"),Y.qZA(),Y.TgZ(11,"span"),Y._uU(12,"Design"),Y.qZA()()(),Y.BQk())}const wt=[{path:"",component:(()=>{class ae{constructor(oe){this.currentRoute=oe}}return ae.\u0275fac=function(oe){return new(oe||ae)(Y.Y36(Q.V))},ae.\u0275cmp=Y.Xpm({type:ae,selectors:[["app-skillset-page"]],decls:4,vars:4,consts:[["id","wrapper"],[4,"ngIf"],["id","content"],["id","development-link",1,"link"],["routerLink","./software-development","role","link",1,"super-title"],[1,"super-title__outline"],["id","design-link",1,"link"],["routerLink","./graphic-design","role","link",1,"super-title","super-title--right"]],template:function(oe,Lt){1&oe&&(Y.TgZ(0,"div",0),Y.YNc(1,je,13,0,"ng-container",1),Y.TgZ(2,"section",2),Y._UZ(3,"router-outlet"),Y.qZA()()),2&oe&&(Y.Tol(Lt.currentRoute.segment),Y.Q6J("@routeAnimations",Lt.currentRoute.segment),Y.xp6(1),Y.Q6J("ngIf","skillset"==Lt.currentRoute.segment))},dependencies:[C.O5,we.lC,we.rH],styles:["#wrapper[_ngcontent-%COMP%]{padding:var(--main-content-padding);height:100%;position:relative}#wrapper.skillset[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:nth-child(2)>a{align-items:flex-end}#content[_ngcontent-%COMP%]{width:100%;overflow:auto}.link[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:50%}.link[_ngcontent-%COMP%]:nth-child(2){right:5rem}.link[_ngcontent-%COMP%] > .super-title[_ngcontent-%COMP%]{transform:translateY(-50%);-webkit-user-select:none;user-select:none;font-size:10vh}"],data:{animation:[O.s]}}),ae})(),children:[{path:"software-development",loadChildren:()=>Promise.all([U.e(592),U.e(821)]).then(U.bind(U,2821)).then(ae=>ae.DevelopmentSkillsPageModule)},{path:"graphic-design",loadChildren:()=>Promise.all([U.e(592),U.e(923)]).then(U.bind(U,1923)).then(ae=>ae.DesignSkillsPageModule)}]}];let it=(()=>{class ae{}return ae.\u0275fac=function(oe){return new(oe||ae)},ae.\u0275mod=Y.oAB({type:ae}),ae.\u0275inj=Y.cJS({imports:[C.ez,we.Bz.forChild(wt)]}),ae})()},7809:(Vt,Be,U)=>{U.r(Be),U.d(Be,{WorkExperiencePageModule:()=>ie});var C=U(6895);const O=[{year:"2012 - 2014",title:"Josimar Producciones",subtitle:"External Photography assistant and Graphic designer",rolesAndResp:["Provide assistance on lighting on photo shooting sessions and carrying equipment","Design photo albums and markups","Design advertising","Attend people on events"]},{year:"2013 - 2020",title:"Freelance",subtitle:"Graphic/Web designer and Front-end developer",rolesAndResp:["Catch projects and manage negotiations","Ensure self-advertising and positioning","Perform Top quality Graphic Design tasks: Advertising design, Web design, UX/UI, - Design Packaging","Create multiple styles of illustrations by requirements: Digital painting, vectors, 3D","Make Graphics and animations for games and advertising","Develop Front-end for Single Page Applications (Web and mobile) using web-based Technologies (HTML, JS, CSS)","Develop and maintain Web APIs (PHP)","Lead temporal teams on complex or multi-part projects like video animations, brand identity and software development"]},{year:"2019 - 2020",title:"Creative Sales S.R.L.",subtitle:"External Full-stack developer",rolesAndResp:["Maintain a CakePHP code base","Design and develop features in the system: UX/UI, programming","Design and develop new subsystems using Angular","Make sure the code meets quality and security standards"]},{year:"2020 - 2022",title:"4ID, Ltd.",subtitle:"Senior Front-end developer",rolesAndResp:["Maintain existing code bases","Design and develop features for a currently running web-based service","Propose and execute improvements in UX/UI for existing systems","Design and develop requirements for new systems","Meet quality code requirements","Communicate frequently with team members","Attend on-demand clients requirements","Work on Back-end features whenever it was necessary.","Research and development of new technologies for the company","Design requirements documentation for new features"]},{year:"2022 - CURRENTLY",title:"publicis sapient",subtitle:"Senior Associate Experience Technology L1",rolesAndResp:["Develop web applications that follow the latest web standards and conform with leading-edge front-end technologies","Work closely with Creative, Business, Technology and QA teams to ensure the technology will be functional and meet performance targets on all web platforms (mobile, desktop)","Own the development of web applications and ensure they follow the overall technical architecture and design established by the technical lead","Implement user and business requirements which are composed of multiple development activities","Maintain up-to-date and complete documentation on projects as dictated by the capabilities guidelines and best practices","Debug or troubleshoot complex issues in existing web applications","Provide proactive feedback on policies and procedures when an opportunity for improvement exists"]}];var Y=U(7340);const Q=(0,Y.oB)({opacity:1}),we=(0,Y.oB)({opacity:0}),je=(0,Y.jt)("500ms ease-out",Q),Ye=(0,Y.jt)("500ms ease-out",we);(0,Y.oQ)((0,Y.jt)("{{ timing }}",Q)),(0,Y.oQ)((0,Y.jt)("{{ timing }}",we));var ae=U(5447);const be=(0,Y.X$)("routeAnimations",[(0,Y.eR)(":enter",[(0,Y.IO)(".work-exp",ae.TR),(0,Y.IO)("#background",[we,je]),(0,Y.IO)("li",ae.TR),(0,Y.ru)([(0,Y.IO)(".work-exp__roles-resp",(0,Y.oB)({overflow:"hidden"})),(0,Y.IO)(".work-exp",(0,Y.EY)(100,ae.hg)),(0,Y.IO)("li",(0,Y.EY)(100,ae.hg))])]),(0,Y.eR)(":leave",[(0,Y.ru)([(0,Y.IO)("#background",[Ye]),(0,Y.IO)(".work-exp",(0,Y._7)(ae.QW,{params:{timing:"300ms"}}))])])]);var oe=U(8256);const Lt=["wrapper"],Xe=["item"];function Ct(qe,Pt){if(1&qe&&(oe.TgZ(0,"li"),oe._uU(1),oe.qZA()),2&qe){const xe=Pt.$implicit;oe.xp6(1),oe.Oqu(xe)}}function ot(qe,Pt){if(1&qe&&(oe.TgZ(0,"div",10)(1,"h4"),oe._uU(2,"Roles and Responsibilities"),oe.qZA(),oe.TgZ(3,"ul"),oe.YNc(4,Ct,2,1,"li",11),oe.qZA()()),2&qe){const xe=oe.oxw().$implicit;oe.xp6(4),oe.Q6J("ngForOf",xe.rolesAndResp)}}function at(qe,Pt){if(1&qe&&(oe.TgZ(0,"div",4,5)(2,"div",6),oe._uU(3),oe.qZA(),oe.TgZ(4,"h3",7),oe._uU(5),oe.qZA(),oe.TgZ(6,"div",8),oe._uU(7),oe.qZA(),oe.YNc(8,ot,5,1,"div",9),oe.qZA()),2&qe){const xe=Pt.$implicit;oe.xp6(3),oe.Oqu(xe.year),oe.xp6(2),oe.Oqu(xe.title),oe.xp6(2),oe.Oqu(xe.subtitle),oe.xp6(1),oe.Q6J("ngIf",xe.rolesAndResp.length)}}const Kt=function(qe){return{"height.px":qe}};let Pn=(()=>{class qe{get backgroundHeight(){return this.itemElement?.nativeElement.clientHeight+100||0}constructor(xe){this.cd=xe,this.isScrollingOnX=!1,this.currentDragSpeed=0,this.decelerationThreshold=2,this.workExperience=O}ngAfterViewInit(){}scrollOnDrag(xe){this.isScrollingOnX&&(this.currentDragSpeed=-1*xe.movementX,this.wrapperElement.nativeElement.scrollBy(this.currentDragSpeed,0))}initDrag(){this.isScrollingOnX=!0}endDrag(){this.isScrollingOnX=!1}scrollOnX(xe){xe.preventDefault(),this.wrapperElement.nativeElement.scrollBy({left:xe.deltaY})}}return qe.\u0275fac=function(xe){return new(xe||qe)(oe.Y36(oe.sBO))},qe.\u0275cmp=oe.Xpm({type:qe,selectors:[["app-work-experience-page"]],viewQuery:function(xe,Qe){if(1&xe&&(oe.Gf(Lt,5),oe.Gf(Xe,5)),2&xe){let Fe;oe.iGM(Fe=oe.CRH())&&(Qe.wrapperElement=Fe.first),oe.iGM(Fe=oe.CRH())&&(Qe.itemElement=Fe.first)}},hostBindings:function(xe,Qe){1&xe&&oe.NdJ("mousemove",function(Je){return Qe.scrollOnDrag(Je)})("mousedown",function(Je){return Qe.initDrag(Je)})("mouseup",function(Je){return Qe.endDrag(Je)},!1,oe.Jf7)("wheel",function(Je){return Qe.scrollOnX(Je)})},decls:4,vars:5,consts:[["id","wrapper"],["wrapper",""],["id","background",3,"ngStyle"],["class","work-exp",4,"ngFor","ngForOf"],[1,"work-exp"],["item",""],[1,"work-exp__year"],[1,"work-exp__title","super-title"],[1,"work-exp__subtitle"],["class","work-exp__roles-resp",4,"ngIf"],[1,"work-exp__roles-resp"],[4,"ngFor","ngForOf"]],template:function(xe,Qe){1&xe&&(oe.TgZ(0,"div",0,1),oe._UZ(2,"div",2),oe.YNc(3,at,9,4,"div",3),oe.qZA()),2&xe&&(oe.Q6J("@routeAnimations",void 0),oe.xp6(2),oe.Q6J("ngStyle",oe.VKq(3,Kt,Qe.backgroundHeight)),oe.xp6(1),oe.Q6J("ngForOf",Qe.workExperience))},dependencies:[C.sg,C.O5,C.PC],styles:['#wrapper[_ngcontent-%COMP%]{display:grid;grid-auto-columns:minmax(50rem,auto);grid-auto-rows:auto;gap:10rem;align-items:start;align-content:center;overflow:auto;-webkit-user-select:none;user-select:none;height:100%;padding:var(--main-content-padding) 10rem;z-index:1}#wrapper[_ngcontent-%COMP%]:active{cursor:grabbing}#wrapper[_ngcontent-%COMP%]   #background[_ngcontent-%COMP%]{background:rgba(255,255,255,.05);-webkit-backdrop-filter:var(--bg-blur);backdrop-filter:var(--bg-blur);position:fixed;z-index:-1;width:100%;top:calc(50% + var(--main-content-padding) - 20px);transform:translateY(-50%);left:0}.work-exp[_ngcontent-%COMP%]{grid-row:1;display:grid;grid-template-columns:[start] minmax(10rem,max-content) [content] 1fr [end];align-content:start;column-gap:2rem;row-gap:.5rem;padding-right:2rem;overflow:auto;height:100%}.work-exp__year[_ngcontent-%COMP%]{padding-top:1rem;grid-column:start;text-align:center;font-weight:700}.work-exp__title[_ngcontent-%COMP%], .work-exp__subtitle[_ngcontent-%COMP%], .work-exp__roles-resp[_ngcontent-%COMP%]{grid-column:content}.work-exp__title[_ngcontent-%COMP%]{font-size:3rem}.work-exp__subtitle[_ngcontent-%COMP%]{margin-bottom:3rem;font-weight:700;text-transform:uppercase}.work-exp__roles-resp[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:1rem}.work-exp__roles-resp[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-left:3rem}.work-exp__roles-resp[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem;list-style:none}.work-exp__roles-resp[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:"";position:absolute;top:.5rem;left:-1.7rem;width:.75rem;height:.75rem;background-color:var(--accent-color);border-radius:100%}'],data:{animation:[be]}}),qe})();var yt=U(521);const Ge=[{path:"",component:Pn}];let ie=(()=>{class qe{}return qe.\u0275fac=function(xe){return new(xe||qe)},qe.\u0275mod=oe.oAB({type:qe}),qe.\u0275inj=oe.cJS({imports:[C.ez,yt.Bz.forChild(Ge)]}),qe})()},4304:(Vt,Be,U)=>{U.d(Be,{I:()=>O});const O=(0,U(7340).oB)({position:"absolute",width:"100%",height:"100%",bottom:0,left:0})},5447:(Vt,Be,U)=>{U.d(Be,{FM:()=>wt,QW:()=>Lt,TR:()=>Q,_G:()=>it,hg:()=>Ye,ht:()=>O,vF:()=>Y});var C=U(7340);const O=(0,C.oB)({opacity:1,transform:"translateX(0)"}),Y=(0,C.oB)({opacity:0,transform:"translateX(-20rem)"}),Q=(0,C.oB)({opacity:0,transform:"translateX(20rem)"}),we=(0,C.oB)({opacity:0,transform:"translateY(20rem)"}),je=(0,C.oB)({opacity:0,transform:"translateY(-20rem)"}),Ye=(0,C.jt)("500ms ease-out",O),wt=(0,C.jt)("500ms ease-in",Y),it=(0,C.jt)("500ms ease-in",Q),Lt=((0,C.jt)("500ms ease-in",we),(0,C.jt)("500ms ease-in",je),(0,C.oQ)((0,C.jt)("{{ timing }}",O)),(0,C.oQ)((0,C.jt)("{{ timing }}",Y)));(0,C.oQ)((0,C.jt)("{{ timing }}",Q)),(0,C.oQ)((0,C.jt)("{{ timing }}",we)),(0,C.oQ)((0,C.jt)("{{ timing }}",je))},6722:(Vt,Be,U)=>{U.d(Be,{u:()=>Y});var C=U(6895),O=U(8256);let Y=(()=>{class Q{}return Q.\u0275fac=function(je){return new(je||Q)},Q.\u0275mod=O.oAB({type:Q}),Q.\u0275inj=O.cJS({imports:[C.ez]}),Q})()},2738:(Vt,Be,U)=>{U.d(Be,{q:()=>Ye});var C=U(8256),O=U(521),Y=U(6895);const Q=["label"],we=function(wt){return{active:wt}},je=["*"];let Ye=(()=>{class wt{constructor(ae){this.router=ae,this.isActive=!1,this.route=null,this.hostTabindex="-1",this.role="",this.ariaLabel=""}ngOnInit(){this.role=this.route?"link":"button"}ngAfterViewInit(){this.ariaLabel=this.labelElem.nativeElement.textContent||""}}return wt.\u0275fac=function(ae){return new(ae||wt)(C.Y36(O.F0))},wt.\u0275cmp=C.Xpm({type:wt,selectors:[["link-button"]],viewQuery:function(ae,be){if(1&ae&&C.Gf(Q,5),2&ae){let oe;C.iGM(oe=C.CRH())&&(be.labelElem=oe.first)}},hostVars:1,hostBindings:function(ae,be){2&ae&&C.uIk("tabindex",be.hostTabindex)},inputs:{isActive:["active","isActive"],route:"route"},ngContentSelectors:je,decls:10,vars:5,consts:[["id","wrapper","tabindex","0",3,"ngClass","click"],["id","icon"],["viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M1.39589 10.8695C0.880775 11.3846 0 11.0198 0 10.2913L5.1695e-08 0.817692C5.1695e-08 0.366093 0.366095 4.48021e-07 0.817696 4.48021e-07L10.2914 0C11.0198 0 11.3847 0.88077 10.8695 1.39589L1.39589 10.8695Z"],["d","M12.6041 3.13051C13.1192 2.6154 14 2.98022 14 3.70871V13.1823C14 13.6339 13.6339 14 13.1823 14H3.70865C2.98016 14 2.61533 13.1192 3.13045 12.6041L12.6041 3.13051Z"],["id","content"],["id","label"],["label",""],["id","line"]],template:function(ae,be){1&ae&&(C.F$t(),C.TgZ(0,"div",0),C.NdJ("click",function(){return be.route?be.router.navigate([be.route]):null}),C.TgZ(1,"div",1),C.O4$(),C.TgZ(2,"svg",2),C._UZ(3,"path",3)(4,"path",4),C.qZA()(),C.kcU(),C.TgZ(5,"div",5)(6,"span",6,7),C.Hsn(8),C.qZA(),C._UZ(9,"div",8),C.qZA()()),2&ae&&(C.Q6J("ngClass",C.VKq(3,we,be.isActive)),C.uIk("aria-label",be.ariaLabel)("role",be.role))},dependencies:[Y.mk],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;padding:1rem 1.5rem}#wrapper[_ngcontent-%COMP%]:not(.active){cursor:pointer}#wrapper[_ngcontent-%COMP%]:not(.active)   #label[_ngcontent-%COMP%]{color:#ffffff80}#wrapper[_ngcontent-%COMP%]:not(.active):hover   #label[_ngcontent-%COMP%]{color:var(--link-selected-color)}#wrapper.active[_ngcontent-%COMP%]   #label[_ngcontent-%COMP%]{color:var(--link-selected-color);text-shadow:var(--link-selected-shadow)}#wrapper.active[_ngcontent-%COMP%]   #line[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_line .5s ease-out;animation-delay:.4s;animation-fill-mode:backwards;transform:scaleX(1);background-color:var(--accent-color)}#wrapper.active[_ngcontent-%COMP%]   #icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:var(--accent-color)}#wrapper.active[_ngcontent-%COMP%]   #icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:first-child{animation:_ngcontent-%COMP%_icon-top .5s ease-out}#wrapper.active[_ngcontent-%COMP%]   #icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]:last-child{animation:_ngcontent-%COMP%_icon-bottom .5s ease-out}#content[_ngcontent-%COMP%]{position:relative}#label[_ngcontent-%COMP%]{display:block;text-transform:uppercase;font-weight:700;-webkit-user-select:none;user-select:none;transition:.35s ease-in-out;width:100%}#line[_ngcontent-%COMP%]{display:block;transform-origin:0;width:100%;height:.4rem;margin-top:.1rem;transform:scaleX(0);transition:.35s}#icon[_ngcontent-%COMP%]{margin:0 .5rem .7rem 0;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-start}#icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:1.25rem}@keyframes _ngcontent-%COMP%_icon-top{0%{transform:translate(-1rem,-1rem);opacity:0}to{transform:translate(0);opacity:1}}@keyframes _ngcontent-%COMP%_icon-bottom{0%{transform:translate(1rem,1rem);opacity:0}to{transform:translate(0);opacity:1}}@keyframes _ngcontent-%COMP%_line{0%{transform:scaleX(0)}to{transform:scaleX(1)}}"]}),wt})()},3875:(Vt,Be,U)=>{U.d(Be,{c:()=>Q});var C=U(6895),O=U(521),Y=U(8256);let Q=(()=>{class we{}return we.\u0275fac=function(Ye){return new(Ye||we)},we.\u0275mod=Y.oAB({type:we}),we.\u0275inj=Y.cJS({imports:[C.ez,O.Bz]}),we})()},3266:(Vt,Be,U)=>{U.d(Be,{N:()=>C});const C=[{label:"About me",route:"/about-me"},{label:"Skillset",route:"/skillset"},{label:"Work experience",route:"/work-experience"}]},8026:(Vt,Be,U)=>{U.d(Be,{B:()=>O});var C=U(8256);let O=(()=>{class Y{constructor(){this.prevAngle=0,this.currentAngle=0}get angle(){return this.currentAngle}updateAngle(we){we!=this.prevAngle&&(this.prevAngle=this.currentAngle,this.currentAngle=we)}}return Y.\u0275fac=function(we){return new(we||Y)},Y.\u0275prov=C.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"}),Y})()},1962:(Vt,Be,U)=>{U.d(Be,{V:()=>Y});var C=U(8256);let O=(()=>{class Q{getRouteLastSegment(je){return(je.match(/[\w-]+$/)||[""])[0]}}return Q.\u0275fac=function(je){return new(je||Q)},Q.\u0275prov=C.Yz7({token:Q,factory:Q.\u0275fac,providedIn:"root"}),Q})(),Y=(()=>{class Q{get path(){return this._route}constructor(je){this.utils=je,this._route="",this.segment=""}setRoute(je){return this._route=je,this.segment=this.utils.getRouteLastSegment(this._route)||"home",this._route}}return Q.\u0275fac=function(je){return new(je||Q)(C.LFG(O))},Q.\u0275prov=C.Yz7({token:Q,factory:Q.\u0275fac,providedIn:"root"}),Q})()},2983:(Vt,Be,U)=>{var C=U(1481),O=U(8256),Y=U(7340);function we(i){return new O.vHH(3e3,!1)}function Sn(){return typeof window<"u"&&typeof window.document<"u"}function En(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function rn(i){switch(i.length){case 0:return new Y.ZN;case 1:return i[0];default:return new Y.ZE(i)}}function qn(i,e,t,n,r=new Map,o=new Map){const l=[],c=[];let u=-1,d=null;if(n.forEach(h=>{const f=h.get("offset"),p=f==u,y=p&&d||new Map;h.forEach((x,_)=>{let w=_,S=x;if("offset"!==_)switch(w=e.normalizePropertyName(w,l),S){case Y.k1:S=r.get(_);break;case Y.l3:S=o.get(_);break;default:S=e.normalizeStyleValue(_,w,S,l)}y.set(w,S)}),p||c.push(y),d=y,u=f}),l.length)throw function Ft(i){return new O.vHH(3502,!1)}();return c}function Yn(i,e,t,n){switch(e){case"start":i.onStart(()=>n(t&&Jt(t,"start",i)));break;case"done":i.onDone(()=>n(t&&Jt(t,"done",i)));break;case"destroy":i.onDestroy(()=>n(t&&Jt(t,"destroy",i)))}}function Jt(i,e,t){const o=Ir(i.element,i.triggerName,i.fromState,i.toState,e||i.phaseName,t.totalTime??i.totalTime,!!t.disabled),l=i._data;return null!=l&&(o._data=l),o}function Ir(i,e,t,n,r="",o=0,l){return{element:i,triggerName:e,fromState:t,toState:n,phaseName:r,totalTime:o,disabled:!!l}}function Hn(i,e,t){let n=i.get(e);return n||i.set(e,n=t),n}function Hr(i){const e=i.indexOf(":");return[i.substring(1,e),i.slice(e+1)]}let yn=(i,e)=>!1,Pr=(i,e,t)=>[],wo=null;function oi(i){const e=i.parentNode||i.host;return e===wo?null:e}(En()||typeof Element<"u")&&(Sn()?(wo=(()=>document.documentElement)(),yn=(i,e)=>{for(;e;){if(e===i)return!0;e=oi(e)}return!1}):yn=(i,e)=>i.contains(e),Pr=(i,e,t)=>{if(t)return Array.from(i.querySelectorAll(e));const n=i.querySelector(e);return n?[n]:[]});let ss=null,Tl=!1;const On=yn,kt=Pr;let So=(()=>{class i{validateStyleProperty(t){return function Mo(i){ss||(ss=function Xt(){return typeof document<"u"?document.body:null}()||{},Tl=!!ss.style&&"WebkitAppearance"in ss.style);let e=!0;return ss.style&&!function bo(i){return"ebkit"==i.substring(1,6)}(i)&&(e=i in ss.style,!e&&Tl&&(e="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in ss.style)),e}(t)}matchesElement(t,n){return!1}containsElement(t,n){return On(t,n)}getParentElement(t){return oi(t)}query(t,n,r){return kt(t,n,r)}computeStyle(t,n,r){return r||""}animate(t,n,r,o,l,c=[],u){return new Y.ZN(r,o)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=O.Yz7({token:i,factory:i.\u0275fac}),i})(),Ss=(()=>{class i{}return i.NOOP=new So,i})();const wn=1e3,ni="ng-enter",ri="ng-leave",ai="ng-trigger",pn=".ng-trigger",Gr="ng-animating",os=".ng-animating";function ir(i){if("number"==typeof i)return i;const e=i.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Es(parseFloat(e[1]),e[2])}function Es(i,e){return"s"===e?i*wn:i}function Eo(i,e,t){return i.hasOwnProperty("duration")?i:function Fa(i,e,t){let r,o=0,l="";if("string"==typeof i){const c=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return e.push(we()),{duration:0,delay:0,easing:""};r=Es(parseFloat(c[1]),c[2]);const u=c[3];null!=u&&(o=Es(parseFloat(u),c[4]));const d=c[5];d&&(l=d)}else r=i;if(!t){let c=!1,u=e.length;r<0&&(e.push(function je(){return new O.vHH(3100,!1)}()),c=!0),o<0&&(e.push(function Ye(){return new O.vHH(3101,!1)}()),c=!0),c&&e.splice(u,0,we())}return{duration:r,delay:o,easing:l}}(i,e,t)}function as(i,e={}){return Object.keys(i).forEach(t=>{e[t]=i[t]}),e}function Rr(i){const e=new Map;return Object.keys(i).forEach(t=>{e.set(t,i[t])}),e}function mn(i,e=new Map,t){if(t)for(let[n,r]of t)e.set(n,r);for(let[n,r]of i)e.set(n,r);return e}function sn(i,e,t){return t?e+":"+t+";":""}function Ts(i){let e="";for(let t=0;t<i.style.length;t++){const n=i.style.item(t);e+=sn(0,n,i.style.getPropertyValue(n))}for(const t in i.style)i.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=sn(0,qt(t),i.style[t]));i.setAttribute("style",e)}function Yi(i,e,t){i.style&&(e.forEach((n,r)=>{const o=vn(r);t&&!t.has(r)&&t.set(r,i.style[o]),i.style[o]=n}),En()&&Ts(i))}function Fi(i,e){i.style&&(e.forEach((t,n)=>{const r=vn(n);i.style[r]=""}),En()&&Ts(i))}function ce(i){return Array.isArray(i)?1==i.length?i[0]:(0,Y.vP)(i):i}const j=new RegExp("{{\\s*(.+?)\\s*}}","g");function he(i){let e=[];if("string"==typeof i){let t;for(;t=j.exec(i);)e.push(t[1]);j.lastIndex=0}return e}function Ae(i,e,t){const n=i.toString(),r=n.replace(j,(o,l)=>{let c=e[l];return null==c&&(t.push(function it(i){return new O.vHH(3003,!1)}()),c=""),c.toString()});return r==n?i:r}function nt(i){const e=[];let t=i.next();for(;!t.done;)e.push(t.value),t=i.next();return e}const $t=/-+([a-z0-9])/g;function vn(i){return i.replace($t,(...e)=>e[1].toUpperCase())}function qt(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ki(i,e,t){switch(e.type){case 7:return i.visitTrigger(e,t);case 0:return i.visitState(e,t);case 1:return i.visitTransition(e,t);case 2:return i.visitSequence(e,t);case 3:return i.visitGroup(e,t);case 4:return i.visitAnimate(e,t);case 5:return i.visitKeyframes(e,t);case 6:return i.visitStyle(e,t);case 8:return i.visitReference(e,t);case 9:return i.visitAnimateChild(e,t);case 10:return i.visitAnimateRef(e,t);case 11:return i.visitQuery(e,t);case 12:return i.visitStagger(e,t);default:throw function ae(i){return new O.vHH(3004,!1)}()}}function ka(i,e){return window.getComputedStyle(i)[e]}const Hs="*";function Ju(i,e){const t=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function Dl(i,e,t){if(":"==i[0]){const u=function Qo(i,e){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function xe(i){return new O.vHH(3016,!1)}()),"* => *"}}(i,t);if("function"==typeof u)return void e.push(u);i=u}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function Pt(i){return new O.vHH(3015,!1)}()),e;const r=n[1],o=n[2],l=n[3];e.push(di(r,l));"<"==o[0]&&!(r==Hs&&l==Hs)&&e.push(di(l,r))}(n,t,e)):t.push(i),t}const Vs=new Set(["true","1"]),ln=new Set(["false","0"]);function di(i,e){const t=Vs.has(i)||ln.has(i),n=Vs.has(e)||ln.has(e);return(r,o)=>{let l=i==Hs||i==r,c=e==Hs||e==o;return!l&&t&&"boolean"==typeof r&&(l=r?Vs.has(i):ln.has(i)),!c&&n&&"boolean"==typeof o&&(c=o?Vs.has(e):ln.has(e)),l&&c}}const As=new RegExp("s*:selfs*,?","g");function Ai(i,e,t,n){return new pt(i).build(e,t,n)}class pt{constructor(e){this._driver=e}build(e,t,n){const r=new fr(t);return this._resetContextStyleTimingState(r),ki(this,ce(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const o=[],l=[];return"@"==e.name.charAt(0)&&t.errors.push(function oe(){return new O.vHH(3006,!1)}()),e.definitions.forEach(c=>{if(this._resetContextStyleTimingState(t),0==c.type){const u=c,d=u.name;d.toString().split(/\s*,\s*/).forEach(h=>{u.name=h,o.push(this.visitState(u,t))}),u.name=d}else if(1==c.type){const u=this.visitTransition(c,t);n+=u.queryCount,r+=u.depCount,l.push(u)}else t.errors.push(function Lt(){return new O.vHH(3007,!1)}())}),{type:7,name:e.name,states:o,transitions:l,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const o=new Set,l=r||{};n.styles.forEach(c=>{c instanceof Map&&c.forEach(u=>{he(u).forEach(d=>{l.hasOwnProperty(d)||o.add(d)})})}),o.size&&(nt(o.values()),t.errors.push(function Xe(i,e){return new O.vHH(3008,!1)}()))}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=ki(this,ce(e.animation),t);return{type:1,matchers:Ju(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:pi(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>ki(this,n,t)),options:pi(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const o=e.steps.map(l=>{t.currentTime=n;const c=ki(this,l,t);return r=Math.max(r,t.currentTime),c});return t.currentTime=r,{type:3,steps:o,options:pi(e.options)}}visitAnimate(e,t){const n=function bi(i,e){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return Kn(Eo(i,e).duration,0,"");const t=i;if(t.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=Kn(0,0,"");return o.dynamic=!0,o.strValue=t,o}const r=Eo(t,e);return Kn(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let r,o=e.styles?e.styles:(0,Y.oB)({});if(5==o.type)r=this.visitKeyframes(o,t);else{let l=e.styles,c=!1;if(!l){c=!0;const d={};n.easing&&(d.easing=n.easing),l=(0,Y.oB)(d)}t.currentTime+=n.duration+n.delay;const u=this.visitStyle(l,t);u.isEmptyStep=c,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let c of r)"string"==typeof c?c===Y.l3?n.push(c):t.errors.push(new O.vHH(3002,!1)):n.push(Rr(c));let o=!1,l=null;return n.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(l=c.get("easing"),c.delete("easing")),!o))for(let u of c.values())if(u.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:n,easing:l,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,o=t.currentTime;n&&o>0&&(o-=n.duration+n.delay),e.styles.forEach(l=>{"string"!=typeof l&&l.forEach((c,u)=>{const d=t.collectedStyles.get(t.currentQuerySelector),h=d.get(u);let f=!0;h&&(o!=r&&o>=h.startTime&&r<=h.endTime&&(t.errors.push(function at(i,e,t,n,r){return new O.vHH(3010,!1)}()),f=!1),o=h.startTime),f&&d.set(u,{startTime:o,endTime:r}),t.options&&function J(i,e,t){const n=e.params||{},r=he(i);r.length&&r.forEach(o=>{n.hasOwnProperty(o)||t.push(function wt(i){return new O.vHH(3001,!1)}())})}(c,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Kt(){return new O.vHH(3011,!1)}()),n;let o=0;const l=[];let c=!1,u=!1,d=0;const h=e.steps.map(S=>{const D=this._makeStyleAst(S,t);let T=null!=D.offset?D.offset:function Cs(i){if("string"==typeof i)return null;let e=null;if(Array.isArray(i))i.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const t=i;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(D.styles),P=0;return null!=T&&(o++,P=D.offset=T),u=u||P<0||P>1,c=c||P<d,d=P,l.push(P),D});u&&t.errors.push(function Pn(){return new O.vHH(3012,!1)}()),c&&t.errors.push(function yt(){return new O.vHH(3200,!1)}());const f=e.steps.length;let p=0;o>0&&o<f?t.errors.push(function Ge(){return new O.vHH(3202,!1)}()):0==o&&(p=1/(f-1));const y=f-1,x=t.currentTime,_=t.currentAnimateTimings,w=_.duration;return h.forEach((S,D)=>{const T=p>0?D==y?1:p*D:l[D],P=T*w;t.currentTime=x+_.delay+P,_.duration=P,this._validateStyleAst(S,t),S.offset=T,n.styles.push(S)}),n}visitReference(e,t){return{type:8,animation:ki(this,ce(e.animation),t),options:pi(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:pi(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:pi(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[o,l]=function Zt(i){const e=!!i.split(/\s*,\s*/).find(t=>":self"==t);return e&&(i=i.replace(As,"")),i=i.replace(/@\*/g,pn).replace(/@\w+/g,t=>pn+"-"+t.slice(1)).replace(/:animating/g,os),[i,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+o:o,Hn(t.collectedStyles,t.currentQuerySelector,new Map);const c=ki(this,ce(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:l,animation:c,originalSelector:e.selector,options:pi(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function ie(){return new O.vHH(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Eo(e.timings,t.errors,!0);return{type:12,animation:ki(this,ce(e.animation),t),timings:n,options:null}}}class fr{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function pi(i){return i?(i=as(i)).params&&(i.params=function Vn(i){return i?as(i):null}(i.params)):i={},i}function Kn(i,e,t){return{duration:i,delay:e,easing:t}}function Co(i,e,t,n,r,o,l=null,c=!1){return{type:1,element:i,keyframes:e,preStyleProps:t,postStyleProps:n,duration:r,delay:o,totalTime:r+o,easing:l,subTimeline:c}}class Ds{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const qr=new RegExp(":enter","g"),Gs=new RegExp(":leave","g");function Ci(i,e,t,n,r,o=new Map,l=new Map,c,u,d=[]){return(new Bi).buildKeyframes(i,e,t,n,r,o,l,c,u,d)}class Bi{buildKeyframes(e,t,n,r,o,l,c,u,d,h=[]){d=d||new Ds;const f=new Ui(e,t,d,r,o,h,[]);f.options=u;const p=u.delay?ir(u.delay):0;f.currentTimeline.delayNextStep(p),f.currentTimeline.setStyles([l],null,f.errors,u),ki(this,n,f);const y=f.timelines.filter(x=>x.containsAnimation());if(y.length&&c.size){let x;for(let _=y.length-1;_>=0;_--){const w=y[_];if(w.element===t){x=w;break}}x&&!x.allowOnlyTimelineStyles()&&x.setStyles([c],null,f.errors,u)}return y.length?y.map(x=>x.buildKeyframes()):[Co(t,[],[],[],0,p,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const r=t.createSubContext(e.options),o=t.currentTimeline.currentTime,l=this._visitSubInstructions(n,r,r.options);o!=l&&t.transformIntoNewTimeline(l)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const r of e){const o=r?.delay;if(o){const l="number"==typeof o?o:ir(Ae(o,r?.params??{},t.errors));n.delayNextStep(l)}}}_visitSubInstructions(e,t,n){let o=t.currentTimeline.currentTime;const l=null!=n.duration?ir(n.duration):null,c=null!=n.delay?ir(n.delay):null;return 0!==l&&e.forEach(u=>{const d=t.appendInstructionToTimeline(u,l,c);o=Math.max(o,d.duration+d.delay)}),o}visitReference(e,t){t.updateOptions(e.options,!0),ki(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const o=e.options;if(o&&(o.params||o.delay)&&(r=t.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Yr);const l=ir(o.delay);r.delayNextStep(l)}e.steps.length&&(e.steps.forEach(l=>ki(this,l,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const o=e.options&&e.options.delay?ir(e.options.delay):0;e.steps.forEach(l=>{const c=t.createSubContext(e.options);o&&c.delayNextStep(o),ki(this,l,c),r=Math.max(r,c.currentTimeline.currentTime),n.push(c.currentTimeline)}),n.forEach(l=>t.currentTimeline.mergeTimelineCollectedStyles(l)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return Eo(t.params?Ae(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const o=e.style;5==o.type?this.visitKeyframes(o,t):(t.incrementTime(n.duration),this.visitStyle(o,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();const o=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(o):n.setStyles(e.styles,o,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,o=n.duration,c=t.createSubContext().currentTimeline;c.easing=n.easing,e.styles.forEach(u=>{c.forwardTime((u.offset||0)*o),c.setStyles(u.styles,u.easing,t.errors,t.options),c.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(c),t.transformIntoNewTimeline(r+o),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},o=r.delay?ir(r.delay):0;o&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Yr);let l=n;const c=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=c.length;let u=null;c.forEach((d,h)=>{t.currentQueryIndex=h;const f=t.createSubContext(e.options,d);o&&f.delayNextStep(o),d===t.element&&(u=f.currentTimeline),ki(this,e.animation,f),f.currentTimeline.applyStylesToKeyframe(),l=Math.max(l,f.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(l),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,o=e.timings,l=Math.abs(o.duration),c=l*(t.currentQueryTotal-1);let u=l*t.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":u=c-u;break;case"full":u=n.currentStaggerTime}const h=t.currentTimeline;u&&h.delayNextStep(u);const f=h.currentTime;ki(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-f+(r.startTime-n.currentTimeline.startTime)}}const Yr={};class Ui{constructor(e,t,n,r,o,l,c,u){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=o,this.errors=l,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Yr,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new Di(this._driver,t,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=ir(n.duration)),null!=n.delay&&(r.delay=ir(n.delay));const o=n.params;if(o){let l=r.params;l||(l=this.options.params={}),Object.keys(o).forEach(c=>{(!t||!l.hasOwnProperty(c))&&(l[c]=Ae(o[c],l,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(r=>{n[r]=t[r]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,o=new Ui(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=Yr,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},o=new Ba(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,o,l){let c=[];if(r&&c.push(this.element),e.length>0){e=(e=e.replace(qr,"."+this._enterClassName)).replace(Gs,"."+this._leaveClassName);let d=this._driver.query(this.element,e,1!=n);0!==n&&(d=n<0?d.slice(d.length+n,d.length):d.slice(0,n)),c.push(...d)}return!o&&0==c.length&&l.push(function qe(i){return new O.vHH(3014,!1)}()),c}}class Di{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Di(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||Y.l3),this._currentKeyframe.set(t,Y.l3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&this._previousKeyframe.set("easing",t);const o=r&&r.params||{},l=function Pl(i,e){const t=new Map;let n;return i.forEach(r=>{if("*"===r){n=n||e.keys();for(let o of n)t.set(o,Y.l3)}else mn(r,t)}),t}(e,this._globalTimelineStyles);for(let[c,u]of l){const d=Ae(u,o,n);this._pendingStyles.set(c,d),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??Y.l3),this._updateStyle(c,d)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const r=this._styleSummary.get(n);(!r||t.time>r.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((c,u)=>{const d=mn(c,new Map,this._backFill);d.forEach((h,f)=>{h===Y.k1?e.add(f):h===Y.l3&&t.add(f)}),n||d.set("offset",u/this.duration),r.push(d)});const o=e.size?nt(e.values()):[],l=t.size?nt(t.values()):[];if(n){const c=r[0],u=new Map(c);c.set("offset",0),u.set("offset",1),r=[c,u]}return Co(this.element,r,o,l,this.duration,this.startTime,this.easing,!1)}}class Ba extends Di{constructor(e,t,n,r,o,l,c=!1){super(e,t,l.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=c,this.timings={duration:l.duration,delay:l.delay,easing:l.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const o=[],l=n+t,c=t/l,u=mn(e[0]);u.set("offset",0),o.push(u);const d=mn(e[0]);d.set("offset",bn(c)),o.push(d);const h=e.length-1;for(let f=1;f<=h;f++){let p=mn(e[f]);const y=p.get("offset");p.set("offset",bn((t+y*n)/l)),o.push(p)}n=l,t=0,r="",e=o}return Co(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function bn(i,e=3){const t=Math.pow(10,e-1);return Math.round(i*t)/t}class Io{}const Ua=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Po extends Io{normalizePropertyName(e,t){return vn(e)}normalizeStyleValue(e,t,n,r){let o="";const l=n.toString().trim();if(Ua.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)o="px";else{const c=n.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&r.push(function be(i,e){return new O.vHH(3005,!1)}())}return l+o}}function zi(i,e,t,n,r,o,l,c,u,d,h,f,p){return{type:0,element:i,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:o,toState:n,toStyles:l,timelines:c,queriedElements:u,preStyleProps:d,postStyleProps:h,totalTime:f,errors:p}}const Rc={};class rr{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function Ll(i,e,t,n,r){return i.some(o=>o(e,t,n,r))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,n):new Map}build(e,t,n,r,o,l,c,u,d,h){const f=[],p=this.ast.options&&this.ast.options.params||Rc,x=this.buildStyles(n,c&&c.params||Rc,f),_=u&&u.params||Rc,w=this.buildStyles(r,_,f),S=new Set,D=new Map,T=new Map,P="void"===r,k={params:ea(_,p),delay:this.ast.options?.delay},H=h?[]:Ci(e,t,this.ast.animation,o,l,x,w,k,d,f);let W=0;if(H.forEach(B=>{W=Math.max(B.duration+B.delay,W)}),f.length)return zi(t,this._triggerName,n,r,P,x,w,[],[],D,T,W,f);H.forEach(B=>{const X=B.element,le=Hn(D,X,new Set);B.preStyleProps.forEach(te=>le.add(te));const Ee=Hn(T,X,new Set);B.postStyleProps.forEach(te=>Ee.add(te)),X!==t&&S.add(X)});const R=nt(S.values());return zi(t,this._triggerName,n,r,P,x,w,H,R,D,T,W)}}function ea(i,e){const t=as(e);for(const n in i)i.hasOwnProperty(n)&&null!=i[n]&&(t[n]=i[n]);return t}class za{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,r=as(this.defaultParams);return Object.keys(e).forEach(o=>{const l=e[o];null!==l&&(r[o]=l)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((l,c)=>{l&&(l=Ae(l,r,t));const u=this.normalizer.normalizePropertyName(c,t);l=this.normalizer.normalizeStyleValue(c,u,l,t),n.set(c,l)})}),n}}class Ol{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new za(r.style,r.options&&r.options.params||{},n))}),Lc(this.states,"true","1"),Lc(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new rr(e,r,this.states))}),this.fallbackTransition=function uh(i,e,t){return new rr(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(l,c)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(l=>l.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function Lc(i,e,t){i.has(e)?i.has(t)||i.set(t,i.get(e)):i.has(t)&&i.set(e,i.get(t))}const ed=new Ds;class Oc{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],r=[],o=Ai(this._driver,t,n,r);if(n.length)throw function An(i){return new O.vHH(3503,!1)}();this._animations.set(e,o)}_buildPlayer(e,t,n){const r=e.element,o=qn(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,o,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],o=this._animations.get(e);let l;const c=new Map;if(o?(l=Ci(this._driver,t,o,ni,ri,new Map,new Map,n,ed,r),l.forEach(h=>{const f=Hn(c,h.element,new Map);h.postStyleProps.forEach(p=>f.set(p,null))})):(r.push(function Tt(){return new O.vHH(3300,!1)}()),l=[]),r.length)throw function Te(i){return new O.vHH(3504,!1)}();c.forEach((h,f)=>{h.forEach((p,y)=>{h.set(y,this._driver.computeStyle(f,y,Y.l3))})});const d=rn(l.map(h=>{const f=c.get(h.element);return this._buildPlayer(h,new Map,f)}));return this._playersById.set(e,d),d.onDestroy(()=>this.destroy(e)),this.players.push(d),d}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function Se(i){return new O.vHH(3301,!1)}();return t}listen(e,t,n,r){const o=Ir(t,"","","");return Yn(this._getPlayer(e),n,o,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const o=this._getPlayer(e);switch(n){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const Nl="ng-animate-queued",Fl="ng-animate-disabled",td=[],Fc={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},rp={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Zi="__ng_removed";class kc{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function Uc(i){return i??null}(n?e.value:e),n){const o=as(e);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(r=>{null==n[r]&&(n[r]=t[r])})}}}const na="void",Ro=new kc(na);class nd{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,sr(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.has(t))throw function Le(i,e){return new O.vHH(3302,!1)}();if(null==n||0==n.length)throw function Ue(i){return new O.vHH(3303,!1)}();if(!function ia(i){return"start"==i||"done"==i}(n))throw function lt(i,e){return new O.vHH(3400,!1)}();const o=Hn(this._elementListeners,e,[]),l={name:t,phase:n,callback:r};o.push(l);const c=Hn(this._engine.statesByElement,e,new Map);return c.has(t)||(sr(e,ai),sr(e,ai+"-"+t),c.set(t,Ro)),()=>{this._engine.afterFlush(()=>{const u=o.indexOf(l);u>=0&&o.splice(u,1),this._triggers.has(t)||c.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function He(i){return new O.vHH(3401,!1)}();return t}trigger(e,t,n,r=!0){const o=this._getTrigger(t),l=new Ha(this.id,t,e);let c=this._engine.statesByElement.get(e);c||(sr(e,ai),sr(e,ai+"-"+t),this._engine.statesByElement.set(e,c=new Map));let u=c.get(t);const d=new kc(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&d.absorbOptions(u.options),c.set(t,d),u||(u=Ro),d.value!==na&&u.value===d.value){if(!function Oo(i,e){const t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++){const o=t[r];if(!e.hasOwnProperty(o)||i[o]!==e[o])return!1}return!0}(u.params,d.params)){const _=[],w=o.matchStyles(u.value,u.params,_),S=o.matchStyles(d.value,d.params,_);_.length?this._engine.reportError(_):this._engine.afterFlush(()=>{Fi(e,w),Yi(e,S)})}return}const p=Hn(this._engine.playersByElement,e,[]);p.forEach(_=>{_.namespaceId==this.id&&_.triggerName==t&&_.queued&&_.destroy()});let y=o.matchTransition(u.value,d.value,e,d.params),x=!1;if(!y){if(!r)return;y=o.fallbackTransition,x=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:y,fromState:u,toState:d,player:l,isFallbackTransition:x}),x||(sr(e,Nl),l.onStart(()=>{Ws(e,Nl)})),l.onDone(()=>{let _=this.players.indexOf(l);_>=0&&this.players.splice(_,1);const w=this._engine.playersByElement.get(e);if(w){let S=w.indexOf(l);S>=0&&w.splice(S,1)}}),this.players.push(l),p.push(l),l}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,pn,!0);n.forEach(r=>{if(r[Zi])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(l=>l.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,n,r){const o=this._engine.statesByElement.get(e),l=new Map;if(o){const c=[];if(o.forEach((u,d)=>{if(l.set(d,u.value),this._triggers.has(d)){const h=this.trigger(e,d,na,r);h&&c.push(h)}}),c.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,l),n&&rn(c).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(o=>{const l=o.name;if(r.has(l))return;r.add(l);const u=this._triggers.get(l).fallbackTransition,d=n.get(l)||Ro,h=new kc(na),f=new Ha(this.id,l,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:l,transition:u,fromState:d,toState:h,player:f,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const o=n.players.length?n.playersByQueriedElement.get(e):[];if(o&&o.length)r=!0;else{let l=e;for(;l=l.parentNode;)if(n.statesByElement.get(l)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const o=e[Zi];(!o||o===Fc)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){sr(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const o=n.element,l=this._elementListeners.get(o);l&&l.forEach(c=>{if(c.name==n.triggerName){const u=Ir(o,n.triggerName,n.fromState.value,n.toState.value);u._data=e,Yn(n.player,c.phase,u,c.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((n,r)=>{const o=n.transition.ast.depCount,l=r.transition.ast.depCount;return 0==o||0==l?o-l:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class Bc{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new nd(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let l=!1,c=this.driver.getParentElement(t);for(;c;){const u=r.get(c);if(u){const d=n.indexOf(u);n.splice(d+1,0,e),l=!0;break}c=this.driver.getParentElement(c)}l||n.unshift(e)}else n.push(e);return r.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let r of n.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&t.add(o)}return t}trigger(e,t,n,r){if(Lo(t)){const o=this._fetchNamespace(e);if(o)return o.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!Lo(t))return;const o=t[Zi];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const l=this.collectedLeaveElements.indexOf(t);l>=0&&this.collectedLeaveElements.splice(l,1)}if(e){const l=this._fetchNamespace(e);l&&l.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),sr(e,Fl)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Ws(e,Fl))}removeNode(e,t,n,r){if(Lo(t)){const o=e?this._fetchNamespace(e):null;if(o?o.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const l=this.namespacesByHostElement.get(t);l&&l.id!==e&&l.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r,o){this.collectedLeaveElements.push(t),t[Zi]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,t,n,r,o){return Lo(t)?this._fetchNamespace(e).listen(t,n,r,o):()=>{}}_buildInstruction(e,t,n,r,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,o)}destroyInnerAnimations(e){let t=this.driver.query(e,pn,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,os,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return rn(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Zi];if(t&&t.setForRemoval){if(e[Zi]=Fc,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(Fl)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)sr(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?rn(t).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(e){throw function Wt(i){return new O.vHH(3402,!1)}()}_flushAnimations(e,t){const n=new Ds,r=[],o=new Map,l=[],c=new Map,u=new Map,d=new Map,h=new Set;this.disabledNodes.forEach(re=>{h.add(re);const ve=this.driver.query(re,".ng-animate-queued",!0);for(let se=0;se<ve.length;se++)h.add(ve[se])});const f=this.bodyNode,p=Array.from(this.statesByElement.keys()),y=ra(p,this.collectedEnterElements),x=new Map;let _=0;y.forEach((re,ve)=>{const se=ni+_++;x.set(ve,se),re.forEach(Me=>sr(Me,se))});const w=[],S=new Set,D=new Set;for(let re=0;re<this.collectedLeaveElements.length;re++){const ve=this.collectedLeaveElements[re],se=ve[Zi];se&&se.setForRemoval&&(w.push(ve),S.add(ve),se.hasAnimation?this.driver.query(ve,".ng-star-inserted",!0).forEach(Me=>S.add(Me)):D.add(ve))}const T=new Map,P=ra(p,Array.from(S));P.forEach((re,ve)=>{const se=ri+_++;T.set(ve,se),re.forEach(Me=>sr(Me,se))}),e.push(()=>{y.forEach((re,ve)=>{const se=x.get(ve);re.forEach(Me=>Ws(Me,se))}),P.forEach((re,ve)=>{const se=T.get(ve);re.forEach(Me=>Ws(Me,se))}),w.forEach(re=>{this.processLeaveNode(re)})});const k=[],H=[];for(let re=this._namespaceList.length-1;re>=0;re--)this._namespaceList[re].drainQueuedTransitions(t).forEach(se=>{const Me=se.player,ke=se.element;if(k.push(Me),this.collectedEnterElements.length){const et=ke[Zi];if(et&&et.setForMove){if(et.previousTriggersValues&&et.previousTriggersValues.has(se.triggerName)){const ft=et.previousTriggersValues.get(se.triggerName),gt=this.statesByElement.get(se.element);if(gt&&gt.has(se.triggerName)){const bt=gt.get(se.triggerName);bt.value=ft,gt.set(se.triggerName,bt)}}return void Me.destroy()}}const ut=!f||!this.driver.containsElement(f,ke),ye=T.get(ke),We=x.get(ke),ze=this._buildInstruction(se,n,We,ye,ut);if(ze.errors&&ze.errors.length)return void H.push(ze);if(ut)return Me.onStart(()=>Fi(ke,ze.fromStyles)),Me.onDestroy(()=>Yi(ke,ze.toStyles)),void r.push(Me);if(se.isFallbackTransition)return Me.onStart(()=>Fi(ke,ze.fromStyles)),Me.onDestroy(()=>Yi(ke,ze.toStyles)),void r.push(Me);const ue=[];ze.timelines.forEach(et=>{et.stretchStartingKeyframe=!0,this.disabledNodes.has(et.element)||ue.push(et)}),ze.timelines=ue,n.append(ke,ze.timelines),l.push({instruction:ze,player:Me,element:ke}),ze.queriedElements.forEach(et=>Hn(c,et,[]).push(Me)),ze.preStyleProps.forEach((et,ft)=>{if(et.size){let gt=u.get(ft);gt||u.set(ft,gt=new Set),et.forEach((bt,Bt)=>gt.add(Bt))}}),ze.postStyleProps.forEach((et,ft)=>{let gt=d.get(ft);gt||d.set(ft,gt=new Set),et.forEach((bt,Bt)=>gt.add(Bt))})});if(H.length){const re=[];H.forEach(ve=>{re.push(function zn(i,e){return new O.vHH(3505,!1)}())}),k.forEach(ve=>ve.destroy()),this.reportError(re)}const W=new Map,R=new Map;l.forEach(re=>{const ve=re.element;n.has(ve)&&(R.set(ve,ve),this._beforeAnimationBuild(re.player.namespaceId,re.instruction,W))}),r.forEach(re=>{const ve=re.element;this._getPreviousPlayers(ve,!1,re.namespaceId,re.triggerName,null).forEach(Me=>{Hn(W,ve,[]).push(Me),Me.destroy()})});const B=w.filter(re=>No(re,u,d)),X=new Map;id(X,this.driver,D,d,Y.l3).forEach(re=>{No(re,u,d)&&B.push(re)});const Ee=new Map;y.forEach((re,ve)=>{id(Ee,this.driver,new Set(re),u,Y.k1)}),B.forEach(re=>{const ve=X.get(re),se=Ee.get(re);X.set(re,new Map([...Array.from(ve?.entries()??[]),...Array.from(se?.entries()??[])]))});const te=[],ee=[],ge={};l.forEach(re=>{const{element:ve,player:se,instruction:Me}=re;if(n.has(ve)){if(h.has(ve))return se.onDestroy(()=>Yi(ve,Me.toStyles)),se.disabled=!0,se.overrideTotalTime(Me.totalTime),void r.push(se);let ke=ge;if(R.size>1){let ye=ve;const We=[];for(;ye=ye.parentNode;){const ze=R.get(ye);if(ze){ke=ze;break}We.push(ye)}We.forEach(ze=>R.set(ze,ke))}const ut=this._buildAnimation(se.namespaceId,Me,W,o,Ee,X);if(se.setRealPlayer(ut),ke===ge)te.push(se);else{const ye=this.playersByElement.get(ke);ye&&ye.length&&(se.parentPlayer=rn(ye)),r.push(se)}}else Fi(ve,Me.fromStyles),se.onDestroy(()=>Yi(ve,Me.toStyles)),ee.push(se),h.has(ve)&&r.push(se)}),ee.forEach(re=>{const ve=o.get(re.element);if(ve&&ve.length){const se=rn(ve);re.setRealPlayer(se)}}),r.forEach(re=>{re.parentPlayer?re.syncPlayerEvents(re.parentPlayer):re.destroy()});for(let re=0;re<w.length;re++){const ve=w[re],se=ve[Zi];if(Ws(ve,ri),se&&se.hasAnimation)continue;let Me=[];if(c.size){let ut=c.get(ve);ut&&ut.length&&Me.push(...ut);let ye=this.driver.query(ve,os,!0);for(let We=0;We<ye.length;We++){let ze=c.get(ye[We]);ze&&ze.length&&Me.push(...ze)}}const ke=Me.filter(ut=>!ut.destroyed);ke.length?js(this,ve,ke):this.processLeaveNode(ve)}return w.length=0,te.forEach(re=>{this.players.push(re),re.onDone(()=>{re.destroy();const ve=this.players.indexOf(re);this.players.splice(ve,1)}),re.play()}),te}elementContainsData(e,t){let n=!1;const r=t[Zi];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,o){let l=[];if(t){const c=this.playersByQueriedElement.get(e);c&&(l=c)}else{const c=this.playersByElement.get(e);if(c){const u=!o||o==na;c.forEach(d=>{d.queued||!u&&d.triggerName!=r||l.push(d)})}}return(n||r)&&(l=l.filter(c=>!(n&&n!=c.namespaceId||r&&r!=c.triggerName))),l}_beforeAnimationBuild(e,t,n){const o=t.element,l=t.isRemovalTransition?void 0:e,c=t.isRemovalTransition?void 0:t.triggerName;for(const u of t.timelines){const d=u.element,h=d!==o,f=Hn(n,d,[]);this._getPreviousPlayers(d,h,l,c,t.toState).forEach(y=>{const x=y.getRealPlayer();x.beforeDestroy&&x.beforeDestroy(),y.destroy(),f.push(y)})}Fi(o,t.fromStyles)}_buildAnimation(e,t,n,r,o,l){const c=t.triggerName,u=t.element,d=[],h=new Set,f=new Set,p=t.timelines.map(x=>{const _=x.element;h.add(_);const w=_[Zi];if(w&&w.removedBeforeQueried)return new Y.ZN(x.duration,x.delay);const S=_!==u,D=function zc(i){const e=[];return Hi(i,e),e}((n.get(_)||td).map(W=>W.getRealPlayer())).filter(W=>!!W.element&&W.element===_),T=o.get(_),P=l.get(_),k=qn(0,this._normalizer,0,x.keyframes,T,P),H=this._buildPlayer(x,k,D);if(x.subTimeline&&r&&f.add(_),S){const W=new Ha(e,c,_);W.setRealPlayer(H),d.push(W)}return H});d.forEach(x=>{Hn(this.playersByQueriedElement,x.element,[]).push(x),x.onDone(()=>function us(i,e,t){let n=i.get(e);if(n){if(n.length){const r=n.indexOf(t);n.splice(r,1)}0==n.length&&i.delete(e)}return n}(this.playersByQueriedElement,x.element,x))}),h.forEach(x=>sr(x,Gr));const y=rn(p);return y.onDestroy(()=>{h.forEach(x=>Ws(x,Gr)),Yi(u,t.toStyles)}),f.forEach(x=>{Hn(r,x,[]).push(y)}),y}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new Y.ZN(e.duration,e.delay)}}class Ha{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new Y.ZN,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(r=>Yn(e,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Hn(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Lo(i){return i&&1===i.nodeType}function Va(i,e){const t=i.style.display;return i.style.display=e??"none",t}function id(i,e,t,n,r){const o=[];t.forEach(u=>o.push(Va(u)));const l=[];n.forEach((u,d)=>{const h=new Map;u.forEach(f=>{const p=e.computeStyle(d,f,r);h.set(f,p),(!p||0==p.length)&&(d[Zi]=rp,l.push(d))}),i.set(d,h)});let c=0;return t.forEach(u=>Va(u,o[c++])),l}function ra(i,e){const t=new Map;if(i.forEach(c=>t.set(c,[])),0==e.length)return t;const n=1,r=new Set(e),o=new Map;function l(c){if(!c)return n;let u=o.get(c);if(u)return u;const d=c.parentNode;return u=t.has(d)?d:r.has(d)?n:l(d),o.set(c,u),u}return e.forEach(c=>{const u=l(c);u!==n&&t.get(u).push(c)}),t}function sr(i,e){i.classList?.add(e)}function Ws(i,e){i.classList?.remove(e)}function js(i,e,t){rn(t).onDone(()=>i.processLeaveNode(e))}function Hi(i,e){for(let t=0;t<i.length;t++){const n=i[t];n instanceof Y.ZE?Hi(n.players,e):e.push(n)}}function No(i,e,t){const n=t.get(i);if(!n)return!1;let r=e.get(i);return r?n.forEach(o=>r.add(o)):e.set(i,n),t.delete(i),!0}class li{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new Bc(e,t,n),this._timelineEngine=new Oc(e,t,n),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(e,t,n,r,o){const l=e+"-"+r;let c=this._triggerCache[l];if(!c){const u=[],d=[],h=Ai(this._driver,o,u,d);if(u.length)throw function Je(i,e){return new O.vHH(3404,!1)}();c=function Or(i,e,t){return new Ol(i,e,t)}(r,h,this._normalizer),this._triggerCache[l]=c}this._transitionEngine.registerTrigger(t,r,c)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[o,l]=Hr(n);this._timelineEngine.command(o,t,l,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,o){if("@"==n.charAt(0)){const[l,c]=Hr(n);return this._timelineEngine.listen(l,t,c,o)}return this._transitionEngine.listen(e,t,n,r,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Ga=(()=>{class i{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let o=i.initialStylesByElement.get(t);o||i.initialStylesByElement.set(t,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Yi(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Yi(this._element,this._initialStyles),this._endStyles&&(Yi(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(Fi(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Fi(this._element,this._endStyles),this._endStyles=null),Yi(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function Ii(i){let e=null;return i.forEach((t,n)=>{(function Hc(i){return"display"===i||"position"===i})(n)&&(e=e||new Map,e.set(n,t))}),e}class sd{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{"offset"!==r&&e.set(r,this._finished?n:ka(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class sa{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return On(e,t)}getParentElement(e){return oi(e)}query(e,t,n){return kt(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,r,o,l=[]){const u={duration:n,delay:r,fill:0==r?"both":"forwards"};o&&(u.easing=o);const d=new Map,h=l.filter(y=>y instanceof sd);(function ls(i,e){return 0===i||0===e})(n,r)&&h.forEach(y=>{y.currentSnapshot.forEach((x,_)=>d.set(_,x))});let f=function Wr(i){return i.length?i[0]instanceof Map?i:i.map(e=>Rr(e)):[]}(t).map(y=>mn(y));f=function Lr(i,e,t){if(t.size&&e.length){let n=e[0],r=[];if(t.forEach((o,l)=>{n.has(l)||r.push(l),n.set(l,o)}),r.length)for(let o=1;o<e.length;o++){let l=e[o];r.forEach(c=>l.set(c,ka(i,c)))}}return e}(e,f,d);const p=function rd(i,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=Ii(e[0]),e.length>1&&(n=Ii(e[e.length-1]))):e instanceof Map&&(t=Ii(e)),t||n?new Ga(i,t,n):null}(e,f);return new sd(e,f,u,p)}}var Mi=U(6895);let hh=(()=>{class i extends Y._j{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:O.ifc.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?(0,Y.vP)(t):t;return ds(this._renderer,null,n,"register",[r]),new Fo(n,this._renderer)}}return i.\u0275fac=function(t){return new(t||i)(O.LFG(O.FYo),O.LFG(Mi.K0))},i.\u0275prov=O.Yz7({token:i,factory:i.\u0275fac}),i})();class Fo extends Y.LC{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new fh(this._id,e,t||{},this._renderer)}}class fh{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return ds(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function ds(i,e,t,n,r){return i.setProperty(e,`@@${t}:${n}`,r)}const ko="@.disabled";let Rt=(()=>{class i{constructor(t,n,r){this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(o,l)=>{const c=l?.parentNode(o);c&&l.removeChild(c,o)}}createRenderer(t,n){const o=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let h=this._rendererCache.get(o);return h||(h=new kl("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,h)),h}const l=n.id,c=n.id+"-"+this._currentId;this._currentId++,this.engine.register(c,t);const u=h=>{Array.isArray(h)?h.forEach(u):this.engine.registerTrigger(l,c,t,h.name,h)};return n.data.animation.forEach(u),new Wa(this,c,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,r){t>=0&&t<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[l,c]=o;l(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(t){return new(t||i)(O.LFG(O.FYo),O.LFG(li),O.LFG(O.R0b))},i.\u0275prov=O.Yz7({token:i,factory:i.\u0275fac}),i})();class kl{constructor(e,t,n,r){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?o=>t.destroyNode(o):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==ko?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Wa extends kl{constructor(e,t,n,r,o){super(t,n,r,o),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==ko?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function ci(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(e);let o=t.slice(1),l="";return"@"!=o.charAt(0)&&([o,l]=function ph(i){const e=i.indexOf(".");return[i.substring(0,e),i.slice(e+1)]}(o)),this.engine.listen(this.namespaceId,r,o,l,c=>{this.factory.scheduleListenerCallback(c._data||-1,n,c)})}return this.delegate.listen(e,t,n)}}const ad=[{provide:Y._j,useClass:hh},{provide:Io,useFactory:function ja(){return new Po}},{provide:li,useClass:(()=>{class i extends li{constructor(t,n,r,o){super(t.body,n,r)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(t){return new(t||i)(O.LFG(Mi.K0),O.LFG(Ss),O.LFG(Io),O.LFG(O.z2F))},i.\u0275prov=O.Yz7({token:i,factory:i.\u0275fac}),i})()},{provide:O.FYo,useFactory:function mh(i,e,t){return new Rt(i,e,t)},deps:[C.se,li,O.R0b]}],Pe=[{provide:Ss,useFactory:()=>new sa},{provide:O.QbO,useValue:"BrowserAnimations"},...ad],hn=[{provide:Ss,useClass:So},{provide:O.QbO,useValue:"NoopAnimations"},...ad];let ld=(()=>{class i{static withConfig(t){return{ngModule:i,providers:t.disableAnimations?hn:Pe}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=O.oAB({type:i}),i.\u0275inj=O.cJS({providers:Pe,imports:[C.b2]}),i})();var Ki=U(521),Zr=U(7320),aa=U(1278),$s=U(7809),yh=U(7747),sp=U(7498);const Vc=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",loadChildren:()=>Promise.resolve().then(U.bind(U,7320)).then(i=>Zr.HomePageModule),data:{animation:"HomePage"}},{path:"about-me",loadChildren:()=>Promise.resolve().then(U.bind(U,7498)).then(i=>sp.AboutMePageModule),data:{animation:"AboutMePage"}},{path:"skillset",loadChildren:()=>Promise.resolve().then(U.bind(U,1278)).then(i=>aa.SkillsetPageModule),data:{animation:"SkillsetPage"}},{path:"work-experience",loadChildren:()=>Promise.resolve().then(U.bind(U,7809)).then(i=>$s.WorkExperiencePageModule),data:{animation:"WorkExperiencePage"}},{path:"portfolio",loadChildren:()=>Promise.resolve().then(U.bind(U,7747)).then(i=>yh.PortfolioPageModule),data:{animation:"PortfolioPage"}}];let Vi=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=O.oAB({type:i}),i.\u0275inj=O.cJS({imports:[Ki.Bz.forRoot(Vc),Ki.Bz]}),i})();const Kr=(0,Y.X$)("routeAnimations",[]);var Uo=U(9300),Nr=U(1962),Qr=U(3266),vh=U(2738);function cd(i,e){if(1&i&&(O.TgZ(0,"link-button",3),O._uU(1),O.qZA()),2&i){const t=e.$implicit,n=O.oxw();O.Q6J("active",n.activeRouteRoot==t.route)("route",t.route),O.xp6(1),O.hij(" ",t.label," ")}}const _h=function(){return["/"]};let xh=(()=>{class i{constructor(t){this.router=t,this.activeRoute="/",this.activeRouteRoot="/",this.links=[...Qr.N]}ngOnInit(){this.router.events.pipe((0,Uo.h)(t=>t instanceof Ki.m2)).subscribe(t=>{this.activeRoute=t.url,this.activeRouteRoot=(this.activeRoute.match(/\/[\w-]+/)||["/"])[0]})}}return i.\u0275fac=function(t){return new(t||i)(O.Y36(Ki.F0))},i.\u0275cmp=O.Xpm({type:i,selectors:[["app-header"]],decls:5,vars:3,consts:[["id","logo",3,"routerLink"],["src","assets/img/logo.svg","alt","Site logo"],[3,"active","route",4,"ngFor","ngForOf"],[3,"active","route"]],template:function(t,n){1&t&&(O.TgZ(0,"header")(1,"div",0),O._UZ(2,"img",1),O.qZA(),O.TgZ(3,"nav"),O.YNc(4,cd,2,3,"link-button",2),O.qZA()()),2&t&&(O.xp6(1),O.Q6J("routerLink",O.DdM(2,_h)),O.xp6(3),O.Q6J("ngForOf",n.links))},dependencies:[Mi.sg,vh.q,Ki.rH],styles:["header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:7rem;padding:1rem 2rem}#logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:3rem}nav[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:flex-start;transform:translateY(.4rem)}"]}),i})();const Gc=["*"];let Wc=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=O.Xpm({type:i,selectors:[["app-layout"]],ngContentSelectors:Gc,decls:3,vars:0,template:function(t,n){1&t&&(O.F$t(),O._UZ(0,"app-header"),O.TgZ(1,"main"),O.Hsn(2),O.qZA())},dependencies:[xh],styles:["main[_ngcontent-%COMP%]{height:var(--main-content-height);position:relative;overflow:auto}"]}),i})();function jc(i,e,t,n,r,o,l){try{var c=i[o](l),u=c.value}catch(d){return void t(d)}c.done?e(u):Promise.resolve(u).then(n,r)}const Bl="150",zo={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Jr={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},qc=0,la=1,ca=2,dd=1,bh=2,ui=3,Qi=0,_n=1,wr=2,hs=0,M=1,I=2,E=3,N=4,q=5,fe=100,De=101,St=102,Cn=103,gn=104,Mn=200,xn=201,Si=202,Nn=203,Pi=204,fs=205,es=206,qs=207,Is=208,ua=209,da=210,$a=0,Ul=1,Mh=2,Xc=3,Zc=4,op=5,Kc=6,Qc=7,Ys=0,_g=1,hd=2,pr=0,fd=1,Ps=2,Sh=3,ha=4,qa=5,Rs=301,Xs=302,Jc=303,Hl=304,Ya=306,Ho=1e3,Ei=1001,Vl=1002,ti=1003,ts=1004,Xa=1005,Qn=1006,or=1007,br=1008,Vo=1009,eu=1010,Gl=1011,Za=1012,Ka=1013,Ls=1014,ps=1015,hi=1016,bg=1017,Qa=1018,Fn=1020,cp=1021,Gi=1023,Eh=1024,Mg=1025,Wl=1026,tu=1027,up=1028,Ja=1029,Th=1030,Sg=1031,Ri=1033,jl=33776,Go=33777,pd=33778,Fr=33779,fa=35840,Ah=35841,Zs=35842,$l=35843,Ch=36196,dp=37492,Dh=37496,hp=37808,Mr=37809,nu=37810,pa=37811,fp=37812,md=37813,gd=37814,Ih=37815,pp=37816,g=37817,v=37818,m=37819,b=37820,A=37821,L=36492,F=36283,K=36284,me=36285,Ke=36286,kr=2300,Sr=2301,b_=0,M_=1,gp=2,ql=3e3,Xn=3001,Eg=3201,Yl=0,Tg=1,Js="srgb",Lh="srgb-linear",Ag="display-p3",Rg="300 es",yp=1035;class Wi{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const o=r.indexOf(t);-1!==o&&r.splice(o,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const r=n.slice(0);for(let o=0,l=r.length;o<l;o++)r[o].call(this,e);e.target=null}}}const ar=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const ma=Math.PI/180,ji=180/Math.PI;function mr(){const i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(ar[255&i]+ar[i>>8&255]+ar[i>>16&255]+ar[i>>24&255]+"-"+ar[255&e]+ar[e>>8&255]+"-"+ar[e>>16&15|64]+ar[e>>24&255]+"-"+ar[63&t|128]+ar[t>>8&255]+"-"+ar[t>>16&255]+ar[t>>24&255]+ar[255&n]+ar[n>>8&255]+ar[n>>16&255]+ar[n>>24&255]).toLowerCase()}function Ti(i,e,t){return Math.max(e,Math.min(t,i))}function Oh(i,e){return(i%e+e)%e}function vd(i,e,t){return(1-t)*i+t*e}function wp(i){return 0==(i&i-1)&&0!==i}function Nh(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Fh(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function ns(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Jn(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(65535*i);case Uint8Array:return Math.round(255*i);case Int16Array:return Math.round(32767*i);case Int8Array:return Math.round(127*i);default:throw new Error("Invalid component type.")}}const kg_radToDeg=function O_(i){return i*ji};class Oe{constructor(e=0,t=0){Oe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),o=this.x-e.x,l=this.y-e.y;return this.x=o*n-l*r+e.x,this.y=o*r+l*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class lr{constructor(){lr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,r,o,l,c,u,d){const h=this.elements;return h[0]=e,h[1]=r,h[2]=c,h[3]=t,h[4]=o,h[5]=u,h[6]=n,h[7]=l,h[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,o=this.elements,l=n[0],c=n[3],u=n[6],d=n[1],h=n[4],f=n[7],p=n[2],y=n[5],x=n[8],_=r[0],w=r[3],S=r[6],D=r[1],T=r[4],P=r[7],k=r[2],H=r[5],W=r[8];return o[0]=l*_+c*D+u*k,o[3]=l*w+c*T+u*H,o[6]=l*S+c*P+u*W,o[1]=d*_+h*D+f*k,o[4]=d*w+h*T+f*H,o[7]=d*S+h*P+f*W,o[2]=p*_+y*D+x*k,o[5]=p*w+y*T+x*H,o[8]=p*S+y*P+x*W,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],l=e[4],c=e[5],u=e[6],d=e[7],h=e[8];return t*l*h-t*c*d-n*o*h+n*c*u+r*o*d-r*l*u}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],l=e[4],c=e[5],u=e[6],d=e[7],h=e[8],f=h*l-c*d,p=c*u-h*o,y=d*o-l*u,x=t*f+n*p+r*y;if(0===x)return this.set(0,0,0,0,0,0,0,0,0);const _=1/x;return e[0]=f*_,e[1]=(r*d-h*n)*_,e[2]=(c*n-r*l)*_,e[3]=p*_,e[4]=(h*t-r*u)*_,e[5]=(r*o-c*t)*_,e[6]=y*_,e[7]=(n*u-d*t)*_,e[8]=(l*t-n*o)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,o,l,c){const u=Math.cos(o),d=Math.sin(o);return this.set(n*u,n*d,-n*(u*l+d*c)+l+e,-r*d,r*u,-r*(-d*l+u*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(bp.makeScale(e,t)),this}rotate(e){return this.premultiply(bp.makeRotation(-e)),this}translate(e,t){return this.premultiply(bp.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const bp=new lr;function Bg(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function xd(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;class gr{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,o,l,c){let u=n[r+0],d=n[r+1],h=n[r+2],f=n[r+3];const p=o[l+0],y=o[l+1],x=o[l+2],_=o[l+3];if(0===c)return e[t+0]=u,e[t+1]=d,e[t+2]=h,void(e[t+3]=f);if(1===c)return e[t+0]=p,e[t+1]=y,e[t+2]=x,void(e[t+3]=_);if(f!==_||u!==p||d!==y||h!==x){let w=1-c;const S=u*p+d*y+h*x+f*_,D=S>=0?1:-1,T=1-S*S;if(T>Number.EPSILON){const k=Math.sqrt(T),H=Math.atan2(k,S*D);w=Math.sin(w*H)/k,c=Math.sin(c*H)/k}const P=c*D;if(u=u*w+p*P,d=d*w+y*P,h=h*w+x*P,f=f*w+_*P,w===1-c){const k=1/Math.sqrt(u*u+d*d+h*h+f*f);u*=k,d*=k,h*=k,f*=k}}e[t]=u,e[t+1]=d,e[t+2]=h,e[t+3]=f}static multiplyQuaternionsFlat(e,t,n,r,o,l){const c=n[r],u=n[r+1],d=n[r+2],h=n[r+3],f=o[l],p=o[l+1],y=o[l+2],x=o[l+3];return e[t]=c*x+h*f+u*y-d*p,e[t+1]=u*x+h*p+d*f-c*y,e[t+2]=d*x+h*y+c*p-u*f,e[t+3]=h*x-c*f-u*p-d*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,r=e._y,o=e._z,l=e._order,c=Math.cos,u=Math.sin,d=c(n/2),h=c(r/2),f=c(o/2),p=u(n/2),y=u(r/2),x=u(o/2);switch(l){case"XYZ":this._x=p*h*f+d*y*x,this._y=d*y*f-p*h*x,this._z=d*h*x+p*y*f,this._w=d*h*f-p*y*x;break;case"YXZ":this._x=p*h*f+d*y*x,this._y=d*y*f-p*h*x,this._z=d*h*x-p*y*f,this._w=d*h*f+p*y*x;break;case"ZXY":this._x=p*h*f-d*y*x,this._y=d*y*f+p*h*x,this._z=d*h*x+p*y*f,this._w=d*h*f-p*y*x;break;case"ZYX":this._x=p*h*f-d*y*x,this._y=d*y*f+p*h*x,this._z=d*h*x-p*y*f,this._w=d*h*f+p*y*x;break;case"YZX":this._x=p*h*f+d*y*x,this._y=d*y*f+p*h*x,this._z=d*h*x-p*y*f,this._w=d*h*f-p*y*x;break;case"XZY":this._x=p*h*f-d*y*x,this._y=d*y*f-p*h*x,this._z=d*h*x+p*y*f,this._w=d*h*f+p*y*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],o=t[8],l=t[1],c=t[5],u=t[9],d=t[2],h=t[6],f=t[10],p=n+c+f;if(p>0){const y=.5/Math.sqrt(p+1);this._w=.25/y,this._x=(h-u)*y,this._y=(o-d)*y,this._z=(l-r)*y}else if(n>c&&n>f){const y=2*Math.sqrt(1+n-c-f);this._w=(h-u)/y,this._x=.25*y,this._y=(r+l)/y,this._z=(o+d)/y}else if(c>f){const y=2*Math.sqrt(1+c-n-f);this._w=(o-d)/y,this._x=(r+l)/y,this._y=.25*y,this._z=(u+h)/y}else{const y=2*Math.sqrt(1+f-n-c);this._w=(l-r)/y,this._x=(o+d)/y,this._y=(u+h)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ti(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,o=e._z,l=e._w,c=t._x,u=t._y,d=t._z,h=t._w;return this._x=n*h+l*c+r*d-o*u,this._y=r*h+l*u+o*c-n*d,this._z=o*h+l*d+n*u-r*c,this._w=l*h-n*c-r*u-o*d,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,o=this._z,l=this._w;let c=l*e._w+n*e._x+r*e._y+o*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=l,this._x=n,this._y=r,this._z=o,this;const u=1-c*c;if(u<=Number.EPSILON){const y=1-t;return this._w=y*l+t*this._w,this._x=y*n+t*this._x,this._y=y*r+t*this._y,this._z=y*o+t*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(u),h=Math.atan2(d,c),f=Math.sin((1-t)*h)/d,p=Math.sin(t*h)/d;return this._w=l*f+this._w*p,this._x=n*f+this._x*p,this._y=r*f+this._y*p,this._z=o*f+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(o),n*Math.cos(o),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class V{constructor(e=0,t=0,n=0){V.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Mp.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Mp.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*n+o[6]*r,this.y=o[1]*t+o[4]*n+o[7]*r,this.z=o[2]*t+o[5]*n+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,o=e.elements,l=1/(o[3]*t+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*n+o[8]*r+o[12])*l,this.y=(o[1]*t+o[5]*n+o[9]*r+o[13])*l,this.z=(o[2]*t+o[6]*n+o[10]*r+o[14])*l,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,o=e.x,l=e.y,c=e.z,u=e.w,d=u*t+l*r-c*n,h=u*n+c*t-o*r,f=u*r+o*n-l*t,p=-o*t-l*n-c*r;return this.x=d*u+p*-o+h*-c-f*-l,this.y=h*u+p*-l+f*-o-d*-c,this.z=f*u+p*-c+d*-l-h*-o,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r,this.y=o[1]*t+o[5]*n+o[9]*r,this.z=o[2]*t+o[6]*n+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,o=e.z,l=t.x,c=t.y,u=t.z;return this.x=r*u-o*c,this.y=o*l-n*u,this.z=n*c-r*l,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return wd.copy(this).projectOnVector(e),this.sub(wd)}reflect(e){return this.sub(wd.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ti(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const wd=new V,Mp=new gr;function tl(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function Sp(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}const F_=(new lr).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Ug=(new lr).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),ga=new V,Hg={[Lh]:i=>i,[Js]:i=>i.convertSRGBToLinear(),[Ag]:function Xl(i){return i.convertSRGBToLinear(),ga.set(i.r,i.g,i.b).applyMatrix3(Ug),i.setRGB(ga.x,ga.y,ga.z)}},k_={[Lh]:i=>i,[Js]:i=>i.convertLinearToSRGB(),[Ag]:function zg(i){return ga.set(i.r,i.g,i.b).applyMatrix3(F_),i.setRGB(ga.x,ga.y,ga.z).convertLinearToSRGB()}},is={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(i){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!i},get workingColorSpace(){return Lh},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(!1===this.enabled||e===t||!e||!t)return i;const n=Hg[e],r=k_[t];if(void 0===n||void 0===r)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(n(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}};let ya;class Vg{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===ya&&(ya=xd("canvas")),ya.width=e.width,ya.height=e.height;const n=ya.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ya}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=xd("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),o=r.data;for(let l=0;l<o.length;l++)o[l]=255*tl(o[l]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*tl(t[n]/255)):tl(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Zl{constructor(e=null){this.isSource=!0,this.uuid=mr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let o;if(Array.isArray(r)){o=[];for(let l=0,c=r.length;l<c;l++)o.push(kh(r[l].isDataTexture?r[l].image:r[l]))}else o=kh(r);n.url=o}return t||(e.images[this.uuid]=n),n}}function kh(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?Vg.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Gg=0,gs=(()=>{class i extends Wi{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=Ei,o=Ei,l=Qn,c=br,u=Gi,d=Vo,h=i.DEFAULT_ANISOTROPY,f=ql){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Gg++}),this.uuid=mr(),this.name="",this.source=new Zl(t),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=o,this.magFilter=l,this.minFilter=c,this.anisotropy=h,this.format=u,this.internalFormat=null,this.type=d,this.offset=new Oe(0,0),this.repeat=new Oe(1,1),this.center=new Oe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new lr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ho:t.x=t.x-Math.floor(t.x);break;case Ei:t.x=t.x<0?0:1;break;case Vl:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ho:t.y=t.y-Math.floor(t.y);break;case Ei:t.y=t.y<0?0:1;break;case Vl:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=300,i.DEFAULT_ANISOTROPY=1,i})();class ei{constructor(e=0,t=0,n=0,r=1){ei.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,o=this.w,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*r+l[12]*o,this.y=l[1]*t+l[5]*n+l[9]*r+l[13]*o,this.z=l[2]*t+l[6]*n+l[10]*r+l[14]*o,this.w=l[3]*t+l[7]*n+l[11]*r+l[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,o;const u=e.elements,d=u[0],h=u[4],f=u[8],p=u[1],y=u[5],x=u[9],_=u[2],w=u[6],S=u[10];if(Math.abs(h-p)<.01&&Math.abs(f-_)<.01&&Math.abs(x-w)<.01){if(Math.abs(h+p)<.1&&Math.abs(f+_)<.1&&Math.abs(x+w)<.1&&Math.abs(d+y+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const T=(d+1)/2,P=(y+1)/2,k=(S+1)/2,H=(h+p)/4,W=(f+_)/4,R=(x+w)/4;return T>P&&T>k?T<.01?(n=0,r=.707106781,o=.707106781):(n=Math.sqrt(T),r=H/n,o=W/n):P>k?P<.01?(n=.707106781,r=0,o=.707106781):(r=Math.sqrt(P),n=H/r,o=R/r):k<.01?(n=.707106781,r=.707106781,o=0):(o=Math.sqrt(k),n=W/o,r=R/o),this.set(n,r,o,t),this}let D=Math.sqrt((w-x)*(w-x)+(f-_)*(f-_)+(p-h)*(p-h));return Math.abs(D)<.001&&(D=1),this.x=(w-x)/D,this.y=(f-_)/D,this.z=(p-h)/D,this.w=Math.acos((d+y+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Wo extends Wi{constructor(e=1,t=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new ei(0,0,e,t),this.scissorTest=!1,this.viewport=new ei(0,0,e,t),this.texture=new gs({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Qn,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Zl(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ru extends gs{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ti,this.minFilter=ti,this.wrapR=Ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Bh extends gs{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ti,this.minFilter=ti,this.wrapR=Ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class eo{constructor(e=new V(1/0,1/0,1/0),t=new V(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,o=-1/0,l=-1/0,c=-1/0;for(let u=0,d=e.length;u<d;u+=3){const h=e[u],f=e[u+1],p=e[u+2];h<t&&(t=h),f<n&&(n=f),p<r&&(r=p),h>o&&(o=h),f>l&&(l=f),p>c&&(c=p)}return this.min.set(t,n,r),this.max.set(o,l,c),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,o=-1/0,l=-1/0,c=-1/0;for(let u=0,d=e.count;u<d;u++){const h=e.getX(u),f=e.getY(u),p=e.getZ(u);h<t&&(t=h),f<n&&(n=f),p<r&&(r=p),h>o&&(o=h),f>l&&(l=f),p>c&&(c=p)}return this.min.set(t,n,r),this.max.set(o,l,c),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=nl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const o=n.attributes.position;for(let l=0,c=o.count;l<c;l++)nl.fromBufferAttribute(o,l).applyMatrix4(e.matrixWorld),this.expandByPoint(nl)}else null===n.boundingBox&&n.computeBoundingBox(),Ep.copy(n.boundingBox),Ep.applyMatrix4(e.matrixWorld),this.union(Ep);const r=e.children;for(let o=0,l=r.length;o<l;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,nl),nl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(jo),Uh.subVectors(this.max,jo),su.subVectors(e.a,jo),ou.subVectors(e.b,jo),Kl.subVectors(e.c,jo),_a.subVectors(ou,su),to.subVectors(Kl,ou),xa.subVectors(su,Kl);let t=[0,-_a.z,_a.y,0,-to.z,to.y,0,-xa.z,xa.y,_a.z,0,-_a.x,to.z,0,-to.x,xa.z,0,-xa.x,-_a.y,_a.x,0,-to.y,to.x,0,-xa.y,xa.x,0];return!(!Tp(t,su,ou,Kl,Uh)||(t=[1,0,0,0,1,0,0,0,1],!Tp(t,su,ou,Kl,Uh)))&&(zh.crossVectors(_a,to),t=[zh.x,zh.y,zh.z],Tp(t,su,ou,Kl,Uh))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,nl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(nl).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(va[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),va[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),va[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),va[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),va[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),va[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),va[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),va[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(va)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const va=[new V,new V,new V,new V,new V,new V,new V,new V],nl=new V,Ep=new eo,su=new V,ou=new V,Kl=new V,_a=new V,to=new V,xa=new V,jo=new V,Uh=new V,zh=new V,au=new V;function Tp(i,e,t,n,r){for(let o=0,l=i.length-3;o<=l;o+=3){au.fromArray(i,o);const c=r.x*Math.abs(au.x)+r.y*Math.abs(au.y)+r.z*Math.abs(au.z),u=e.dot(au),d=t.dot(au),h=n.dot(au);if(Math.max(-Math.max(u,d,h),Math.min(u,d,h))>c)return!1}return!0}const Ap=new eo,bd=new V,Hh=new V;class $o{constructor(e=new V,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Ap.setFromPoints(e).getCenter(n);let r=0;for(let o=0,l=e.length;o<l;o++)r=Math.max(r,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;bd.subVectors(e,this.center);const t=bd.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector(bd,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Hh.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(bd.copy(e.center).add(Hh)),this.expandByPoint(bd.copy(e.center).sub(Hh))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const no=new V,Vh=new V,Md=new V,wa=new V,Gh=new V,Wh=new V,Cp=new V;class jh{constructor(e=new V,t=new V(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,no)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=no.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(no.copy(this.origin).addScaledVector(this.direction,t),no.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Vh.copy(e).add(t).multiplyScalar(.5),Md.copy(t).sub(e).normalize(),wa.copy(this.origin).sub(Vh);const o=.5*e.distanceTo(t),l=-this.direction.dot(Md),c=wa.dot(this.direction),u=-wa.dot(Md),d=wa.lengthSq(),h=Math.abs(1-l*l);let f,p,y,x;if(h>0)if(f=l*u-c,p=l*c-u,x=o*h,f>=0)if(p>=-x)if(p<=x){const _=1/h;f*=_,p*=_,y=f*(f+l*p+2*c)+p*(l*f+p+2*u)+d}else p=o,f=Math.max(0,-(l*p+c)),y=-f*f+p*(p+2*u)+d;else p=-o,f=Math.max(0,-(l*p+c)),y=-f*f+p*(p+2*u)+d;else p<=-x?(f=Math.max(0,-(-l*o+c)),p=f>0?-o:Math.min(Math.max(-o,-u),o),y=-f*f+p*(p+2*u)+d):p<=x?(f=0,p=Math.min(Math.max(-o,-u),o),y=p*(p+2*u)+d):(f=Math.max(0,-(l*o+c)),p=f>0?o:Math.min(Math.max(-o,-u),o),y=-f*f+p*(p+2*u)+d);else p=l>0?-o:o,f=Math.max(0,-(l*p+c)),y=-f*f+p*(p+2*u)+d;return n&&n.copy(this.origin).addScaledVector(this.direction,f),r&&r.copy(Vh).addScaledVector(Md,p),y}intersectSphere(e,t){no.subVectors(e.center,this.origin);const n=no.dot(this.direction),r=no.dot(no)-n*n,o=e.radius*e.radius;if(r>o)return null;const l=Math.sqrt(o-r),c=n-l,u=n+l;return u<0?null:this.at(c<0?u:c,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,o,l,c,u;const d=1/this.direction.x,h=1/this.direction.y,f=1/this.direction.z,p=this.origin;return d>=0?(n=(e.min.x-p.x)*d,r=(e.max.x-p.x)*d):(n=(e.max.x-p.x)*d,r=(e.min.x-p.x)*d),h>=0?(o=(e.min.y-p.y)*h,l=(e.max.y-p.y)*h):(o=(e.max.y-p.y)*h,l=(e.min.y-p.y)*h),n>l||o>r||((o>n||isNaN(n))&&(n=o),(l<r||isNaN(r))&&(r=l),f>=0?(c=(e.min.z-p.z)*f,u=(e.max.z-p.z)*f):(c=(e.max.z-p.z)*f,u=(e.min.z-p.z)*f),n>u||c>r)||((c>n||n!=n)&&(n=c),(u<r||r!=r)&&(r=u),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,no)}intersectTriangle(e,t,n,r,o){Gh.subVectors(t,e),Wh.subVectors(n,e),Cp.crossVectors(Gh,Wh);let c,l=this.direction.dot(Cp);if(l>0){if(r)return null;c=1}else{if(!(l<0))return null;c=-1,l=-l}wa.subVectors(this.origin,e);const u=c*this.direction.dot(Wh.crossVectors(wa,Wh));if(u<0)return null;const d=c*this.direction.dot(Gh.cross(wa));if(d<0||u+d>l)return null;const h=-c*wa.dot(Cp);return h<0?null:this.at(h/l,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class an{constructor(){an.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,r,o,l,c,u,d,h,f,p,y,x,_,w){const S=this.elements;return S[0]=e,S[4]=t,S[8]=n,S[12]=r,S[1]=o,S[5]=l,S[9]=c,S[13]=u,S[2]=d,S[6]=h,S[10]=f,S[14]=p,S[3]=y,S[7]=x,S[11]=_,S[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new an).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/lu.setFromMatrixColumn(e,0).length(),o=1/lu.setFromMatrixColumn(e,1).length(),l=1/lu.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*o,t[5]=n[5]*o,t[6]=n[6]*o,t[7]=0,t[8]=n[8]*l,t[9]=n[9]*l,t[10]=n[10]*l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,o=e.z,l=Math.cos(n),c=Math.sin(n),u=Math.cos(r),d=Math.sin(r),h=Math.cos(o),f=Math.sin(o);if("XYZ"===e.order){const p=l*h,y=l*f,x=c*h,_=c*f;t[0]=u*h,t[4]=-u*f,t[8]=d,t[1]=y+x*d,t[5]=p-_*d,t[9]=-c*u,t[2]=_-p*d,t[6]=x+y*d,t[10]=l*u}else if("YXZ"===e.order){const p=u*h,y=u*f,x=d*h,_=d*f;t[0]=p+_*c,t[4]=x*c-y,t[8]=l*d,t[1]=l*f,t[5]=l*h,t[9]=-c,t[2]=y*c-x,t[6]=_+p*c,t[10]=l*u}else if("ZXY"===e.order){const p=u*h,y=u*f,x=d*h,_=d*f;t[0]=p-_*c,t[4]=-l*f,t[8]=x+y*c,t[1]=y+x*c,t[5]=l*h,t[9]=_-p*c,t[2]=-l*d,t[6]=c,t[10]=l*u}else if("ZYX"===e.order){const p=l*h,y=l*f,x=c*h,_=c*f;t[0]=u*h,t[4]=x*d-y,t[8]=p*d+_,t[1]=u*f,t[5]=_*d+p,t[9]=y*d-x,t[2]=-d,t[6]=c*u,t[10]=l*u}else if("YZX"===e.order){const p=l*u,y=l*d,x=c*u,_=c*d;t[0]=u*h,t[4]=_-p*f,t[8]=x*f+y,t[1]=f,t[5]=l*h,t[9]=-c*h,t[2]=-d*h,t[6]=y*f+x,t[10]=p-_*f}else if("XZY"===e.order){const p=l*u,y=l*d,x=c*u,_=c*d;t[0]=u*h,t[4]=-f,t[8]=d*h,t[1]=p*f+_,t[5]=l*h,t[9]=y*f-x,t[2]=x*f-y,t[6]=c*h,t[10]=_*f+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Sd,e,U_)}lookAt(e,t,n){const r=this.elements;return Os.subVectors(e,t),0===Os.lengthSq()&&(Os.z=1),Os.normalize(),Ql.crossVectors(n,Os),0===Ql.lengthSq()&&(1===Math.abs(n.z)?Os.x+=1e-4:Os.z+=1e-4,Os.normalize(),Ql.crossVectors(n,Os)),Ql.normalize(),Dp.crossVectors(Os,Ql),r[0]=Ql.x,r[4]=Dp.x,r[8]=Os.x,r[1]=Ql.y,r[5]=Dp.y,r[9]=Os.y,r[2]=Ql.z,r[6]=Dp.z,r[10]=Os.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,o=this.elements,l=n[0],c=n[4],u=n[8],d=n[12],h=n[1],f=n[5],p=n[9],y=n[13],x=n[2],_=n[6],w=n[10],S=n[14],D=n[3],T=n[7],P=n[11],k=n[15],H=r[0],W=r[4],R=r[8],B=r[12],X=r[1],le=r[5],Ee=r[9],te=r[13],ee=r[2],ge=r[6],re=r[10],ve=r[14],se=r[3],Me=r[7],ke=r[11],ut=r[15];return o[0]=l*H+c*X+u*ee+d*se,o[4]=l*W+c*le+u*ge+d*Me,o[8]=l*R+c*Ee+u*re+d*ke,o[12]=l*B+c*te+u*ve+d*ut,o[1]=h*H+f*X+p*ee+y*se,o[5]=h*W+f*le+p*ge+y*Me,o[9]=h*R+f*Ee+p*re+y*ke,o[13]=h*B+f*te+p*ve+y*ut,o[2]=x*H+_*X+w*ee+S*se,o[6]=x*W+_*le+w*ge+S*Me,o[10]=x*R+_*Ee+w*re+S*ke,o[14]=x*B+_*te+w*ve+S*ut,o[3]=D*H+T*X+P*ee+k*se,o[7]=D*W+T*le+P*ge+k*Me,o[11]=D*R+T*Ee+P*re+k*ke,o[15]=D*B+T*te+P*ve+k*ut,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],o=e[12],l=e[1],c=e[5],u=e[9],d=e[13],h=e[2],f=e[6],p=e[10],y=e[14];return e[3]*(+o*u*f-r*d*f-o*c*p+n*d*p+r*c*y-n*u*y)+e[7]*(+t*u*y-t*d*p+o*l*p-r*l*y+r*d*h-o*u*h)+e[11]*(+t*d*f-t*c*y-o*l*f+n*l*y+o*c*h-n*d*h)+e[15]*(-r*c*h-t*u*f+t*c*p+r*l*f-n*l*p+n*u*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],l=e[4],c=e[5],u=e[6],d=e[7],h=e[8],f=e[9],p=e[10],y=e[11],x=e[12],_=e[13],w=e[14],S=e[15],D=f*w*d-_*p*d+_*u*y-c*w*y-f*u*S+c*p*S,T=x*p*d-h*w*d-x*u*y+l*w*y+h*u*S-l*p*S,P=h*_*d-x*f*d+x*c*y-l*_*y-h*c*S+l*f*S,k=x*f*u-h*_*u-x*c*p+l*_*p+h*c*w-l*f*w,H=t*D+n*T+r*P+o*k;if(0===H)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const W=1/H;return e[0]=D*W,e[1]=(_*p*o-f*w*o-_*r*y+n*w*y+f*r*S-n*p*S)*W,e[2]=(c*w*o-_*u*o+_*r*d-n*w*d-c*r*S+n*u*S)*W,e[3]=(f*u*o-c*p*o-f*r*d+n*p*d+c*r*y-n*u*y)*W,e[4]=T*W,e[5]=(h*w*o-x*p*o+x*r*y-t*w*y-h*r*S+t*p*S)*W,e[6]=(x*u*o-l*w*o-x*r*d+t*w*d+l*r*S-t*u*S)*W,e[7]=(l*p*o-h*u*o+h*r*d-t*p*d-l*r*y+t*u*y)*W,e[8]=P*W,e[9]=(x*f*o-h*_*o-x*n*y+t*_*y+h*n*S-t*f*S)*W,e[10]=(l*_*o-x*c*o+x*n*d-t*_*d-l*n*S+t*c*S)*W,e[11]=(h*c*o-l*f*o-h*n*d+t*f*d+l*n*y-t*c*y)*W,e[12]=k*W,e[13]=(h*_*r-x*f*r+x*n*p-t*_*p-h*n*w+t*f*w)*W,e[14]=(x*c*r-l*_*r-x*n*u+t*_*u+l*n*w-t*c*w)*W,e[15]=(l*f*r-h*c*r+h*n*u-t*f*u-l*n*p+t*c*p)*W,this}scale(e){const t=this.elements,n=e.x,r=e.y,o=e.z;return t[0]*=n,t[4]*=r,t[8]*=o,t[1]*=n,t[5]*=r,t[9]*=o,t[2]*=n,t[6]*=r,t[10]*=o,t[3]*=n,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),o=1-n,l=e.x,c=e.y,u=e.z,d=o*l,h=o*c;return this.set(d*l+n,d*c-r*u,d*u+r*c,0,d*c+r*u,h*c+n,h*u-r*l,0,d*u-r*c,h*u+r*l,o*u*u+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,o,l){return this.set(1,n,o,0,e,1,l,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,o=t._x,l=t._y,c=t._z,u=t._w,d=o+o,h=l+l,f=c+c,p=o*d,y=o*h,x=o*f,_=l*h,w=l*f,S=c*f,D=u*d,T=u*h,P=u*f,k=n.x,H=n.y,W=n.z;return r[0]=(1-(_+S))*k,r[1]=(y+P)*k,r[2]=(x-T)*k,r[3]=0,r[4]=(y-P)*H,r[5]=(1-(p+S))*H,r[6]=(w+D)*H,r[7]=0,r[8]=(x+T)*W,r[9]=(w-D)*W,r[10]=(1-(p+_))*W,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let o=lu.set(r[0],r[1],r[2]).length();const l=lu.set(r[4],r[5],r[6]).length(),c=lu.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],cr.copy(this);const d=1/o,h=1/l,f=1/c;return cr.elements[0]*=d,cr.elements[1]*=d,cr.elements[2]*=d,cr.elements[4]*=h,cr.elements[5]*=h,cr.elements[6]*=h,cr.elements[8]*=f,cr.elements[9]*=f,cr.elements[10]*=f,t.setFromRotationMatrix(cr),n.x=o,n.y=l,n.z=c,this}makePerspective(e,t,n,r,o,l){const c=this.elements,d=2*o/(n-r),h=(t+e)/(t-e),f=(n+r)/(n-r),p=-(l+o)/(l-o),y=-2*l*o/(l-o);return c[0]=2*o/(t-e),c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=d,c[9]=f,c[13]=0,c[2]=0,c[6]=0,c[10]=p,c[14]=y,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,n,r,o,l){const c=this.elements,u=1/(t-e),d=1/(n-r),h=1/(l-o),f=(t+e)*u,p=(n+r)*d,y=(l+o)*h;return c[0]=2*u,c[4]=0,c[8]=0,c[12]=-f,c[1]=0,c[5]=2*d,c[9]=0,c[13]=-p,c[2]=0,c[6]=0,c[10]=-2*h,c[14]=-y,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const lu=new V,cr=new an,Sd=new V(0,0,0),U_=new V(1,1,1),Ql=new V,Dp=new V,Os=new V,z_=new an,H_=new gr;let $g=(()=>{class i{constructor(t=0,n=0,r=0,o=i.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=o}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,o=this._order){return this._x=t,this._y=n,this._z=r,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const o=t.elements,l=o[0],c=o[4],u=o[8],d=o[1],h=o[5],f=o[9],p=o[2],y=o[6],x=o[10];switch(n){case"XYZ":this._y=Math.asin(Ti(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,x),this._z=Math.atan2(-c,l)):(this._x=Math.atan2(y,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Ti(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(u,x),this._z=Math.atan2(d,h)):(this._y=Math.atan2(-p,l),this._z=0);break;case"ZXY":this._x=Math.asin(Ti(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-p,x),this._z=Math.atan2(-c,h)):(this._y=0,this._z=Math.atan2(d,l));break;case"ZYX":this._y=Math.asin(-Ti(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(y,x),this._z=Math.atan2(d,l)):(this._x=0,this._z=Math.atan2(-c,h));break;case"YZX":this._z=Math.asin(Ti(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-f,h),this._y=Math.atan2(-p,l)):(this._x=0,this._y=Math.atan2(u,x));break;case"XZY":this._z=Math.asin(-Ti(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(y,h),this._y=Math.atan2(u,l)):(this._x=Math.atan2(-f,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return z_.makeRotationFromQuaternion(t),this.setFromRotationMatrix(z_,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return H_.setFromEuler(this),this.setFromQuaternion(H_,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return i.DEFAULT_ORDER="XYZ",i})();class Ip{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let V_=0;const qg=new V,cu=new gr,io=new an,Ns=new V,ba=new V,Yg=new V,Xg=new gr,Pp=new V(1,0,0),G_=new V(0,1,0),W_=new V(0,0,1),vM={type:"added"},$h={type:"removed"};let Li=(()=>{class i extends Wi{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:V_++}),this.uuid=mr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DEFAULT_UP.clone();const t=new V,n=new $g,r=new gr,o=new V(1,1,1);n._onChange(function l(){r.setFromEuler(n,!1)}),r._onChange(function c(){n.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new an},normalMatrix:{value:new lr}}),this.matrix=new an,this.matrixWorld=new an,this.matrixAutoUpdate=i.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Ip,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return cu.setFromAxisAngle(t,n),this.quaternion.multiply(cu),this}rotateOnWorldAxis(t,n){return cu.setFromAxisAngle(t,n),this.quaternion.premultiply(cu),this}rotateX(t){return this.rotateOnAxis(Pp,t)}rotateY(t){return this.rotateOnAxis(G_,t)}rotateZ(t){return this.rotateOnAxis(W_,t)}translateOnAxis(t,n){return qg.copy(t).applyQuaternion(this.quaternion),this.position.add(qg.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(Pp,t)}translateY(t){return this.translateOnAxis(G_,t)}translateZ(t){return this.translateOnAxis(W_,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(io.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?Ns.copy(t):Ns.set(t,n,r);const o=this.parent;this.updateWorldMatrix(!0,!1),ba.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?io.lookAt(ba,Ns,this.up):io.lookAt(Ns,ba,this.up),this.quaternion.setFromRotationMatrix(io),o&&(io.extractRotation(o.matrixWorld),cu.setFromRotationMatrix(io),this.quaternion.premultiply(cu.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(vM)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent($h)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const n=this.children[t];n.parent=null,n.dispatchEvent($h)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),io.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),io.multiply(t.parent.matrixWorld)),t.applyMatrix4(io),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,o=this.children.length;r<o;r++){const c=this.children[r].getObjectByProperty(t,n);if(void 0!==c)return c}}getObjectsByProperty(t,n){let r=[];this[t]===n&&r.push(this);for(let o=0,l=this.children.length;o<l;o++){const c=this.children[o].getObjectsByProperty(t,n);c.length>0&&(r=r.concat(c))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ba,t,Yg),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ba,Xg,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].traverseVisible(t)}traverseAncestors(t){const n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let r=0,o=n.length;r<o;r++){const l=n[r];(!0===l.matrixWorldAutoUpdate||!0===t)&&l.updateMatrixWorld(t)}}updateWorldMatrix(t,n){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const o=this.children;for(let l=0,c=o.length;l<c;l++){const u=o[l];!0===u.matrixWorldAutoUpdate&&u.updateWorldMatrix(!1,!0)}}}toJSON(t){const n=void 0===t||"string"==typeof t,r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const o={};function l(u,d){return void 0===u[d.uuid]&&(u[d.uuid]=d.toJSON(t)),d.uuid}if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(o.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(o.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=l(t.geometries,this.geometry);const u=this.geometry.parameters;if(void 0!==u&&void 0!==u.shapes){const d=u.shapes;if(Array.isArray(d))for(let h=0,f=d.length;h<f;h++)l(t.shapes,d[h]);else l(t.shapes,d)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(l(t.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const u=[];for(let d=0,h=this.material.length;d<h;d++)u.push(l(t.materials,this.material[d]));o.material=u}else o.material=l(t.materials,this.material);if(this.children.length>0){o.children=[];for(let u=0;u<this.children.length;u++)o.children.push(this.children[u].toJSON(t).object)}if(this.animations.length>0){o.animations=[];for(let u=0;u<this.animations.length;u++)o.animations.push(l(t.animations,this.animations[u]))}if(n){const u=c(t.geometries),d=c(t.materials),h=c(t.textures),f=c(t.images),p=c(t.shapes),y=c(t.skeletons),x=c(t.animations),_=c(t.nodes);u.length>0&&(r.geometries=u),d.length>0&&(r.materials=d),h.length>0&&(r.textures=h),f.length>0&&(r.images=f),p.length>0&&(r.shapes=p),y.length>0&&(r.skeletons=y),x.length>0&&(r.animations=x),_.length>0&&(r.nodes=_)}return r.object=o,r;function c(u){const d=[];for(const h in u){const f=u[h];delete f.metadata,d.push(f)}return d}}clone(t){return(new this.constructor).copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return i.DEFAULT_UP=new V(0,1,0),i.DEFAULT_MATRIX_AUTO_UPDATE=!0,i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,i})();const qo=new V,il=new V,qh=new V,Ma=new V,uu=new V,du=new V,Zg=new V,Yh=new V,hu=new V,Rp=new V;class ys{constructor(e=new V,t=new V,n=new V){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),qo.subVectors(e,t),r.cross(qo);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,n,r,o){qo.subVectors(r,t),il.subVectors(n,t),qh.subVectors(e,t);const l=qo.dot(qo),c=qo.dot(il),u=qo.dot(qh),d=il.dot(il),h=il.dot(qh),f=l*d-c*c;if(0===f)return o.set(-2,-1,-1);const p=1/f,y=(d*u-c*h)*p,x=(l*h-c*u)*p;return o.set(1-y-x,x,y)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Ma),Ma.x>=0&&Ma.y>=0&&Ma.x+Ma.y<=1}static getUV(e,t,n,r,o,l,c,u){return this.getBarycoord(e,t,n,r,Ma),u.set(0,0),u.addScaledVector(o,Ma.x),u.addScaledVector(l,Ma.y),u.addScaledVector(c,Ma.z),u}static isFrontFacing(e,t,n,r){return qo.subVectors(n,t),il.subVectors(e,t),qo.cross(il).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return qo.subVectors(this.c,this.b),il.subVectors(this.a,this.b),.5*qo.cross(il).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ys.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ys.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,o){return ys.getUV(e,this.a,this.b,this.c,t,n,r,o)}containsPoint(e){return ys.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ys.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,o=this.c;let l,c;uu.subVectors(r,n),du.subVectors(o,n),Yh.subVectors(e,n);const u=uu.dot(Yh),d=du.dot(Yh);if(u<=0&&d<=0)return t.copy(n);hu.subVectors(e,r);const h=uu.dot(hu),f=du.dot(hu);if(h>=0&&f<=h)return t.copy(r);const p=u*f-h*d;if(p<=0&&u>=0&&h<=0)return l=u/(u-h),t.copy(n).addScaledVector(uu,l);Rp.subVectors(e,o);const y=uu.dot(Rp),x=du.dot(Rp);if(x>=0&&y<=x)return t.copy(o);const _=y*d-u*x;if(_<=0&&d>=0&&x<=0)return c=d/(d-x),t.copy(n).addScaledVector(du,c);const w=h*x-y*f;if(w<=0&&f-h>=0&&y-x>=0)return Zg.subVectors(o,r),c=(f-h)/(f-h+(y-x)),t.copy(r).addScaledVector(Zg,c);const S=1/(w+_+p);return l=_*S,c=p*S,t.copy(n).addScaledVector(uu,l).addScaledVector(du,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let j_=0;class Gn extends Wi{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:j_++}),this.uuid=mr(),this.name="",this.type="Material",this.blending=M,this.side=Qi,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Pi,this.blendDst=fs,this.blendEquation=fe,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Xc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(o){const l=[];for(const c in o){const u=o[c];delete u.metadata,l.push(u)}return l}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==M&&(n.blending=this.blending),this.side!==Qi&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const o=r(e.textures),l=r(e.images);o.length>0&&(n.textures=o),l.length>0&&(n.images=l)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const r=t.length;n=new Array(r);for(let o=0;o!==r;++o)n[o]=t[o].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const Kg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ro={h:0,s:0,l:0},Ed={h:0,s:0,l:0};function Xh(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+6*(e-i)*(2/3-t):i}class xt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Js){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,is.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=is.workingColorSpace){return this.r=e,this.g=t,this.b=n,is.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=is.workingColorSpace){if(e=Oh(e,1),t=Ti(t,0,1),n=Ti(n,0,1),0===t)this.r=this.g=this.b=n;else{const o=n<=.5?n*(1+t):n+t-n*t,l=2*n-o;this.r=Xh(l,o,e+1/3),this.g=Xh(l,o,e),this.b=Xh(l,o,e-1/3)}return is.toWorkingColorSpace(this,r),this}setStyle(e,t=Js){function n(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const c=r[2];switch(r[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,is.toWorkingColorSpace(this,t),n(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,is.toWorkingColorSpace(this,t),n(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c)){const u=parseFloat(o[1])/360,d=parseFloat(o[2])/100,h=parseFloat(o[3])/100;return n(o[4]),this.setHSL(u,d,h,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=r[1],l=o.length;if(3===l)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,is.toWorkingColorSpace(this,t),this;if(6===l)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,is.toWorkingColorSpace(this,t),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Js){const n=Kg[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=tl(e.r),this.g=tl(e.g),this.b=tl(e.b),this}copyLinearToSRGB(e){return this.r=Sp(e.r),this.g=Sp(e.g),this.b=Sp(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Js){return is.fromWorkingColorSpace(Er.copy(this),e),Ti(255*Er.r,0,255)<<16^Ti(255*Er.g,0,255)<<8^Ti(255*Er.b,0,255)<<0}getHexString(e=Js){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=is.workingColorSpace){is.fromWorkingColorSpace(Er.copy(this),t);const n=Er.r,r=Er.g,o=Er.b,l=Math.max(n,r,o),c=Math.min(n,r,o);let u,d;const h=(c+l)/2;if(c===l)u=0,d=0;else{const f=l-c;switch(d=h<=.5?f/(l+c):f/(2-l-c),l){case n:u=(r-o)/f+(r<o?6:0);break;case r:u=(o-n)/f+2;break;case o:u=(n-r)/f+4}u/=6}return e.h=u,e.s=d,e.l=h,e}getRGB(e,t=is.workingColorSpace){return is.fromWorkingColorSpace(Er.copy(this),t),e.r=Er.r,e.g=Er.g,e.b=Er.b,e}getStyle(e=Js){is.fromWorkingColorSpace(Er.copy(this),e);const t=Er.r,n=Er.g,r=Er.b;return e!==Js?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${255*t|0},${255*n|0},${255*r|0})`}offsetHSL(e,t,n){return this.getHSL(ro),ro.h+=e,ro.s+=t,ro.l+=n,this.setHSL(ro.h,ro.s,ro.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(ro),e.getHSL(Ed);const n=vd(ro.h,Ed.h,t),r=vd(ro.s,Ed.s,t),o=vd(ro.l,Ed.l,t);return this.setHSL(n,r,o),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Er=new xt;xt.NAMES=Kg;class Br extends Gn{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ys,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const $i=new V,Td=new Oe;class Oi{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Td.fromBufferAttribute(this,t),Td.applyMatrix3(e),this.setXY(t,Td.x,Td.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)$i.fromBufferAttribute(this,t),$i.applyMatrix3(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)$i.fromBufferAttribute(this,t),$i.applyMatrix4(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)$i.fromBufferAttribute(this,t),$i.applyNormalMatrix(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)$i.fromBufferAttribute(this,t),$i.transformDirection(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ns(t,this.array)),t}setX(e,t){return this.normalized&&(t=Jn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ns(t,this.array)),t}setY(e,t){return this.normalized&&(t=Jn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ns(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Jn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ns(t,this.array)),t}setW(e,t){return this.normalized&&(t=Jn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Jn(t,this.array),n=Jn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Jn(t,this.array),n=Jn(n,this.array),r=Jn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,o){return e*=this.itemSize,this.normalized&&(t=Jn(t,this.array),n=Jn(n,this.array),r=Jn(r,this.array),o=Jn(o,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Lp extends Oi{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Y_ extends Oi{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class It extends Oi{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Op=0;const so=new an,Ad=new Li,fu=new V,Ur=new eo,pu=new eo,Ji=new V;class cn extends Wi{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Op++}),this.uuid=mr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Bg(e)?Y_:Lp)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const o=(new lr).getNormalMatrix(e);n.applyNormalMatrix(o),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return so.makeRotationFromQuaternion(e),this.applyMatrix4(so),this}rotateX(e){return so.makeRotationX(e),this.applyMatrix4(so),this}rotateY(e){return so.makeRotationY(e),this.applyMatrix4(so),this}rotateZ(e){return so.makeRotationZ(e),this.applyMatrix4(so),this}translate(e,t,n){return so.makeTranslation(e,t,n),this.applyMatrix4(so),this}scale(e,t,n){return so.makeScale(e,t,n),this.applyMatrix4(so),this}lookAt(e){return Ad.lookAt(e),Ad.updateMatrix(),this.applyMatrix4(Ad.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(fu).negate(),this.translate(fu.x,fu.y,fu.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new It(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new eo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new V(-1/0,-1/0,-1/0),new V(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++)Ur.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Ji.addVectors(this.boundingBox.min,Ur.min),this.boundingBox.expandByPoint(Ji),Ji.addVectors(this.boundingBox.max,Ur.max),this.boundingBox.expandByPoint(Ji)):(this.boundingBox.expandByPoint(Ur.min),this.boundingBox.expandByPoint(Ur.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new $o);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new V,1/0);if(e){const n=this.boundingSphere.center;if(Ur.setFromBufferAttribute(e),t)for(let o=0,l=t.length;o<l;o++)pu.setFromBufferAttribute(t[o]),this.morphTargetsRelative?(Ji.addVectors(Ur.min,pu.min),Ur.expandByPoint(Ji),Ji.addVectors(Ur.max,pu.max),Ur.expandByPoint(Ji)):(Ur.expandByPoint(pu.min),Ur.expandByPoint(pu.max));Ur.getCenter(n);let r=0;for(let o=0,l=e.count;o<l;o++)Ji.fromBufferAttribute(e,o),r=Math.max(r,n.distanceToSquared(Ji));if(t)for(let o=0,l=t.length;o<l;o++){const c=t[o],u=this.morphTargetsRelative;for(let d=0,h=c.count;d<h;d++)Ji.fromBufferAttribute(c,d),u&&(fu.fromBufferAttribute(e,d),Ji.add(fu)),r=Math.max(r,n.distanceToSquared(Ji))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,o=t.normal.array,l=t.uv.array,c=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Oi(new Float32Array(4*c),4));const u=this.getAttribute("tangent").array,d=[],h=[];for(let X=0;X<c;X++)d[X]=new V,h[X]=new V;const f=new V,p=new V,y=new V,x=new Oe,_=new Oe,w=new Oe,S=new V,D=new V;function T(X,le,Ee){f.fromArray(r,3*X),p.fromArray(r,3*le),y.fromArray(r,3*Ee),x.fromArray(l,2*X),_.fromArray(l,2*le),w.fromArray(l,2*Ee),p.sub(f),y.sub(f),_.sub(x),w.sub(x);const te=1/(_.x*w.y-w.x*_.y);isFinite(te)&&(S.copy(p).multiplyScalar(w.y).addScaledVector(y,-_.y).multiplyScalar(te),D.copy(y).multiplyScalar(_.x).addScaledVector(p,-w.x).multiplyScalar(te),d[X].add(S),d[le].add(S),d[Ee].add(S),h[X].add(D),h[le].add(D),h[Ee].add(D))}let P=this.groups;0===P.length&&(P=[{start:0,count:n.length}]);for(let X=0,le=P.length;X<le;++X){const Ee=P[X],te=Ee.start;for(let ge=te,re=te+Ee.count;ge<re;ge+=3)T(n[ge+0],n[ge+1],n[ge+2])}const k=new V,H=new V,W=new V,R=new V;function B(X){W.fromArray(o,3*X),R.copy(W);const le=d[X];k.copy(le),k.sub(W.multiplyScalar(W.dot(le))).normalize(),H.crossVectors(R,le);const te=H.dot(h[X])<0?-1:1;u[4*X]=k.x,u[4*X+1]=k.y,u[4*X+2]=k.z,u[4*X+3]=te}for(let X=0,le=P.length;X<le;++X){const Ee=P[X],te=Ee.start;for(let ge=te,re=te+Ee.count;ge<re;ge+=3)B(n[ge+0]),B(n[ge+1]),B(n[ge+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Oi(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let p=0,y=n.count;p<y;p++)n.setXYZ(p,0,0,0);const r=new V,o=new V,l=new V,c=new V,u=new V,d=new V,h=new V,f=new V;if(e)for(let p=0,y=e.count;p<y;p+=3){const x=e.getX(p+0),_=e.getX(p+1),w=e.getX(p+2);r.fromBufferAttribute(t,x),o.fromBufferAttribute(t,_),l.fromBufferAttribute(t,w),h.subVectors(l,o),f.subVectors(r,o),h.cross(f),c.fromBufferAttribute(n,x),u.fromBufferAttribute(n,_),d.fromBufferAttribute(n,w),c.add(h),u.add(h),d.add(h),n.setXYZ(x,c.x,c.y,c.z),n.setXYZ(_,u.x,u.y,u.z),n.setXYZ(w,d.x,d.y,d.z)}else for(let p=0,y=t.count;p<y;p+=3)r.fromBufferAttribute(t,p+0),o.fromBufferAttribute(t,p+1),l.fromBufferAttribute(t,p+2),h.subVectors(l,o),f.subVectors(r,o),h.cross(f),n.setXYZ(p+0,h.x,h.y,h.z),n.setXYZ(p+1,h.x,h.y,h.z),n.setXYZ(p+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Ji.fromBufferAttribute(e,t),Ji.normalize(),e.setXYZ(t,Ji.x,Ji.y,Ji.z)}toNonIndexed(){function e(c,u){const d=c.array,h=c.itemSize,f=c.normalized,p=new d.constructor(u.length*h);let y=0,x=0;for(let _=0,w=u.length;_<w;_++){y=c.isInterleavedBufferAttribute?u[_]*c.data.stride+c.offset:u[_]*h;for(let S=0;S<h;S++)p[x++]=d[y++]}return new Oi(p,h,f)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new cn,n=this.index.array,r=this.attributes;for(const c in r){const d=e(r[c],n);t.setAttribute(c,d)}const o=this.morphAttributes;for(const c in o){const u=[],d=o[c];for(let h=0,f=d.length;h<f;h++){const y=e(d[h],n);u.push(y)}t.morphAttributes[c]=u}t.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let c=0,u=l.length;c<u;c++){const d=l[c];t.addGroup(d.start,d.count,d.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const u=this.parameters;for(const d in u)void 0!==u[d]&&(e[d]=u[d]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const u in n)e.data.attributes[u]=n[u].toJSON(e.data);const r={};let o=!1;for(const u in this.morphAttributes){const d=this.morphAttributes[u],h=[];for(let f=0,p=d.length;f<p;f++)h.push(d[f].toJSON(e.data));h.length>0&&(r[u]=h,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const c=this.boundingSphere;return null!==c&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const d in r)this.setAttribute(d,r[d].clone(t));const o=e.morphAttributes;for(const d in o){const h=[],f=o[d];for(let p=0,y=f.length;p<y;p++)h.push(f[p].clone(t));this.morphAttributes[d]=h}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let d=0,h=l.length;d<h;d++){const f=l[d];this.addGroup(f.start,f.count,f.materialIndex)}const c=e.boundingBox;null!==c&&(this.boundingBox=c.clone());const u=e.boundingSphere;return null!==u&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Jg=new an,Fs=new jh,Jl=new $o,ey=new V,ec=new V,rl=new V,oo=new V,Kh=new V,mu=new V,Qh=new Oe,Jh=new Oe,Cd=new Oe,sl=new V,ef=new V;class er extends Li{constructor(e=new cn,t=new Br){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){const c=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}getVertexPosition(e,t){const n=this.geometry,o=n.morphAttributes.position,l=n.morphTargetsRelative;t.fromBufferAttribute(n.attributes.position,e);const c=this.morphTargetInfluences;if(o&&c){mu.set(0,0,0);for(let u=0,d=o.length;u<d;u++){const h=c[u];0!==h&&(Kh.fromBufferAttribute(o[u],e),mu.addScaledVector(l?Kh:Kh.sub(t),h))}t.add(mu)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const n=this.geometry,r=this.material,o=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),Jl.copy(n.boundingSphere),Jl.applyMatrix4(o),Fs.copy(e.ray).recast(e.near),!1===Jl.containsPoint(Fs.origin)&&(null===Fs.intersectSphere(Jl,ey)||Fs.origin.distanceToSquared(ey)>(e.far-e.near)**2))||(Jg.copy(o).invert(),Fs.copy(e.ray).applyMatrix4(Jg),null!==n.boundingBox&&!1===Fs.intersectsBox(n.boundingBox)))return;let l;const c=n.index,u=n.attributes.position,d=n.attributes.uv,h=n.attributes.uv2,f=n.groups,p=n.drawRange;if(null!==c)if(Array.isArray(r))for(let y=0,x=f.length;y<x;y++){const _=f[y],w=r[_.materialIndex];for(let T=Math.max(_.start,p.start),P=Math.min(c.count,Math.min(_.start+_.count,p.start+p.count));T<P;T+=3){const k=c.getX(T),H=c.getX(T+1),W=c.getX(T+2);l=gu(this,w,e,Fs,d,h,k,H,W),l&&(l.faceIndex=Math.floor(T/3),l.face.materialIndex=_.materialIndex,t.push(l))}}else for(let _=Math.max(0,p.start),w=Math.min(c.count,p.start+p.count);_<w;_+=3){const S=c.getX(_),D=c.getX(_+1),T=c.getX(_+2);l=gu(this,r,e,Fs,d,h,S,D,T),l&&(l.faceIndex=Math.floor(_/3),t.push(l))}else if(void 0!==u)if(Array.isArray(r))for(let y=0,x=f.length;y<x;y++){const _=f[y],w=r[_.materialIndex];for(let T=Math.max(_.start,p.start),P=Math.min(u.count,Math.min(_.start+_.count,p.start+p.count));T<P;T+=3)l=gu(this,w,e,Fs,d,h,T,T+1,T+2),l&&(l.faceIndex=Math.floor(T/3),l.face.materialIndex=_.materialIndex,t.push(l))}else for(let _=Math.max(0,p.start),w=Math.min(u.count,p.start+p.count);_<w;_+=3)l=gu(this,r,e,Fs,d,h,_,_+1,_+2),l&&(l.faceIndex=Math.floor(_/3),t.push(l))}}function gu(i,e,t,n,r,o,l,c,u){i.getVertexPosition(l,ec),i.getVertexPosition(c,rl),i.getVertexPosition(u,oo);const d=function Z_(i,e,t,n,r,o,l,c){let u;if(u=e.side===_n?n.intersectTriangle(l,o,r,!0,c):n.intersectTriangle(r,o,l,e.side===Qi,c),null===u)return null;ef.copy(c),ef.applyMatrix4(i.matrixWorld);const d=t.ray.origin.distanceTo(ef);return d<t.near||d>t.far?null:{distance:d,point:ef.clone(),object:i}}(i,e,t,n,ec,rl,oo,sl);if(d){r&&(Qh.fromBufferAttribute(r,l),Jh.fromBufferAttribute(r,c),Cd.fromBufferAttribute(r,u),d.uv=ys.getUV(sl,ec,rl,oo,Qh,Jh,Cd,new Oe)),o&&(Qh.fromBufferAttribute(o,l),Jh.fromBufferAttribute(o,c),Cd.fromBufferAttribute(o,u),d.uv2=ys.getUV(sl,ec,rl,oo,Qh,Jh,Cd,new Oe));const h={a:l,b:c,c:u,normal:new V,materialIndex:0};ys.getNormal(ec,rl,oo,h.normal),d.face=h}return d}class yu extends cn{constructor(e=1,t=1,n=1,r=1,o=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:o,depthSegments:l};const c=this;r=Math.floor(r),o=Math.floor(o),l=Math.floor(l);const u=[],d=[],h=[],f=[];let p=0,y=0;function x(_,w,S,D,T,P,k,H,W,R,B){const X=P/W,le=k/R,Ee=P/2,te=k/2,ee=H/2,ge=W+1,re=R+1;let ve=0,se=0;const Me=new V;for(let ke=0;ke<re;ke++){const ut=ke*le-te;for(let ye=0;ye<ge;ye++)Me[_]=(ye*X-Ee)*D,Me[w]=ut*T,Me[S]=ee,d.push(Me.x,Me.y,Me.z),Me[_]=0,Me[w]=0,Me[S]=H>0?1:-1,h.push(Me.x,Me.y,Me.z),f.push(ye/W),f.push(1-ke/R),ve+=1}for(let ke=0;ke<R;ke++)for(let ut=0;ut<W;ut++){const We=p+ut+ge*(ke+1),ze=p+(ut+1)+ge*(ke+1),ue=p+(ut+1)+ge*ke;u.push(p+ut+ge*ke,We,ue),u.push(We,ze,ue),se+=6}c.addGroup(y,se,B),y+=se,p+=ve}x("z","y","x",-1,-1,n,t,e,l,o,0),x("z","y","x",1,-1,n,t,-e,l,o,1),x("x","z","y",1,1,e,n,t,r,l,2),x("x","z","y",1,-1,e,n,-t,r,l,3),x("x","y","z",1,-1,e,t,n,r,o,4),x("x","y","z",-1,-1,e,t,-n,r,o,5),this.setIndex(u),this.setAttribute("position",new It(d,3)),this.setAttribute("normal",new It(h,3)),this.setAttribute("uv",new It(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yu(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function tc(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];e[t][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function zr(i){const e={};for(let t=0;t<i.length;t++){const n=tc(i[t]);for(const r in n)e[r]=n[r]}return e}function K_(i){return null===i.getRenderTarget()&&i.outputEncoding===Xn?Js:Lh}const Q_={clone:tc,merge:zr};class vs extends Gn{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=tc(e.uniforms),this.uniformsGroups=function ty(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const l=this.uniforms[r].value;t.uniforms[r]=l&&l.isTexture?{type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?{type:"c",value:l.getHex()}:l&&l.isVector2?{type:"v2",value:l.toArray()}:l&&l.isVector3?{type:"v3",value:l.toArray()}:l&&l.isVector4?{type:"v4",value:l.toArray()}:l&&l.isMatrix3?{type:"m3",value:l.toArray()}:l&&l.isMatrix4?{type:"m4",value:l.toArray()}:{value:l}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class nc extends Li{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new an,this.projectionMatrix=new an,this.projectionMatrixInverse=new an}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class ur extends nc{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*ji*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*ma*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ji*Math.atan(Math.tan(.5*ma*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,o,l){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*ma*this.fov)/this.zoom,n=2*t,r=this.aspect*n,o=-.5*r;const l=this.view;if(null!==this.view&&this.view.enabled){const u=l.fullWidth,d=l.fullHeight;o+=l.offsetX*r/u,t-=l.offsetY*n/d,r*=l.width/u,n*=l.height/d}const c=this.filmOffset;0!==c&&(o+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class ex extends Li{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;const r=new ur(-90,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const o=new ur(-90,1,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(-1,0,0),this.add(o);const l=new ur(-90,1,e,t);l.layers=this.layers,l.up.set(0,0,-1),l.lookAt(0,1,0),this.add(l);const c=new ur(-90,1,e,t);c.layers=this.layers,c.up.set(0,0,1),c.lookAt(0,-1,0),this.add(c);const u=new ur(-90,1,e,t);u.layers=this.layers,u.up.set(0,1,0),u.lookAt(0,0,1),this.add(u);const d=new ur(-90,1,e,t);d.layers=this.layers,d.up.set(0,1,0),d.lookAt(0,0,-1),this.add(d)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,o,l,c,u,d]=this.children,h=e.getRenderTarget(),f=e.toneMapping,p=e.xr.enabled;e.toneMapping=pr,e.xr.enabled=!1;const y=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,o),e.setRenderTarget(n,2),e.render(t,l),e.setRenderTarget(n,3),e.render(t,c),e.setRenderTarget(n,4),e.render(t,u),n.texture.generateMipmaps=y,e.setRenderTarget(n,5),e.render(t,d),e.setRenderTarget(h),e.toneMapping=f,e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class tf extends gs{constructor(e,t,n,r,o,l,c,u,d,h){super(e=void 0!==e?e:[],t=void 0!==t?t:Rs,n,r,o,l,c,u,d,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class ny extends Wo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1};this.texture=new tf([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Qn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new yu(5,5,5),o=new vs({name:"CubemapFromEquirect",uniforms:tc(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:_n,blending:hs});o.uniforms.tEquirect.value=t;const l=new er(r,o),c=t.minFilter;return t.minFilter===br&&(t.minFilter=Qn),new ex(1,10,this).update(e,l),t.minFilter=c,l.geometry.dispose(),l.material.dispose(),this}clear(e,t,n,r){const o=e.getRenderTarget();for(let l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(t,n,r);e.setRenderTarget(o)}}const Np=new V,Fp=new V,kp=new lr;class rc{constructor(e=new V(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Np.subVectors(n,t).cross(Fp.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Np),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:t.copy(e.start).addScaledVector(n,o)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||kp.getNormalMatrix(e),r=this.coplanarPoint(Np).applyMatrix4(e),o=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const ol=new $o,al=new V;class Bp{constructor(e=new rc,t=new rc,n=new rc,r=new rc,o=new rc,l=new rc){this.planes=[e,t,n,r,o,l]}set(e,t,n,r,o,l){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(r),c[4].copy(o),c[5].copy(l),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],o=n[1],l=n[2],c=n[3],u=n[4],d=n[5],h=n[6],f=n[7],p=n[8],y=n[9],x=n[10],_=n[11],w=n[12],S=n[13],D=n[14],T=n[15];return t[0].setComponents(c-r,f-u,_-p,T-w).normalize(),t[1].setComponents(c+r,f+u,_+p,T+w).normalize(),t[2].setComponents(c+o,f+d,_+y,T+S).normalize(),t[3].setComponents(c-o,f-d,_-y,T-S).normalize(),t[4].setComponents(c-l,f-h,_-x,T-D).normalize(),t[5].setComponents(c+l,f+h,_+x,T+D).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),ol.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(ol)}intersectsSprite(e){return ol.center.set(0,0,0),ol.radius=.7071067811865476,ol.applyMatrix4(e.matrixWorld),this.intersectsSphere(ol)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(al.x=r.normal.x>0?e.max.x:e.min.x,al.y=r.normal.y>0?e.max.y:e.min.y,al.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(al)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function iy(){let i=null,e=!1,t=null,n=null;function r(o,l){t(o,l),n=i.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){i=o}}}function tx(i,e){const t=e.isWebGL2,n=new WeakMap;return{get:function l(d){return d.isInterleavedBufferAttribute&&(d=d.data),n.get(d)},remove:function c(d){d.isInterleavedBufferAttribute&&(d=d.data);const h=n.get(d);h&&(i.deleteBuffer(h.buffer),n.delete(d))},update:function u(d,h){if(d.isGLBufferAttribute){const p=n.get(d);return void((!p||p.version<d.version)&&n.set(d,{buffer:d.buffer,type:d.type,bytesPerElement:d.elementSize,version:d.version}))}d.isInterleavedBufferAttribute&&(d=d.data);const f=n.get(d);void 0===f?n.set(d,function r(d,h){const f=d.array,p=d.usage,y=i.createBuffer();let x;if(i.bindBuffer(h,y),i.bufferData(h,f,p),d.onUploadCallback(),f instanceof Float32Array)x=5126;else if(f instanceof Uint16Array)if(d.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");x=5131}else x=5123;else if(f instanceof Int16Array)x=5122;else if(f instanceof Uint32Array)x=5125;else if(f instanceof Int32Array)x=5124;else if(f instanceof Int8Array)x=5120;else if(f instanceof Uint8Array)x=5121;else{if(!(f instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);x=5121}return{buffer:y,type:x,bytesPerElement:f.BYTES_PER_ELEMENT,version:d.version}}(d,h)):f.version<d.version&&(function o(d,h,f){const p=h.array,y=h.updateRange;i.bindBuffer(f,d),-1===y.count?i.bufferSubData(f,0,p):(t?i.bufferSubData(f,y.offset*p.BYTES_PER_ELEMENT,p,y.offset,y.count):i.bufferSubData(f,y.offset*p.BYTES_PER_ELEMENT,p.subarray(y.offset,y.offset+y.count)),y.count=-1),h.onUploadCallback()}(f.buffer,d,h),f.version=d.version)}}}class nf extends cn{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const o=e/2,l=t/2,c=Math.floor(n),u=Math.floor(r),d=c+1,h=u+1,f=e/c,p=t/u,y=[],x=[],_=[],w=[];for(let S=0;S<h;S++){const D=S*p-l;for(let T=0;T<d;T++)x.push(T*f-o,-D,0),_.push(0,0,1),w.push(T/c),w.push(1-S/u)}for(let S=0;S<u;S++)for(let D=0;D<c;D++){const P=D+d*(S+1),k=D+1+d*(S+1),H=D+1+d*S;y.push(D+d*S,P,H),y.push(P,k,H)}this.setIndex(y),this.setAttribute("position",new It(x,3)),this.setAttribute("normal",new It(_,3)),this.setAttribute("uv",new It(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nf(e.width,e.height,e.widthSegments,e.heightSegments)}}const en={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\t\n\t\tvec2 lodFudge = pow( 1.95, lod ) / fullSize;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec2 fullSize = vec2( textureSize( sampler, 0 ) );\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},dt={common:{diffuse:{value:new xt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new lr},uv2Transform:{value:new lr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Oe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new lr}},sprite:{diffuse:{value:new xt(16777215)},opacity:{value:1},center:{value:new Oe(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new lr}}},xs={basic:{uniforms:zr([dt.common,dt.specularmap,dt.envmap,dt.aomap,dt.lightmap,dt.fog]),vertexShader:en.meshbasic_vert,fragmentShader:en.meshbasic_frag},lambert:{uniforms:zr([dt.common,dt.specularmap,dt.envmap,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.fog,dt.lights,{emissive:{value:new xt(0)}}]),vertexShader:en.meshlambert_vert,fragmentShader:en.meshlambert_frag},phong:{uniforms:zr([dt.common,dt.specularmap,dt.envmap,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.fog,dt.lights,{emissive:{value:new xt(0)},specular:{value:new xt(1118481)},shininess:{value:30}}]),vertexShader:en.meshphong_vert,fragmentShader:en.meshphong_frag},standard:{uniforms:zr([dt.common,dt.envmap,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.roughnessmap,dt.metalnessmap,dt.fog,dt.lights,{emissive:{value:new xt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:en.meshphysical_vert,fragmentShader:en.meshphysical_frag},toon:{uniforms:zr([dt.common,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.gradientmap,dt.fog,dt.lights,{emissive:{value:new xt(0)}}]),vertexShader:en.meshtoon_vert,fragmentShader:en.meshtoon_frag},matcap:{uniforms:zr([dt.common,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.fog,{matcap:{value:null}}]),vertexShader:en.meshmatcap_vert,fragmentShader:en.meshmatcap_frag},points:{uniforms:zr([dt.points,dt.fog]),vertexShader:en.points_vert,fragmentShader:en.points_frag},dashed:{uniforms:zr([dt.common,dt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:en.linedashed_vert,fragmentShader:en.linedashed_frag},depth:{uniforms:zr([dt.common,dt.displacementmap]),vertexShader:en.depth_vert,fragmentShader:en.depth_frag},normal:{uniforms:zr([dt.common,dt.bumpmap,dt.normalmap,dt.displacementmap,{opacity:{value:1}}]),vertexShader:en.meshnormal_vert,fragmentShader:en.meshnormal_frag},sprite:{uniforms:zr([dt.sprite,dt.fog]),vertexShader:en.sprite_vert,fragmentShader:en.sprite_frag},background:{uniforms:{uvTransform:{value:new lr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:en.background_vert,fragmentShader:en.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:en.backgroundCube_vert,fragmentShader:en.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:en.cube_vert,fragmentShader:en.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:en.equirect_vert,fragmentShader:en.equirect_frag},distanceRGBA:{uniforms:zr([dt.common,dt.displacementmap,{referencePosition:{value:new V},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:en.distanceRGBA_vert,fragmentShader:en.distanceRGBA_frag},shadow:{uniforms:zr([dt.lights,dt.fog,{color:{value:new xt(0)},opacity:{value:1}}]),vertexShader:en.shadow_vert,fragmentShader:en.shadow_frag}};xs.physical={uniforms:zr([xs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Oe(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new xt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Oe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new xt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new xt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:en.meshphysical_vert,fragmentShader:en.meshphysical_frag};const ll={r:0,b:0,g:0};function Zx(i,e,t,n,r,o,l){const c=new xt(0);let d,h,u=!0===o?0:1,f=null,p=0,y=null;function _(w,S){w.getRGB(ll,K_(i)),n.buffers.color.setClear(ll.r,ll.g,ll.b,S,l)}return{getClearColor:function(){return c},setClearColor:function(w,S=1){c.set(w),u=S,_(c,u)},getClearAlpha:function(){return u},setClearAlpha:function(w){u=w,_(c,u)},render:function x(w,S){let D=!1,T=!0===S.isScene?S.background:null;T&&T.isTexture&&(T=(S.backgroundBlurriness>0?t:e).get(T));const P=i.xr,k=P.getSession&&P.getSession();k&&"additive"===k.environmentBlendMode&&(T=null),null===T?_(c,u):T&&T.isColor&&(_(T,1),D=!0),(i.autoClear||D)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),T&&(T.isCubeTexture||T.mapping===Ya)?(void 0===h&&(h=new er(new yu(1,1,1),new vs({name:"BackgroundCubeMaterial",uniforms:tc(xs.backgroundCube.uniforms),vertexShader:xs.backgroundCube.vertexShader,fragmentShader:xs.backgroundCube.fragmentShader,side:_n,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(H,W,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=T,h.material.uniforms.flipEnvMap.value=T.isCubeTexture&&!1===T.isRenderTargetTexture?-1:1,h.material.uniforms.backgroundBlurriness.value=S.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,h.material.toneMapped=T.encoding!==Xn,(f!==T||p!==T.version||y!==i.toneMapping)&&(h.material.needsUpdate=!0,f=T,p=T.version,y=i.toneMapping),h.layers.enableAll(),w.unshift(h,h.geometry,h.material,0,0,null)):T&&T.isTexture&&(void 0===d&&(d=new er(new nf(2,2),new vs({name:"BackgroundMaterial",uniforms:tc(xs.background.uniforms),vertexShader:xs.background.vertexShader,fragmentShader:xs.background.fragmentShader,side:Qi,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(d)),d.material.uniforms.t2D.value=T,d.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,d.material.toneMapped=T.encoding!==Xn,!0===T.matrixAutoUpdate&&T.updateMatrix(),d.material.uniforms.uvTransform.value.copy(T.matrix),(f!==T||p!==T.version||y!==i.toneMapping)&&(d.material.needsUpdate=!0,f=T,p=T.version,y=i.toneMapping),d.layers.enableAll(),w.unshift(d,d.geometry,d.material,0,0,null))}}}function Uy(i,e,t,n){const r=i.getParameter(34921),o=n.isWebGL2?null:e.get("OES_vertex_array_object"),l=n.isWebGL2||null!==o,c={},u=w(null);let d=u,h=!1;function y(ee){return n.isWebGL2?i.bindVertexArray(ee):o.bindVertexArrayOES(ee)}function x(ee){return n.isWebGL2?i.deleteVertexArray(ee):o.deleteVertexArrayOES(ee)}function w(ee){const ge=[],re=[],ve=[];for(let se=0;se<r;se++)ge[se]=0,re[se]=0,ve[se]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ge,enabledAttributes:re,attributeDivisors:ve,object:ee,attributes:{},index:null}}function T(){const ee=d.newAttributes;for(let ge=0,re=ee.length;ge<re;ge++)ee[ge]=0}function P(ee){k(ee,0)}function k(ee,ge){const ve=d.enabledAttributes,se=d.attributeDivisors;d.newAttributes[ee]=1,0===ve[ee]&&(i.enableVertexAttribArray(ee),ve[ee]=1),se[ee]!==ge&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ee,ge),se[ee]=ge)}function H(){const ee=d.newAttributes,ge=d.enabledAttributes;for(let re=0,ve=ge.length;re<ve;re++)ge[re]!==ee[re]&&(i.disableVertexAttribArray(re),ge[re]=0)}function W(ee,ge,re,ve,se,Me){!0!==n.isWebGL2||5124!==re&&5125!==re?i.vertexAttribPointer(ee,ge,re,ve,se,Me):i.vertexAttribIPointer(ee,ge,re,se,Me)}function Ee(){te(),h=!0,d!==u&&(d=u,y(d.object))}function te(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function f(ee,ge,re,ve,se){let Me=!1;if(l){const ke=function _(ee,ge,re){const ve=!0===re.wireframe;let se=c[ee.id];void 0===se&&(se={},c[ee.id]=se);let Me=se[ge.id];void 0===Me&&(Me={},se[ge.id]=Me);let ke=Me[ve];return void 0===ke&&(ke=w(function p(){return n.isWebGL2?i.createVertexArray():o.createVertexArrayOES()}()),Me[ve]=ke),ke}(ve,re,ge);d!==ke&&(d=ke,y(d.object)),Me=function S(ee,ge,re,ve){const se=d.attributes,Me=ge.attributes;let ke=0;const ut=re.getAttributes();for(const ye in ut)if(ut[ye].location>=0){const ze=se[ye];let ue=Me[ye];if(void 0===ue&&("instanceMatrix"===ye&&ee.instanceMatrix&&(ue=ee.instanceMatrix),"instanceColor"===ye&&ee.instanceColor&&(ue=ee.instanceColor)),void 0===ze||ze.attribute!==ue||ue&&ze.data!==ue.data)return!0;ke++}return d.attributesNum!==ke||d.index!==ve}(ee,ve,re,se),Me&&function D(ee,ge,re,ve){const se={},Me=ge.attributes;let ke=0;const ut=re.getAttributes();for(const ye in ut)if(ut[ye].location>=0){let ze=Me[ye];void 0===ze&&("instanceMatrix"===ye&&ee.instanceMatrix&&(ze=ee.instanceMatrix),"instanceColor"===ye&&ee.instanceColor&&(ze=ee.instanceColor));const ue={};ue.attribute=ze,ze&&ze.data&&(ue.data=ze.data),se[ye]=ue,ke++}d.attributes=se,d.attributesNum=ke,d.index=ve}(ee,ve,re,se)}else{const ke=!0===ge.wireframe;(d.geometry!==ve.id||d.program!==re.id||d.wireframe!==ke)&&(d.geometry=ve.id,d.program=re.id,d.wireframe=ke,Me=!0)}null!==se&&t.update(se,34963),(Me||h)&&(h=!1,function R(ee,ge,re,ve){if(!1===n.isWebGL2&&(ee.isInstancedMesh||ve.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;T();const se=ve.attributes,Me=re.getAttributes(),ke=ge.defaultAttributeValues;for(const ut in Me){const ye=Me[ut];if(ye.location>=0){let We=se[ut];if(void 0===We&&("instanceMatrix"===ut&&ee.instanceMatrix&&(We=ee.instanceMatrix),"instanceColor"===ut&&ee.instanceColor&&(We=ee.instanceColor)),void 0!==We){const ze=We.normalized,ue=We.itemSize,mt=t.get(We);if(void 0===mt)continue;const et=mt.buffer,ft=mt.type,gt=mt.bytesPerElement;if(We.isInterleavedBufferAttribute){const bt=We.data,Bt=bt.stride,Ve=We.offset;if(bt.isInstancedInterleavedBuffer){for(let Ze=0;Ze<ye.locationSize;Ze++)k(ye.location+Ze,bt.meshPerAttribute);!0!==ee.isInstancedMesh&&void 0===ve._maxInstanceCount&&(ve._maxInstanceCount=bt.meshPerAttribute*bt.count)}else for(let Ze=0;Ze<ye.locationSize;Ze++)P(ye.location+Ze);i.bindBuffer(34962,et);for(let Ze=0;Ze<ye.locationSize;Ze++)W(ye.location+Ze,ue/ye.locationSize,ft,ze,Bt*gt,(Ve+ue/ye.locationSize*Ze)*gt)}else{if(We.isInstancedBufferAttribute){for(let bt=0;bt<ye.locationSize;bt++)k(ye.location+bt,We.meshPerAttribute);!0!==ee.isInstancedMesh&&void 0===ve._maxInstanceCount&&(ve._maxInstanceCount=We.meshPerAttribute*We.count)}else for(let bt=0;bt<ye.locationSize;bt++)P(ye.location+bt);i.bindBuffer(34962,et);for(let bt=0;bt<ye.locationSize;bt++)W(ye.location+bt,ue/ye.locationSize,ft,ze,ue*gt,ue/ye.locationSize*bt*gt)}}else if(void 0!==ke){const ze=ke[ut];if(void 0!==ze)switch(ze.length){case 2:i.vertexAttrib2fv(ye.location,ze);break;case 3:i.vertexAttrib3fv(ye.location,ze);break;case 4:i.vertexAttrib4fv(ye.location,ze);break;default:i.vertexAttrib1fv(ye.location,ze)}}}}H()}(ee,ge,re,ve),null!==se&&i.bindBuffer(34963,t.get(se).buffer))},reset:Ee,resetDefaultState:te,dispose:function B(){Ee();for(const ee in c){const ge=c[ee];for(const re in ge){const ve=ge[re];for(const se in ve)x(ve[se].object),delete ve[se];delete ge[re]}delete c[ee]}},releaseStatesOfGeometry:function X(ee){if(void 0===c[ee.id])return;const ge=c[ee.id];for(const re in ge){const ve=ge[re];for(const se in ve)x(ve[se].object),delete ve[se];delete ge[re]}delete c[ee.id]},releaseStatesOfProgram:function le(ee){for(const ge in c){const re=c[ge];if(void 0===re[ee.id])continue;const ve=re[ee.id];for(const se in ve)x(ve[se].object),delete ve[se];delete re[ee.id]}},initAttributes:T,enableAttribute:P,disableUnusedAttributes:H}}function zy(i,e,t,n){const r=n.isWebGL2;let o;this.setMode=function l(d){o=d},this.render=function c(d,h){i.drawArrays(o,d,h),t.update(h,o,1)},this.renderInstances=function u(d,h,f){if(0===f)return;let p,y;if(r)p=i,y="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),y="drawArraysInstancedANGLE",null===p)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[y](o,d,h,f),t.update(h,o,f)}}function Kx(i,e,t){let n;function o(W){if("highp"===W){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";W="mediump"}return"mediump"===W&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const l=typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext;let c=void 0!==t.precision?t.precision:"highp";const u=o(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const d=l||e.has("WEBGL_draw_buffers"),h=!0===t.logarithmicDepthBuffer,f=i.getParameter(34930),p=i.getParameter(35660),y=i.getParameter(3379),x=i.getParameter(34076),_=i.getParameter(34921),w=i.getParameter(36347),S=i.getParameter(36348),D=i.getParameter(36349),T=p>0,P=l||e.has("OES_texture_float");return{isWebGL2:l,drawBuffers:d,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const W=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(W.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:o,precision:c,logarithmicDepthBuffer:h,maxTextures:f,maxVertexTextures:p,maxTextureSize:y,maxCubemapSize:x,maxAttributes:_,maxVertexUniforms:w,maxVaryings:S,maxFragmentUniforms:D,vertexTextures:T,floatFragmentTextures:P,floatVertexTextures:T&&P,maxSamples:l?i.getParameter(36183):0}}function Qx(i){const e=this;let t=null,n=0,r=!1,o=!1;const l=new rc,c=new lr,u={value:null,needsUpdate:!1};function h(f,p,y,x){const _=null!==f?f.length:0;let w=null;if(0!==_){if(w=u.value,!0!==x||null===w){const S=y+4*_,D=p.matrixWorldInverse;c.getNormalMatrix(D),(null===w||w.length<S)&&(w=new Float32Array(S));for(let T=0,P=y;T!==_;++T,P+=4)l.copy(f[T]).applyMatrix4(D,c),l.normal.toArray(w,P),w[P+3]=l.constant}u.value=w,u.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,w}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(f,p){const y=0!==f.length||p||0!==n||r;return r=p,n=f.length,y},this.beginShadows=function(){o=!0,h(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(f,p){t=h(f,p,0)},this.setState=function(f,p,y){const x=f.clippingPlanes,_=f.clipIntersection,w=f.clipShadows,S=i.get(f);if(!r||null===x||0===x.length||o&&!w)o?h(null):function d(){u.value!==t&&(u.value=t,u.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}();else{const D=o?0:n,T=4*D;let P=S.clippingState||null;u.value=P,P=h(x,p,T,y);for(let k=0;k!==T;++k)P[k]=t[k];S.clippingState=P,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=D}}}function Pd(i){let e=new WeakMap;function t(l,c){return c===Jc?l.mapping=Rs:c===Hl&&(l.mapping=Xs),l}function r(l){const c=l.target;c.removeEventListener("dispose",r);const u=e.get(c);void 0!==u&&(e.delete(c),u.dispose())}return{get:function n(l){if(l&&l.isTexture&&!1===l.isRenderTargetTexture){const c=l.mapping;if(c===Jc||c===Hl){if(e.has(l))return t(e.get(l).texture,l.mapping);{const u=l.image;if(u&&u.height>0){const d=new ny(u.height/2);return d.fromEquirectangularTexture(i,l),e.set(l,d),l.addEventListener("dispose",r),t(d.texture,l.mapping)}return null}}}return l},dispose:function o(){e=new WeakMap}}}class lf extends nc{constructor(e=-1,t=1,n=1,r=-1,o=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=o,this.far=l,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,o,l){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=n-e,l=n+e,c=r+t,u=r-t;if(null!==this.view&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=d*this.view.offsetX,l=o+d*this.view.width,c-=h*this.view.offsetY,u=c-h*this.view.height}this.projectionMatrix.makeOrthographic(o,l,c,u,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Hy=[.125,.215,.35,.446,.526,.582],Qp=new lf,Vy=new xt;let Jp=null;const ac=(1+Math.sqrt(5))/2,Mu=1/ac,em=[new V(1,1,1),new V(-1,1,1),new V(1,1,-1),new V(-1,1,-1),new V(0,ac,Mu),new V(0,ac,-Mu),new V(Mu,0,ac),new V(-Mu,0,ac),new V(ac,Mu,0),new V(-ac,Mu,0)];class tm{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){Jp=this._renderer.getRenderTarget(),this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,n,r,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Wy(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Gy(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Jp),e.scissorTest=!1,uf(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Rs||e.mapping===Xs?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Jp=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Qn,minFilter:Qn,generateMipmaps:!1,type:hi,format:Gi,encoding:ql,depthBuffer:!1},r=cf(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=cf(e,t,n);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Jx(i){const e=[],t=[],n=[];let r=i;const o=i-4+1+Hy.length;for(let l=0;l<o;l++){const c=Math.pow(2,r);t.push(c);let u=1/c;l>i-4?u=Hy[l-i+4-1]:0===l&&(u=0),n.push(u);const d=1/(c-2),h=-d,f=1+d,p=[h,h,f,h,f,f,h,h,f,f,h,f],y=6,x=6,_=3,w=2,S=1,D=new Float32Array(_*x*y),T=new Float32Array(w*x*y),P=new Float32Array(S*x*y);for(let H=0;H<y;H++){const W=H%3*2/3-1,R=H>2?0:-1;D.set([W,R,0,W+2/3,R,0,W+2/3,R+1,0,W,R,0,W+2/3,R+1,0,W,R+1,0],_*x*H),T.set(p,w*x*H),P.set([H,H,H,H,H,H],S*x*H)}const k=new cn;k.setAttribute("position",new Oi(D,_)),k.setAttribute("uv",new Oi(T,w)),k.setAttribute("faceIndex",new Oi(P,S)),e.push(k),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(o)),this._blurMaterial=function ew(i,e,t){const n=new Float32Array(20),r=new V(0,1,0);return new vs({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:hs,depthTest:!1,depthWrite:!1})}(o,e,t)}return r}_compileMaterial(e){const t=new er(this._lodPlanes[0],e);this._renderer.compile(t,Qp)}_sceneToCubeUV(e,t,n,r){const c=new ur(90,1,t,n),u=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],h=this._renderer,f=h.autoClear,p=h.toneMapping;h.getClearColor(Vy),h.toneMapping=pr,h.autoClear=!1;const y=new Br({name:"PMREM.Background",side:_n,depthWrite:!1,depthTest:!1}),x=new er(new yu,y);let _=!1;const w=e.background;w?w.isColor&&(y.color.copy(w),e.background=null,_=!0):(y.color.copy(Vy),_=!0);for(let S=0;S<6;S++){const D=S%3;0===D?(c.up.set(0,u[S],0),c.lookAt(d[S],0,0)):1===D?(c.up.set(0,0,u[S]),c.lookAt(0,d[S],0)):(c.up.set(0,u[S],0),c.lookAt(0,0,d[S]));const T=this._cubeSize;uf(r,D*T,S>2?T:0,T,T),h.setRenderTarget(r),_&&h.render(x,c),h.render(e,c)}x.geometry.dispose(),x.material.dispose(),h.toneMapping=p,h.autoClear=f,e.background=w}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===Rs||e.mapping===Xs;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=Wy()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Gy());const o=r?this._cubemapMaterial:this._equirectMaterial,l=new er(this._lodPlanes[0],o);o.uniforms.envMap.value=e;const u=this._cubeSize;uf(t,0,0,3*u,2*u),n.setRenderTarget(t),n.render(l,Qp)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,o,em[(r-1)%em.length])}t.autoClear=n}_blur(e,t,n,r,o){const l=this._pingPongRenderTarget;this._halfBlur(e,l,t,n,r,"latitudinal",o),this._halfBlur(l,e,n,n,r,"longitudinal",o)}_halfBlur(e,t,n,r,o,l,c){const u=this._renderer,d=this._blurMaterial;"latitudinal"!==l&&"longitudinal"!==l&&console.error("blur direction must be either latitudinal or longitudinal!");const f=new er(this._lodPlanes[r],d),p=d.uniforms,y=this._sizeLods[n]-1,x=isFinite(o)?Math.PI/(2*y):2*Math.PI/39,_=o/x,w=isFinite(o)?1+Math.floor(3*_):20;w>20&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${w} samples when the maximum is set to 20`);const S=[];let D=0;for(let W=0;W<20;++W){const R=W/_,B=Math.exp(-R*R/2);S.push(B),0===W?D+=B:W<w&&(D+=2*B)}for(let W=0;W<S.length;W++)S[W]=S[W]/D;p.envMap.value=e.texture,p.samples.value=w,p.weights.value=S,p.latitudinal.value="latitudinal"===l,c&&(p.poleAxis.value=c);const{_lodMax:T}=this;p.dTheta.value=x,p.mipInt.value=T-n;const P=this._sizeLods[r];uf(t,3*P*(r>T-4?r-T+4:0),4*(this._cubeSize-P),3*P,2*P),u.setRenderTarget(t),u.render(f,Qp)}}function cf(i,e,t){const n=new Wo(i,e,t);return n.texture.mapping=Ya,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function uf(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function Gy(){return new vs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:hs,depthTest:!1,depthWrite:!1})}function Wy(){return new vs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:hs,depthTest:!1,depthWrite:!1})}function tw(i){let e=new WeakMap,t=null;function o(c){const u=c.target;u.removeEventListener("dispose",o);const d=e.get(u);void 0!==d&&(e.delete(u),d.dispose())}return{get:function n(c){if(c&&c.isTexture){const u=c.mapping,d=u===Jc||u===Hl,h=u===Rs||u===Xs;if(d||h){if(c.isRenderTargetTexture&&!0===c.needsPMREMUpdate){c.needsPMREMUpdate=!1;let f=e.get(c);return null===t&&(t=new tm(i)),f=d?t.fromEquirectangular(c,f):t.fromCubemap(c,f),e.set(c,f),f.texture}if(e.has(c))return e.get(c).texture;{const f=c.image;if(d&&f&&f.height>0||h&&f&&function r(c){let u=0;for(let h=0;h<6;h++)void 0!==c[h]&&u++;return 6===u}(f)){null===t&&(t=new tm(i));const p=d?t.fromEquirectangular(c):t.fromCubemap(c);return e.set(c,p),c.addEventListener("dispose",o),p.texture}return null}}}return c},dispose:function l(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function nw(i){const e={};function t(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function jy(i,e,t,n){const r={},o=new WeakMap;function l(f){const p=f.target;null!==p.index&&e.remove(p.index);for(const x in p.attributes)e.remove(p.attributes[x]);p.removeEventListener("dispose",l),delete r[p.id];const y=o.get(p);y&&(e.remove(y),o.delete(p)),n.releaseStatesOfGeometry(p),!0===p.isInstancedBufferGeometry&&delete p._maxInstanceCount,t.memory.geometries--}function d(f){const p=[],y=f.index,x=f.attributes.position;let _=0;if(null!==y){const D=y.array;_=y.version;for(let T=0,P=D.length;T<P;T+=3){const k=D[T+0],H=D[T+1],W=D[T+2];p.push(k,H,H,W,W,k)}}else{_=x.version;for(let T=0,P=x.array.length/3-1;T<P;T+=3){const k=T+0,H=T+1,W=T+2;p.push(k,H,H,W,W,k)}}const w=new(Bg(p)?Y_:Lp)(p,1);w.version=_;const S=o.get(f);S&&e.remove(S),o.set(f,w)}return{get:function c(f,p){return!0===r[p.id]||(p.addEventListener("dispose",l),r[p.id]=!0,t.memory.geometries++),p},update:function u(f){const p=f.attributes;for(const x in p)e.update(p[x],34962);const y=f.morphAttributes;for(const x in y){const _=y[x];for(let w=0,S=_.length;w<S;w++)e.update(_[w],34962)}},getWireframeAttribute:function h(f){const p=o.get(f);if(p){const y=f.index;null!==y&&p.version<y.version&&d(f)}else d(f);return o.get(f)}}}function $y(i,e,t,n){const r=n.isWebGL2;let o,c,u;this.setMode=function l(p){o=p},this.setIndex=function d(p){c=p.type,u=p.bytesPerElement},this.render=function h(p,y){i.drawElements(o,y,c,p*u),t.update(y,o,1)},this.renderInstances=function f(p,y,x){if(0===x)return;let _,w;if(r)_=i,w="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),w="drawElementsInstancedANGLE",null===_)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");_[w](o,y,c,p*u,x),t.update(y,o,x)}}function iw(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(o,l,c){switch(t.calls++,l){case 4:t.triangles+=c*(o/3);break;case 1:t.lines+=c*(o/2);break;case 3:t.lines+=c*(o-1);break;case 2:t.lines+=c*o;break;case 0:t.points+=c*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",l)}}}}function YM(i,e){return i[0]-e[0]}function qy(i,e){return Math.abs(e[1])-Math.abs(i[1])}function XM(i,e,t){const n={},r=new Float32Array(8),o=new WeakMap,l=new ei,c=[];for(let d=0;d<8;d++)c[d]=[d,0];return{update:function u(d,h,f){const p=d.morphTargetInfluences;if(!0===e.isWebGL2){const y=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,x=void 0!==y?y.length:0;let _=o.get(h);if(void 0===_||_.count!==x){let ee=function(){Ee.dispose(),o.delete(h),h.removeEventListener("dispose",ee)};void 0!==_&&_.texture.dispose();const D=void 0!==h.morphAttributes.position,T=void 0!==h.morphAttributes.normal,P=void 0!==h.morphAttributes.color,k=h.morphAttributes.position||[],H=h.morphAttributes.normal||[],W=h.morphAttributes.color||[];let R=0;!0===D&&(R=1),!0===T&&(R=2),!0===P&&(R=3);let B=h.attributes.position.count*R,X=1;B>e.maxTextureSize&&(X=Math.ceil(B/e.maxTextureSize),B=e.maxTextureSize);const le=new Float32Array(B*X*4*x),Ee=new ru(le,B,X,x);Ee.type=ps,Ee.needsUpdate=!0;const te=4*R;for(let ge=0;ge<x;ge++){const re=k[ge],ve=H[ge],se=W[ge],Me=B*X*4*ge;for(let ke=0;ke<re.count;ke++){const ut=ke*te;!0===D&&(l.fromBufferAttribute(re,ke),le[Me+ut+0]=l.x,le[Me+ut+1]=l.y,le[Me+ut+2]=l.z,le[Me+ut+3]=0),!0===T&&(l.fromBufferAttribute(ve,ke),le[Me+ut+4]=l.x,le[Me+ut+5]=l.y,le[Me+ut+6]=l.z,le[Me+ut+7]=0),!0===P&&(l.fromBufferAttribute(se,ke),le[Me+ut+8]=l.x,le[Me+ut+9]=l.y,le[Me+ut+10]=l.z,le[Me+ut+11]=4===se.itemSize?l.w:1)}}_={count:x,texture:Ee,size:new Oe(B,X)},o.set(h,_),h.addEventListener("dispose",ee)}let w=0;for(let D=0;D<p.length;D++)w+=p[D];const S=h.morphTargetsRelative?1:1-w;f.getUniforms().setValue(i,"morphTargetBaseInfluence",S),f.getUniforms().setValue(i,"morphTargetInfluences",p),f.getUniforms().setValue(i,"morphTargetsTexture",_.texture,t),f.getUniforms().setValue(i,"morphTargetsTextureSize",_.size)}else{const y=void 0===p?0:p.length;let x=n[h.id];if(void 0===x||x.length!==y){x=[];for(let T=0;T<y;T++)x[T]=[T,0];n[h.id]=x}for(let T=0;T<y;T++){const P=x[T];P[0]=T,P[1]=p[T]}x.sort(qy);for(let T=0;T<8;T++)T<y&&x[T][1]?(c[T][0]=x[T][0],c[T][1]=x[T][1]):(c[T][0]=Number.MAX_SAFE_INTEGER,c[T][1]=0);c.sort(YM);const _=h.morphAttributes.position,w=h.morphAttributes.normal;let S=0;for(let T=0;T<8;T++){const P=c[T],k=P[0],H=P[1];k!==Number.MAX_SAFE_INTEGER&&H?(_&&h.getAttribute("morphTarget"+T)!==_[k]&&h.setAttribute("morphTarget"+T,_[k]),w&&h.getAttribute("morphNormal"+T)!==w[k]&&h.setAttribute("morphNormal"+T,w[k]),r[T]=H,S+=H):(_&&!0===h.hasAttribute("morphTarget"+T)&&h.deleteAttribute("morphTarget"+T),w&&!0===h.hasAttribute("morphNormal"+T)&&h.deleteAttribute("morphNormal"+T),r[T]=0)}const D=h.morphTargetsRelative?1:1-S;f.getUniforms().setValue(i,"morphTargetBaseInfluence",D),f.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function df(i,e,t,n){let r=new WeakMap;function c(u){const d=u.target;d.removeEventListener("dispose",c),t.remove(d.instanceMatrix),null!==d.instanceColor&&t.remove(d.instanceColor)}return{update:function o(u){const d=n.render.frame,f=e.get(u,u.geometry);return r.get(f)!==d&&(e.update(f),r.set(f,d)),u.isInstancedMesh&&(!1===u.hasEventListener("dispose",c)&&u.addEventListener("dispose",c),t.update(u.instanceMatrix,34962),null!==u.instanceColor&&t.update(u.instanceColor,34962)),f},dispose:function l(){r=new WeakMap}}}const Yy=new gs,Xy=new ru,hf=new Bh,Zy=new tf,lo=[],Su=[],yr=new Float32Array(16),cl=new Float32Array(9),Ld=new Float32Array(4);function vr(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let o=lo[r];if(void 0===o&&(o=new Float32Array(r),lo[r]=o),0!==e){n.toArray(o,0);for(let l=1,c=0;l!==e;++l)c+=t,i[l].toArray(o,c)}return o}function Ni(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function fi(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function Ta(i,e){let t=Su[e];void 0===t&&(t=new Int32Array(e),Su[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function Eu(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function Tu(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ni(t,e))return;i.uniform2fv(this.addr,e),fi(t,e)}}function Au(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ni(t,e))return;i.uniform3fv(this.addr,e),fi(t,e)}}function Cu(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ni(t,e))return;i.uniform4fv(this.addr,e),fi(t,e)}}function Du(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Ni(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),fi(t,e)}else{if(Ni(t,n))return;Ld.set(n),i.uniformMatrix2fv(this.addr,!1,Ld),fi(t,n)}}function Iu(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Ni(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),fi(t,e)}else{if(Ni(t,n))return;cl.set(n),i.uniformMatrix3fv(this.addr,!1,cl),fi(t,n)}}function Pu(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Ni(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),fi(t,e)}else{if(Ni(t,n))return;yr.set(n),i.uniformMatrix4fv(this.addr,!1,yr),fi(t,n)}}function Ky(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function Qy(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ni(t,e))return;i.uniform2iv(this.addr,e),fi(t,e)}}function Jy(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ni(t,e))return;i.uniform3iv(this.addr,e),fi(t,e)}}function e0(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ni(t,e))return;i.uniform4iv(this.addr,e),fi(t,e)}}function t0(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function n0(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ni(t,e))return;i.uniform2uiv(this.addr,e),fi(t,e)}}function r0(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ni(t,e))return;i.uniform3uiv(this.addr,e),fi(t,e)}}function s0(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ni(t,e))return;i.uniform4uiv(this.addr,e),fi(t,e)}}function o0(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||Yy,r)}function rw(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||hf,r)}function sw(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||Zy,r)}function a0(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||Xy,r)}function aw(i,e){i.uniform1fv(this.addr,e)}function im(i,e){const t=vr(e,this.size,2);i.uniform2fv(this.addr,t)}function rm(i,e){const t=vr(e,this.size,3);i.uniform3fv(this.addr,t)}function lw(i,e){const t=vr(e,this.size,4);i.uniform4fv(this.addr,t)}function ff(i,e){const t=vr(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function pf(i,e){const t=vr(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function sm(i,e){const t=vr(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function cw(i,e){i.uniform1iv(this.addr,e)}function mf(i,e){i.uniform2iv(this.addr,e)}function gf(i,e){i.uniform3iv(this.addr,e)}function l0(i,e){i.uniform4iv(this.addr,e)}function c0(i,e){i.uniform1uiv(this.addr,e)}function om(i,e){i.uniform2uiv(this.addr,e)}function u0(i,e){i.uniform3uiv(this.addr,e)}function d0(i,e){i.uniform4uiv(this.addr,e)}function am(i,e,t){const n=this.cache,r=e.length,o=Ta(t,r);Ni(n,o)||(i.uniform1iv(this.addr,o),fi(n,o));for(let l=0;l!==r;++l)t.setTexture2D(e[l]||Yy,o[l])}function h0(i,e,t){const n=this.cache,r=e.length,o=Ta(t,r);Ni(n,o)||(i.uniform1iv(this.addr,o),fi(n,o));for(let l=0;l!==r;++l)t.setTexture3D(e[l]||hf,o[l])}function uw(i,e,t){const n=this.cache,r=e.length,o=Ta(t,r);Ni(n,o)||(i.uniform1iv(this.addr,o),fi(n,o));for(let l=0;l!==r;++l)t.setTextureCube(e[l]||Zy,o[l])}function f0(i,e,t){const n=this.cache,r=e.length,o=Ta(t,r);Ni(n,o)||(i.uniform1iv(this.addr,o),fi(n,o));for(let l=0;l!==r;++l)t.setTexture2DArray(e[l]||Xy,o[l])}class m0{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function ow(i){switch(i){case 5126:return Eu;case 35664:return Tu;case 35665:return Au;case 35666:return Cu;case 35674:return Du;case 35675:return Iu;case 35676:return Pu;case 5124:case 35670:return Ky;case 35667:case 35671:return Qy;case 35668:case 35672:return Jy;case 35669:case 35673:return e0;case 5125:return t0;case 36294:return n0;case 36295:return r0;case 36296:return s0;case 35678:case 36198:case 36298:case 36306:case 35682:return o0;case 35679:case 36299:case 36307:return rw;case 35680:case 36300:case 36308:case 36293:return sw;case 36289:case 36303:case 36311:case 36292:return a0}}(t.type)}}class g0{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function p0(i){switch(i){case 5126:return aw;case 35664:return im;case 35665:return rm;case 35666:return lw;case 35674:return ff;case 35675:return pf;case 35676:return sm;case 5124:case 35670:return cw;case 35667:case 35671:return mf;case 35668:case 35672:return gf;case 35669:case 35673:return l0;case 5125:return c0;case 36294:return om;case 36295:return u0;case 36296:return d0;case 35678:case 36198:case 36298:case 36306:case 35682:return am;case 35679:case 36299:case 36307:return h0;case 35680:case 36300:case 36308:case 36293:return uw;case 36289:case 36303:case 36311:case 36292:return f0}}(t.type)}}class dw{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let o=0,l=r.length;o!==l;++o){const c=r[o];c.setValue(e,t[c.id],n)}}}const yf=/(\w+)(\])?(\[|\.)?/g;function lm(i,e){i.seq.push(e),i.map[e.id]=e}function y0(i,e,t){const n=i.name,r=n.length;for(yf.lastIndex=0;;){const o=yf.exec(n);let c=o[1];const d=o[3];if("]"===o[2]&&(c|=0),void 0===d||"["===d&&yf.lastIndex+2===r){lm(t,void 0===d?new m0(c,i,e):new g0(c,i,e));break}{let f=t.map[c];void 0===f&&(f=new dw(c),lm(t,f)),t=f}}}class Ru{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const o=e.getActiveUniform(t,r);y0(o,e.getUniformLocation(t,o.name),this)}}setValue(e,t,n,r){const o=this.map[t];void 0!==o&&o.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let o=0,l=t.length;o!==l;++o){const c=t[o],u=n[c.id];!1!==u.needsUpdate&&c.setValue(e,u.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,o=e.length;r!==o;++r){const l=e[r];l.id in t&&n.push(l)}return n}}function cm(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}let v0=0;function um(i,e,t){const n=i.getShaderParameter(e,35713),r=i.getShaderInfoLog(e).trim();if(n&&""===r)return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const l=parseInt(o[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function _0(i,e){const t=i.split("\n"),n=[],r=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let l=r;l<o;l++){const c=l+1;n.push(`${c===e?">":" "} ${c}: ${t[l]}`)}return n.join("\n")}(i.getShaderSource(e),l)}return r}function w0(i,e){const t=function x0(i){switch(i){case ql:return["Linear","( value )"];case Xn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function b0(i,e){let t;switch(e){case fd:t="Linear";break;case Ps:t="Reinhard";break;case Sh:t="OptimizedCineon";break;case ha:t="ACESFilmic";break;case qa:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Od(i){return""!==i}function S0(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function _f(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const lc=/^[ \t]*#include +<([\w\d./]+)>/gm;function Nd(i){return i.replace(lc,hw)}function hw(i,e){const t=en[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return Nd(t)}const dm=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function fw(i){return i.replace(dm,ZM)}function ZM(i,e,t,n){let r="";for(let o=parseInt(e);o<parseInt(t);o++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function E0(i){let e="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?e+="\n#define HIGH_PRECISION":"mediump"===i.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(e+="\n#define LOW_PRECISION"),e}function gw(i,e,t,n){const r=i.getContext(),o=t.defines;let l=t.vertexShader,c=t.fragmentShader;const u=function pw(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===dd?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===bh?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===ui&&(e="SHADOWMAP_TYPE_VSM"),e}(t),d=function T0(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Rs:case Xs:e="ENVMAP_TYPE_CUBE";break;case Ya:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),h=function mw(i){let e="ENVMAP_MODE_REFLECTION";return i.envMap&&i.envMapMode===Xs&&(e="ENVMAP_MODE_REFRACTION"),e}(t),f=function tr(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case Ys:e="ENVMAP_BLENDING_MULTIPLY";break;case _g:e="ENVMAP_BLENDING_MIX";break;case hd:e="ENVMAP_BLENDING_ADD"}return e}(t),p=function A0(i){const e=i.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),y=t.isWebGL2?"":function M0(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Od).join("\n")}(t),x=function vf(i){const e=[];for(const t in i){const n=i[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(o),_=r.createProgram();let w,S,D=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(w=[x].filter(Od).join("\n"),w.length>0&&(w+="\n"),S=[y,x].filter(Od).join("\n"),S.length>0&&(S+="\n")):(w=[E0(t),"#define SHADER_NAME "+t.shaderName,x,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Od).join("\n"),S=[y,E0(t),"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.envMap?"#define "+h:"",t.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==pr?"#define TONE_MAPPING":"",t.toneMapping!==pr?en.tonemapping_pars_fragment:"",t.toneMapping!==pr?b0("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",en.encodings_pars_fragment,w0("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Od).join("\n")),l=Nd(l),l=S0(l,t),l=_f(l,t),c=Nd(c),c=S0(c,t),c=_f(c,t),l=fw(l),c=fw(c),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(D="#version 300 es\n",w=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+w,S=["#define varying in",t.glslVersion===Rg?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Rg?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+S);const P=D+S+c,k=cm(r,35633,D+w+l),H=cm(r,35632,P);if(r.attachShader(_,k),r.attachShader(_,H),void 0!==t.index0AttributeName?r.bindAttribLocation(_,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),i.debug.checkShaderErrors){const B=r.getProgramInfoLog(_).trim(),X=r.getShaderInfoLog(k).trim(),le=r.getShaderInfoLog(H).trim();let Ee=!0,te=!0;if(!1===r.getProgramParameter(_,35714)){Ee=!1;const ee=um(r,k,"vertex"),ge=um(r,H,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,35715)+"\n\nProgram Info Log: "+B+"\n"+ee+"\n"+ge)}else""!==B?console.warn("THREE.WebGLProgram: Program Info Log:",B):(""===X||""===le)&&(te=!1);te&&(this.diagnostics={runnable:Ee,programLog:B,vertexShader:{log:X,prefix:w},fragmentShader:{log:le,prefix:S}})}let W,R;return r.deleteShader(k),r.deleteShader(H),this.getUniforms=function(){return void 0===W&&(W=new Ru(r,_)),W},this.getAttributes=function(){return void 0===R&&(R=function ul(i,e){const t={},n=i.getProgramParameter(e,35721);for(let r=0;r<n;r++){const o=i.getActiveAttrib(e,r),l=o.name;let c=1;35674===o.type&&(c=2),35675===o.type&&(c=3),35676===o.type&&(c=4),t[l]={type:o.type,location:i.getAttribLocation(e,l),locationSize:c}}return t}(r,_)),R},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.name=t.shaderName,this.id=v0++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=k,this.fragmentShader=H,this}let yw=0;class C0{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,r=this._getShaderStage(e.vertexShader),o=this._getShaderStage(n),l=this._getShaderCacheForMaterial(e);return!1===l.has(r)&&(l.add(r),r.usedTimes++),!1===l.has(o)&&(l.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new vw(e),t.set(e,n)),n}}class vw{constructor(e){this.id=yw++,this.code=e,this.usedTimes=0}}function D0(i,e,t,n,r,o,l){const c=new Ip,u=new C0,d=[],h=r.isWebGL2,f=r.logarithmicDepthBuffer,p=r.vertexTextures;let y=r.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function _(R,B,X,le,Ee){const te=le.fog,ee=Ee.geometry,re=(R.isMeshStandardMaterial?t:e).get(R.envMap||(R.isMeshStandardMaterial?le.environment:null)),ve=re&&re.mapping===Ya?re.image.height:null,se=x[R.type];null!==R.precision&&(y=r.getMaxPrecision(R.precision),y!==R.precision&&console.warn("THREE.WebGLProgram.getParameters:",R.precision,"not supported, using",y,"instead."));const Me=ee.morphAttributes.position||ee.morphAttributes.normal||ee.morphAttributes.color,ke=void 0!==Me?Me.length:0;let ye,We,ze,ue,ut=0;if(void 0!==ee.morphAttributes.position&&(ut=1),void 0!==ee.morphAttributes.normal&&(ut=2),void 0!==ee.morphAttributes.color&&(ut=3),se){const Bt=xs[se];ye=Bt.vertexShader,We=Bt.fragmentShader}else ye=R.vertexShader,We=R.fragmentShader,u.update(R),ze=u.getVertexShaderID(R),ue=u.getFragmentShaderID(R);const mt=i.getRenderTarget(),ft=R.clearcoat>0,gt=R.iridescence>0;return{isWebGL2:h,shaderID:se,shaderName:R.type,vertexShader:ye,fragmentShader:We,defines:R.defines,customVertexShaderID:ze,customFragmentShaderID:ue,isRawShaderMaterial:!0===R.isRawShaderMaterial,glslVersion:R.glslVersion,precision:y,instancing:!0===Ee.isInstancedMesh,instancingColor:!0===Ee.isInstancedMesh&&null!==Ee.instanceColor,supportsVertexTextures:p,outputEncoding:null===mt?i.outputEncoding:!0===mt.isXRRenderTarget?mt.texture.encoding:ql,map:!!R.map,matcap:!!R.matcap,envMap:!!re,envMapMode:re&&re.mapping,envMapCubeUVHeight:ve,lightMap:!!R.lightMap,aoMap:!!R.aoMap,emissiveMap:!!R.emissiveMap,bumpMap:!!R.bumpMap,normalMap:!!R.normalMap,objectSpaceNormalMap:R.normalMapType===Tg,tangentSpaceNormalMap:R.normalMapType===Yl,decodeVideoTexture:!!R.map&&!0===R.map.isVideoTexture&&R.map.encoding===Xn,clearcoat:ft,clearcoatMap:ft&&!!R.clearcoatMap,clearcoatRoughnessMap:ft&&!!R.clearcoatRoughnessMap,clearcoatNormalMap:ft&&!!R.clearcoatNormalMap,iridescence:gt,iridescenceMap:gt&&!!R.iridescenceMap,iridescenceThicknessMap:gt&&!!R.iridescenceThicknessMap,displacementMap:!!R.displacementMap,roughnessMap:!!R.roughnessMap,metalnessMap:!!R.metalnessMap,specularMap:!!R.specularMap,specularIntensityMap:!!R.specularIntensityMap,specularColorMap:!!R.specularColorMap,opaque:!1===R.transparent&&R.blending===M,alphaMap:!!R.alphaMap,alphaTest:R.alphaTest>0,gradientMap:!!R.gradientMap,sheen:R.sheen>0,sheenColorMap:!!R.sheenColorMap,sheenRoughnessMap:!!R.sheenRoughnessMap,transmission:R.transmission>0,transmissionMap:!!R.transmissionMap,thicknessMap:!!R.thicknessMap,combine:R.combine,vertexTangents:!!R.normalMap&&!!ee.attributes.tangent,vertexColors:R.vertexColors,vertexAlphas:!0===R.vertexColors&&!!ee.attributes.color&&4===ee.attributes.color.itemSize,vertexUvs:!!(R.map||R.bumpMap||R.normalMap||R.specularMap||R.alphaMap||R.emissiveMap||R.roughnessMap||R.metalnessMap||R.clearcoatMap||R.clearcoatRoughnessMap||R.clearcoatNormalMap||R.iridescenceMap||R.iridescenceThicknessMap||R.displacementMap||R.transmissionMap||R.thicknessMap||R.specularIntensityMap||R.specularColorMap||R.sheenColorMap||R.sheenRoughnessMap),uvsVertexOnly:!(R.map||R.bumpMap||R.normalMap||R.specularMap||R.alphaMap||R.emissiveMap||R.roughnessMap||R.metalnessMap||R.clearcoatNormalMap||R.iridescenceMap||R.iridescenceThicknessMap||R.transmission>0||R.transmissionMap||R.thicknessMap||R.specularIntensityMap||R.specularColorMap||R.sheen>0||R.sheenColorMap||R.sheenRoughnessMap||!R.displacementMap),fog:!!te,useFog:!0===R.fog,fogExp2:te&&te.isFogExp2,flatShading:!!R.flatShading,sizeAttenuation:R.sizeAttenuation,logarithmicDepthBuffer:f,skinning:!0===Ee.isSkinnedMesh,morphTargets:void 0!==ee.morphAttributes.position,morphNormals:void 0!==ee.morphAttributes.normal,morphColors:void 0!==ee.morphAttributes.color,morphTargetsCount:ke,morphTextureStride:ut,numDirLights:B.directional.length,numPointLights:B.point.length,numSpotLights:B.spot.length,numSpotLightMaps:B.spotLightMap.length,numRectAreaLights:B.rectArea.length,numHemiLights:B.hemi.length,numDirLightShadows:B.directionalShadowMap.length,numPointLightShadows:B.pointShadowMap.length,numSpotLightShadows:B.spotShadowMap.length,numSpotLightShadowsWithMaps:B.numSpotLightShadowsWithMaps,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:R.dithering,shadowMapEnabled:i.shadowMap.enabled&&X.length>0,shadowMapType:i.shadowMap.type,toneMapping:R.toneMapped?i.toneMapping:pr,useLegacyLights:i.useLegacyLights,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===wr,flipSided:R.side===_n,useDepthPacking:!!R.depthPacking,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionDerivatives:R.extensions&&R.extensions.derivatives,extensionFragDepth:R.extensions&&R.extensions.fragDepth,extensionDrawBuffers:R.extensions&&R.extensions.drawBuffers,extensionShaderTextureLOD:R.extensions&&R.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||n.has("EXT_shader_texture_lod"),customProgramCacheKey:R.customProgramCacheKey()}},getProgramCacheKey:function w(R){const B=[];if(R.shaderID?B.push(R.shaderID):(B.push(R.customVertexShaderID),B.push(R.customFragmentShaderID)),void 0!==R.defines)for(const X in R.defines)B.push(X),B.push(R.defines[X]);return!1===R.isRawShaderMaterial&&(function S(R,B){R.push(B.precision),R.push(B.outputEncoding),R.push(B.envMapMode),R.push(B.envMapCubeUVHeight),R.push(B.combine),R.push(B.vertexUvs),R.push(B.fogExp2),R.push(B.sizeAttenuation),R.push(B.morphTargetsCount),R.push(B.morphAttributeCount),R.push(B.numDirLights),R.push(B.numPointLights),R.push(B.numSpotLights),R.push(B.numSpotLightMaps),R.push(B.numHemiLights),R.push(B.numRectAreaLights),R.push(B.numDirLightShadows),R.push(B.numPointLightShadows),R.push(B.numSpotLightShadows),R.push(B.numSpotLightShadowsWithMaps),R.push(B.shadowMapType),R.push(B.toneMapping),R.push(B.numClippingPlanes),R.push(B.numClipIntersection),R.push(B.depthPacking)}(B,R),function D(R,B){c.disableAll(),B.isWebGL2&&c.enable(0),B.supportsVertexTextures&&c.enable(1),B.instancing&&c.enable(2),B.instancingColor&&c.enable(3),B.map&&c.enable(4),B.matcap&&c.enable(5),B.envMap&&c.enable(6),B.lightMap&&c.enable(7),B.aoMap&&c.enable(8),B.emissiveMap&&c.enable(9),B.bumpMap&&c.enable(10),B.normalMap&&c.enable(11),B.objectSpaceNormalMap&&c.enable(12),B.tangentSpaceNormalMap&&c.enable(13),B.clearcoat&&c.enable(14),B.clearcoatMap&&c.enable(15),B.clearcoatRoughnessMap&&c.enable(16),B.clearcoatNormalMap&&c.enable(17),B.iridescence&&c.enable(18),B.iridescenceMap&&c.enable(19),B.iridescenceThicknessMap&&c.enable(20),B.displacementMap&&c.enable(21),B.specularMap&&c.enable(22),B.roughnessMap&&c.enable(23),B.metalnessMap&&c.enable(24),B.gradientMap&&c.enable(25),B.alphaMap&&c.enable(26),B.alphaTest&&c.enable(27),B.vertexColors&&c.enable(28),B.vertexAlphas&&c.enable(29),B.vertexUvs&&c.enable(30),B.vertexTangents&&c.enable(31),B.uvsVertexOnly&&c.enable(32),R.push(c.mask),c.disableAll(),B.fog&&c.enable(0),B.useFog&&c.enable(1),B.flatShading&&c.enable(2),B.logarithmicDepthBuffer&&c.enable(3),B.skinning&&c.enable(4),B.morphTargets&&c.enable(5),B.morphNormals&&c.enable(6),B.morphColors&&c.enable(7),B.premultipliedAlpha&&c.enable(8),B.shadowMapEnabled&&c.enable(9),B.useLegacyLights&&c.enable(10),B.doubleSided&&c.enable(11),B.flipSided&&c.enable(12),B.useDepthPacking&&c.enable(13),B.dithering&&c.enable(14),B.specularIntensityMap&&c.enable(15),B.specularColorMap&&c.enable(16),B.transmission&&c.enable(17),B.transmissionMap&&c.enable(18),B.thicknessMap&&c.enable(19),B.sheen&&c.enable(20),B.sheenColorMap&&c.enable(21),B.sheenRoughnessMap&&c.enable(22),B.decodeVideoTexture&&c.enable(23),B.opaque&&c.enable(24),R.push(c.mask)}(B,R),B.push(i.outputEncoding)),B.push(R.customProgramCacheKey),B.join()},getUniforms:function T(R){const B=x[R.type];let X;return X=B?Q_.clone(xs[B].uniforms):R.uniforms,X},acquireProgram:function P(R,B){let X;for(let le=0,Ee=d.length;le<Ee;le++){const te=d[le];if(te.cacheKey===B){X=te,++X.usedTimes;break}}return void 0===X&&(X=new gw(i,B,R,o),d.push(X)),X},releaseProgram:function k(R){if(0==--R.usedTimes){const B=d.indexOf(R);d[B]=d[d.length-1],d.pop(),R.destroy()}},releaseShaderCache:function H(R){u.remove(R)},programs:d,dispose:function W(){u.dispose()}}}function I0(){let i=new WeakMap;return{get:function e(o){let l=i.get(o);return void 0===l&&(l={},i.set(o,l)),l},remove:function t(o){i.delete(o)},update:function n(o,l,c){i.get(o)[l]=c},dispose:function r(){i=new WeakMap}}}function Lu(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function P0(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function R0(){const i=[];let e=0;const t=[],n=[],r=[];function l(f,p,y,x,_,w){let S=i[e];return void 0===S?(S={id:f.id,object:f,geometry:p,material:y,groupOrder:x,renderOrder:f.renderOrder,z:_,group:w},i[e]=S):(S.id=f.id,S.object=f,S.geometry=p,S.material=y,S.groupOrder=x,S.renderOrder=f.renderOrder,S.z=_,S.group=w),e++,S}return{opaque:t,transmissive:n,transparent:r,init:function o(){e=0,t.length=0,n.length=0,r.length=0},push:function c(f,p,y,x,_,w){const S=l(f,p,y,x,_,w);y.transmission>0?n.push(S):!0===y.transparent?r.push(S):t.push(S)},unshift:function u(f,p,y,x,_,w){const S=l(f,p,y,x,_,w);y.transmission>0?n.unshift(S):!0===y.transparent?r.unshift(S):t.unshift(S)},finish:function h(){for(let f=e,p=i.length;f<p;f++){const y=i[f];if(null===y.id)break;y.id=null,y.object=null,y.geometry=null,y.material=null,y.group=null}},sort:function d(f,p){t.length>1&&t.sort(f||Lu),n.length>1&&n.sort(p||P0),r.length>1&&r.sort(p||P0)}}}function L0(){let i=new WeakMap;return{get:function e(n,r){const o=i.get(n);let l;return void 0===o?(l=new R0,i.set(n,[l])):r>=o.length?(l=new R0,o.push(l)):l=o[r],l},dispose:function t(){i=new WeakMap}}}function _w(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new V,color:new xt};break;case"SpotLight":t={position:new V,direction:new V,color:new xt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new V,color:new xt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new V,skyColor:new xt,groundColor:new xt};break;case"RectAreaLight":t={color:new xt,position:new V,halfWidth:new V,halfHeight:new V}}return i[e.id]=t,t}}}let KM=0;function N0(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function F0(i,e){const t=new _w,n=function O0(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe,shadowCameraNear:1,shadowCameraFar:1e3}}return i[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new V);const o=new V,l=new an,c=new an;return{setup:function u(h,f){let p=0,y=0,x=0;for(let le=0;le<9;le++)r.probe[le].set(0,0,0);let _=0,w=0,S=0,D=0,T=0,P=0,k=0,H=0,W=0,R=0;h.sort(N0);const B=!0===f?Math.PI:1;for(let le=0,Ee=h.length;le<Ee;le++){const te=h[le],ee=te.color,ge=te.intensity,re=te.distance,ve=te.shadow&&te.shadow.map?te.shadow.map.texture:null;if(te.isAmbientLight)p+=ee.r*ge*B,y+=ee.g*ge*B,x+=ee.b*ge*B;else if(te.isLightProbe)for(let se=0;se<9;se++)r.probe[se].addScaledVector(te.sh.coefficients[se],ge);else if(te.isDirectionalLight){const se=t.get(te);if(se.color.copy(te.color).multiplyScalar(te.intensity*B),te.castShadow){const Me=te.shadow,ke=n.get(te);ke.shadowBias=Me.bias,ke.shadowNormalBias=Me.normalBias,ke.shadowRadius=Me.radius,ke.shadowMapSize=Me.mapSize,r.directionalShadow[_]=ke,r.directionalShadowMap[_]=ve,r.directionalShadowMatrix[_]=te.shadow.matrix,P++}r.directional[_]=se,_++}else if(te.isSpotLight){const se=t.get(te);se.position.setFromMatrixPosition(te.matrixWorld),se.color.copy(ee).multiplyScalar(ge*B),se.distance=re,se.coneCos=Math.cos(te.angle),se.penumbraCos=Math.cos(te.angle*(1-te.penumbra)),se.decay=te.decay,r.spot[S]=se;const Me=te.shadow;if(te.map&&(r.spotLightMap[W]=te.map,W++,Me.updateMatrices(te),te.castShadow&&R++),r.spotLightMatrix[S]=Me.matrix,te.castShadow){const ke=n.get(te);ke.shadowBias=Me.bias,ke.shadowNormalBias=Me.normalBias,ke.shadowRadius=Me.radius,ke.shadowMapSize=Me.mapSize,r.spotShadow[S]=ke,r.spotShadowMap[S]=ve,H++}S++}else if(te.isRectAreaLight){const se=t.get(te);se.color.copy(ee).multiplyScalar(ge),se.halfWidth.set(.5*te.width,0,0),se.halfHeight.set(0,.5*te.height,0),r.rectArea[D]=se,D++}else if(te.isPointLight){const se=t.get(te);if(se.color.copy(te.color).multiplyScalar(te.intensity*B),se.distance=te.distance,se.decay=te.decay,te.castShadow){const Me=te.shadow,ke=n.get(te);ke.shadowBias=Me.bias,ke.shadowNormalBias=Me.normalBias,ke.shadowRadius=Me.radius,ke.shadowMapSize=Me.mapSize,ke.shadowCameraNear=Me.camera.near,ke.shadowCameraFar=Me.camera.far,r.pointShadow[w]=ke,r.pointShadowMap[w]=ve,r.pointShadowMatrix[w]=te.shadow.matrix,k++}r.point[w]=se,w++}else if(te.isHemisphereLight){const se=t.get(te);se.skyColor.copy(te.color).multiplyScalar(ge*B),se.groundColor.copy(te.groundColor).multiplyScalar(ge*B),r.hemi[T]=se,T++}}D>0&&(e.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=dt.LTC_FLOAT_1,r.rectAreaLTC2=dt.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=dt.LTC_HALF_1,r.rectAreaLTC2=dt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=y,r.ambient[2]=x;const X=r.hash;(X.directionalLength!==_||X.pointLength!==w||X.spotLength!==S||X.rectAreaLength!==D||X.hemiLength!==T||X.numDirectionalShadows!==P||X.numPointShadows!==k||X.numSpotShadows!==H||X.numSpotMaps!==W)&&(r.directional.length=_,r.spot.length=S,r.rectArea.length=D,r.point.length=w,r.hemi.length=T,r.directionalShadow.length=P,r.directionalShadowMap.length=P,r.pointShadow.length=k,r.pointShadowMap.length=k,r.spotShadow.length=H,r.spotShadowMap.length=H,r.directionalShadowMatrix.length=P,r.pointShadowMatrix.length=k,r.spotLightMatrix.length=H+W-R,r.spotLightMap.length=W,r.numSpotLightShadowsWithMaps=R,X.directionalLength=_,X.pointLength=w,X.spotLength=S,X.rectAreaLength=D,X.hemiLength=T,X.numDirectionalShadows=P,X.numPointShadows=k,X.numSpotShadows=H,X.numSpotMaps=W,r.version=KM++)},setupView:function d(h,f){let p=0,y=0,x=0,_=0,w=0;const S=f.matrixWorldInverse;for(let D=0,T=h.length;D<T;D++){const P=h[D];if(P.isDirectionalLight){const k=r.directional[p];k.direction.setFromMatrixPosition(P.matrixWorld),o.setFromMatrixPosition(P.target.matrixWorld),k.direction.sub(o),k.direction.transformDirection(S),p++}else if(P.isSpotLight){const k=r.spot[x];k.position.setFromMatrixPosition(P.matrixWorld),k.position.applyMatrix4(S),k.direction.setFromMatrixPosition(P.matrixWorld),o.setFromMatrixPosition(P.target.matrixWorld),k.direction.sub(o),k.direction.transformDirection(S),x++}else if(P.isRectAreaLight){const k=r.rectArea[_];k.position.setFromMatrixPosition(P.matrixWorld),k.position.applyMatrix4(S),c.identity(),l.copy(P.matrixWorld),l.premultiply(S),c.extractRotation(l),k.halfWidth.set(.5*P.width,0,0),k.halfHeight.set(0,.5*P.height,0),k.halfWidth.applyMatrix4(c),k.halfHeight.applyMatrix4(c),_++}else if(P.isPointLight){const k=r.point[y];k.position.setFromMatrixPosition(P.matrixWorld),k.position.applyMatrix4(S),y++}else if(P.isHemisphereLight){const k=r.hemi[w];k.direction.setFromMatrixPosition(P.matrixWorld),k.direction.transformDirection(S),w++}}},state:r}}function co(i,e){const t=new F0(i,e),n=[],r=[];return{init:function o(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:function u(f){t.setup(n,f)},setupLightsView:function d(f){t.setupView(n,f)},pushLight:function l(f){n.push(f)},pushShadow:function c(f){r.push(f)}}}function xw(i,e){let t=new WeakMap;return{get:function n(o,l=0){const c=t.get(o);let u;return void 0===c?(u=new co(i,e),t.set(o,[u])):l>=c.length?(u=new co(i,e),c.push(u)):u=c[l],u},dispose:function r(){t=new WeakMap}}}class hm extends Gn{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class uo extends Gn{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new V,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const ho="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fo="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function k0(i,e,t){let n=new Bp;const r=new Oe,o=new Oe,l=new ei,c=new hm({depthPacking:Eg}),u=new uo,d={},h=t.maxTextureSize,f={[Qi]:_n,[_n]:Qi,[wr]:wr},p=new vs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Oe},radius:{value:4}},vertexShader:ho,fragmentShader:fo}),y=p.clone();y.defines.HORIZONTAL_PASS=1;const x=new cn;x.setAttribute("position",new Oi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new er(x,p),w=this;function S(P,k){const H=e.update(_);p.defines.VSM_SAMPLES!==P.blurSamples&&(p.defines.VSM_SAMPLES=P.blurSamples,y.defines.VSM_SAMPLES=P.blurSamples,p.needsUpdate=!0,y.needsUpdate=!0),null===P.mapPass&&(P.mapPass=new Wo(r.x,r.y)),p.uniforms.shadow_pass.value=P.map.texture,p.uniforms.resolution.value=P.mapSize,p.uniforms.radius.value=P.radius,i.setRenderTarget(P.mapPass),i.clear(),i.renderBufferDirect(k,null,H,p,_,null),y.uniforms.shadow_pass.value=P.mapPass.texture,y.uniforms.resolution.value=P.mapSize,y.uniforms.radius.value=P.radius,i.setRenderTarget(P.map),i.clear(),i.renderBufferDirect(k,null,H,y,_,null)}function D(P,k,H,W,R,B){let X=null;const le=!0===H.isPointLight?P.customDistanceMaterial:P.customDepthMaterial;if(void 0!==le)X=le;else if(X=!0===H.isPointLight?u:c,i.localClippingEnabled&&!0===k.clipShadows&&Array.isArray(k.clippingPlanes)&&0!==k.clippingPlanes.length||k.displacementMap&&0!==k.displacementScale||k.alphaMap&&k.alphaTest>0||k.map&&k.alphaTest>0){const Ee=X.uuid,te=k.uuid;let ee=d[Ee];void 0===ee&&(ee={},d[Ee]=ee);let ge=ee[te];void 0===ge&&(ge=X.clone(),ee[te]=ge),X=ge}return X.visible=k.visible,X.wireframe=k.wireframe,X.side=B===ui?null!==k.shadowSide?k.shadowSide:k.side:null!==k.shadowSide?k.shadowSide:f[k.side],X.alphaMap=k.alphaMap,X.alphaTest=k.alphaTest,X.map=k.map,X.clipShadows=k.clipShadows,X.clippingPlanes=k.clippingPlanes,X.clipIntersection=k.clipIntersection,X.displacementMap=k.displacementMap,X.displacementScale=k.displacementScale,X.displacementBias=k.displacementBias,X.wireframeLinewidth=k.wireframeLinewidth,X.linewidth=k.linewidth,!0===H.isPointLight&&!0===X.isMeshDistanceMaterial&&(X.referencePosition.setFromMatrixPosition(H.matrixWorld),X.nearDistance=W,X.farDistance=R),X}function T(P,k,H,W,R){if(!1===P.visible)return;if(P.layers.test(k.layers)&&(P.isMesh||P.isLine||P.isPoints)&&(P.castShadow||P.receiveShadow&&R===ui)&&(!P.frustumCulled||n.intersectsObject(P))){P.modelViewMatrix.multiplyMatrices(H.matrixWorldInverse,P.matrixWorld);const le=e.update(P),Ee=P.material;if(Array.isArray(Ee)){const te=le.groups;for(let ee=0,ge=te.length;ee<ge;ee++){const re=te[ee],ve=Ee[re.materialIndex];if(ve&&ve.visible){const se=D(P,ve,W,H.near,H.far,R);i.renderBufferDirect(H,null,le,se,P,re)}}}else if(Ee.visible){const te=D(P,Ee,W,H.near,H.far,R);i.renderBufferDirect(H,null,le,te,P,null)}}const X=P.children;for(let le=0,Ee=X.length;le<Ee;le++)T(X[le],k,H,W,R)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=dd,this.render=function(P,k,H){if(!1===w.enabled||!1===w.autoUpdate&&!1===w.needsUpdate||0===P.length)return;const W=i.getRenderTarget(),R=i.getActiveCubeFace(),B=i.getActiveMipmapLevel(),X=i.state;X.setBlending(hs),X.buffers.color.setClear(1,1,1,1),X.buffers.depth.setTest(!0),X.setScissorTest(!1);for(let le=0,Ee=P.length;le<Ee;le++){const te=P[le],ee=te.shadow;if(void 0===ee){console.warn("THREE.WebGLShadowMap:",te,"has no shadow.");continue}if(!1===ee.autoUpdate&&!1===ee.needsUpdate)continue;r.copy(ee.mapSize);const ge=ee.getFrameExtents();r.multiply(ge),o.copy(ee.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(o.x=Math.floor(h/ge.x),r.x=o.x*ge.x,ee.mapSize.x=o.x),r.y>h&&(o.y=Math.floor(h/ge.y),r.y=o.y*ge.y,ee.mapSize.y=o.y)),null===ee.map&&(ee.map=new Wo(r.x,r.y,this.type!==ui?{minFilter:ti,magFilter:ti}:{}),ee.map.texture.name=te.name+".shadowMap",ee.camera.updateProjectionMatrix()),i.setRenderTarget(ee.map),i.clear();const re=ee.getViewportCount();for(let ve=0;ve<re;ve++){const se=ee.getViewport(ve);l.set(o.x*se.x,o.y*se.y,o.x*se.z,o.y*se.w),X.viewport(l),ee.updateMatrices(te,ve),n=ee.getFrustum(),T(k,H,ee.camera,te,this.type)}!0!==ee.isPointLightShadow&&this.type===ui&&S(ee,H),ee.needsUpdate=!1}w.needsUpdate=!1,i.setRenderTarget(W,R,B)}}function B0(i,e,t){const n=t.isWebGL2,c=new function r(){let ne=!1;const Re=new ei;let tt=null;const At=new ei(0,0,0,0);return{setMask:function(Nt){tt!==Nt&&!ne&&(i.colorMask(Nt,Nt,Nt,Nt),tt=Nt)},setLocked:function(Nt){ne=Nt},setClear:function(Nt,wi,Cr,ws,Sl){!0===Sl&&(Nt*=ws,wi*=ws,Cr*=ws),Re.set(Nt,wi,Cr,ws),!1===At.equals(Re)&&(i.clearColor(Nt,wi,Cr,ws),At.copy(Re))},reset:function(){ne=!1,tt=null,At.set(-1,0,0,0)}}},u=new function o(){let ne=!1,Re=null,tt=null,At=null;return{setTest:function(Nt){Nt?et(2929):ft(2929)},setMask:function(Nt){Re!==Nt&&!ne&&(i.depthMask(Nt),Re=Nt)},setFunc:function(Nt){if(tt!==Nt){switch(Nt){case $a:i.depthFunc(512);break;case Ul:i.depthFunc(519);break;case Mh:i.depthFunc(513);break;case Xc:i.depthFunc(515);break;case Zc:i.depthFunc(514);break;case op:i.depthFunc(518);break;case Kc:i.depthFunc(516);break;case Qc:i.depthFunc(517);break;default:i.depthFunc(515)}tt=Nt}},setLocked:function(Nt){ne=Nt},setClear:function(Nt){At!==Nt&&(i.clearDepth(Nt),At=Nt)},reset:function(){ne=!1,Re=null,tt=null,At=null}}},d=new function l(){let ne=!1,Re=null,tt=null,At=null,Nt=null,wi=null,Cr=null,ws=null,Sl=null;return{setTest:function(nr){ne||(nr?et(2960):ft(2960))},setMask:function(nr){Re!==nr&&!ne&&(i.stencilMask(nr),Re=nr)},setFunc:function(nr,Ko,El){(tt!==nr||At!==Ko||Nt!==El)&&(i.stencilFunc(nr,Ko,El),tt=nr,At=Ko,Nt=El)},setOp:function(nr,Ko,El){(wi!==nr||Cr!==Ko||ws!==El)&&(i.stencilOp(nr,Ko,El),wi=nr,Cr=Ko,ws=El)},setLocked:function(nr){ne=nr},setClear:function(nr){Sl!==nr&&(i.clearStencil(nr),Sl=nr)},reset:function(){ne=!1,Re=null,tt=null,At=null,Nt=null,wi=null,Cr=null,ws=null,Sl=null}}},h=new WeakMap,f=new WeakMap;let p={},y={},x=new WeakMap,_=[],w=null,S=!1,D=null,T=null,P=null,k=null,H=null,W=null,R=null,B=!1,X=null,le=null,Ee=null,te=null,ee=null;const ge=i.getParameter(35661);let re=!1,ve=0;const se=i.getParameter(7938);-1!==se.indexOf("WebGL")?(ve=parseFloat(/^WebGL (\d)/.exec(se)[1]),re=ve>=1):-1!==se.indexOf("OpenGL ES")&&(ve=parseFloat(/^OpenGL ES (\d)/.exec(se)[1]),re=ve>=2);let Me=null,ke={};const ut=i.getParameter(3088),ye=i.getParameter(2978),We=(new ei).fromArray(ut),ze=(new ei).fromArray(ye);function ue(ne,Re,tt){const At=new Uint8Array(4),Nt=i.createTexture();i.bindTexture(ne,Nt),i.texParameteri(ne,10241,9728),i.texParameteri(ne,10240,9728);for(let wi=0;wi<tt;wi++)i.texImage2D(Re+wi,0,6408,1,1,0,6408,5121,At);return Nt}const mt={};function et(ne){!0!==p[ne]&&(i.enable(ne),p[ne]=!0)}function ft(ne){!1!==p[ne]&&(i.disable(ne),p[ne]=!1)}mt[3553]=ue(3553,3553,1),mt[34067]=ue(34067,34069,6),c.setClear(0,0,0,1),u.setClear(1),d.setClear(0),et(2929),u.setFunc(Xc),vt(!1),tn(la),et(2884),ht(hs);const Ve={[fe]:32774,[De]:32778,[St]:32779};if(n)Ve[Cn]=32775,Ve[gn]=32776;else{const ne=e.get("EXT_blend_minmax");null!==ne&&(Ve[Cn]=ne.MIN_EXT,Ve[gn]=ne.MAX_EXT)}const Ze={[Mn]:0,[xn]:1,[Si]:768,[Pi]:770,[da]:776,[Is]:774,[es]:772,[Nn]:769,[fs]:771,[ua]:775,[qs]:773};function ht(ne,Re,tt,At,Nt,wi,Cr,ws){if(ne!==hs){if(!1===S&&(et(3042),S=!0),ne===q)Nt=Nt||Re,wi=wi||tt,Cr=Cr||At,(Re!==T||Nt!==H)&&(i.blendEquationSeparate(Ve[Re],Ve[Nt]),T=Re,H=Nt),(tt!==P||At!==k||wi!==W||Cr!==R)&&(i.blendFuncSeparate(Ze[tt],Ze[At],Ze[wi],Ze[Cr]),P=tt,k=At,W=wi,R=Cr),D=ne,B=!1;else if(ne!==D||ws!==B){if((T!==fe||H!==fe)&&(i.blendEquation(32774),T=fe,H=fe),ws)switch(ne){case M:i.blendFuncSeparate(1,771,1,771);break;case I:i.blendFunc(1,1);break;case E:i.blendFuncSeparate(0,769,0,1);break;case N:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ne)}else switch(ne){case M:i.blendFuncSeparate(770,771,1,771);break;case I:i.blendFunc(770,1);break;case E:i.blendFuncSeparate(0,769,0,1);break;case N:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ne)}P=null,k=null,W=null,R=null,D=ne,B=ws}}else!0===S&&(ft(3042),S=!1)}function vt(ne){X!==ne&&(i.frontFace(ne?2304:2305),X=ne)}function tn(ne){ne!==qc?(et(2884),ne!==le&&i.cullFace(ne===la?1029:ne===ca?1028:1032)):ft(2884),le=ne}function nn(ne,Re,tt){ne?(et(32823),(te!==Re||ee!==tt)&&(i.polygonOffset(Re,tt),te=Re,ee=tt)):ft(32823)}return{buffers:{color:c,depth:u,stencil:d},enable:et,disable:ft,bindFramebuffer:function gt(ne,Re){return y[ne]!==Re&&(i.bindFramebuffer(ne,Re),y[ne]=Re,n&&(36009===ne&&(y[36160]=Re),36160===ne&&(y[36009]=Re)),!0)},drawBuffers:function bt(ne,Re){let tt=_,At=!1;if(ne)if(tt=x.get(Re),void 0===tt&&(tt=[],x.set(Re,tt)),ne.isWebGLMultipleRenderTargets){const Nt=ne.texture;if(tt.length!==Nt.length||36064!==tt[0]){for(let wi=0,Cr=Nt.length;wi<Cr;wi++)tt[wi]=36064+wi;tt.length=Nt.length,At=!0}}else 36064!==tt[0]&&(tt[0]=36064,At=!0);else 1029!==tt[0]&&(tt[0]=1029,At=!0);At&&(t.isWebGL2?i.drawBuffers(tt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(tt))},useProgram:function Bt(ne){return w!==ne&&(i.useProgram(ne),w=ne,!0)},setBlending:ht,setMaterial:function Ot(ne,Re){ne.side===wr?ft(2884):et(2884);let tt=ne.side===_n;Re&&(tt=!tt),vt(tt),ne.blending===M&&!1===ne.transparent?ht(hs):ht(ne.blending,ne.blendEquation,ne.blendSrc,ne.blendDst,ne.blendEquationAlpha,ne.blendSrcAlpha,ne.blendDstAlpha,ne.premultipliedAlpha),u.setFunc(ne.depthFunc),u.setTest(ne.depthTest),u.setMask(ne.depthWrite),c.setMask(ne.colorWrite);const At=ne.stencilWrite;d.setTest(At),At&&(d.setMask(ne.stencilWriteMask),d.setFunc(ne.stencilFunc,ne.stencilRef,ne.stencilFuncMask),d.setOp(ne.stencilFail,ne.stencilZFail,ne.stencilZPass)),nn(ne.polygonOffset,ne.polygonOffsetFactor,ne.polygonOffsetUnits),!0===ne.alphaToCoverage?et(32926):ft(32926)},setFlipSided:vt,setCullFace:tn,setLineWidth:function Yt(ne){ne!==Ee&&(re&&i.lineWidth(ne),Ee=ne)},setPolygonOffset:nn,setScissorTest:function ii(ne){ne?et(3089):ft(3089)},activeTexture:function jn(ne){void 0===ne&&(ne=33984+ge-1),Me!==ne&&(i.activeTexture(ne),Me=ne)},bindTexture:function $(ne,Re,tt){void 0===tt&&(tt=null===Me?33984+ge-1:Me);let At=ke[tt];void 0===At&&(At={type:void 0,texture:void 0},ke[tt]=At),(At.type!==ne||At.texture!==Re)&&(Me!==tt&&(i.activeTexture(tt),Me=tt),i.bindTexture(ne,Re||mt[ne]),At.type=ne,At.texture=Re)},unbindTexture:function z(){const ne=ke[Me];void 0!==ne&&void 0!==ne.type&&(i.bindTexture(ne.type,null),ne.type=void 0,ne.texture=void 0)},compressedTexImage2D:function Ce(){try{i.compressedTexImage2D.apply(i,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}},compressedTexImage3D:function rt(){try{i.compressedTexImage3D.apply(i,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}},texImage2D:function _t(){try{i.texImage2D.apply(i,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}},texImage3D:function Ut(){try{i.texImage3D.apply(i,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}},updateUBOMapping:function Ln(ne,Re){let tt=f.get(Re);void 0===tt&&(tt=new WeakMap,f.set(Re,tt));let At=tt.get(ne);void 0===At&&(At=i.getUniformBlockIndex(Re,ne.name),tt.set(ne,At))},uniformBlockBinding:function $n(ne,Re){const At=f.get(Re).get(ne);h.get(Re)!==At&&(i.uniformBlockBinding(Re,At,ne.__bindingPointIndex),h.set(Re,At))},texStorage2D:function de(){try{i.texStorage2D.apply(i,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}},texStorage3D:function Et(){try{i.texStorage3D.apply(i,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}},texSubImage2D:function st(){try{i.texSubImage2D.apply(i,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}},texSubImage3D:function Mt(){try{i.texSubImage3D.apply(i,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}},compressedTexSubImage2D:function zt(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}},compressedTexSubImage3D:function Z(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}},scissor:function Gt(ne){!1===We.equals(ne)&&(i.scissor(ne.x,ne.y,ne.z,ne.w),We.copy(ne))},viewport:function Ht(ne){!1===ze.equals(ne)&&(i.viewport(ne.x,ne.y,ne.z,ne.w),ze.copy(ne))},reset:function si(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),!0===n&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),p={},Me=null,ke={},y={},x=new WeakMap,_=[],w=null,S=!1,D=null,T=null,P=null,k=null,H=null,W=null,R=null,B=!1,X=null,le=null,Ee=null,te=null,ee=null,We.set(0,0,i.canvas.width,i.canvas.height),ze.set(0,0,i.canvas.width,i.canvas.height),c.reset(),u.reset(),d.reset()}}}function ww(i,e,t,n,r,o,l){const c=r.isWebGL2,u=r.maxTextures,d=r.maxCubemapSize,h=r.maxTextureSize,f=r.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,y=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),x=new WeakMap;let _;const w=new WeakMap;let S=!1;try{S=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function D($,z){return S?new OffscreenCanvas($,z):xd("canvas")}function T($,z,Ce,rt){let st=1;if(($.width>rt||$.height>rt)&&(st=rt/Math.max($.width,$.height)),st<1||!0===z){if(typeof HTMLImageElement<"u"&&$ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&$ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&$ instanceof ImageBitmap){const Mt=z?Fh:Math.floor,zt=Mt(st*$.width),Z=Mt(st*$.height);void 0===_&&(_=D(zt,Z));const de=Ce?D(zt,Z):_;return de.width=zt,de.height=Z,de.getContext("2d").drawImage($,0,0,zt,Z),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+$.width+"x"+$.height+") to ("+zt+"x"+Z+")."),de}return"data"in $&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+$.width+"x"+$.height+")."),$}return $}function P($){return wp($.width)&&wp($.height)}function H($,z){return $.generateMipmaps&&z&&$.minFilter!==ti&&$.minFilter!==Qn}function W($){i.generateMipmap($)}function R($,z,Ce,rt,st=!1){if(!1===c)return z;if(null!==$){if(void 0!==i[$])return i[$];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+$+"'")}let Mt=z;return 6403===z&&(5126===Ce&&(Mt=33326),5131===Ce&&(Mt=33325),5121===Ce&&(Mt=33321)),33319===z&&(5126===Ce&&(Mt=33328),5131===Ce&&(Mt=33327),5121===Ce&&(Mt=33323)),6408===z&&(5126===Ce&&(Mt=34836),5131===Ce&&(Mt=34842),5121===Ce&&(Mt=rt===Xn&&!1===st?35907:32856),32819===Ce&&(Mt=32854),32820===Ce&&(Mt=32855)),(33325===Mt||33326===Mt||33327===Mt||33328===Mt||34842===Mt||34836===Mt)&&e.get("EXT_color_buffer_float"),Mt}function B($,z,Ce){return!0===H($,Ce)||$.isFramebufferTexture&&$.minFilter!==ti&&$.minFilter!==Qn?Math.log2(Math.max(z.width,z.height))+1:void 0!==$.mipmaps&&$.mipmaps.length>0?$.mipmaps.length:$.isCompressedTexture&&Array.isArray($.image)?z.mipmaps.length:1}function X($){return $===ti||$===ts||$===Xa?9728:9729}function le($){const z=$.target;z.removeEventListener("dispose",le),function te($){const z=n.get($);if(void 0===z.__webglInit)return;const Ce=$.source,rt=w.get(Ce);if(rt){const st=rt[z.__cacheKey];st.usedTimes--,0===st.usedTimes&&ee($),0===Object.keys(rt).length&&w.delete(Ce)}n.remove($)}(z),z.isVideoTexture&&x.delete(z)}function Ee($){const z=$.target;z.removeEventListener("dispose",Ee),function ge($){const z=$.texture,Ce=n.get($),rt=n.get(z);if(void 0!==rt.__webglTexture&&(i.deleteTexture(rt.__webglTexture),l.memory.textures--),$.depthTexture&&$.depthTexture.dispose(),$.isWebGLCubeRenderTarget)for(let st=0;st<6;st++)i.deleteFramebuffer(Ce.__webglFramebuffer[st]),Ce.__webglDepthbuffer&&i.deleteRenderbuffer(Ce.__webglDepthbuffer[st]);else{if(i.deleteFramebuffer(Ce.__webglFramebuffer),Ce.__webglDepthbuffer&&i.deleteRenderbuffer(Ce.__webglDepthbuffer),Ce.__webglMultisampledFramebuffer&&i.deleteFramebuffer(Ce.__webglMultisampledFramebuffer),Ce.__webglColorRenderbuffer)for(let st=0;st<Ce.__webglColorRenderbuffer.length;st++)Ce.__webglColorRenderbuffer[st]&&i.deleteRenderbuffer(Ce.__webglColorRenderbuffer[st]);Ce.__webglDepthRenderbuffer&&i.deleteRenderbuffer(Ce.__webglDepthRenderbuffer)}if($.isWebGLMultipleRenderTargets)for(let st=0,Mt=z.length;st<Mt;st++){const zt=n.get(z[st]);zt.__webglTexture&&(i.deleteTexture(zt.__webglTexture),l.memory.textures--),n.remove(z[st])}n.remove(z),n.remove($)}(z)}function ee($){const z=n.get($);i.deleteTexture(z.__webglTexture),delete w.get($.source)[z.__cacheKey],l.memory.textures--}let re=0;function ke($,z){const Ce=n.get($);if($.isVideoTexture&&function ii($){const z=l.render.frame;x.get($)!==z&&(x.set($,z),$.update())}($),!1===$.isRenderTargetTexture&&$.version>0&&Ce.__version!==$.version){const rt=$.image;if(null===rt)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==rt.complete)return void ft(Ce,$,z);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(3553,Ce.__webglTexture,33984+z)}const ze={[Ho]:10497,[Ei]:33071,[Vl]:33648},ue={[ti]:9728,[ts]:9984,[Xa]:9986,[Qn]:9729,[or]:9985,[br]:9987};function mt($,z,Ce){if(Ce?(i.texParameteri($,10242,ze[z.wrapS]),i.texParameteri($,10243,ze[z.wrapT]),(32879===$||35866===$)&&i.texParameteri($,32882,ze[z.wrapR]),i.texParameteri($,10240,ue[z.magFilter]),i.texParameteri($,10241,ue[z.minFilter])):(i.texParameteri($,10242,33071),i.texParameteri($,10243,33071),(32879===$||35866===$)&&i.texParameteri($,32882,33071),(z.wrapS!==Ei||z.wrapT!==Ei)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri($,10240,X(z.magFilter)),i.texParameteri($,10241,X(z.minFilter)),z.minFilter!==ti&&z.minFilter!==Qn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const rt=e.get("EXT_texture_filter_anisotropic");if(z.magFilter===ti||z.minFilter!==Xa&&z.minFilter!==br||z.type===ps&&!1===e.has("OES_texture_float_linear")||!1===c&&z.type===hi&&!1===e.has("OES_texture_half_float_linear"))return;(z.anisotropy>1||n.get(z).__currentAnisotropy)&&(i.texParameterf($,rt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(z.anisotropy,r.getMaxAnisotropy())),n.get(z).__currentAnisotropy=z.anisotropy)}}function et($,z){let Ce=!1;void 0===$.__webglInit&&($.__webglInit=!0,z.addEventListener("dispose",le));const rt=z.source;let st=w.get(rt);void 0===st&&(st={},w.set(rt,st));const Mt=function Me($){const z=[];return z.push($.wrapS),z.push($.wrapT),z.push($.wrapR||0),z.push($.magFilter),z.push($.minFilter),z.push($.anisotropy),z.push($.internalFormat),z.push($.format),z.push($.type),z.push($.generateMipmaps),z.push($.premultiplyAlpha),z.push($.flipY),z.push($.unpackAlignment),z.push($.encoding),z.join()}(z);if(Mt!==$.__cacheKey){void 0===st[Mt]&&(st[Mt]={texture:i.createTexture(),usedTimes:0},l.memory.textures++,Ce=!0),st[Mt].usedTimes++;const zt=st[$.__cacheKey];void 0!==zt&&(st[$.__cacheKey].usedTimes--,0===zt.usedTimes&&ee(z)),$.__cacheKey=Mt,$.__webglTexture=st[Mt].texture}return Ce}function ft($,z,Ce){let rt=3553;(z.isDataArrayTexture||z.isCompressedArrayTexture)&&(rt=35866),z.isData3DTexture&&(rt=32879);const st=et($,z),Mt=z.source;t.bindTexture(rt,$.__webglTexture,33984+Ce);const zt=n.get(Mt);if(Mt.version!==zt.__version||!0===st){t.activeTexture(33984+Ce),i.pixelStorei(37440,z.flipY),i.pixelStorei(37441,z.premultiplyAlpha),i.pixelStorei(3317,z.unpackAlignment),i.pixelStorei(37443,0);const Z=function k($){return!c&&($.wrapS!==Ei||$.wrapT!==Ei||$.minFilter!==ti&&$.minFilter!==Qn)}(z)&&!1===P(z.image);let de=T(z.image,Z,!1,h);de=jn(z,de);const Et=P(de)||c,_t=o.convert(z.format,z.encoding);let Ht,Ut=o.convert(z.type),Gt=R(z.internalFormat,_t,Ut,z.encoding,z.isVideoTexture);mt(rt,z,Et);const Ln=z.mipmaps,$n=c&&!0!==z.isVideoTexture,si=void 0===zt.__version||!0===st,ne=B(z,de,Et);if(z.isDepthTexture)Gt=6402,c?Gt=z.type===ps?36012:z.type===Ls?33190:z.type===Fn?35056:33189:z.type===ps&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),z.format===Wl&&6402===Gt&&z.type!==Za&&z.type!==Ls&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),z.type=Ls,Ut=o.convert(z.type)),z.format===tu&&6402===Gt&&(Gt=34041,z.type!==Fn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),z.type=Fn,Ut=o.convert(z.type))),si&&($n?t.texStorage2D(3553,1,Gt,de.width,de.height):t.texImage2D(3553,0,Gt,de.width,de.height,0,_t,Ut,null));else if(z.isDataTexture)if(Ln.length>0&&Et){$n&&si&&t.texStorage2D(3553,ne,Gt,Ln[0].width,Ln[0].height);for(let Re=0,tt=Ln.length;Re<tt;Re++)Ht=Ln[Re],$n?t.texSubImage2D(3553,Re,0,0,Ht.width,Ht.height,_t,Ut,Ht.data):t.texImage2D(3553,Re,Gt,Ht.width,Ht.height,0,_t,Ut,Ht.data);z.generateMipmaps=!1}else $n?(si&&t.texStorage2D(3553,ne,Gt,de.width,de.height),t.texSubImage2D(3553,0,0,0,de.width,de.height,_t,Ut,de.data)):t.texImage2D(3553,0,Gt,de.width,de.height,0,_t,Ut,de.data);else if(z.isCompressedTexture)if(z.isCompressedArrayTexture){$n&&si&&t.texStorage3D(35866,ne,Gt,Ln[0].width,Ln[0].height,de.depth);for(let Re=0,tt=Ln.length;Re<tt;Re++)Ht=Ln[Re],z.format!==Gi?null!==_t?$n?t.compressedTexSubImage3D(35866,Re,0,0,0,Ht.width,Ht.height,de.depth,_t,Ht.data,0,0):t.compressedTexImage3D(35866,Re,Gt,Ht.width,Ht.height,de.depth,0,Ht.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$n?t.texSubImage3D(35866,Re,0,0,0,Ht.width,Ht.height,de.depth,_t,Ut,Ht.data):t.texImage3D(35866,Re,Gt,Ht.width,Ht.height,de.depth,0,_t,Ut,Ht.data)}else{$n&&si&&t.texStorage2D(3553,ne,Gt,Ln[0].width,Ln[0].height);for(let Re=0,tt=Ln.length;Re<tt;Re++)Ht=Ln[Re],z.format!==Gi?null!==_t?$n?t.compressedTexSubImage2D(3553,Re,0,0,Ht.width,Ht.height,_t,Ht.data):t.compressedTexImage2D(3553,Re,Gt,Ht.width,Ht.height,0,Ht.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$n?t.texSubImage2D(3553,Re,0,0,Ht.width,Ht.height,_t,Ut,Ht.data):t.texImage2D(3553,Re,Gt,Ht.width,Ht.height,0,_t,Ut,Ht.data)}else if(z.isDataArrayTexture)$n?(si&&t.texStorage3D(35866,ne,Gt,de.width,de.height,de.depth),t.texSubImage3D(35866,0,0,0,0,de.width,de.height,de.depth,_t,Ut,de.data)):t.texImage3D(35866,0,Gt,de.width,de.height,de.depth,0,_t,Ut,de.data);else if(z.isData3DTexture)$n?(si&&t.texStorage3D(32879,ne,Gt,de.width,de.height,de.depth),t.texSubImage3D(32879,0,0,0,0,de.width,de.height,de.depth,_t,Ut,de.data)):t.texImage3D(32879,0,Gt,de.width,de.height,de.depth,0,_t,Ut,de.data);else if(z.isFramebufferTexture){if(si)if($n)t.texStorage2D(3553,ne,Gt,de.width,de.height);else{let Re=de.width,tt=de.height;for(let At=0;At<ne;At++)t.texImage2D(3553,At,Gt,Re,tt,0,_t,Ut,null),Re>>=1,tt>>=1}}else if(Ln.length>0&&Et){$n&&si&&t.texStorage2D(3553,ne,Gt,Ln[0].width,Ln[0].height);for(let Re=0,tt=Ln.length;Re<tt;Re++)Ht=Ln[Re],$n?t.texSubImage2D(3553,Re,0,0,_t,Ut,Ht):t.texImage2D(3553,Re,Gt,_t,Ut,Ht);z.generateMipmaps=!1}else $n?(si&&t.texStorage2D(3553,ne,Gt,de.width,de.height),t.texSubImage2D(3553,0,0,0,_t,Ut,de)):t.texImage2D(3553,0,Gt,_t,Ut,de);H(z,Et)&&W(rt),zt.__version=Mt.version,z.onUpdate&&z.onUpdate(z)}$.__version=z.version}function bt($,z,Ce,rt,st){const Mt=o.convert(Ce.format,Ce.encoding),zt=o.convert(Ce.type),Z=R(Ce.internalFormat,Mt,zt,Ce.encoding);n.get(z).__hasExternalTextures||(32879===st||35866===st?t.texImage3D(st,0,Z,z.width,z.height,z.depth,0,Mt,zt,null):t.texImage2D(st,0,Z,z.width,z.height,0,Mt,zt,null)),t.bindFramebuffer(36160,$),nn(z)?p.framebufferTexture2DMultisampleEXT(36160,rt,st,n.get(Ce).__webglTexture,0,Yt(z)):(3553===st||st>=34069&&st<=34074)&&i.framebufferTexture2D(36160,rt,st,n.get(Ce).__webglTexture,0),t.bindFramebuffer(36160,null)}function Bt($,z,Ce){if(i.bindRenderbuffer(36161,$),z.depthBuffer&&!z.stencilBuffer){let rt=33189;if(Ce||nn(z)){const st=z.depthTexture;st&&st.isDepthTexture&&(st.type===ps?rt=36012:st.type===Ls&&(rt=33190));const Mt=Yt(z);nn(z)?p.renderbufferStorageMultisampleEXT(36161,Mt,rt,z.width,z.height):i.renderbufferStorageMultisample(36161,Mt,rt,z.width,z.height)}else i.renderbufferStorage(36161,rt,z.width,z.height);i.framebufferRenderbuffer(36160,36096,36161,$)}else if(z.depthBuffer&&z.stencilBuffer){const rt=Yt(z);Ce&&!1===nn(z)?i.renderbufferStorageMultisample(36161,rt,35056,z.width,z.height):nn(z)?p.renderbufferStorageMultisampleEXT(36161,rt,35056,z.width,z.height):i.renderbufferStorage(36161,34041,z.width,z.height),i.framebufferRenderbuffer(36160,33306,36161,$)}else{const rt=!0===z.isWebGLMultipleRenderTargets?z.texture:[z.texture];for(let st=0;st<rt.length;st++){const Mt=rt[st],zt=o.convert(Mt.format,Mt.encoding),Z=o.convert(Mt.type),de=R(Mt.internalFormat,zt,Z,Mt.encoding),Et=Yt(z);Ce&&!1===nn(z)?i.renderbufferStorageMultisample(36161,Et,de,z.width,z.height):nn(z)?p.renderbufferStorageMultisampleEXT(36161,Et,de,z.width,z.height):i.renderbufferStorage(36161,de,z.width,z.height)}}i.bindRenderbuffer(36161,null)}function Ze($){const z=n.get($),Ce=!0===$.isWebGLCubeRenderTarget;if($.depthTexture&&!z.__autoAllocateDepthBuffer){if(Ce)throw new Error("target.depthTexture not supported in Cube render targets");!function Ve($,z){if(z&&z.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,$),!z.depthTexture||!z.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(z.depthTexture).__webglTexture||z.depthTexture.image.width!==z.width||z.depthTexture.image.height!==z.height)&&(z.depthTexture.image.width=z.width,z.depthTexture.image.height=z.height,z.depthTexture.needsUpdate=!0),ke(z.depthTexture,0);const rt=n.get(z.depthTexture).__webglTexture,st=Yt(z);if(z.depthTexture.format===Wl)nn(z)?p.framebufferTexture2DMultisampleEXT(36160,36096,3553,rt,0,st):i.framebufferTexture2D(36160,36096,3553,rt,0);else{if(z.depthTexture.format!==tu)throw new Error("Unknown depthTexture format");nn(z)?p.framebufferTexture2DMultisampleEXT(36160,33306,3553,rt,0,st):i.framebufferTexture2D(36160,33306,3553,rt,0)}}(z.__webglFramebuffer,$)}else if(Ce){z.__webglDepthbuffer=[];for(let rt=0;rt<6;rt++)t.bindFramebuffer(36160,z.__webglFramebuffer[rt]),z.__webglDepthbuffer[rt]=i.createRenderbuffer(),Bt(z.__webglDepthbuffer[rt],$,!1)}else t.bindFramebuffer(36160,z.__webglFramebuffer),z.__webglDepthbuffer=i.createRenderbuffer(),Bt(z.__webglDepthbuffer,$,!1);t.bindFramebuffer(36160,null)}function Yt($){return Math.min(f,$.samples)}function nn($){const z=n.get($);return c&&$.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==z.__useRenderToTexture}function jn($,z){const Ce=$.encoding,rt=$.format,st=$.type;return!0===$.isCompressedTexture||!0===$.isVideoTexture||$.format===yp||Ce!==ql&&(Ce===Xn?!1===c?!0===e.has("EXT_sRGB")&&rt===Gi?($.format=yp,$.minFilter=Qn,$.generateMipmaps=!1):z=Vg.sRGBToLinear(z):(rt!==Gi||st!==Vo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Ce)),z}this.allocateTextureUnit=function se(){const $=re;return $>=u&&console.warn("THREE.WebGLTextures: Trying to use "+$+" texture units while this GPU supports only "+u),re+=1,$},this.resetTextureUnits=function ve(){re=0},this.setTexture2D=ke,this.setTexture2DArray=function ut($,z){const Ce=n.get($);$.version>0&&Ce.__version!==$.version?ft(Ce,$,z):t.bindTexture(35866,Ce.__webglTexture,33984+z)},this.setTexture3D=function ye($,z){const Ce=n.get($);$.version>0&&Ce.__version!==$.version?ft(Ce,$,z):t.bindTexture(32879,Ce.__webglTexture,33984+z)},this.setTextureCube=function We($,z){const Ce=n.get($);$.version>0&&Ce.__version!==$.version?function gt($,z,Ce){if(6!==z.image.length)return;const rt=et($,z),st=z.source;t.bindTexture(34067,$.__webglTexture,33984+Ce);const Mt=n.get(st);if(st.version!==Mt.__version||!0===rt){t.activeTexture(33984+Ce),i.pixelStorei(37440,z.flipY),i.pixelStorei(37441,z.premultiplyAlpha),i.pixelStorei(3317,z.unpackAlignment),i.pixelStorei(37443,0);const zt=z.isCompressedTexture||z.image[0].isCompressedTexture,Z=z.image[0]&&z.image[0].isDataTexture,de=[];for(let Re=0;Re<6;Re++)de[Re]=zt||Z?Z?z.image[Re].image:z.image[Re]:T(z.image[Re],!1,!0,d),de[Re]=jn(z,de[Re]);const Et=de[0],_t=P(Et)||c,Ut=o.convert(z.format,z.encoding),Gt=o.convert(z.type),Ht=R(z.internalFormat,Ut,Gt,z.encoding),Ln=c&&!0!==z.isVideoTexture,$n=void 0===Mt.__version||!0===rt;let ne,si=B(z,Et,_t);if(mt(34067,z,_t),zt){Ln&&$n&&t.texStorage2D(34067,si,Ht,Et.width,Et.height);for(let Re=0;Re<6;Re++){ne=de[Re].mipmaps;for(let tt=0;tt<ne.length;tt++){const At=ne[tt];z.format!==Gi?null!==Ut?Ln?t.compressedTexSubImage2D(34069+Re,tt,0,0,At.width,At.height,Ut,At.data):t.compressedTexImage2D(34069+Re,tt,Ht,At.width,At.height,0,At.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ln?t.texSubImage2D(34069+Re,tt,0,0,At.width,At.height,Ut,Gt,At.data):t.texImage2D(34069+Re,tt,Ht,At.width,At.height,0,Ut,Gt,At.data)}}}else{ne=z.mipmaps,Ln&&$n&&(ne.length>0&&si++,t.texStorage2D(34067,si,Ht,de[0].width,de[0].height));for(let Re=0;Re<6;Re++)if(Z){Ln?t.texSubImage2D(34069+Re,0,0,0,de[Re].width,de[Re].height,Ut,Gt,de[Re].data):t.texImage2D(34069+Re,0,Ht,de[Re].width,de[Re].height,0,Ut,Gt,de[Re].data);for(let tt=0;tt<ne.length;tt++){const Nt=ne[tt].image[Re].image;Ln?t.texSubImage2D(34069+Re,tt+1,0,0,Nt.width,Nt.height,Ut,Gt,Nt.data):t.texImage2D(34069+Re,tt+1,Ht,Nt.width,Nt.height,0,Ut,Gt,Nt.data)}}else{Ln?t.texSubImage2D(34069+Re,0,0,0,Ut,Gt,de[Re]):t.texImage2D(34069+Re,0,Ht,Ut,Gt,de[Re]);for(let tt=0;tt<ne.length;tt++){const At=ne[tt];Ln?t.texSubImage2D(34069+Re,tt+1,0,0,Ut,Gt,At.image[Re]):t.texImage2D(34069+Re,tt+1,Ht,Ut,Gt,At.image[Re])}}}H(z,_t)&&W(34067),Mt.__version=st.version,z.onUpdate&&z.onUpdate(z)}$.__version=z.version}(Ce,$,z):t.bindTexture(34067,Ce.__webglTexture,33984+z)},this.rebindTextures=function ht($,z,Ce){const rt=n.get($);void 0!==z&&bt(rt.__webglFramebuffer,$,$.texture,36064,3553),void 0!==Ce&&Ze($)},this.setupRenderTarget=function Ot($){const z=$.texture,Ce=n.get($),rt=n.get(z);$.addEventListener("dispose",Ee),!0!==$.isWebGLMultipleRenderTargets&&(void 0===rt.__webglTexture&&(rt.__webglTexture=i.createTexture()),rt.__version=z.version,l.memory.textures++);const st=!0===$.isWebGLCubeRenderTarget,Mt=!0===$.isWebGLMultipleRenderTargets,zt=P($)||c;if(st){Ce.__webglFramebuffer=[];for(let Z=0;Z<6;Z++)Ce.__webglFramebuffer[Z]=i.createFramebuffer()}else{if(Ce.__webglFramebuffer=i.createFramebuffer(),Mt)if(r.drawBuffers){const Z=$.texture;for(let de=0,Et=Z.length;de<Et;de++){const _t=n.get(Z[de]);void 0===_t.__webglTexture&&(_t.__webglTexture=i.createTexture(),l.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(c&&$.samples>0&&!1===nn($)){const Z=Mt?z:[z];Ce.__webglMultisampledFramebuffer=i.createFramebuffer(),Ce.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,Ce.__webglMultisampledFramebuffer);for(let de=0;de<Z.length;de++){const Et=Z[de];Ce.__webglColorRenderbuffer[de]=i.createRenderbuffer(),i.bindRenderbuffer(36161,Ce.__webglColorRenderbuffer[de]);const _t=o.convert(Et.format,Et.encoding),Ut=o.convert(Et.type),Gt=R(Et.internalFormat,_t,Ut,Et.encoding,!0===$.isXRRenderTarget),Ht=Yt($);i.renderbufferStorageMultisample(36161,Ht,Gt,$.width,$.height),i.framebufferRenderbuffer(36160,36064+de,36161,Ce.__webglColorRenderbuffer[de])}i.bindRenderbuffer(36161,null),$.depthBuffer&&(Ce.__webglDepthRenderbuffer=i.createRenderbuffer(),Bt(Ce.__webglDepthRenderbuffer,$,!0)),t.bindFramebuffer(36160,null)}}if(st){t.bindTexture(34067,rt.__webglTexture),mt(34067,z,zt);for(let Z=0;Z<6;Z++)bt(Ce.__webglFramebuffer[Z],$,z,36064,34069+Z);H(z,zt)&&W(34067),t.unbindTexture()}else if(Mt){const Z=$.texture;for(let de=0,Et=Z.length;de<Et;de++){const _t=Z[de],Ut=n.get(_t);t.bindTexture(3553,Ut.__webglTexture),mt(3553,_t,zt),bt(Ce.__webglFramebuffer,$,_t,36064+de,3553),H(_t,zt)&&W(3553)}t.unbindTexture()}else{let Z=3553;($.isWebGL3DRenderTarget||$.isWebGLArrayRenderTarget)&&(c?Z=$.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Z,rt.__webglTexture),mt(Z,z,zt),bt(Ce.__webglFramebuffer,$,z,36064,Z),H(z,zt)&&W(Z),t.unbindTexture()}$.depthBuffer&&Ze($)},this.updateRenderTargetMipmap=function vt($){const z=P($)||c,Ce=!0===$.isWebGLMultipleRenderTargets?$.texture:[$.texture];for(let rt=0,st=Ce.length;rt<st;rt++){const Mt=Ce[rt];if(H(Mt,z)){const zt=$.isWebGLCubeRenderTarget?34067:3553,Z=n.get(Mt).__webglTexture;t.bindTexture(zt,Z),W(zt),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function tn($){if(c&&$.samples>0&&!1===nn($)){const z=$.isWebGLMultipleRenderTargets?$.texture:[$.texture],Ce=$.width,rt=$.height;let st=16384;const Mt=[],zt=$.stencilBuffer?33306:36096,Z=n.get($),de=!0===$.isWebGLMultipleRenderTargets;if(de)for(let Et=0;Et<z.length;Et++)t.bindFramebuffer(36160,Z.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Et,36161,null),t.bindFramebuffer(36160,Z.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Et,3553,null,0);t.bindFramebuffer(36008,Z.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,Z.__webglFramebuffer);for(let Et=0;Et<z.length;Et++){Mt.push(36064+Et),$.depthBuffer&&Mt.push(zt);const _t=void 0!==Z.__ignoreDepthValues&&Z.__ignoreDepthValues;if(!1===_t&&($.depthBuffer&&(st|=256),$.stencilBuffer&&(st|=1024)),de&&i.framebufferRenderbuffer(36008,36064,36161,Z.__webglColorRenderbuffer[Et]),!0===_t&&(i.invalidateFramebuffer(36008,[zt]),i.invalidateFramebuffer(36009,[zt])),de){const Ut=n.get(z[Et]).__webglTexture;i.framebufferTexture2D(36009,36064,3553,Ut,0)}i.blitFramebuffer(0,0,Ce,rt,0,0,Ce,rt,st,9728),y&&i.invalidateFramebuffer(36008,Mt)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),de)for(let Et=0;Et<z.length;Et++){t.bindFramebuffer(36160,Z.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Et,36161,Z.__webglColorRenderbuffer[Et]);const _t=n.get(z[Et]).__webglTexture;t.bindFramebuffer(36160,Z.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Et,3553,_t,0)}t.bindFramebuffer(36009,Z.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Ze,this.setupFrameBufferTexture=bt,this.useMultisampledRTT=nn}function bw(i,e,t){const n=t.isWebGL2;return{convert:function r(o,l=null){let c;if(o===Vo)return 5121;if(o===bg)return 32819;if(o===Qa)return 32820;if(o===eu)return 5120;if(o===Gl)return 5122;if(o===Za)return 5123;if(o===Ka)return 5124;if(o===Ls)return 5125;if(o===ps)return 5126;if(o===hi)return n?5131:(c=e.get("OES_texture_half_float"),null!==c?c.HALF_FLOAT_OES:null);if(o===cp)return 6406;if(o===Gi)return 6408;if(o===Eh)return 6409;if(o===Mg)return 6410;if(o===Wl)return 6402;if(o===tu)return 34041;if(o===yp)return c=e.get("EXT_sRGB"),null!==c?c.SRGB_ALPHA_EXT:null;if(o===up)return 6403;if(o===Ja)return 36244;if(o===Th)return 33319;if(o===Sg)return 33320;if(o===Ri)return 36249;if(o===jl||o===Go||o===pd||o===Fr)if(l===Xn){if(c=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===c)return null;if(o===jl)return c.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(o===Go)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(o===pd)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(o===Fr)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(c=e.get("WEBGL_compressed_texture_s3tc"),null===c)return null;if(o===jl)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===Go)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===pd)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===Fr)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(o===fa||o===Ah||o===Zs||o===$l){if(c=e.get("WEBGL_compressed_texture_pvrtc"),null===c)return null;if(o===fa)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===Ah)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===Zs)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===$l)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(o===Ch)return c=e.get("WEBGL_compressed_texture_etc1"),null!==c?c.COMPRESSED_RGB_ETC1_WEBGL:null;if(o===dp||o===Dh){if(c=e.get("WEBGL_compressed_texture_etc"),null===c)return null;if(o===dp)return l===Xn?c.COMPRESSED_SRGB8_ETC2:c.COMPRESSED_RGB8_ETC2;if(o===Dh)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:c.COMPRESSED_RGBA8_ETC2_EAC}if(o===hp||o===Mr||o===nu||o===pa||o===fp||o===md||o===gd||o===Ih||o===pp||o===g||o===v||o===m||o===b||o===A){if(c=e.get("WEBGL_compressed_texture_astc"),null===c)return null;if(o===hp)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:c.COMPRESSED_RGBA_ASTC_4x4_KHR;if(o===Mr)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:c.COMPRESSED_RGBA_ASTC_5x4_KHR;if(o===nu)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:c.COMPRESSED_RGBA_ASTC_5x5_KHR;if(o===pa)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:c.COMPRESSED_RGBA_ASTC_6x5_KHR;if(o===fp)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:c.COMPRESSED_RGBA_ASTC_6x6_KHR;if(o===md)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:c.COMPRESSED_RGBA_ASTC_8x5_KHR;if(o===gd)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:c.COMPRESSED_RGBA_ASTC_8x6_KHR;if(o===Ih)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:c.COMPRESSED_RGBA_ASTC_8x8_KHR;if(o===pp)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:c.COMPRESSED_RGBA_ASTC_10x5_KHR;if(o===g)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:c.COMPRESSED_RGBA_ASTC_10x6_KHR;if(o===v)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:c.COMPRESSED_RGBA_ASTC_10x8_KHR;if(o===m)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:c.COMPRESSED_RGBA_ASTC_10x10_KHR;if(o===b)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:c.COMPRESSED_RGBA_ASTC_12x10_KHR;if(o===A)return l===Xn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:c.COMPRESSED_RGBA_ASTC_12x12_KHR}if(o===L){if(c=e.get("EXT_texture_compression_bptc"),null===c)return null;if(o===L)return l===Xn?c.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:c.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(o===F||o===K||o===me||o===Ke){if(c=e.get("EXT_texture_compression_rgtc"),null===c)return null;if(o===L)return c.COMPRESSED_RED_RGTC1_EXT;if(o===K)return c.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(o===me)return c.COMPRESSED_RED_GREEN_RGTC2_EXT;if(o===Ke)return c.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return o===Fn?n?34042:(c=e.get("WEBGL_depth_texture"),null!==c?c.UNSIGNED_INT_24_8_WEBGL:null):void 0!==i[o]?i[o]:null}}}class Mw extends ur{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class dl extends Li{constructor(){super(),this.isGroup=!0,this.type="Group"}}const fm={type:"move"};class cc{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new dl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new dl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new V,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new V),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new dl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new V,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new V),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,o=null,l=null;const c=this._targetRay,u=this._grip,d=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(d&&e.hand){l=!0;for(const _ of e.hand.values()){const w=t.getJointPose(_,n),S=this._getHandJoint(d,_);null!==w&&(S.matrix.fromArray(w.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.jointRadius=w.radius),S.visible=null!==w}const p=d.joints["index-finger-tip"].position.distanceTo(d.joints["thumb-tip"].position),y=.02,x=.005;d.inputState.pinching&&p>y+x?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&p<=y-x&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==u&&e.gripSpace&&(o=t.getPose(e.gripSpace,n),null!==o&&(u.matrix.fromArray(o.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),o.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(o.linearVelocity)):u.hasLinearVelocity=!1,o.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(o.angularVelocity)):u.hasAngularVelocity=!1));null!==c&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==o&&(r=o),null!==r&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(fm)))}return null!==c&&(c.visible=null!==r),null!==u&&(u.visible=null!==o),null!==d&&(d.visible=null!==l),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new dl;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Sw extends gs{constructor(e,t,n,r,o,l,c,u,d,h){if((h=void 0!==h?h:Wl)!==Wl&&h!==tu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&h===Wl&&(n=Ls),void 0===n&&h===tu&&(n=Fn),super(null,r,o,l,c,u,h,n,d),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==c?c:ti,this.minFilter=void 0!==u?u:ti,this.flipY=!1,this.generateMipmaps=!1}}class U0 extends Wi{constructor(e,t){super();const n=this;let r=null,o=1,l=null,c="local-floor",u=1,d=null,h=null,f=null,p=null,y=null,x=null;const _=t.getContextAttributes();let w=null,S=null;const D=[],T=[],P=new Set,k=new Map,H=new ur;H.layers.enable(1),H.viewport=new ei;const W=new ur;W.layers.enable(2),W.viewport=new ei;const R=[H,W],B=new Mw;B.layers.enable(1),B.layers.enable(2);let X=null,le=null;function Ee(ye){const We=T.indexOf(ye.inputSource);if(-1===We)return;const ze=D[We];void 0!==ze&&ze.dispatchEvent({type:ye.type,data:ye.inputSource})}function te(){r.removeEventListener("select",Ee),r.removeEventListener("selectstart",Ee),r.removeEventListener("selectend",Ee),r.removeEventListener("squeeze",Ee),r.removeEventListener("squeezestart",Ee),r.removeEventListener("squeezeend",Ee),r.removeEventListener("end",te),r.removeEventListener("inputsourceschange",ee);for(let ye=0;ye<D.length;ye++){const We=T[ye];null!==We&&(T[ye]=null,D[ye].disconnect(We))}X=null,le=null,e.setRenderTarget(w),y=null,p=null,f=null,r=null,S=null,ut.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function ee(ye){for(let We=0;We<ye.removed.length;We++){const ze=ye.removed[We],ue=T.indexOf(ze);ue>=0&&(T[ue]=null,D[ue].disconnect(ze))}for(let We=0;We<ye.added.length;We++){const ze=ye.added[We];let ue=T.indexOf(ze);if(-1===ue){for(let et=0;et<D.length;et++){if(et>=T.length){T.push(ze),ue=et;break}if(null===T[et]){T[et]=ze,ue=et;break}}if(-1===ue)break}const mt=D[ue];mt&&mt.connect(ze)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ye){let We=D[ye];return void 0===We&&(We=new cc,D[ye]=We),We.getTargetRaySpace()},this.getControllerGrip=function(ye){let We=D[ye];return void 0===We&&(We=new cc,D[ye]=We),We.getGripSpace()},this.getHand=function(ye){let We=D[ye];return void 0===We&&(We=new cc,D[ye]=We),We.getHandSpace()},this.setFramebufferScaleFactor=function(ye){o=ye,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ye){c=ye,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||l},this.setReferenceSpace=function(ye){d=ye},this.getBaseLayer=function(){return null!==p?p:y},this.getBinding=function(){return f},this.getFrame=function(){return x},this.getSession=function(){return r},this.setSession=function(){var ye=function $c(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var o=i.apply(e,t);function l(u){jc(o,n,r,l,c,"next",u)}function c(u){jc(o,n,r,l,c,"throw",u)}l(void 0)})}}(function*(We){if(r=We,null!==r){if(w=e.getRenderTarget(),r.addEventListener("select",Ee),r.addEventListener("selectstart",Ee),r.addEventListener("selectend",Ee),r.addEventListener("squeeze",Ee),r.addEventListener("squeezestart",Ee),r.addEventListener("squeezeend",Ee),r.addEventListener("end",te),r.addEventListener("inputsourceschange",ee),!0!==_.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)y=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||_.antialias,alpha:_.alpha,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:o}),r.updateRenderState({baseLayer:y}),S=new Wo(y.framebufferWidth,y.framebufferHeight,{format:Gi,type:Vo,encoding:e.outputEncoding,stencilBuffer:_.stencil});else{let ze=null,ue=null,mt=null;_.depth&&(mt=_.stencil?35056:33190,ze=_.stencil?tu:Wl,ue=_.stencil?Fn:Ls);const et={colorFormat:32856,depthFormat:mt,scaleFactor:o};f=new XRWebGLBinding(r,t),p=f.createProjectionLayer(et),r.updateRenderState({layers:[p]}),S=new Wo(p.textureWidth,p.textureHeight,{format:Gi,type:Vo,depthTexture:new Sw(p.textureWidth,p.textureHeight,ue,void 0,void 0,void 0,void 0,void 0,void 0,ze),stencilBuffer:_.stencil,encoding:e.outputEncoding,samples:_.antialias?4:0}),e.properties.get(S).__ignoreDepthValues=p.ignoreDepthValues}S.isXRRenderTarget=!0,this.setFoveation(u),d=null,l=yield r.requestReferenceSpace(c),ut.setContext(r),ut.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(We){return ye.apply(this,arguments)}}();const ge=new V,re=new V;function se(ye,We){null===We?ye.matrixWorld.copy(ye.matrix):ye.matrixWorld.multiplyMatrices(We.matrixWorld,ye.matrix),ye.matrixWorldInverse.copy(ye.matrixWorld).invert()}this.updateCamera=function(ye){if(null===r)return;B.near=W.near=H.near=ye.near,B.far=W.far=H.far=ye.far,(X!==B.near||le!==B.far)&&(r.updateRenderState({depthNear:B.near,depthFar:B.far}),X=B.near,le=B.far);const We=ye.parent,ze=B.cameras;se(B,We);for(let mt=0;mt<ze.length;mt++)se(ze[mt],We);B.matrixWorld.decompose(B.position,B.quaternion,B.scale),ye.matrix.copy(B.matrix),ye.matrix.decompose(ye.position,ye.quaternion,ye.scale);const ue=ye.children;for(let mt=0,et=ue.length;mt<et;mt++)ue[mt].updateMatrixWorld(!0);2===ze.length?function ve(ye,We,ze){ge.setFromMatrixPosition(We.matrixWorld),re.setFromMatrixPosition(ze.matrixWorld);const ue=ge.distanceTo(re),mt=We.projectionMatrix.elements,et=ze.projectionMatrix.elements,ft=mt[14]/(mt[10]-1),gt=mt[14]/(mt[10]+1),bt=(mt[9]+1)/mt[5],Bt=(mt[9]-1)/mt[5],Ve=(mt[8]-1)/mt[0],Ze=(et[8]+1)/et[0],ht=ft*Ve,Ot=ft*Ze,vt=ue/(-Ve+Ze),tn=vt*-Ve;We.matrixWorld.decompose(ye.position,ye.quaternion,ye.scale),ye.translateX(tn),ye.translateZ(vt),ye.matrixWorld.compose(ye.position,ye.quaternion,ye.scale),ye.matrixWorldInverse.copy(ye.matrixWorld).invert();const Yt=ft+vt,nn=gt+vt;ye.projectionMatrix.makePerspective(ht-tn,Ot+(ue-tn),bt*gt/nn*Yt,Bt*gt/nn*Yt,Yt,nn)}(B,H,W):B.projectionMatrix.copy(H.projectionMatrix)},this.getCamera=function(){return B},this.getFoveation=function(){if(null!==p||null!==y)return u},this.setFoveation=function(ye){u=ye,null!==p&&(p.fixedFoveation=ye),null!==y&&void 0!==y.fixedFoveation&&(y.fixedFoveation=ye)},this.getPlanes=function(){return P};let Me=null;const ut=new iy;ut.setAnimationLoop(function ke(ye,We){if(h=We.getViewerPose(d||l),x=We,null!==h){const ze=h.views;null!==y&&(e.setRenderTargetFramebuffer(S,y.framebuffer),e.setRenderTarget(S));let ue=!1;ze.length!==B.cameras.length&&(B.cameras.length=0,ue=!0);for(let mt=0;mt<ze.length;mt++){const et=ze[mt];let ft=null;if(null!==y)ft=y.getViewport(et);else{const bt=f.getViewSubImage(p,et);ft=bt.viewport,0===mt&&(e.setRenderTargetTextures(S,bt.colorTexture,p.ignoreDepthValues?void 0:bt.depthStencilTexture),e.setRenderTarget(S))}let gt=R[mt];void 0===gt&&(gt=new ur,gt.layers.enable(mt),gt.viewport=new ei,R[mt]=gt),gt.matrix.fromArray(et.transform.matrix),gt.projectionMatrix.fromArray(et.projectionMatrix),gt.viewport.set(ft.x,ft.y,ft.width,ft.height),0===mt&&B.matrix.copy(gt.matrix),!0===ue&&B.cameras.push(gt)}}for(let ze=0;ze<D.length;ze++){const ue=T[ze],mt=D[ze];null!==ue&&void 0!==mt&&mt.update(ue,We,d||l)}if(Me&&Me(ye,We),We.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:We.detectedPlanes});let ze=null;for(const ue of P)We.detectedPlanes.has(ue)||(null===ze&&(ze=[]),ze.push(ue));if(null!==ze)for(const ue of ze)P.delete(ue),k.delete(ue),n.dispatchEvent({type:"planeremoved",data:ue});for(const ue of We.detectedPlanes)if(P.has(ue)){const mt=k.get(ue);ue.lastChangedTime>mt&&(k.set(ue,ue.lastChangedTime),n.dispatchEvent({type:"planechanged",data:ue}))}else P.add(ue),k.set(ue,We.lastChangedTime),n.dispatchEvent({type:"planeadded",data:ue})}x=null}),this.setAnimationLoop=function(ye){Me=ye},this.dispose=function(){}}}function Ew(i,e){function r(_,w){_.opacity.value=w.opacity,w.color&&_.diffuse.value.copy(w.color),w.emissive&&_.emissive.value.copy(w.emissive).multiplyScalar(w.emissiveIntensity),w.map&&(_.map.value=w.map),w.alphaMap&&(_.alphaMap.value=w.alphaMap),w.bumpMap&&(_.bumpMap.value=w.bumpMap,_.bumpScale.value=w.bumpScale,w.side===_n&&(_.bumpScale.value*=-1)),w.displacementMap&&(_.displacementMap.value=w.displacementMap,_.displacementScale.value=w.displacementScale,_.displacementBias.value=w.displacementBias),w.emissiveMap&&(_.emissiveMap.value=w.emissiveMap),w.normalMap&&(_.normalMap.value=w.normalMap,_.normalScale.value.copy(w.normalScale),w.side===_n&&_.normalScale.value.negate()),w.specularMap&&(_.specularMap.value=w.specularMap),w.alphaTest>0&&(_.alphaTest.value=w.alphaTest);const S=e.get(w).envMap;if(S&&(_.envMap.value=S,_.flipEnvMap.value=S.isCubeTexture&&!1===S.isRenderTargetTexture?-1:1,_.reflectivity.value=w.reflectivity,_.ior.value=w.ior,_.refractionRatio.value=w.refractionRatio),w.lightMap){_.lightMap.value=w.lightMap;const P=!0===i.useLegacyLights?Math.PI:1;_.lightMapIntensity.value=w.lightMapIntensity*P}let D,T;w.aoMap&&(_.aoMap.value=w.aoMap,_.aoMapIntensity.value=w.aoMapIntensity),w.map?D=w.map:w.specularMap?D=w.specularMap:w.displacementMap?D=w.displacementMap:w.normalMap?D=w.normalMap:w.bumpMap?D=w.bumpMap:w.roughnessMap?D=w.roughnessMap:w.metalnessMap?D=w.metalnessMap:w.alphaMap?D=w.alphaMap:w.emissiveMap?D=w.emissiveMap:w.clearcoatMap?D=w.clearcoatMap:w.clearcoatNormalMap?D=w.clearcoatNormalMap:w.clearcoatRoughnessMap?D=w.clearcoatRoughnessMap:w.iridescenceMap?D=w.iridescenceMap:w.iridescenceThicknessMap?D=w.iridescenceThicknessMap:w.specularIntensityMap?D=w.specularIntensityMap:w.specularColorMap?D=w.specularColorMap:w.transmissionMap?D=w.transmissionMap:w.thicknessMap?D=w.thicknessMap:w.sheenColorMap?D=w.sheenColorMap:w.sheenRoughnessMap&&(D=w.sheenRoughnessMap),void 0!==D&&(D.isWebGLRenderTarget&&(D=D.texture),!0===D.matrixAutoUpdate&&D.updateMatrix(),_.uvTransform.value.copy(D.matrix)),w.aoMap?T=w.aoMap:w.lightMap&&(T=w.lightMap),void 0!==T&&(T.isWebGLRenderTarget&&(T=T.texture),!0===T.matrixAutoUpdate&&T.updateMatrix(),_.uv2Transform.value.copy(T.matrix))}return{refreshFogUniforms:function t(_,w){w.color.getRGB(_.fogColor.value,K_(i)),w.isFog?(_.fogNear.value=w.near,_.fogFar.value=w.far):w.isFogExp2&&(_.fogDensity.value=w.density)},refreshMaterialUniforms:function n(_,w,S,D,T){w.isMeshBasicMaterial||w.isMeshLambertMaterial?r(_,w):w.isMeshToonMaterial?(r(_,w),function h(_,w){w.gradientMap&&(_.gradientMap.value=w.gradientMap)}(_,w)):w.isMeshPhongMaterial?(r(_,w),function d(_,w){_.specular.value.copy(w.specular),_.shininess.value=Math.max(w.shininess,1e-4)}(_,w)):w.isMeshStandardMaterial?(r(_,w),function f(_,w){_.roughness.value=w.roughness,_.metalness.value=w.metalness,w.roughnessMap&&(_.roughnessMap.value=w.roughnessMap),w.metalnessMap&&(_.metalnessMap.value=w.metalnessMap),e.get(w).envMap&&(_.envMapIntensity.value=w.envMapIntensity)}(_,w),w.isMeshPhysicalMaterial&&function p(_,w,S){_.ior.value=w.ior,w.sheen>0&&(_.sheenColor.value.copy(w.sheenColor).multiplyScalar(w.sheen),_.sheenRoughness.value=w.sheenRoughness,w.sheenColorMap&&(_.sheenColorMap.value=w.sheenColorMap),w.sheenRoughnessMap&&(_.sheenRoughnessMap.value=w.sheenRoughnessMap)),w.clearcoat>0&&(_.clearcoat.value=w.clearcoat,_.clearcoatRoughness.value=w.clearcoatRoughness,w.clearcoatMap&&(_.clearcoatMap.value=w.clearcoatMap),w.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=w.clearcoatRoughnessMap),w.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(w.clearcoatNormalScale),_.clearcoatNormalMap.value=w.clearcoatNormalMap,w.side===_n&&_.clearcoatNormalScale.value.negate())),w.iridescence>0&&(_.iridescence.value=w.iridescence,_.iridescenceIOR.value=w.iridescenceIOR,_.iridescenceThicknessMinimum.value=w.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=w.iridescenceThicknessRange[1],w.iridescenceMap&&(_.iridescenceMap.value=w.iridescenceMap),w.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=w.iridescenceThicknessMap)),w.transmission>0&&(_.transmission.value=w.transmission,_.transmissionSamplerMap.value=S.texture,_.transmissionSamplerSize.value.set(S.width,S.height),w.transmissionMap&&(_.transmissionMap.value=w.transmissionMap),_.thickness.value=w.thickness,w.thicknessMap&&(_.thicknessMap.value=w.thicknessMap),_.attenuationDistance.value=w.attenuationDistance,_.attenuationColor.value.copy(w.attenuationColor)),_.specularIntensity.value=w.specularIntensity,_.specularColor.value.copy(w.specularColor),w.specularIntensityMap&&(_.specularIntensityMap.value=w.specularIntensityMap),w.specularColorMap&&(_.specularColorMap.value=w.specularColorMap)}(_,w,T)):w.isMeshMatcapMaterial?(r(_,w),function y(_,w){w.matcap&&(_.matcap.value=w.matcap)}(_,w)):w.isMeshDepthMaterial?r(_,w):w.isMeshDistanceMaterial?(r(_,w),function x(_,w){_.referencePosition.value.copy(w.referencePosition),_.nearDistance.value=w.nearDistance,_.farDistance.value=w.farDistance}(_,w)):w.isMeshNormalMaterial?r(_,w):w.isLineBasicMaterial?(function o(_,w){_.diffuse.value.copy(w.color),_.opacity.value=w.opacity}(_,w),w.isLineDashedMaterial&&function l(_,w){_.dashSize.value=w.dashSize,_.totalSize.value=w.dashSize+w.gapSize,_.scale.value=w.scale}(_,w)):w.isPointsMaterial?function c(_,w,S,D){let T;_.diffuse.value.copy(w.color),_.opacity.value=w.opacity,_.size.value=w.size*S,_.scale.value=.5*D,w.map&&(_.map.value=w.map),w.alphaMap&&(_.alphaMap.value=w.alphaMap),w.alphaTest>0&&(_.alphaTest.value=w.alphaTest),w.map?T=w.map:w.alphaMap&&(T=w.alphaMap),void 0!==T&&(!0===T.matrixAutoUpdate&&T.updateMatrix(),_.uvTransform.value.copy(T.matrix))}(_,w,S,D):w.isSpriteMaterial?function u(_,w){let S;_.diffuse.value.copy(w.color),_.opacity.value=w.opacity,_.rotation.value=w.rotation,w.map&&(_.map.value=w.map),w.alphaMap&&(_.alphaMap.value=w.alphaMap),w.alphaTest>0&&(_.alphaTest.value=w.alphaTest),w.map?S=w.map:w.alphaMap&&(S=w.alphaMap),void 0!==S&&(!0===S.matrixAutoUpdate&&S.updateMatrix(),_.uvTransform.value.copy(S.matrix))}(_,w):w.isShadowMaterial?(_.color.value.copy(w.color),_.opacity.value=w.opacity):w.isShaderMaterial&&(w.uniformsNeedUpdate=!1)}}}function z0(i,e,t,n){let r={},o={},l=[];const c=t.isWebGL2?i.getParameter(35375):0;function y(D,T,P){const k=D.value;if(void 0===P[T]){if("number"==typeof k)P[T]=k;else{const H=Array.isArray(k)?k:[k],W=[];for(let R=0;R<H.length;R++)W.push(H[R].clone());P[T]=W}return!0}if("number"==typeof k){if(P[T]!==k)return P[T]=k,!0}else{const H=Array.isArray(P[T])?P[T]:[P[T]],W=Array.isArray(k)?k:[k];for(let R=0;R<H.length;R++){const B=H[R];if(!1===B.equals(W[R]))return B.copy(W[R]),!0}}return!1}function _(D){const T={boundary:0,storage:0};return"number"==typeof D?(T.boundary=4,T.storage=4):D.isVector2?(T.boundary=8,T.storage=8):D.isVector3||D.isColor?(T.boundary=16,T.storage=12):D.isVector4?(T.boundary=16,T.storage=16):D.isMatrix3?(T.boundary=48,T.storage=48):D.isMatrix4?(T.boundary=64,T.storage=64):D.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",D),T}function w(D){const T=D.target;T.removeEventListener("dispose",w);const P=l.indexOf(T.__bindingPointIndex);l.splice(P,1),i.deleteBuffer(r[T.id]),delete r[T.id],delete o[T.id]}return{bind:function u(D,T){n.uniformBlockBinding(D,T.program)},update:function d(D,T){let P=r[D.id];void 0===P&&(function x(D){const T=D.uniforms;let P=0;let H=0;for(let W=0,R=T.length;W<R;W++){const B=T[W],X={boundary:0,storage:0},le=Array.isArray(B.value)?B.value:[B.value];for(let Ee=0,te=le.length;Ee<te;Ee++){const ge=_(le[Ee]);X.boundary+=ge.boundary,X.storage+=ge.storage}B.__data=new Float32Array(X.storage/Float32Array.BYTES_PER_ELEMENT),B.__offset=P,W>0&&(H=P%16,0!==H&&16-H-X.boundary<0&&(P+=16-H,B.__offset=P)),P+=X.storage}H=P%16,H>0&&(P+=16-H),D.__size=P,D.__cache={}}(D),P=function h(D){const T=function f(){for(let D=0;D<c;D++)if(-1===l.indexOf(D))return l.push(D),D;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();D.__bindingPointIndex=T;const P=i.createBuffer(),k=D.__size,H=D.usage;return i.bindBuffer(35345,P),i.bufferData(35345,k,H),i.bindBuffer(35345,null),i.bindBufferBase(35345,T,P),P}(D),r[D.id]=P,D.addEventListener("dispose",w)),n.updateUBOMapping(D,T.program);const H=e.render.frame;o[D.id]!==H&&(function p(D){const P=D.uniforms,k=D.__cache;i.bindBuffer(35345,r[D.id]);for(let H=0,W=P.length;H<W;H++){const R=P[H];if(!0===y(R,H,k)){const B=R.__offset,X=Array.isArray(R.value)?R.value:[R.value];let le=0;for(let Ee=0;Ee<X.length;Ee++){const te=X[Ee],ee=_(te);"number"==typeof te?(R.__data[0]=te,i.bufferSubData(35345,B+le,R.__data)):te.isMatrix3?(R.__data[0]=te.elements[0],R.__data[1]=te.elements[1],R.__data[2]=te.elements[2],R.__data[3]=te.elements[0],R.__data[4]=te.elements[3],R.__data[5]=te.elements[4],R.__data[6]=te.elements[5],R.__data[7]=te.elements[0],R.__data[8]=te.elements[6],R.__data[9]=te.elements[7],R.__data[10]=te.elements[8],R.__data[11]=te.elements[0]):(te.toArray(R.__data,le),le+=ee.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(35345,B,R.__data)}}i.bindBuffer(35345,null)}(D),o[D.id]=H)},dispose:function S(){for(const D in r)i.deleteBuffer(r[D]);l=[],r={},o={}}}}function Ou(i={}){this.isWebGLRenderer=!0;const e=void 0!==i.canvas?i.canvas:function H0(){const i=xd("canvas");return i.style.display="block",i}(),t=void 0!==i.context?i.context:null,n=void 0===i.depth||i.depth,r=void 0===i.stencil||i.stencil,o=void 0!==i.antialias&&i.antialias,l=void 0===i.premultipliedAlpha||i.premultipliedAlpha,c=void 0!==i.preserveDrawingBuffer&&i.preserveDrawingBuffer,u=void 0!==i.powerPreference?i.powerPreference:"default",d=void 0!==i.failIfMajorPerformanceCaveat&&i.failIfMajorPerformanceCaveat;let h;h=null!==t?t.getContextAttributes().alpha:void 0!==i.alpha&&i.alpha;let f=null,p=null;const y=[],x=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=ql,this.useLegacyLights=!0,this.toneMapping=pr,this.toneMappingExposure=1;const _=this;let w=!1,S=0,D=0,T=null,P=-1,k=null;const H=new ei,W=new ei;let R=null,B=e.width,X=e.height,le=1,Ee=null,te=null;const ee=new ei(0,0,B,X),ge=new ei(0,0,B,X);let re=!1;const ve=new Bp;let se=!1,Me=!1,ke=null;const ut=new an,ye=new V,We={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ze(){return null===T?le:1}let et,ft,gt,bt,Bt,Ve,Ze,ht,Ot,vt,tn,Yt,nn,ii,jn,$,z,Ce,rt,st,Mt,zt,Z,de,ue=t;function mt(G,_e){for(let Ie=0;Ie<G.length;Ie++){const Ne=e.getContext(G[Ie],_e);if(null!==Ne)return Ne}return null}try{const G={alpha:!0,depth:n,stencil:r,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Bl}`),e.addEventListener("webglcontextlost",Ut,!1),e.addEventListener("webglcontextrestored",Gt,!1),e.addEventListener("webglcontextcreationerror",Ht,!1),null===ue){const _e=["webgl2","webgl","experimental-webgl"];if(!0===_.isWebGL1Renderer&&_e.shift(),ue=mt(_e,G),null===ue)throw mt(_e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ue.getShaderPrecisionFormat&&(ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(G){throw console.error("THREE.WebGLRenderer: "+G.message),G}function Et(){et=new nw(ue),ft=new Kx(ue,et,i),et.init(ft),zt=new bw(ue,et,ft),gt=new B0(ue,et,ft),bt=new iw,Bt=new I0,Ve=new ww(ue,et,gt,Bt,ft,zt,bt),Ze=new Pd(_),ht=new tw(_),Ot=new tx(ue,ft),Z=new Uy(ue,et,Ot,ft),vt=new jy(ue,Ot,bt,Z),tn=new df(ue,vt,Ot,bt),rt=new XM(ue,ft,Ve),$=new Qx(Bt),Yt=new D0(_,Ze,ht,et,ft,Z,$),nn=new Ew(_,Bt),ii=new L0,jn=new xw(et,ft),Ce=new Zx(_,Ze,ht,gt,tn,h,l),z=new k0(_,tn,ft),de=new z0(ue,bt,ft,gt),st=new zy(ue,et,bt,ft),Mt=new $y(ue,et,bt,ft),bt.programs=Yt.programs,_.capabilities=ft,_.extensions=et,_.properties=Bt,_.renderLists=ii,_.shadowMap=z,_.state=gt,_.info=bt}Et();const _t=new U0(_,ue);function Ut(G){G.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),w=!0}function Gt(){console.log("THREE.WebGLRenderer: Context Restored."),w=!1;const G=bt.autoReset,_e=z.enabled,Ie=z.autoUpdate,pe=z.needsUpdate,Ne=z.type;Et(),bt.autoReset=G,z.enabled=_e,z.autoUpdate=Ie,z.needsUpdate=pe,z.type=Ne}function Ht(G){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",G.statusMessage)}function Ln(G){const _e=G.target;_e.removeEventListener("dispose",Ln),function $n(G){(function si(G){const _e=Bt.get(G).programs;void 0!==_e&&(_e.forEach(function(Ie){Yt.releaseProgram(Ie)}),G.isShaderMaterial&&Yt.releaseShaderCache(G))})(G),Bt.remove(G)}(_e)}this.xr=_t,this.getContext=function(){return ue},this.getContextAttributes=function(){return ue.getContextAttributes()},this.forceContextLoss=function(){const G=et.get("WEBGL_lose_context");G&&G.loseContext()},this.forceContextRestore=function(){const G=et.get("WEBGL_lose_context");G&&G.restoreContext()},this.getPixelRatio=function(){return le},this.setPixelRatio=function(G){void 0!==G&&(le=G,this.setSize(B,X,!1))},this.getSize=function(G){return G.set(B,X)},this.setSize=function(G,_e,Ie=!0){_t.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(B=G,X=_e,e.width=Math.floor(G*le),e.height=Math.floor(_e*le),!0===Ie&&(e.style.width=G+"px",e.style.height=_e+"px"),this.setViewport(0,0,G,_e))},this.getDrawingBufferSize=function(G){return G.set(B*le,X*le).floor()},this.setDrawingBufferSize=function(G,_e,Ie){B=G,X=_e,le=Ie,e.width=Math.floor(G*Ie),e.height=Math.floor(_e*Ie),this.setViewport(0,0,G,_e)},this.getCurrentViewport=function(G){return G.copy(H)},this.getViewport=function(G){return G.copy(ee)},this.setViewport=function(G,_e,Ie,pe){G.isVector4?ee.set(G.x,G.y,G.z,G.w):ee.set(G,_e,Ie,pe),gt.viewport(H.copy(ee).multiplyScalar(le).floor())},this.getScissor=function(G){return G.copy(ge)},this.setScissor=function(G,_e,Ie,pe){G.isVector4?ge.set(G.x,G.y,G.z,G.w):ge.set(G,_e,Ie,pe),gt.scissor(W.copy(ge).multiplyScalar(le).floor())},this.getScissorTest=function(){return re},this.setScissorTest=function(G){gt.setScissorTest(re=G)},this.setOpaqueSort=function(G){Ee=G},this.setTransparentSort=function(G){te=G},this.getClearColor=function(G){return G.copy(Ce.getClearColor())},this.setClearColor=function(){Ce.setClearColor.apply(Ce,arguments)},this.getClearAlpha=function(){return Ce.getClearAlpha()},this.setClearAlpha=function(){Ce.setClearAlpha.apply(Ce,arguments)},this.clear=function(G=!0,_e=!0,Ie=!0){let pe=0;G&&(pe|=16384),_e&&(pe|=256),Ie&&(pe|=1024),ue.clear(pe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Ut,!1),e.removeEventListener("webglcontextrestored",Gt,!1),e.removeEventListener("webglcontextcreationerror",Ht,!1),ii.dispose(),jn.dispose(),Bt.dispose(),Ze.dispose(),ht.dispose(),tn.dispose(),Z.dispose(),de.dispose(),Yt.dispose(),_t.dispose(),_t.removeEventListener("sessionstart",tt),_t.removeEventListener("sessionend",At),ke&&(ke.dispose(),ke=null),Nt.stop()},this.renderBufferDirect=function(G,_e,Ie,pe,Ne,Qt){null===_e&&(_e=We);const fn=Ne.isMesh&&Ne.matrixWorld.determinant()<0,Tn=function ME(G,_e,Ie,pe,Ne){!0!==_e.isScene&&(_e=We),Ve.resetTextureUnits();const Qt=_e.fog,Tn=null===T?_.outputEncoding:!0===T.isXRRenderTarget?T.texture.encoding:ql,In=(pe.isMeshStandardMaterial?ht:Ze).get(pe.envMap||(pe.isMeshStandardMaterial?_e.environment:null)),Zn=!0===pe.vertexColors&&!!Ie.attributes.color&&4===Ie.attributes.color.itemSize,kn=!!pe.normalMap&&!!Ie.attributes.tangent,Bn=!!Ie.morphAttributes.position,dr=!!Ie.morphAttributes.normal,_o=!!Ie.morphAttributes.color,Pc=pe.toneMapped?_.toneMapping:pr,ah=Ie.morphAttributes.position||Ie.morphAttributes.normal||Ie.morphAttributes.color,hr=void 0!==ah?ah.length:0,Un=Bt.get(pe),oM=p.state.lights;!0!==se||!0!==Me&&G===k||$.setState(pe,G,G===k&&pe.id===P);let Dr=!1;pe.version===Un.__version?(Un.needsLights&&Un.lightsStateVersion!==oM.state.version||Un.outputEncoding!==Tn||Ne.isInstancedMesh&&!1===Un.instancing||!Ne.isInstancedMesh&&!0===Un.instancing||Ne.isSkinnedMesh&&!1===Un.skinning||!Ne.isSkinnedMesh&&!0===Un.skinning||Un.envMap!==In||!0===pe.fog&&Un.fog!==Qt||void 0!==Un.numClippingPlanes&&(Un.numClippingPlanes!==$.numPlanes||Un.numIntersection!==$.numIntersection)||Un.vertexAlphas!==Zn||Un.vertexTangents!==kn||Un.morphTargets!==Bn||Un.morphNormals!==dr||Un.morphColors!==_o||Un.toneMapping!==Pc||!0===ft.isWebGL2&&Un.morphTargetsCount!==hr)&&(Dr=!0):(Dr=!0,Un.__version=pe.version);let lh=Un.currentProgram;!0===Dr&&(lh=Ko(pe,_e,Ne));let KS=!1,vg=!1,aM=!1;const bs=lh.getUniforms(),ch=Un.uniforms;if(gt.useProgram(lh.program)&&(KS=!0,vg=!0,aM=!0),pe.id!==P&&(P=pe.id,vg=!0),KS||k!==G){if(bs.setValue(ue,"projectionMatrix",G.projectionMatrix),ft.logarithmicDepthBuffer&&bs.setValue(ue,"logDepthBufFC",2/(Math.log(G.far+1)/Math.LN2)),k!==G&&(k=G,vg=!0,aM=!0),pe.isShaderMaterial||pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshStandardMaterial||pe.envMap){const xo=bs.map.cameraPosition;void 0!==xo&&xo.setValue(ue,ye.setFromMatrixPosition(G.matrixWorld))}(pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshLambertMaterial||pe.isMeshBasicMaterial||pe.isMeshStandardMaterial||pe.isShaderMaterial)&&bs.setValue(ue,"isOrthographic",!0===G.isOrthographicCamera),(pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshLambertMaterial||pe.isMeshBasicMaterial||pe.isMeshStandardMaterial||pe.isShaderMaterial||pe.isShadowMaterial||Ne.isSkinnedMesh)&&bs.setValue(ue,"viewMatrix",G.matrixWorldInverse)}if(Ne.isSkinnedMesh){bs.setOptional(ue,Ne,"bindMatrix"),bs.setOptional(ue,Ne,"bindMatrixInverse");const xo=Ne.skeleton;xo&&(ft.floatVertexTextures?(null===xo.boneTexture&&xo.computeBoneTexture(),bs.setValue(ue,"boneTexture",xo.boneTexture,Ve),bs.setValue(ue,"boneTextureSize",xo.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const lM=Ie.morphAttributes;if((void 0!==lM.position||void 0!==lM.normal||void 0!==lM.color&&!0===ft.isWebGL2)&&rt.update(Ne,Ie,lh),(vg||Un.receiveShadow!==Ne.receiveShadow)&&(Un.receiveShadow=Ne.receiveShadow,bs.setValue(ue,"receiveShadow",Ne.receiveShadow)),pe.isMeshGouraudMaterial&&null!==pe.envMap&&(ch.envMap.value=In,ch.flipEnvMap.value=In.isCubeTexture&&!1===In.isRenderTargetTexture?-1:1),vg&&(bs.setValue(ue,"toneMappingExposure",_.toneMappingExposure),Un.needsLights&&function SE(G,_e){G.ambientLightColor.needsUpdate=_e,G.lightProbe.needsUpdate=_e,G.directionalLights.needsUpdate=_e,G.directionalLightShadows.needsUpdate=_e,G.pointLights.needsUpdate=_e,G.pointLightShadows.needsUpdate=_e,G.spotLights.needsUpdate=_e,G.spotLightShadows.needsUpdate=_e,G.rectAreaLights.needsUpdate=_e,G.hemisphereLights.needsUpdate=_e}(ch,aM),Qt&&!0===pe.fog&&nn.refreshFogUniforms(ch,Qt),nn.refreshMaterialUniforms(ch,pe,le,X,ke),Ru.upload(ue,Un.uniformsList,ch,Ve)),pe.isShaderMaterial&&!0===pe.uniformsNeedUpdate&&(Ru.upload(ue,Un.uniformsList,ch,Ve),pe.uniformsNeedUpdate=!1),pe.isSpriteMaterial&&bs.setValue(ue,"center",Ne.center),bs.setValue(ue,"modelViewMatrix",Ne.modelViewMatrix),bs.setValue(ue,"normalMatrix",Ne.normalMatrix),bs.setValue(ue,"modelMatrix",Ne.matrixWorld),pe.isShaderMaterial||pe.isRawShaderMaterial){const xo=pe.uniformsGroups;for(let cM=0,TE=xo.length;cM<TE;cM++)if(ft.isWebGL2){const QS=xo[cM];de.update(QS,lh),de.bind(QS,lh)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return lh}(G,_e,Ie,pe,Ne);gt.setMaterial(pe,fn);let In=Ie.index,Zn=1;!0===pe.wireframe&&(In=vt.getWireframeAttribute(Ie),Zn=2);const kn=Ie.drawRange,Bn=Ie.attributes.position;let dr=kn.start*Zn,_o=(kn.start+kn.count)*Zn;null!==Qt&&(dr=Math.max(dr,Qt.start*Zn),_o=Math.min(_o,(Qt.start+Qt.count)*Zn)),null!==In?(dr=Math.max(dr,0),_o=Math.min(_o,In.count)):null!=Bn&&(dr=Math.max(dr,0),_o=Math.min(_o,Bn.count));const Pc=_o-dr;if(Pc<0||Pc===1/0)return;Z.setup(Ne,pe,Tn,Ie,In);let ah,hr=st;if(null!==In&&(ah=Ot.get(In),hr=Mt,hr.setIndex(ah)),Ne.isMesh)!0===pe.wireframe?(gt.setLineWidth(pe.wireframeLinewidth*ze()),hr.setMode(1)):hr.setMode(4);else if(Ne.isLine){let Un=pe.linewidth;void 0===Un&&(Un=1),gt.setLineWidth(Un*ze()),hr.setMode(Ne.isLineSegments?1:Ne.isLineLoop?2:3)}else Ne.isPoints?hr.setMode(0):Ne.isSprite&&hr.setMode(4);if(Ne.isInstancedMesh)hr.renderInstances(dr,Pc,Ne.count);else if(Ie.isInstancedBufferGeometry){const oM=Math.min(Ie.instanceCount,void 0!==Ie._maxInstanceCount?Ie._maxInstanceCount:1/0);hr.renderInstances(dr,Pc,oM)}else hr.render(dr,Pc)},this.compile=function(G,_e){function Ie(pe,Ne,Qt){!0===pe.transparent&&pe.side===wr&&!1===pe.forceSinglePass?(pe.side=_n,pe.needsUpdate=!0,Ko(pe,Ne,Qt),pe.side=Qi,pe.needsUpdate=!0,Ko(pe,Ne,Qt),pe.side=wr):Ko(pe,Ne,Qt)}p=jn.get(G),p.init(),x.push(p),G.traverseVisible(function(pe){pe.isLight&&pe.layers.test(_e.layers)&&(p.pushLight(pe),pe.castShadow&&p.pushShadow(pe))}),p.setupLights(_.useLegacyLights),G.traverse(function(pe){const Ne=pe.material;if(Ne)if(Array.isArray(Ne))for(let Qt=0;Qt<Ne.length;Qt++)Ie(Ne[Qt],G,pe);else Ie(Ne,G,pe)}),x.pop(),p=null};let ne=null;function tt(){Nt.stop()}function At(){Nt.start()}const Nt=new iy;function wi(G,_e,Ie,pe){if(!1===G.visible)return;if(G.layers.test(_e.layers))if(G.isGroup)Ie=G.renderOrder;else if(G.isLOD)!0===G.autoUpdate&&G.update(_e);else if(G.isLight)p.pushLight(G),G.castShadow&&p.pushShadow(G);else if(G.isSprite){if(!G.frustumCulled||ve.intersectsSprite(G)){pe&&ye.setFromMatrixPosition(G.matrixWorld).applyMatrix4(ut);const fn=tn.update(G),Tn=G.material;Tn.visible&&f.push(G,fn,Tn,Ie,ye.z,null)}}else if((G.isMesh||G.isLine||G.isPoints)&&(G.isSkinnedMesh&&G.skeleton.frame!==bt.render.frame&&(G.skeleton.update(),G.skeleton.frame=bt.render.frame),!G.frustumCulled||ve.intersectsObject(G))){pe&&ye.setFromMatrixPosition(G.matrixWorld).applyMatrix4(ut);const fn=tn.update(G),Tn=G.material;if(Array.isArray(Tn)){const In=fn.groups;for(let Zn=0,kn=In.length;Zn<kn;Zn++){const Bn=In[Zn],dr=Tn[Bn.materialIndex];dr&&dr.visible&&f.push(G,fn,dr,Ie,ye.z,Bn)}}else Tn.visible&&f.push(G,fn,Tn,Ie,ye.z,null)}const Qt=G.children;for(let fn=0,Tn=Qt.length;fn<Tn;fn++)wi(Qt[fn],_e,Ie,pe)}function Cr(G,_e,Ie,pe){const Ne=G.opaque,Qt=G.transmissive,fn=G.transparent;p.setupLightsView(Ie),!0===se&&$.setGlobalState(_.clippingPlanes,Ie),Qt.length>0&&function ws(G,_e,Ie){const pe=ft.isWebGL2;null===ke&&(ke=new Wo(1024,1024,{generateMipmaps:!0,type:et.has("EXT_color_buffer_half_float")?hi:Vo,minFilter:br,samples:pe&&!0===o?4:0}));const Ne=_.getRenderTarget();_.setRenderTarget(ke),_.clear();const Qt=_.toneMapping;_.toneMapping=pr,Sl(G,_e,Ie),_.toneMapping=Qt,Ve.updateMultisampleRenderTarget(ke),Ve.updateRenderTargetMipmap(ke),_.setRenderTarget(Ne)}(Ne,_e,Ie),pe&&gt.viewport(H.copy(pe)),Ne.length>0&&Sl(Ne,_e,Ie),Qt.length>0&&Sl(Qt,_e,Ie),fn.length>0&&Sl(fn,_e,Ie),gt.buffers.depth.setTest(!0),gt.buffers.depth.setMask(!0),gt.buffers.color.setMask(!0),gt.setPolygonOffset(!1)}function Sl(G,_e,Ie){const pe=!0===_e.isScene?_e.overrideMaterial:null;for(let Ne=0,Qt=G.length;Ne<Qt;Ne++){const fn=G[Ne],Tn=fn.object,In=fn.geometry,Zn=null===pe?fn.material:pe,kn=fn.group;Tn.layers.test(Ie.layers)&&nr(Tn,_e,Ie,In,Zn,kn)}}function nr(G,_e,Ie,pe,Ne,Qt){G.onBeforeRender(_,_e,Ie,pe,Ne,Qt),G.modelViewMatrix.multiplyMatrices(Ie.matrixWorldInverse,G.matrixWorld),G.normalMatrix.getNormalMatrix(G.modelViewMatrix),Ne.onBeforeRender(_,_e,Ie,pe,G,Qt),!0===Ne.transparent&&Ne.side===wr&&!1===Ne.forceSinglePass?(Ne.side=_n,Ne.needsUpdate=!0,_.renderBufferDirect(Ie,_e,pe,Ne,G,Qt),Ne.side=Qi,Ne.needsUpdate=!0,_.renderBufferDirect(Ie,_e,pe,Ne,G,Qt),Ne.side=wr):_.renderBufferDirect(Ie,_e,pe,Ne,G,Qt),G.onAfterRender(_,_e,Ie,pe,Ne,Qt)}function Ko(G,_e,Ie){!0!==_e.isScene&&(_e=We);const pe=Bt.get(G),Ne=p.state.lights,fn=Ne.state.version,Tn=Yt.getParameters(G,Ne.state,p.state.shadowsArray,_e,Ie),In=Yt.getProgramCacheKey(Tn);let Zn=pe.programs;pe.environment=G.isMeshStandardMaterial?_e.environment:null,pe.fog=_e.fog,pe.envMap=(G.isMeshStandardMaterial?ht:Ze).get(G.envMap||pe.environment),void 0===Zn&&(G.addEventListener("dispose",Ln),Zn=new Map,pe.programs=Zn);let kn=Zn.get(In);if(void 0!==kn){if(pe.currentProgram===kn&&pe.lightsStateVersion===fn)return El(G,Tn),kn}else Tn.uniforms=Yt.getUniforms(G),G.onBuild(Ie,Tn,_),G.onBeforeCompile(Tn,_),kn=Yt.acquireProgram(Tn,In),Zn.set(In,kn),pe.uniforms=Tn.uniforms;const Bn=pe.uniforms;(!G.isShaderMaterial&&!G.isRawShaderMaterial||!0===G.clipping)&&(Bn.clippingPlanes=$.uniform),El(G,Tn),pe.needsLights=function EE(G){return G.isMeshLambertMaterial||G.isMeshToonMaterial||G.isMeshPhongMaterial||G.isMeshStandardMaterial||G.isShadowMaterial||G.isShaderMaterial&&!0===G.lights}(G),pe.lightsStateVersion=fn,pe.needsLights&&(Bn.ambientLightColor.value=Ne.state.ambient,Bn.lightProbe.value=Ne.state.probe,Bn.directionalLights.value=Ne.state.directional,Bn.directionalLightShadows.value=Ne.state.directionalShadow,Bn.spotLights.value=Ne.state.spot,Bn.spotLightShadows.value=Ne.state.spotShadow,Bn.rectAreaLights.value=Ne.state.rectArea,Bn.ltc_1.value=Ne.state.rectAreaLTC1,Bn.ltc_2.value=Ne.state.rectAreaLTC2,Bn.pointLights.value=Ne.state.point,Bn.pointLightShadows.value=Ne.state.pointShadow,Bn.hemisphereLights.value=Ne.state.hemi,Bn.directionalShadowMap.value=Ne.state.directionalShadowMap,Bn.directionalShadowMatrix.value=Ne.state.directionalShadowMatrix,Bn.spotShadowMap.value=Ne.state.spotShadowMap,Bn.spotLightMatrix.value=Ne.state.spotLightMatrix,Bn.spotLightMap.value=Ne.state.spotLightMap,Bn.pointShadowMap.value=Ne.state.pointShadowMap,Bn.pointShadowMatrix.value=Ne.state.pointShadowMatrix);const dr=kn.getUniforms(),_o=Ru.seqWithValue(dr.seq,Bn);return pe.currentProgram=kn,pe.uniformsList=_o,kn}function El(G,_e){const Ie=Bt.get(G);Ie.outputEncoding=_e.outputEncoding,Ie.instancing=_e.instancing,Ie.skinning=_e.skinning,Ie.morphTargets=_e.morphTargets,Ie.morphNormals=_e.morphNormals,Ie.morphColors=_e.morphColors,Ie.morphTargetsCount=_e.morphTargetsCount,Ie.numClippingPlanes=_e.numClippingPlanes,Ie.numIntersection=_e.numClipIntersection,Ie.vertexAlphas=_e.vertexAlphas,Ie.vertexTangents=_e.vertexTangents,Ie.toneMapping=_e.toneMapping}Nt.setAnimationLoop(function Re(G){ne&&ne(G)}),typeof self<"u"&&Nt.setContext(self),this.setAnimationLoop=function(G){ne=G,_t.setAnimationLoop(G),null===G?Nt.stop():Nt.start()},_t.addEventListener("sessionstart",tt),_t.addEventListener("sessionend",At),this.render=function(G,_e){if(void 0===_e||!0===_e.isCamera){if(!0!==w){if(!0===G.matrixWorldAutoUpdate&&G.updateMatrixWorld(),null===_e.parent&&!0===_e.matrixWorldAutoUpdate&&_e.updateMatrixWorld(),!0===_t.enabled&&!0===_t.isPresenting&&(!0===_t.cameraAutoUpdate&&_t.updateCamera(_e),_e=_t.getCamera()),!0===G.isScene&&G.onBeforeRender(_,G,_e,T),p=jn.get(G,x.length),p.init(),x.push(p),ut.multiplyMatrices(_e.projectionMatrix,_e.matrixWorldInverse),ve.setFromProjectionMatrix(ut),Me=this.localClippingEnabled,se=$.init(this.clippingPlanes,Me),f=ii.get(G,y.length),f.init(),y.push(f),wi(G,_e,0,_.sortObjects),f.finish(),!0===_.sortObjects&&f.sort(Ee,te),!0===se&&$.beginShadows(),z.render(p.state.shadowsArray,G,_e),!0===se&&$.endShadows(),!0===this.info.autoReset&&this.info.reset(),Ce.render(f,G),p.setupLights(_.useLegacyLights),_e.isArrayCamera){const pe=_e.cameras;for(let Ne=0,Qt=pe.length;Ne<Qt;Ne++){const fn=pe[Ne];Cr(f,G,fn,fn.viewport)}}else Cr(f,G,_e);null!==T&&(Ve.updateMultisampleRenderTarget(T),Ve.updateRenderTargetMipmap(T)),!0===G.isScene&&G.onAfterRender(_,G,_e),Z.resetDefaultState(),P=-1,k=null,x.pop(),p=x.length>0?x[x.length-1]:null,y.pop(),f=y.length>0?y[y.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(G,_e,Ie){Bt.get(G.texture).__webglTexture=_e,Bt.get(G.depthTexture).__webglTexture=Ie;const pe=Bt.get(G);pe.__hasExternalTextures=!0,pe.__hasExternalTextures&&(pe.__autoAllocateDepthBuffer=void 0===Ie,pe.__autoAllocateDepthBuffer||!0===et.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),pe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(G,_e){const Ie=Bt.get(G);Ie.__webglFramebuffer=_e,Ie.__useDefaultFramebuffer=void 0===_e},this.setRenderTarget=function(G,_e=0,Ie=0){T=G,S=_e,D=Ie;let pe=!0,Ne=null,Qt=!1,fn=!1;if(G){const In=Bt.get(G);void 0!==In.__useDefaultFramebuffer?(gt.bindFramebuffer(36160,null),pe=!1):void 0===In.__webglFramebuffer?Ve.setupRenderTarget(G):In.__hasExternalTextures&&Ve.rebindTextures(G,Bt.get(G.texture).__webglTexture,Bt.get(G.depthTexture).__webglTexture);const Zn=G.texture;(Zn.isData3DTexture||Zn.isDataArrayTexture||Zn.isCompressedArrayTexture)&&(fn=!0);const kn=Bt.get(G).__webglFramebuffer;G.isWebGLCubeRenderTarget?(Ne=kn[_e],Qt=!0):Ne=ft.isWebGL2&&G.samples>0&&!1===Ve.useMultisampledRTT(G)?Bt.get(G).__webglMultisampledFramebuffer:kn,H.copy(G.viewport),W.copy(G.scissor),R=G.scissorTest}else H.copy(ee).multiplyScalar(le).floor(),W.copy(ge).multiplyScalar(le).floor(),R=re;if(gt.bindFramebuffer(36160,Ne)&&ft.drawBuffers&&pe&&gt.drawBuffers(G,Ne),gt.viewport(H),gt.scissor(W),gt.setScissorTest(R),Qt){const In=Bt.get(G.texture);ue.framebufferTexture2D(36160,36064,34069+_e,In.__webglTexture,Ie)}else if(fn){const In=Bt.get(G.texture);ue.framebufferTextureLayer(36160,36064,In.__webglTexture,Ie||0,_e||0)}P=-1},this.readRenderTargetPixels=function(G,_e,Ie,pe,Ne,Qt,fn){if(!G||!G.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Tn=Bt.get(G).__webglFramebuffer;if(G.isWebGLCubeRenderTarget&&void 0!==fn&&(Tn=Tn[fn]),Tn){gt.bindFramebuffer(36160,Tn);try{const In=G.texture,Zn=In.format,kn=In.type;if(Zn!==Gi&&zt.convert(Zn)!==ue.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Bn=kn===hi&&(et.has("EXT_color_buffer_half_float")||ft.isWebGL2&&et.has("EXT_color_buffer_float"));if(!(kn===Vo||zt.convert(kn)===ue.getParameter(35738)||kn===ps&&(ft.isWebGL2||et.has("OES_texture_float")||et.has("WEBGL_color_buffer_float"))||Bn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");_e>=0&&_e<=G.width-pe&&Ie>=0&&Ie<=G.height-Ne&&ue.readPixels(_e,Ie,pe,Ne,zt.convert(Zn),zt.convert(kn),Qt)}finally{const In=null!==T?Bt.get(T).__webglFramebuffer:null;gt.bindFramebuffer(36160,In)}}},this.copyFramebufferToTexture=function(G,_e,Ie=0){const pe=Math.pow(2,-Ie),Ne=Math.floor(_e.image.width*pe),Qt=Math.floor(_e.image.height*pe);Ve.setTexture2D(_e,0),ue.copyTexSubImage2D(3553,Ie,0,0,G.x,G.y,Ne,Qt),gt.unbindTexture()},this.copyTextureToTexture=function(G,_e,Ie,pe=0){const Ne=_e.image.width,Qt=_e.image.height,fn=zt.convert(Ie.format),Tn=zt.convert(Ie.type);Ve.setTexture2D(Ie,0),ue.pixelStorei(37440,Ie.flipY),ue.pixelStorei(37441,Ie.premultiplyAlpha),ue.pixelStorei(3317,Ie.unpackAlignment),_e.isDataTexture?ue.texSubImage2D(3553,pe,G.x,G.y,Ne,Qt,fn,Tn,_e.image.data):_e.isCompressedTexture?ue.compressedTexSubImage2D(3553,pe,G.x,G.y,_e.mipmaps[0].width,_e.mipmaps[0].height,fn,_e.mipmaps[0].data):ue.texSubImage2D(3553,pe,G.x,G.y,fn,Tn,_e.image),0===pe&&Ie.generateMipmaps&&ue.generateMipmap(3553),gt.unbindTexture()},this.copyTextureToTexture3D=function(G,_e,Ie,pe,Ne=0){if(_.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Qt=G.max.x-G.min.x+1,fn=G.max.y-G.min.y+1,Tn=G.max.z-G.min.z+1,In=zt.convert(pe.format),Zn=zt.convert(pe.type);let kn;if(pe.isData3DTexture)Ve.setTexture3D(pe,0),kn=32879;else{if(!pe.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Ve.setTexture2DArray(pe,0),kn=35866}ue.pixelStorei(37440,pe.flipY),ue.pixelStorei(37441,pe.premultiplyAlpha),ue.pixelStorei(3317,pe.unpackAlignment);const Bn=ue.getParameter(3314),dr=ue.getParameter(32878),_o=ue.getParameter(3316),Pc=ue.getParameter(3315),ah=ue.getParameter(32877),hr=Ie.isCompressedTexture?Ie.mipmaps[0]:Ie.image;ue.pixelStorei(3314,hr.width),ue.pixelStorei(32878,hr.height),ue.pixelStorei(3316,G.min.x),ue.pixelStorei(3315,G.min.y),ue.pixelStorei(32877,G.min.z),Ie.isDataTexture||Ie.isData3DTexture?ue.texSubImage3D(kn,Ne,_e.x,_e.y,_e.z,Qt,fn,Tn,In,Zn,hr.data):Ie.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ue.compressedTexSubImage3D(kn,Ne,_e.x,_e.y,_e.z,Qt,fn,Tn,In,hr.data)):ue.texSubImage3D(kn,Ne,_e.x,_e.y,_e.z,Qt,fn,Tn,In,Zn,hr),ue.pixelStorei(3314,Bn),ue.pixelStorei(32878,dr),ue.pixelStorei(3316,_o),ue.pixelStorei(3315,Pc),ue.pixelStorei(32877,ah),0===Ne&&pe.generateMipmaps&&ue.generateMipmap(kn),gt.unbindTexture()},this.initTexture=function(G){G.isCubeTexture?Ve.setTextureCube(G,0):G.isData3DTexture?Ve.setTexture3D(G,0):G.isDataArrayTexture||G.isCompressedArrayTexture?Ve.setTexture2DArray(G,0):Ve.setTexture2D(G,0),gt.unbindTexture()},this.resetState=function(){S=0,D=0,T=null,gt.reset(),Z.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(Ou.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(i){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!i}}}),class Tw extends Ou{}.prototype.isWebGL1Renderer=!0;class bf extends Li{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class Nu{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=mr()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,o=this.stride;r<o;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=mr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=mr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Tr=new V;class hl{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Tr.fromBufferAttribute(this,t),Tr.applyMatrix4(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Tr.fromBufferAttribute(this,t),Tr.applyNormalMatrix(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Tr.fromBufferAttribute(this,t),Tr.transformDirection(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}setX(e,t){return this.normalized&&(t=Jn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Jn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Jn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Jn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ns(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ns(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ns(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ns(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Jn(t,this.array),n=Jn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Jn(t,this.array),n=Jn(n,this.array),r=Jn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=Jn(t,this.array),n=Jn(n,this.array),r=Jn(r,this.array),o=Jn(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=o,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return new Oi(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new hl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const $0=new V,q0=new ei,Y0=new ei,Dw=new V,X0=new an;class gm extends er{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new an,this.bindMatrixInverse=new an}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ei,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;q0.fromBufferAttribute(r.attributes.skinIndex,e),Y0.fromBufferAttribute(r.attributes.skinWeight,e),$0.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const l=Y0.getComponent(o);if(0!==l){const c=q0.getComponent(o);X0.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(Dw.copy($0).applyMatrix4(X0),l)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Af extends Li{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ku extends gs{constructor(e=null,t=1,n=1,r,o,l,c,u,d=ti,h=ti,f,p){super(null,l,c,u,d,h,r,o,f,p),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const ym=new an,Z0=new an;class Bd{constructor(e=[],t=[]){this.uuid=mr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new an)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new an;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let o=0,l=e.length;o<l;o++)ym.multiplyMatrices(e[o]?e[o].matrixWorld:Z0,t[o]),ym.toArray(n,16*o);null!==r&&(r.needsUpdate=!0)}clone(){return new Bd(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Nh(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new ku(t,e,e,Gi,ps);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const o=e.bones[n];let l=t[o];void 0===l&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),l=new Af),this.bones.push(l),this.boneInverses.push((new an).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,o=t.length;r<o;r++)e.bones.push(t[r].uuid),e.boneInverses.push(n[r].toArray());return e}}class Bu extends Oi{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const vm=new an,_m=new an,Ud=[],K0=new an,po=new er;class Q0 extends er{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Bu(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let r=0;r<n;r++)this.setMatrixAt(r,K0)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(po.geometry=this.geometry,po.material=this.material,void 0!==po.material)for(let o=0;o<r;o++){this.getMatrixAt(o,vm),_m.multiplyMatrices(n,vm),po.matrixWorld=_m,po.raycast(e,Ud);for(let l=0,c=Ud.length;l<c;l++){const u=Ud[l];u.instanceId=o,u.object=this,t.push(u)}Ud.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Bu(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class rs extends Gn{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new xt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const pc=new V,Iw=new V,Cf=new an,J0=new jh,zd=new $o;class fl extends Li{constructor(e=new cn,t=new rs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let r=1,o=t.count;r<o;r++)pc.fromBufferAttribute(t,r-1),Iw.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=pc.distanceTo(Iw);e.setAttribute("lineDistance",new It(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,l=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),zd.copy(n.boundingSphere),zd.applyMatrix4(r),zd.radius+=o,!1===e.ray.intersectsSphere(zd))return;Cf.copy(r).invert(),J0.copy(e.ray).applyMatrix4(Cf);const c=o/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,d=new V,h=new V,f=new V,p=new V,y=this.isLineSegments?2:1,x=n.index,w=n.attributes.position;if(null!==x)for(let T=Math.max(0,l.start),P=Math.min(x.count,l.start+l.count)-1;T<P;T+=y){const k=x.getX(T),H=x.getX(T+1);if(d.fromBufferAttribute(w,k),h.fromBufferAttribute(w,H),J0.distanceSqToSegment(d,h,p,f)>u)continue;p.applyMatrix4(this.matrixWorld);const R=e.ray.origin.distanceTo(p);R<e.near||R>e.far||t.push({distance:R,point:f.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}else for(let T=Math.max(0,l.start),P=Math.min(w.count,l.start+l.count)-1;T<P;T+=y){if(d.fromBufferAttribute(w,T),h.fromBufferAttribute(w,T+1),J0.distanceSqToSegment(d,h,p,f)>u)continue;p.applyMatrix4(this.matrixWorld);const H=e.ray.origin.distanceTo(p);H<e.near||H>e.far||t.push({distance:H,point:f.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){const c=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}}const Pw=new V,jt=new V;class Df extends fl{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let r=0,o=t.count;r<o;r+=2)Pw.fromBufferAttribute(t,r),jt.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Pw.distanceTo(jt);e.setAttribute("lineDistance",new It(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class ev extends fl{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class xm extends Gn{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new xt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const mc=new an,wm=new jh,gc=new $o,yc=new V;class vi extends Li{constructor(e=new cn,t=new xm){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,l=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),gc.copy(n.boundingSphere),gc.applyMatrix4(r),gc.radius+=o,!1===e.ray.intersectsSphere(gc))return;mc.copy(r).invert(),wm.copy(e.ray).applyMatrix4(mc);const c=o/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,d=n.index,f=n.attributes.position;if(null!==d)for(let x=Math.max(0,l.start),_=Math.min(d.count,l.start+l.count);x<_;x++){const w=d.getX(x);yc.fromBufferAttribute(f,w),Rw(yc,w,u,r,e,t,this)}else for(let x=Math.max(0,l.start),_=Math.min(f.count,l.start+l.count);x<_;x++)yc.fromBufferAttribute(f,x),Rw(yc,x,u,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){const c=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}}function Rw(i,e,t,n,r,o,l){const c=wm.distanceSqToPoint(i);if(c<t){const u=new V;wm.closestPointToPoint(i,u),u.applyMatrix4(n);const d=r.ray.origin.distanceTo(u);if(d<r.near||d>r.far)return;o.push({distance:d,distanceToRay:Math.sqrt(c),point:u,index:e,face:null,object:l})}}class $d extends cn{constructor(e=1,t=1,n=1,r=32,o=1,l=!1,c=0,u=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:o,openEnded:l,thetaStart:c,thetaLength:u};const d=this;r=Math.floor(r),o=Math.floor(o);const h=[],f=[],p=[],y=[];let x=0;const _=[],w=n/2;let S=0;function T(P){const k=x,H=new Oe,W=new V;let R=0;const B=!0===P?e:t,X=!0===P?1:-1;for(let Ee=1;Ee<=r;Ee++)f.push(0,w*X,0),p.push(0,X,0),y.push(.5,.5),x++;const le=x;for(let Ee=0;Ee<=r;Ee++){const ee=Ee/r*u+c,ge=Math.cos(ee),re=Math.sin(ee);W.x=B*re,W.y=w*X,W.z=B*ge,f.push(W.x,W.y,W.z),p.push(0,X,0),H.x=.5*ge+.5,H.y=.5*re*X+.5,y.push(H.x,H.y),x++}for(let Ee=0;Ee<r;Ee++){const te=k+Ee,ee=le+Ee;!0===P?h.push(ee,ee+1,te):h.push(ee+1,ee,te),R+=3}d.addGroup(S,R,!0===P?1:2),S+=R}(function D(){const P=new V,k=new V;let H=0;const W=(t-e)/n;for(let R=0;R<=o;R++){const B=[],X=R/o,le=X*(t-e)+e;for(let Ee=0;Ee<=r;Ee++){const te=Ee/r,ee=te*u+c,ge=Math.sin(ee),re=Math.cos(ee);k.x=le*ge,k.y=-X*n+w,k.z=le*re,f.push(k.x,k.y,k.z),P.set(ge,W,re).normalize(),p.push(P.x,P.y,P.z),y.push(te,1-X),B.push(x++)}_.push(B)}for(let R=0;R<r;R++)for(let B=0;B<o;B++){const le=_[B+1][R],Ee=_[B+1][R+1],te=_[B][R+1];h.push(_[B][R],le,te),h.push(le,Ee,te),H+=6}d.addGroup(S,H,0),S+=H})(),!1===l&&(e>0&&T(!0),t>0&&T(!1)),this.setIndex(h),this.setAttribute("position",new It(f,3)),this.setAttribute("normal",new It(p,3)),this.setAttribute("uv",new It(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $d(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Da extends cn{constructor(e=1,t=32,n=16,r=0,o=2*Math.PI,l=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:o,thetaStart:l,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const u=Math.min(l+c,Math.PI);let d=0;const h=[],f=new V,p=new V,y=[],x=[],_=[],w=[];for(let S=0;S<=n;S++){const D=[],T=S/n;let P=0;0==S&&0==l?P=.5/t:S==n&&u==Math.PI&&(P=-.5/t);for(let k=0;k<=t;k++){const H=k/t;f.x=-e*Math.cos(r+H*o)*Math.sin(l+T*c),f.y=e*Math.cos(l+T*c),f.z=e*Math.sin(r+H*o)*Math.sin(l+T*c),x.push(f.x,f.y,f.z),p.copy(f).normalize(),_.push(p.x,p.y,p.z),w.push(H+P,1-T),D.push(d++)}h.push(D)}for(let S=0;S<n;S++)for(let D=0;D<t;D++){const P=h[S][D],k=h[S+1][D],H=h[S+1][D+1];(0!==S||l>0)&&y.push(h[S][D+1],P,H),(S!==n-1||u<Math.PI)&&y.push(P,k,H)}this.setIndex(y),this.setAttribute("position",new It(x,3)),this.setAttribute("normal",new It(_,3)),this.setAttribute("uv",new It(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Da(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Gu extends Gn{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new xt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yl,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class gl extends Gu{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Oe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ti(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new xt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new xt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new xt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Qd extends Gn{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new xt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yl,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}function ks(i,e,t){return Vm(i)?new i.constructor(i.subarray(e,void 0!==t?t:i.length)):i.slice(e,t)}function wc(i,e,t){return!i||!t&&i.constructor===e?i:"number"==typeof e.BYTES_PER_ELEMENT?new e(i):Array.prototype.slice.call(i)}function Vm(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function Sv(i){const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function e(r,o){return i[r]-i[o]}),n}function Hf(i,e,t){const n=i.length,r=new i.constructor(n);for(let o=0,l=0;l!==n;++o){const c=t[o]*e;for(let u=0;u!==e;++u)r[l++]=i[c+u]}return r}function Ev(i,e,t,n){let r=1,o=i[0];for(;void 0!==o&&void 0===o[n];)o=i[r++];if(void 0===o)return;let l=o[n];if(void 0!==l)if(Array.isArray(l))do{l=o[n],void 0!==l&&(e.push(o.time),t.push.apply(t,l)),o=i[r++]}while(void 0!==o);else if(void 0!==l.toArray)do{l=o[n],void 0!==l&&(e.push(o.time),l.toArray(t,t.length)),o=i[r++]}while(void 0!==o);else do{l=o[n],void 0!==l&&(e.push(o.time),t.push(l)),o=i[r++]}while(void 0!==o)}class Vf{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],o=t[n-1];e:{t:{let l;n:{i:if(!(e<r)){for(let c=n+2;;){if(void 0===r){if(e<o)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(o=r,r=t[++n],e<r)break t}l=t.length;break n}if(e>=o)break e;{const c=t[1];e<c&&(n=2,o=c);for(let u=n-2;;){if(void 0===o)return this._cachedIndex=0,this.copySampleValue_(0);if(n===u)break;if(r=o,o=t[--n-1],e>=o)break t}l=n,n=0}}for(;n<l;){const c=n+l>>>1;e<t[c]?l=c:n=c+1}if(r=t[n],o=t[n-1],void 0===o)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,o,r)}return this.interpolate_(n,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r;for(let l=0;l!==r;++l)t[l]=n[o+l];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class rb extends Vf{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,n){const r=this.parameterPositions;let o=e-2,l=e+1,c=r[o],u=r[l];if(void 0===c)switch(this.getSettings_().endingStart){case 2401:o=e,c=2*t-n;break;case 2402:o=r.length-2,c=t+r[o]-r[o+1];break;default:o=e,c=n}if(void 0===u)switch(this.getSettings_().endingEnd){case 2401:l=e,u=2*n-t;break;case 2402:l=1,u=n+r[1]-r[0];break;default:l=e-1,u=t}const d=.5*(n-t),h=this.valueSize;this._weightPrev=d/(t-c),this._weightNext=d/(u-n),this._offsetPrev=o*h,this._offsetNext=l*h}interpolate_(e,t,n,r){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,u=e*c,d=u-c,h=this._offsetPrev,f=this._offsetNext,p=this._weightPrev,y=this._weightNext,x=(n-t)/(r-t),_=x*x,w=_*x,S=-p*w+2*p*_-p*x,D=(1+p)*w+(-1.5-2*p)*_+(-.5+p)*x+1,T=(-1-y)*w+(1.5+y)*_+.5*x,P=y*w-y*_;for(let k=0;k!==c;++k)o[k]=S*l[h+k]+D*l[d+k]+T*l[u+k]+P*l[f+k];return o}}class Av extends Vf{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,u=e*c,d=u-c,h=(n-t)/(r-t),f=1-h;for(let p=0;p!==c;++p)o[p]=l[d+p]*f+l[u+p]*h;return o}}class Cv extends Vf{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class go{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=wc(t,this.TimeBufferType),this.values=wc(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:wc(e.times,Array),values:wc(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Cv(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Av(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new rb(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case kr:t=this.InterpolantFactoryMethodDiscrete;break;case Sr:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return kr;case this.InterpolantFactoryMethodLinear:return Sr;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let o=0,l=r-1;for(;o!==r&&n[o]<e;)++o;for(;-1!==l&&n[l]>t;)--l;if(++l,0!==o||l!==r){o>=l&&(l=Math.max(l,1),o=l-1);const c=this.getValueSize();this.times=ks(n,o,l),this.values=ks(this.values,o*c,l*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,o=n.length;0===o&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let l=null;for(let c=0;c!==o;c++){const u=n[c];if("number"==typeof u&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,u),e=!1;break}if(null!==l&&l>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,u,l),e=!1;break}l=u}if(void 0!==r&&Vm(r))for(let c=0,u=r.length;c!==u;++c){const d=r[c];if(isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,d),e=!1;break}}return e}optimize(){const e=ks(this.times),t=ks(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),o=e.length-1;let l=1;for(let c=1;c<o;++c){let u=!1;const d=e[c];if(d!==e[c+1]&&(1!==c||d!==e[0]))if(r)u=!0;else{const f=c*n,p=f-n,y=f+n;for(let x=0;x!==n;++x){const _=t[f+x];if(_!==t[p+x]||_!==t[y+x]){u=!0;break}}}if(u){if(c!==l){e[l]=e[c];const f=c*n,p=l*n;for(let y=0;y!==n;++y)t[p+y]=t[f+y]}++l}}if(o>0){e[l]=e[o];for(let c=o*n,u=l*n,d=0;d!==n;++d)t[u+d]=t[c+d];++l}return l!==e.length?(this.times=ks(e,0,l),this.values=ks(t,0,l*n)):(this.times=e,this.values=t),this}clone(){const e=ks(this.times,0),t=ks(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}go.prototype.TimeBufferType=Float32Array,go.prototype.ValueBufferType=Float32Array,go.prototype.DefaultInterpolation=Sr;class bc extends go{}bc.prototype.ValueTypeName="bool",bc.prototype.ValueBufferType=Array,bc.prototype.DefaultInterpolation=kr,bc.prototype.InterpolantFactoryMethodLinear=void 0,bc.prototype.InterpolantFactoryMethodSmooth=void 0;class Dv extends go{}Dv.prototype.ValueTypeName="color";class Jd extends go{}Jd.prototype.ValueTypeName="number";class sb extends Vf{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,u=(n-t)/(r-t);let d=e*c;for(let h=d+c;d!==h;d+=4)gr.slerpFlat(o,0,l,d-c,l,d,u);return o}}class Mc extends go{InterpolantFactoryMethodLinear(e){return new sb(this.times,this.values,this.getValueSize(),e)}}Mc.prototype.ValueTypeName="quaternion",Mc.prototype.DefaultInterpolation=Sr,Mc.prototype.InterpolantFactoryMethodSmooth=void 0;class Wu extends go{}Wu.prototype.ValueTypeName="string",Wu.prototype.ValueBufferType=Array,Wu.prototype.DefaultInterpolation=kr,Wu.prototype.InterpolantFactoryMethodLinear=void 0,Wu.prototype.InterpolantFactoryMethodSmooth=void 0;class eh extends go{}eh.prototype.ValueTypeName="vector";class th{constructor(e,t=-1,n,r=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=mr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let l=0,c=n.length;l!==c;++l)t.push(Iv(n[l]).scale(r));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,l=n.length;o!==l;++o)t.push(go.toJSON(n[o]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const o=t.length,l=[];for(let c=0;c<o;c++){let u=[],d=[];u.push((c+o-1)%o,c,(c+1)%o),d.push(0,1,0);const h=Sv(u);u=Hf(u,1,h),d=Hf(d,1,h),!r&&0===u[0]&&(u.push(o),d.push(d[0])),l.push(new Jd(".morphTargetInfluences["+t[c].name+"]",u,d).scale(1/n))}return new this(e,-1,l)}static findByName(e,t){let n=e;Array.isArray(e)||(n=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},o=/^([\w-]*?)([\d]+)$/;for(let c=0,u=e.length;c<u;c++){const d=e[c],h=d.name.match(o);if(h&&h.length>1){const f=h[1];let p=r[f];p||(r[f]=p=[]),p.push(d)}}const l=[];for(const c in r)l.push(this.CreateFromMorphTargetSequence(c,r[c],t,n));return l}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(f,p,y,x,_){if(0!==y.length){const w=[],S=[];Ev(y,w,S,x),0!==w.length&&_.push(new f(p,w,S))}},r=[],o=e.name||"default",l=e.fps||30,c=e.blendMode;let u=e.length||-1;const d=e.hierarchy||[];for(let f=0;f<d.length;f++){const p=d[f].keys;if(p&&0!==p.length)if(p[0].morphTargets){const y={};let x;for(x=0;x<p.length;x++)if(p[x].morphTargets)for(let _=0;_<p[x].morphTargets.length;_++)y[p[x].morphTargets[_]]=-1;for(const _ in y){const w=[],S=[];for(let D=0;D!==p[x].morphTargets.length;++D){const T=p[x];w.push(T.time),S.push(T.morphTarget===_?1:0)}r.push(new Jd(".morphTargetInfluence["+_+"]",w,S))}u=y.length*l}else{const y=".bones["+t[f].name+"]";n(eh,y+".position",p,"pos",r),n(Mc,y+".quaternion",p,"rot",r),n(eh,y+".scale",p,"scl",r)}}return 0===r.length?null:new this(o,u,r,c)}resetDuration(){let t=0;for(let n=0,r=this.tracks.length;n!==r;++n){const o=this.tracks[n];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Iv(i){if(void 0===i.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function nh(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Jd;case"vector":case"vector2":case"vector3":case"vector4":return eh;case"color":return Dv;case"quaternion":return Mc;case"bool":case"boolean":return bc;case"string":return Wu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(i.type);if(void 0===i.times){const t=[],n=[];Ev(i.keys,t,n,"value"),i.times=t,i.values=n}return void 0!==e.parse?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Sc={enabled:!1,files:{},add:function(i,e){!1!==this.enabled&&(this.files[i]=e)},get:function(i){if(!1!==this.enabled)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class Gm{constructor(e,t,n){const r=this;let u,o=!1,l=0,c=0;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(h){c++,!1===o&&void 0!==r.onStart&&r.onStart(h,l,c),o=!0},this.itemEnd=function(h){l++,void 0!==r.onProgress&&r.onProgress(h,l,c),l===c&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(h){void 0!==r.onError&&r.onError(h)},this.resolveURL=function(h){return u?u(h):h},this.setURLModifier=function(h){return u=h,this},this.addHandler=function(h,f){return d.push(h,f),this},this.removeHandler=function(h){const f=d.indexOf(h);return-1!==f&&d.splice(f,2),this},this.getHandler=function(h){for(let f=0,p=d.length;f<p;f+=2){const y=d[f],x=d[f+1];if(y.global&&(y.lastIndex=0),y.test(h))return x}return null}}}const Pv=new Gm;class ju{constructor(e){this.manager=void 0!==e?e:Pv,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,o){n.load(e,r,t,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Ia={};class ob extends Error{constructor(e,t){super(e),this.response=t}}class Pa extends ju{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=Sc.get(e);if(void 0!==o)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(void 0!==Ia[e])return void Ia[e].push({onLoad:t,onProgress:n,onError:r});Ia[e]=[],Ia[e].push({onLoad:t,onProgress:n,onError:r});const l=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),c=this.mimeType,u=this.responseType;fetch(l).then(d=>{if(200===d.status||0===d.status){if(0===d.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===d.body||void 0===d.body.getReader)return d;const h=Ia[e],f=d.body.getReader(),p=d.headers.get("Content-Length")||d.headers.get("X-File-Size"),y=p?parseInt(p):0,x=0!==y;let _=0;const w=new ReadableStream({start(S){!function D(){f.read().then(({done:T,value:P})=>{if(T)S.close();else{_+=P.byteLength;const k=new ProgressEvent("progress",{lengthComputable:x,loaded:_,total:y});for(let H=0,W=h.length;H<W;H++){const R=h[H];R.onProgress&&R.onProgress(k)}S.enqueue(P),D()}})}()}});return new Response(w)}throw new ob(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`,d)}).then(d=>{switch(u){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(h=>(new DOMParser).parseFromString(h,c));case"json":return d.json();default:if(void 0===c)return d.text();{const f=/charset="?([^;"\s]*)"?/i.exec(c),p=f&&f[1]?f[1].toLowerCase():void 0,y=new TextDecoder(p);return d.arrayBuffer().then(x=>y.decode(x))}}}).then(d=>{Sc.add(e,d);const h=Ia[e];delete Ia[e];for(let f=0,p=h.length;f<p;f++){const y=h[f];y.onLoad&&y.onLoad(d)}}).catch(d=>{const h=Ia[e];if(void 0===h)throw this.manager.itemError(e),d;delete Ia[e];for(let f=0,p=h.length;f<p;f++){const y=h[f];y.onError&&y.onError(d)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Gf extends ju{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,l=Sc.get(e);if(void 0!==l)return o.manager.itemStart(e),setTimeout(function(){t&&t(l),o.manager.itemEnd(e)},0),l;const c=xd("img");function u(){h(),Sc.add(e,this),t&&t(this),o.manager.itemEnd(e)}function d(f){h(),r&&r(f),o.manager.itemError(e),o.manager.itemEnd(e)}function h(){c.removeEventListener("load",u,!1),c.removeEventListener("error",d,!1)}return c.addEventListener("load",u,!1),c.addEventListener("error",d,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(c.crossOrigin=this.crossOrigin),o.manager.itemStart(e),c.src=e,c}}class yl extends ju{constructor(e){super(e)}load(e,t,n,r){const o=new gs,l=new Gf(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(e,function(c){o.image=c,o.needsUpdate=!0,void 0!==t&&t(o)},n,r),o}}class Wf extends Li{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new xt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const Bs=new an,Rv=new V,jf=new V;class Ec{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Oe(512,512),this.map=null,this.mapPass=null,this.matrix=new an,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Bp,this._frameExtents=new Oe(1,1),this._viewportCount=1,this._viewports=[new ei(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Rv.setFromMatrixPosition(e.matrixWorld),t.position.copy(Rv),jf.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(jf),t.updateMatrixWorld(),Bs.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Bs),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Bs)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class ab extends Ec{constructor(){super(new ur(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*ji*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;(n!==t.fov||r!==t.aspect||o!==t.far)&&(t.fov=n,t.aspect=r,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Lv extends Wf{constructor(e,t,n=0,r=Math.PI/3,o=0,l=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Li.DEFAULT_UP),this.updateMatrix(),this.target=new Li,this.distance=n,this.angle=r,this.penumbra=o,this.decay=l,this.map=null,this.shadow=new ab}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Ov=new an,vl=new V,$u=new V;class lb extends Ec{constructor(){super(new ur(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Oe(4,2),this._viewportCount=6,this._viewports=[new ei(2,1,1,1),new ei(0,1,1,1),new ei(3,1,1,1),new ei(1,1,1,1),new ei(3,0,1,1),new ei(1,0,1,1)],this._cubeDirections=[new V(1,0,0),new V(-1,0,0),new V(0,0,1),new V(0,0,-1),new V(0,1,0),new V(0,-1,0)],this._cubeUps=[new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,0,1),new V(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,o=e.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),vl.setFromMatrixPosition(e.matrixWorld),n.position.copy(vl),$u.copy(n.position),$u.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt($u),n.updateMatrixWorld(),r.makeTranslation(-vl.x,-vl.y,-vl.z),Ov.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ov)}}class $f extends Wf{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new lb}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Nv extends Ec{constructor(){super(new lf(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class jm extends Wf{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Li.DEFAULT_UP),this.updateMatrix(),this.target=new Li,this.shadow=new Nv}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class qf extends Wf{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Tc{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Zm extends ju{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,l=Sc.get(e);if(void 0!==l)return o.manager.itemStart(e),setTimeout(function(){t&&t(l),o.manager.itemEnd(e)},0),l;const c={};c.credentials="anonymous"===this.crossOrigin?"same-origin":"include",c.headers=this.requestHeader,fetch(e,c).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(u){Sc.add(e,u),t&&t(u),o.manager.itemEnd(e)}).catch(function(u){r&&r(u),o.manager.itemError(e),o.manager.itemEnd(e)}),o.manager.itemStart(e)}}const eg="\\[\\]\\.:\\/",xb=new RegExp("["+eg+"]","g"),rh="[^"+eg+"]",Uv="[^"+eg.replace("\\.","")+"]",Hv=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",rh)+/(WCOD+)?/.source.replace("WCOD",Uv)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",rh)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",rh)+"$"),wb=["material","materials","bones","map"];class Vv{constructor(e,t,n){const r=n||Wn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=n.length;r!==o;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let Wn=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(xb,"")}static parseTrackName(t){const n=Hv.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},o=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==o&&-1!==o){const l=r.nodeName.substring(o+1);-1!==wb.indexOf(l)&&(r.nodeName=r.nodeName.substring(0,o),r.objectName=l)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(n);if(void 0!==r)return r}if(t.children){const r=function(l){for(let c=0;c<l.length;c++){const u=l[c];if(u.name===n||u.uuid===n)return u;const d=r(u.children);if(d)return d}return null},o=r(t.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)t[n++]=r[o]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)r[o]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)r[o]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)r[o]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,r=n.objectName,o=n.propertyName;let l=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let h=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let f=0;f<t.length;f++)if(t[f].name===h){h=f;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==h){if(void 0===t[h])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[h]}}const c=t[o];if(void 0===c)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+o+" but it wasn't found.",t);let u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(void 0!==l){if("morphTargetInfluences"===o){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[l]&&(l=t.morphTargetDictionary[l])}d=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=l}else void 0!==c.fromArray&&void 0!==c.toArray?(d=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(d=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=o;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=Vv,i})();Wn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Wn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Wn.prototype.GetterByBindingType=[Wn.prototype._getValue_direct,Wn.prototype._getValue_array,Wn.prototype._getValue_arrayElement,Wn.prototype._getValue_toArray],Wn.prototype.SetterByBindingTypeAndVersioning=[[Wn.prototype._setValue_direct,Wn.prototype._setValue_direct_setNeedsUpdate,Wn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Wn.prototype._setValue_array,Wn.prototype._setValue_array_setNeedsUpdate,Wn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Wn.prototype._setValue_arrayElement,Wn.prototype._setValue_arrayElement_setNeedsUpdate,Wn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Wn.prototype._setValue_fromArray,Wn.prototype._setValue_fromArray_setNeedsUpdate,Wn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class sg{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ti(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const $v=new V;let Qf,ug;class Jf extends Li{constructor(e=new V(0,0,1),t=new V(0,0,0),n=1,r=16776960,o=.2*n,l=.2*o){super(),this.type="ArrowHelper",void 0===Qf&&(Qf=new cn,Qf.setAttribute("position",new It([0,0,0,0,1,0],3)),ug=new $d(0,.5,1,5,1),ug.translate(0,-.5,0)),this.position.copy(t),this.line=new fl(Qf,new rs({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new er(ug,new Br({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,o,l)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{$v.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle($v,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class qv extends Df{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new cn;r.setAttribute("position",new It(t,3)),r.setAttribute("color",new It([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new rs({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new xt,o=this.geometry.attributes.color.array;return r.set(e),r.toArray(o,0),r.toArray(o,3),r.set(t),r.toArray(o,6),r.toArray(o,9),r.set(n),r.toArray(o,12),r.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Bl}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Bl);class dg{copyPosition(e){return new V(e.x,e.y,e.z)}isDefault(e){return 0===e.x&&0===e.y&&0===e.z}}function e_(i,e){if(e===b_)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===gp||e===M_){let t=i.getIndex();if(null===t){const l=[],c=i.getAttribute("position");if(void 0===c)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i;for(let u=0;u<c.count;u++)l.push(u);i.setIndex(l),t=i.getIndex()}const n=t.count-2,r=[];if(e===gp)for(let l=1;l<=n;l++)r.push(t.getX(0)),r.push(t.getX(l)),r.push(t.getX(l+1));else for(let l=0;l<n;l++)l%2==0?(r.push(t.getX(l)),r.push(t.getX(l+1)),r.push(t.getX(l+2))):(r.push(t.getX(l+2)),r.push(t.getX(l+1)),r.push(t.getX(l)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=i.clone();return o.setIndex(r),o.clearGroups(),o}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}class Gb extends ju{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new n_(t)}),this.register(function(t){return new a_(t)}),this.register(function(t){return new ep(t)}),this.register(function(t){return new tp(t)}),this.register(function(t){return new hg(t)}),this.register(function(t){return new i_(t)}),this.register(function(t){return new r_(t)}),this.register(function(t){return new s_(t)}),this.register(function(t){return new jb(t)}),this.register(function(t){return new o_(t)}),this.register(function(t){return new IS(t)}),this.register(function(t){return new DS(t)}),this.register(function(t){return new l_(t)}),this.register(function(t){return new $b(t)})}load(e,t,n,r){const o=this;let l;l=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Tc.extractUrlBase(e),this.manager.itemStart(e);const c=function(d){r?r(d):console.error(d),o.manager.itemError(e),o.manager.itemEnd(e)},u=new Pa(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(d){try{o.parse(d,l,function(h){t(h),o.manager.itemEnd(e)},c)}catch(h){c(h)}},n,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let o;const l={},c={},u=new TextDecoder;if("string"==typeof e)o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(u.decode(new Uint8Array(e,0,4))===qb){try{l[Dn.KHR_BINARY_GLTF]=new PS(e)}catch(f){return void(r&&r(f))}o=JSON.parse(l[Dn.KHR_BINARY_GLTF].content)}else o=JSON.parse(u.decode(e));else o=e;if(void 0===o.asset||o.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const d=new FS(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const f=this.pluginCallbacks[h](d);c[f.name]=f,l[f.name]=!0}if(o.extensionsUsed)for(let h=0;h<o.extensionsUsed.length;++h){const f=o.extensionsUsed[h],p=o.extensionsRequired||[];switch(f){case Dn.KHR_MATERIALS_UNLIT:l[f]=new t_;break;case Dn.KHR_DRACO_MESH_COMPRESSION:l[f]=new c_(o,this.dracoLoader);break;case Dn.KHR_TEXTURE_TRANSFORM:l[f]=new Xb;break;case Dn.KHR_MESH_QUANTIZATION:l[f]=new Zb;break;default:p.indexOf(f)>=0&&void 0===c[f]&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}d.setExtensions(l),d.setPlugins(c),d.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,o){n.parse(e,t,r,o)})}}function Wb(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const Dn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class DS{constructor(e){this.parser=e,this.name=Dn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const o=t[n];o.extensions&&o.extensions[this.name]&&void 0!==o.extensions[this.name].light&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const o=t.json,u=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let d;const h=new xt(16777215);void 0!==u.color&&h.fromArray(u.color);const f=void 0!==u.range?u.range:0;switch(u.type){case"directional":d=new jm(h),d.target.position.set(0,0,-1),d.add(d.target);break;case"point":d=new $f(h),d.distance=f;break;case"spot":d=new Lv(h),d.distance=f,u.spot=u.spot||{},u.spot.innerConeAngle=void 0!==u.spot.innerConeAngle?u.spot.innerConeAngle:0,u.spot.outerConeAngle=void 0!==u.spot.outerConeAngle?u.spot.outerConeAngle:Math.PI/4,d.angle=u.spot.outerConeAngle,d.penumbra=1-u.spot.innerConeAngle/u.spot.outerConeAngle,d.target.position.set(0,0,-1),d.add(d.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+u.type)}return d.position.set(0,0,0),d.decay=2,Zo(d,u),void 0!==u.intensity&&(d.intensity=u.intensity),d.name=t.createUniqueName(u.name||"light_"+e),r=Promise.resolve(d),t.cache.add(n,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,o=n.json.nodes[e],c=(o.extensions&&o.extensions[this.name]||{}).light;return void 0===c?null:this._loadLight(c).then(function(u){return n._getNodeRef(t.cache,c,u)})}}class t_{constructor(){this.name=Dn.KHR_MATERIALS_UNLIT}getMaterialType(){return Br}extendParams(e,t,n){const r=[];e.color=new xt(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const l=o.baseColorFactor;e.color.fromArray(l),e.opacity=l[3]}void 0!==o.baseColorTexture&&r.push(n.assignTexture(e,"map",o.baseColorTexture,Xn))}return Promise.all(r)}}class jb{constructor(e){this.parser=e,this.name=Dn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=r.extensions[this.name].emissiveStrength;return void 0!==o&&(t.emissiveIntensity=o),Promise.resolve()}}class n_{constructor(e){this.parser=e,this.name=Dn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?gl:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],l=r.extensions[this.name];if(void 0!==l.clearcoatFactor&&(t.clearcoat=l.clearcoatFactor),void 0!==l.clearcoatTexture&&o.push(n.assignTexture(t,"clearcoatMap",l.clearcoatTexture)),void 0!==l.clearcoatRoughnessFactor&&(t.clearcoatRoughness=l.clearcoatRoughnessFactor),void 0!==l.clearcoatRoughnessTexture&&o.push(n.assignTexture(t,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),void 0!==l.clearcoatNormalTexture&&(o.push(n.assignTexture(t,"clearcoatNormalMap",l.clearcoatNormalTexture)),void 0!==l.clearcoatNormalTexture.scale)){const c=l.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Oe(c,c)}return Promise.all(o)}}class IS{constructor(e){this.parser=e,this.name=Dn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?gl:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],l=r.extensions[this.name];return void 0!==l.iridescenceFactor&&(t.iridescence=l.iridescenceFactor),void 0!==l.iridescenceTexture&&o.push(n.assignTexture(t,"iridescenceMap",l.iridescenceTexture)),void 0!==l.iridescenceIor&&(t.iridescenceIOR=l.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==l.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=l.iridescenceThicknessMinimum),void 0!==l.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=l.iridescenceThicknessMaximum),void 0!==l.iridescenceThicknessTexture&&o.push(n.assignTexture(t,"iridescenceThicknessMap",l.iridescenceThicknessTexture)),Promise.all(o)}}class hg{constructor(e){this.parser=e,this.name=Dn.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?gl:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new xt(0,0,0),t.sheenRoughness=0,t.sheen=1;const l=r.extensions[this.name];return void 0!==l.sheenColorFactor&&t.sheenColor.fromArray(l.sheenColorFactor),void 0!==l.sheenRoughnessFactor&&(t.sheenRoughness=l.sheenRoughnessFactor),void 0!==l.sheenColorTexture&&o.push(n.assignTexture(t,"sheenColorMap",l.sheenColorTexture,Xn)),void 0!==l.sheenRoughnessTexture&&o.push(n.assignTexture(t,"sheenRoughnessMap",l.sheenRoughnessTexture)),Promise.all(o)}}class i_{constructor(e){this.parser=e,this.name=Dn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?gl:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],l=r.extensions[this.name];return void 0!==l.transmissionFactor&&(t.transmission=l.transmissionFactor),void 0!==l.transmissionTexture&&o.push(n.assignTexture(t,"transmissionMap",l.transmissionTexture)),Promise.all(o)}}class r_{constructor(e){this.parser=e,this.name=Dn.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?gl:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],l=r.extensions[this.name];t.thickness=void 0!==l.thicknessFactor?l.thicknessFactor:0,void 0!==l.thicknessTexture&&o.push(n.assignTexture(t,"thicknessMap",l.thicknessTexture)),t.attenuationDistance=l.attenuationDistance||1/0;const c=l.attenuationColor||[1,1,1];return t.attenuationColor=new xt(c[0],c[1],c[2]),Promise.all(o)}}class s_{constructor(e){this.parser=e,this.name=Dn.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?gl:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=r.extensions[this.name];return t.ior=void 0!==o.ior?o.ior:1.5,Promise.resolve()}}class o_{constructor(e){this.parser=e,this.name=Dn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?gl:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],l=r.extensions[this.name];t.specularIntensity=void 0!==l.specularFactor?l.specularFactor:1,void 0!==l.specularTexture&&o.push(n.assignTexture(t,"specularIntensityMap",l.specularTexture));const c=l.specularColorFactor||[1,1,1];return t.specularColor=new xt(c[0],c[1],c[2]),void 0!==l.specularColorTexture&&o.push(n.assignTexture(t,"specularColorMap",l.specularColorTexture,Xn)),Promise.all(o)}}class a_{constructor(e){this.parser=e,this.name=Dn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const o=r.extensions[this.name],l=t.options.ktx2Loader;if(!l){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,l)}}class ep{constructor(e){this.parser=e,this.name=Dn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const l=o.extensions[t],c=r.images[l.source];let u=n.textureLoader;if(c.uri){const d=n.options.manager.getHandler(c.uri);null!==d&&(u=d)}return this.detectSupport().then(function(d){if(d)return n.loadTextureImage(e,l.source,u);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class tp{constructor(e){this.parser=e,this.name=Dn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const l=o.extensions[t],c=r.images[l.source];let u=n.textureLoader;if(c.uri){const d=n.options.manager.getHandler(c.uri);null!==d&&(u=d)}return this.detectSupport().then(function(d){if(d)return n.loadTextureImage(e,l.source,u);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class l_{constructor(e){this.name=Dn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],o=this.parser.getDependency("buffer",r.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(c){const h=r.count,f=r.byteStride,p=new Uint8Array(c,r.byteOffset||0,r.byteLength||0);return l.decodeGltfBufferAsync?l.decodeGltfBufferAsync(h,f,p,r.mode,r.filter).then(function(y){return y.buffer}):l.ready.then(function(){const y=new ArrayBuffer(h*f);return l.decodeGltfBuffer(new Uint8Array(y),h,f,p,r.mode,r.filter),y})})}return null}}class $b{constructor(e){this.name=Dn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=t.meshes[n.mesh];for(const d of r.primitives)if(d.mode!==vo.TRIANGLES&&d.mode!==vo.TRIANGLE_STRIP&&d.mode!==vo.TRIANGLE_FAN&&void 0!==d.mode)return null;const l=n.extensions[this.name].attributes,c=[],u={};for(const d in l)c.push(this.parser.getDependency("accessor",l[d]).then(h=>(u[d]=h,u[d])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(d=>{const h=d.pop(),f=h.isGroup?h.children:[h],p=d[0].count,y=[];for(const x of f){const _=new an,w=new V,S=new gr,D=new V(1,1,1),T=new Q0(x.geometry,x.material,p);for(let P=0;P<p;P++)u.TRANSLATION&&w.fromBufferAttribute(u.TRANSLATION,P),u.ROTATION&&S.fromBufferAttribute(u.ROTATION,P),u.SCALE&&D.fromBufferAttribute(u.SCALE,P),T.setMatrixAt(P,_.compose(w,S,D));for(const P in u)"TRANSLATION"!==P&&"ROTATION"!==P&&"SCALE"!==P&&x.geometry.setAttribute(P,u[P]);Li.prototype.copy.call(T,x),T.frustumCulled=!1,this.parser.assignFinalMaterial(T),y.push(T)}return h.isGroup?(h.clear(),h.add(...y),h):y[0]}))}}const qb="glTF";class PS{constructor(e){this.name=Dn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==qb)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,o=new DataView(e,12);let l=0;for(;l<r;){const c=o.getUint32(l,!0);l+=4;const u=o.getUint32(l,!0);if(l+=4,1313821514===u){const d=new Uint8Array(e,12+l,c);this.content=n.decode(d)}else if(5130562===u){const d=12+l;this.body=e.slice(d,d+c)}l+=c}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class c_{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Dn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,c={},u={},d={};for(const h in l){const f=fg[h]||h.toLowerCase();c[f]=l[h]}for(const h in e.attributes){const f=fg[h]||h.toLowerCase();if(void 0!==l[h]){const p=n.accessors[e.attributes[h]];d[f]=sh[p.componentType].name,u[f]=!0===p.normalized}}return t.getDependency("bufferView",o).then(function(h){return new Promise(function(f){r.decodeDracoFile(h,function(p){for(const y in p.attributes){const _=u[y];void 0!==_&&(p.attributes[y].normalized=_)}f(p)},c,d)})})}}class Xb{constructor(){this.name=Dn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Zb{constructor(){this.name=Dn.KHR_MESH_QUANTIZATION}}class u_ extends Vf{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r*3+r;for(let l=0;l!==r;l++)t[l]=n[o+l];return t}interpolate_(e,t,n,r){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,u=2*c,d=3*c,h=r-t,f=(n-t)/h,p=f*f,y=p*f,x=e*d,_=x-d,w=-2*y+3*p,S=y-p,D=1-w,T=S-p+f;for(let P=0;P!==c;P++)o[P]=D*l[_+P+c]+T*(l[_+P+u]*h)+w*l[x+P+c]+S*(l[x+P]*h);return o}}const RS=new gr;class LS extends u_{interpolate_(e,t,n,r){const o=super.interpolate_(e,t,n,r);return RS.fromArray(o).normalize().toArray(o),o}}const vo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},sh={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Kb={9728:ti,9729:Qn,9984:ts,9985:or,9986:Xa,9987:br},d_={33071:Ei,33648:Vl,10497:Ho},Zu={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},fg={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},wl={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},h_={CUBICSPLINE:void 0,LINEAR:Sr,STEP:kr};function Ic(i,e,t){for(const n in t.extensions)void 0===i[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Zo(i,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function pg(i,e){if(i.updateMorphTargets(),void 0!==e.weights)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function mg(i){const e=i.extensions&&i.extensions[Dn.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+oh(e.attributes):i.indices+":"+oh(i.attributes)+":"+i.mode,t}function oh(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function p_(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const NS=new an;class FS{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Wb,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,o=-1;typeof navigator<"u"&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,o=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||n||r&&o<98?new yl(this.options.manager):new Zm(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Pa(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(l){return l._markDefs&&l._markDefs()}),Promise.all(this._invokeAll(function(l){return l.beforeRoot&&l.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(l){const c={scene:l[0][r.scene||0],scenes:l[0],animations:l[1],cameras:l[2],asset:r.asset,parser:n,userData:{}};Ic(o,c,r),Zo(c,r),Promise.all(n._invokeAll(function(u){return u.afterRoot&&u.afterRoot(c)})).then(function(){e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,o=t.length;r<o;r++){const l=t[r].joints;for(let c=0,u=l.length;c<u;c++)e[l[c]].isBone=!0}for(let r=0,o=e.length;r<o;r++){const l=e[r];void 0!==l.mesh&&(this._addNodeRef(this.meshCache,l.mesh),void 0!==l.skin&&(n[l.mesh].isSkinnedMesh=!0)),void 0!==l.camera&&this._addNodeRef(this.cameraCache,l.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),o=(l,c)=>{const u=this.associations.get(l);null!=u&&this.associations.set(c,u);for(const[d,h]of l.children.entries())o(h,c.children[d])};return o(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const o=e(t[r]);o&&n.push(o)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":r=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(o,l){return n.getDependency(e,l)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Dn.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(o,l){n.load(Tc.resolveURL(t.uri,r.path),o,void 0,function(){l(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const o=t.byteOffset||0;return n.slice(o,o+(t.byteLength||0))})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const l=Zu[r.type],u=!0===r.normalized,d=new(0,sh[r.componentType])(r.count*l);return Promise.resolve(new Oi(d,l,u))}const o=[];return o.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then(function(l){const c=l[0],u=Zu[r.type],d=sh[r.componentType],h=d.BYTES_PER_ELEMENT,p=r.byteOffset||0,y=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,x=!0===r.normalized;let _,w;if(y&&y!==h*u){const S=Math.floor(p/y),D="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+S+":"+r.count;let T=t.cache.get(D);T||(_=new d(c,S*y,r.count*y/h),T=new Nu(_,y/h),t.cache.add(D,T)),w=new hl(T,u,p%y/h,x)}else _=null===c?new d(r.count*u):new d(c,p,r.count*u),w=new Oi(_,u,x);if(void 0!==r.sparse){const P=r.sparse.values.byteOffset||0,k=new(0,sh[r.sparse.indices.componentType])(l[1],r.sparse.indices.byteOffset||0,r.sparse.count*Zu.SCALAR),H=new d(l[2],P,r.sparse.count*u);null!==c&&(w=new Oi(w.array.slice(),w.itemSize,w.normalized));for(let W=0,R=k.length;W<R;W++){const B=k[W];if(w.setX(B,H[W*u]),u>=2&&w.setY(B,H[W*u+1]),u>=3&&w.setZ(B,H[W*u+2]),u>=4&&w.setW(B,H[W*u+3]),u>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return w})}loadTexture(e){const t=this.json,o=t.textures[e].source,l=t.images[o];let c=this.textureLoader;if(l.uri){const u=this.options.manager.getHandler(l.uri);null!==u&&(c=u)}return this.loadTextureImage(e,o,c)}loadTextureImage(e,t,n){const r=this,o=this.json,l=o.textures[e],c=o.images[t],u=(c.uri||c.bufferView)+":"+l.sampler;if(this.textureCache[u])return this.textureCache[u];const d=this.loadImageSource(t,n).then(function(h){h.flipY=!1,h.name=l.name||c.name||"";const p=(o.samplers||{})[l.sampler]||{};return h.magFilter=Kb[p.magFilter]||Qn,h.minFilter=Kb[p.minFilter]||br,h.wrapS=d_[p.wrapS]||Ho,h.wrapT=d_[p.wrapT]||Ho,r.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[u]=d,d}loadImageSource(e,t){const r=this.json,o=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(f=>f.clone());const l=r.images[e],c=self.URL||self.webkitURL;let u=l.uri||"",d=!1;if(void 0!==l.bufferView)u=this.getDependency("bufferView",l.bufferView).then(function(f){d=!0;const p=new Blob([f],{type:l.mimeType});return u=c.createObjectURL(p),u});else if(void 0===l.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(u).then(function(f){return new Promise(function(p,y){let x=p;!0===t.isImageBitmapLoader&&(x=function(_){const w=new gs(_);w.needsUpdate=!0,p(w)}),t.load(Tc.resolveURL(f,o.path),x,void 0,y)})}).then(function(f){return!0===d&&c.revokeObjectURL(u),f.userData.mimeType=l.mimeType||function OS(i){return i.search(/\.jpe?g($|\?)/i)>0||0===i.search(/^data\:image\/jpeg/)?"image/jpeg":i.search(/\.webp($|\?)/i)>0||0===i.search(/^data\:image\/webp/)?"image/webp":"image/png"}(l.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",u),f});return this.sourceCache[e]=h,h}assignTexture(e,t,n,r){const o=this;return this.getDependency("texture",n.index).then(function(l){if(!l)return null;if(void 0!==n.texCoord&&0!=n.texCoord&&!("aoMap"===t&&1==n.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),o.extensions[Dn.KHR_TEXTURE_TRANSFORM]){const c=void 0!==n.extensions?n.extensions[Dn.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const u=o.associations.get(l);l=o.extensions[Dn.KHR_TEXTURE_TRANSFORM].extendTexture(l,c),o.associations.set(l,u)}}return void 0!==r&&(l.encoding=r),e[t]=l,l})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,o=void 0!==t.attributes.color,l=void 0===t.attributes.normal;if(e.isPoints){const c="PointsMaterial:"+n.uuid;let u=this.cache.get(c);u||(u=new xm,Gn.prototype.copy.call(u,n),u.color.copy(n.color),u.map=n.map,u.sizeAttenuation=!1,this.cache.add(c,u)),n=u}else if(e.isLine){const c="LineBasicMaterial:"+n.uuid;let u=this.cache.get(c);u||(u=new rs,Gn.prototype.copy.call(u,n),u.color.copy(n.color),this.cache.add(c,u)),n=u}if(r||o||l){let c="ClonedMaterial:"+n.uuid+":";r&&(c+="derivative-tangents:"),o&&(c+="vertex-colors:"),l&&(c+="flat-shading:");let u=this.cache.get(c);u||(u=n.clone(),o&&(u.vertexColors=!0),l&&(u.flatShading=!0),r&&(u.normalScale&&(u.normalScale.y*=-1),u.clearcoatNormalScale&&(u.clearcoatNormalScale.y*=-1)),this.cache.add(c,u),this.associations.set(u,this.associations.get(n))),n=u}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return Gu}loadMaterial(e){const t=this,r=this.extensions,o=this.json.materials[e];let l;const c={},d=[];if((o.extensions||{})[Dn.KHR_MATERIALS_UNLIT]){const f=r[Dn.KHR_MATERIALS_UNLIT];l=f.getMaterialType(),d.push(f.extendParams(c,o,t))}else{const f=o.pbrMetallicRoughness||{};if(c.color=new xt(1,1,1),c.opacity=1,Array.isArray(f.baseColorFactor)){const p=f.baseColorFactor;c.color.fromArray(p),c.opacity=p[3]}void 0!==f.baseColorTexture&&d.push(t.assignTexture(c,"map",f.baseColorTexture,Xn)),c.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,c.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(d.push(t.assignTexture(c,"metalnessMap",f.metallicRoughnessTexture)),d.push(t.assignTexture(c,"roughnessMap",f.metallicRoughnessTexture))),l=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),d.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,c)})))}!0===o.doubleSided&&(c.side=wr);const h=o.alphaMode||"OPAQUE";if("BLEND"===h?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,"MASK"===h&&(c.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&l!==Br&&(d.push(t.assignTexture(c,"normalMap",o.normalTexture)),c.normalScale=new Oe(1,1),void 0!==o.normalTexture.scale)){const f=o.normalTexture.scale;c.normalScale.set(f,f)}return void 0!==o.occlusionTexture&&l!==Br&&(d.push(t.assignTexture(c,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(c.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&l!==Br&&(c.emissive=(new xt).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&l!==Br&&d.push(t.assignTexture(c,"emissiveMap",o.emissiveTexture,Xn)),Promise.all(d).then(function(){const f=new l(c);return o.name&&(f.name=o.name),Zo(f,o),t.associations.set(f,{materials:e}),o.extensions&&Ic(r,f,o),f})}createUniqueName(e){const t=Wn.sanitizeNodeName(e||"");let n=t;for(let r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function o(c){return n[Dn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(u){return g_(u,c,t)})}const l=[];for(let c=0,u=e.length;c<u;c++){const d=e[c],h=mg(d),f=r[h];if(f)l.push(f.promise);else{let p;p=d.extensions&&d.extensions[Dn.KHR_DRACO_MESH_COMPRESSION]?o(d):g_(new cn,d,t),r[h]={primitive:d,promise:p},l.push(p)}}return Promise.all(l)}loadMesh(e){const t=this,r=this.extensions,o=this.json.meshes[e],l=o.primitives,c=[];for(let u=0,d=l.length;u<d;u++){const h=void 0===l[u].material?(void 0===(i=this.cache).DefaultMaterial&&(i.DefaultMaterial=new Gu({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Qi})),i.DefaultMaterial):this.getDependency("material",l[u].material);c.push(h)}var i;return c.push(t.loadGeometries(l)),Promise.all(c).then(function(u){const d=u.slice(0,u.length-1),h=u[u.length-1],f=[];for(let y=0,x=h.length;y<x;y++){const _=h[y],w=l[y];let S;const D=d[y];if(w.mode===vo.TRIANGLES||w.mode===vo.TRIANGLE_STRIP||w.mode===vo.TRIANGLE_FAN||void 0===w.mode)S=!0===o.isSkinnedMesh?new gm(_,D):new er(_,D),!0===S.isSkinnedMesh&&S.normalizeSkinWeights(),w.mode===vo.TRIANGLE_STRIP?S.geometry=e_(S.geometry,M_):w.mode===vo.TRIANGLE_FAN&&(S.geometry=e_(S.geometry,gp));else if(w.mode===vo.LINES)S=new Df(_,D);else if(w.mode===vo.LINE_STRIP)S=new fl(_,D);else if(w.mode===vo.LINE_LOOP)S=new ev(_,D);else{if(w.mode!==vo.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+w.mode);S=new vi(_,D)}Object.keys(S.geometry.morphAttributes).length>0&&pg(S,o),S.name=t.createUniqueName(o.name||"mesh_"+e),Zo(S,o),w.extensions&&Ic(r,S,w),t.assignFinalMaterial(S),f.push(S)}for(let y=0,x=f.length;y<x;y++)t.associations.set(f[y],{meshes:e,primitives:y});if(1===f.length)return f[0];const p=new dl;t.associations.set(p,{meshes:e});for(let y=0,x=f.length;y<x;y++)p.add(f[y]);return p})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new ur(kg_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new lf(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Zo(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,o=t.joints.length;r<o;r++)n.push(this._loadNodeShallow(t.joints[r]));return n.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(n).then(function(r){const o=r.pop(),l=r,c=[],u=[];for(let d=0,h=l.length;d<h;d++){const f=l[d];if(f){c.push(f);const p=new an;null!==o&&p.fromArray(o.array,16*d),u.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[d])}return new Bd(c,u)})}loadAnimation(e){const n=this.json.animations[e],r=[],o=[],l=[],c=[],u=[];for(let d=0,h=n.channels.length;d<h;d++){const f=n.channels[d],p=n.samplers[f.sampler],y=f.target,_=void 0!==n.parameters?n.parameters[p.input]:p.input,w=void 0!==n.parameters?n.parameters[p.output]:p.output;r.push(this.getDependency("node",y.node)),o.push(this.getDependency("accessor",_)),l.push(this.getDependency("accessor",w)),c.push(p),u.push(y)}return Promise.all([Promise.all(r),Promise.all(o),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(d){const h=d[0],f=d[1],p=d[2],y=d[3],x=d[4],_=[];for(let S=0,D=h.length;S<D;S++){const T=h[S],P=f[S],k=p[S],H=y[S],W=x[S];if(void 0===T)continue;let R;switch(T.updateMatrix(),wl[W.path]){case wl.weights:R=Jd;break;case wl.rotation:R=Mc;break;default:R=eh}const B=T.name?T.name:T.uuid,X=void 0!==H.interpolation?h_[H.interpolation]:Sr,le=[];wl[W.path]===wl.weights?T.traverse(function(te){te.morphTargetInfluences&&le.push(te.name?te.name:te.uuid)}):le.push(B);let Ee=k.array;if(k.normalized){const te=p_(Ee.constructor),ee=new Float32Array(Ee.length);for(let ge=0,re=Ee.length;ge<re;ge++)ee[ge]=Ee[ge]*te;Ee=ee}for(let te=0,ee=le.length;te<ee;te++){const ge=new R(le[te]+"."+wl[W.path],P.array,Ee,X);"CUBICSPLINE"===H.interpolation&&(ge.createInterpolant=function(ve){return new(this instanceof Mc?LS:u_)(this.times,this.values,this.getValueSize()/3,ve)},ge.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),_.push(ge)}}return new th(n.name?n.name:"animation_"+e,void 0,_)})}createNodeMesh(e){const n=this,r=this.json.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then(function(o){const l=n._getNodeRef(n.meshCache,r.mesh,o);return void 0!==r.weights&&l.traverse(function(c){if(c.isMesh)for(let u=0,d=r.weights.length;u<d;u++)c.morphTargetInfluences[u]=r.weights[u]}),l})}loadNode(e){const n=this,r=this.json.nodes[e],o=n._loadNodeShallow(e),l=[],c=r.children||[];for(let d=0,h=c.length;d<h;d++)l.push(n.getDependency("node",c[d]));const u=void 0===r.skin?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([o,Promise.all(l),u]).then(function(d){const h=d[0],f=d[1],p=d[2];null!==p&&h.traverse(function(y){y.isSkinnedMesh&&y.bind(p,NS)});for(let y=0,x=f.length;y<x;y++)h.add(f[y]);return h})}_loadNodeShallow(e){const n=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const o=this.json.nodes[e],l=o.name?r.createUniqueName(o.name):"",c=[],u=r._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(e)});return u&&c.push(u),void 0!==o.camera&&c.push(r.getDependency("camera",o.camera).then(function(d){return r._getNodeRef(r.cameraCache,o.camera,d)})),r._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(e)}).forEach(function(d){c.push(d)}),this.nodeCache[e]=Promise.all(c).then(function(d){let h;if(h=!0===o.isBone?new Af:d.length>1?new dl:1===d.length?d[0]:new Li,h!==d[0])for(let f=0,p=d.length;f<p;f++)h.add(d[f]);if(o.name&&(h.userData.name=o.name,h.name=l),Zo(h,o),o.extensions&&Ic(n,h,o),void 0!==o.matrix){const f=new an;f.fromArray(o.matrix),h.applyMatrix4(f)}else void 0!==o.translation&&h.position.fromArray(o.translation),void 0!==o.rotation&&h.quaternion.fromArray(o.rotation),void 0!==o.scale&&h.scale.fromArray(o.scale);return r.associations.has(h)||r.associations.set(h,{}),r.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,o=new dl;n.name&&(o.name=r.createUniqueName(n.name)),Zo(o,n),n.extensions&&Ic(t,o,n);const l=n.nodes||[],c=[];for(let u=0,d=l.length;u<d;u++)c.push(r.getDependency("node",l[u]));return Promise.all(c).then(function(u){for(let h=0,f=u.length;h<f;h++)o.add(u[h]);return r.associations=(h=>{const f=new Map;for(const[p,y]of r.associations)(p instanceof Gn||p instanceof gs)&&f.set(p,y);return h.traverse(p=>{const y=r.associations.get(p);null!=y&&f.set(p,y)}),f})(o),o})}}function g_(i,e,t){const n=e.attributes,r=[];function o(l,c){return t.getDependency("accessor",l).then(function(u){i.setAttribute(c,u)})}for(const l in n){const c=fg[l]||l.toLowerCase();c in i.attributes||r.push(o(n[l],c))}if(void 0!==e.indices&&!i.index){const l=t.getDependency("accessor",e.indices).then(function(c){i.setIndex(c)});r.push(l)}return Zo(i,e),function m_(i,e,t){const n=e.attributes,r=new eo;if(void 0===n.POSITION)return;{const c=t.json.accessors[n.POSITION],u=c.min,d=c.max;if(void 0===u||void 0===d)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new V(u[0],u[1],u[2]),new V(d[0],d[1],d[2])),c.normalized){const h=p_(sh[c.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}const o=e.targets;if(void 0!==o){const c=new V,u=new V;for(let d=0,h=o.length;d<h;d++){const f=o[d];if(void 0!==f.POSITION){const p=t.json.accessors[f.POSITION],y=p.min,x=p.max;if(void 0!==y&&void 0!==x){if(u.setX(Math.max(Math.abs(y[0]),Math.abs(x[0]))),u.setY(Math.max(Math.abs(y[1]),Math.abs(x[1]))),u.setZ(Math.max(Math.abs(y[2]),Math.abs(x[2]))),p.normalized){const _=p_(sh[p.componentType]);u.multiplyScalar(_)}c.max(u)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(c)}i.boundingBox=r;const l=new $o;r.getCenter(l.center),l.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=l}(i,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function Qb(i,e,t){let n=!1,r=!1,o=!1;for(let d=0,h=e.length;d<h;d++){const f=e[d];if(void 0!==f.POSITION&&(n=!0),void 0!==f.NORMAL&&(r=!0),void 0!==f.COLOR_0&&(o=!0),n&&r&&o)break}if(!n&&!r&&!o)return Promise.resolve(i);const l=[],c=[],u=[];for(let d=0,h=e.length;d<h;d++){const f=e[d];if(n){const p=void 0!==f.POSITION?t.getDependency("accessor",f.POSITION):i.attributes.position;l.push(p)}if(r){const p=void 0!==f.NORMAL?t.getDependency("accessor",f.NORMAL):i.attributes.normal;c.push(p)}if(o){const p=void 0!==f.COLOR_0?t.getDependency("accessor",f.COLOR_0):i.attributes.color;u.push(p)}}return Promise.all([Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(d){const f=d[1],p=d[2];return n&&(i.morphAttributes.position=d[0]),r&&(i.morphAttributes.normal=f),o&&(i.morphAttributes.color=p),i.morphTargetsRelative=!0,i})}(i,e.targets,t):i})}const y_={type:"change"},gg={type:"start"},v_={type:"end"};class __ extends Wi{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new V,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:zo.ROTATE,MIDDLE:zo.DOLLY,RIGHT:zo.PAN},this.touches={ONE:Jr.ROTATE,TWO:Jr.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return c.phi},this.getAzimuthalAngle=function(){return c.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Z){Z.addEventListener("keydown",jn),this._domElementKeyEvents=Z},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",jn),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(y_),n.update(),o=r.NONE},this.update=function(){const Z=new V,de=(new gr).setFromUnitVectors(e.up,new V(0,1,0)),Et=de.clone().invert(),_t=new V,Ut=new gr,Gt=2*Math.PI;return function(){const Ln=n.object.position;Z.copy(Ln).sub(n.target),Z.applyQuaternion(de),c.setFromVector3(Z),n.autoRotate&&o===r.NONE&&B(function W(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(c.theta+=u.theta*n.dampingFactor,c.phi+=u.phi*n.dampingFactor):(c.theta+=u.theta,c.phi+=u.phi);let $n=n.minAzimuthAngle,si=n.maxAzimuthAngle;return isFinite($n)&&isFinite(si)&&($n<-Math.PI?$n+=Gt:$n>Math.PI&&($n-=Gt),si<-Math.PI?si+=Gt:si>Math.PI&&(si-=Gt),c.theta=$n<=si?Math.max($n,Math.min(si,c.theta)):c.theta>($n+si)/2?Math.max($n,c.theta):Math.min(si,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),c.radius*=d,c.radius=Math.max(n.minDistance,Math.min(n.maxDistance,c.radius)),!0===n.enableDamping?n.target.addScaledVector(h,n.dampingFactor):n.target.add(h),Z.setFromSpherical(c),Z.applyQuaternion(Et),Ln.copy(n.target).add(Z),n.object.lookAt(n.target),!0===n.enableDamping?(u.theta*=1-n.dampingFactor,u.phi*=1-n.dampingFactor,h.multiplyScalar(1-n.dampingFactor)):(u.set(0,0,0),h.set(0,0,0)),d=1,!!(f||_t.distanceToSquared(n.object.position)>l||8*(1-Ut.dot(n.object.quaternion))>l)&&(n.dispatchEvent(y_),_t.copy(n.object.position),Ut.copy(n.object.quaternion),f=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",Ce),n.domElement.removeEventListener("pointerdown",ht),n.domElement.removeEventListener("pointercancel",tn),n.domElement.removeEventListener("wheel",ii),n.domElement.removeEventListener("pointermove",Ot),n.domElement.removeEventListener("pointerup",vt),null!==n._domElementKeyEvents&&(n._domElementKeyEvents.removeEventListener("keydown",jn),n._domElementKeyEvents=null)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=r.NONE;const l=1e-6,c=new sg,u=new sg;let d=1;const h=new V;let f=!1;const p=new Oe,y=new Oe,x=new Oe,_=new Oe,w=new Oe,S=new Oe,D=new Oe,T=new Oe,P=new Oe,k=[],H={};function R(){return Math.pow(.95,n.zoomSpeed)}function B(Z){u.theta-=Z}function X(Z){u.phi-=Z}const le=function(){const Z=new V;return function(Et,_t){Z.setFromMatrixColumn(_t,0),Z.multiplyScalar(-Et),h.add(Z)}}(),Ee=function(){const Z=new V;return function(Et,_t){!0===n.screenSpacePanning?Z.setFromMatrixColumn(_t,1):(Z.setFromMatrixColumn(_t,0),Z.crossVectors(n.object.up,Z)),Z.multiplyScalar(Et),h.add(Z)}}(),te=function(){const Z=new V;return function(Et,_t){const Ut=n.domElement;if(n.object.isPerspectiveCamera){Z.copy(n.object.position).sub(n.target);let Ht=Z.length();Ht*=Math.tan(n.object.fov/2*Math.PI/180),le(2*Et*Ht/Ut.clientHeight,n.object.matrix),Ee(2*_t*Ht/Ut.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(le(Et*(n.object.right-n.object.left)/n.object.zoom/Ut.clientWidth,n.object.matrix),Ee(_t*(n.object.top-n.object.bottom)/n.object.zoom/Ut.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function ee(Z){n.object.isPerspectiveCamera?d/=Z:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*Z)),n.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function ge(Z){n.object.isPerspectiveCamera?d*=Z:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/Z)),n.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function re(Z){p.set(Z.clientX,Z.clientY)}function se(Z){_.set(Z.clientX,Z.clientY)}function ze(){1===k.length?p.set(k[0].pageX,k[0].pageY):p.set(.5*(k[0].pageX+k[1].pageX),.5*(k[0].pageY+k[1].pageY))}function ue(){1===k.length?_.set(k[0].pageX,k[0].pageY):_.set(.5*(k[0].pageX+k[1].pageX),.5*(k[0].pageY+k[1].pageY))}function mt(){const Z=k[0].pageX-k[1].pageX,de=k[0].pageY-k[1].pageY,Et=Math.sqrt(Z*Z+de*de);D.set(0,Et)}function gt(Z){if(1==k.length)y.set(Z.pageX,Z.pageY);else{const Et=zt(Z);y.set(.5*(Z.pageX+Et.x),.5*(Z.pageY+Et.y))}x.subVectors(y,p).multiplyScalar(n.rotateSpeed);const de=n.domElement;B(2*Math.PI*x.x/de.clientHeight),X(2*Math.PI*x.y/de.clientHeight),p.copy(y)}function bt(Z){if(1===k.length)w.set(Z.pageX,Z.pageY);else{const de=zt(Z);w.set(.5*(Z.pageX+de.x),.5*(Z.pageY+de.y))}S.subVectors(w,_).multiplyScalar(n.panSpeed),te(S.x,S.y),_.copy(w)}function Bt(Z){const de=zt(Z),Et=Z.pageX-de.x,_t=Z.pageY-de.y,Ut=Math.sqrt(Et*Et+_t*_t);T.set(0,Ut),P.set(0,Math.pow(T.y/D.y,n.zoomSpeed)),ee(P.y),D.copy(T)}function ht(Z){!1!==n.enabled&&(0===k.length&&(n.domElement.setPointerCapture(Z.pointerId),n.domElement.addEventListener("pointermove",Ot),n.domElement.addEventListener("pointerup",vt)),function rt(Z){k.push(Z)}(Z),"touch"===Z.pointerType?function $(Z){switch(Mt(Z),k.length){case 1:switch(n.touches.ONE){case Jr.ROTATE:if(!1===n.enableRotate)return;ze(),o=r.TOUCH_ROTATE;break;case Jr.PAN:if(!1===n.enablePan)return;ue(),o=r.TOUCH_PAN;break;default:o=r.NONE}break;case 2:switch(n.touches.TWO){case Jr.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function et(){n.enableZoom&&mt(),n.enablePan&&ue()})(),o=r.TOUCH_DOLLY_PAN;break;case Jr.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function ft(){n.enableZoom&&mt(),n.enableRotate&&ze()})(),o=r.TOUCH_DOLLY_ROTATE;break;default:o=r.NONE}break;default:o=r.NONE}o!==r.NONE&&n.dispatchEvent(gg)}(Z):function Yt(Z){let de;switch(Z.button){case 0:de=n.mouseButtons.LEFT;break;case 1:de=n.mouseButtons.MIDDLE;break;case 2:de=n.mouseButtons.RIGHT;break;default:de=-1}switch(de){case zo.DOLLY:if(!1===n.enableZoom)return;(function ve(Z){D.set(Z.clientX,Z.clientY)})(Z),o=r.DOLLY;break;case zo.ROTATE:if(Z.ctrlKey||Z.metaKey||Z.shiftKey){if(!1===n.enablePan)return;se(Z),o=r.PAN}else{if(!1===n.enableRotate)return;re(Z),o=r.ROTATE}break;case zo.PAN:if(Z.ctrlKey||Z.metaKey||Z.shiftKey){if(!1===n.enableRotate)return;re(Z),o=r.ROTATE}else{if(!1===n.enablePan)return;se(Z),o=r.PAN}break;default:o=r.NONE}o!==r.NONE&&n.dispatchEvent(gg)}(Z))}function Ot(Z){!1!==n.enabled&&("touch"===Z.pointerType?function z(Z){switch(Mt(Z),o){case r.TOUCH_ROTATE:if(!1===n.enableRotate)return;gt(Z),n.update();break;case r.TOUCH_PAN:if(!1===n.enablePan)return;bt(Z),n.update();break;case r.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Ve(Z){n.enableZoom&&Bt(Z),n.enablePan&&bt(Z)})(Z),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function Ze(Z){n.enableZoom&&Bt(Z),n.enableRotate&&gt(Z)})(Z),n.update();break;default:o=r.NONE}}(Z):function nn(Z){switch(o){case r.ROTATE:if(!1===n.enableRotate)return;!function Me(Z){y.set(Z.clientX,Z.clientY),x.subVectors(y,p).multiplyScalar(n.rotateSpeed);const de=n.domElement;B(2*Math.PI*x.x/de.clientHeight),X(2*Math.PI*x.y/de.clientHeight),p.copy(y),n.update()}(Z);break;case r.DOLLY:if(!1===n.enableZoom)return;!function ke(Z){T.set(Z.clientX,Z.clientY),P.subVectors(T,D),P.y>0?ee(R()):P.y<0&&ge(R()),D.copy(T),n.update()}(Z);break;case r.PAN:if(!1===n.enablePan)return;!function ut(Z){w.set(Z.clientX,Z.clientY),S.subVectors(w,_).multiplyScalar(n.panSpeed),te(S.x,S.y),_.copy(w),n.update()}(Z)}}(Z))}function vt(Z){st(Z),0===k.length&&(n.domElement.releasePointerCapture(Z.pointerId),n.domElement.removeEventListener("pointermove",Ot),n.domElement.removeEventListener("pointerup",vt)),n.dispatchEvent(v_),o=r.NONE}function tn(Z){st(Z)}function ii(Z){!1===n.enabled||!1===n.enableZoom||o!==r.NONE||(Z.preventDefault(),n.dispatchEvent(gg),function ye(Z){Z.deltaY<0?ge(R()):Z.deltaY>0&&ee(R()),n.update()}(Z),n.dispatchEvent(v_))}function jn(Z){!1===n.enabled||!1===n.enablePan||function We(Z){let de=!1;switch(Z.code){case n.keys.UP:Z.ctrlKey||Z.metaKey||Z.shiftKey?X(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):te(0,n.keyPanSpeed),de=!0;break;case n.keys.BOTTOM:Z.ctrlKey||Z.metaKey||Z.shiftKey?X(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):te(0,-n.keyPanSpeed),de=!0;break;case n.keys.LEFT:Z.ctrlKey||Z.metaKey||Z.shiftKey?B(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):te(n.keyPanSpeed,0),de=!0;break;case n.keys.RIGHT:Z.ctrlKey||Z.metaKey||Z.shiftKey?B(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):te(-n.keyPanSpeed,0),de=!0}de&&(Z.preventDefault(),n.update())}(Z)}function Ce(Z){!1!==n.enabled&&Z.preventDefault()}function st(Z){delete H[Z.pointerId];for(let de=0;de<k.length;de++)if(k[de].pointerId==Z.pointerId)return void k.splice(de,1)}function Mt(Z){let de=H[Z.pointerId];void 0===de&&(de=new Oe,H[Z.pointerId]=de),de.set(Z.pageX,Z.pageY)}function zt(Z){return H[(Z.pointerId===k[0].pointerId?k[1]:k[0]).pointerId]}n.domElement.addEventListener("contextmenu",Ce),n.domElement.addEventListener("pointerdown",ht),n.domElement.addEventListener("pointercancel",tn),n.domElement.addEventListener("wheel",ii,{passive:!1}),this.update()}}class x_{get prevMarker(){return this.targetMarkers.prev}get nextMarker(){return this.targetMarkers.next}get prevMarkerIsValid(){return!this.vectorsUtils.isDefault(this.prevMarker)}get nextMarkerIsValid(){return!this.vectorsUtils.isDefault(this.nextMarker)}get modelIsLoaded(){return this.modelSetupFinished}get isReady(){return this.ready}constructor(){this.renderer=new Ou({alpha:!0,antialias:!0}),this.camera=new ur,this.scene=new bf,this.markerTracker=new Jf,this.markerTrackLerp=new V,this.markerTrackLerpFromPos=new V,this.orbitControls=new __(this.camera,this.renderer.domElement),this.targetMarkers={prev:new V,next:new V},this.modelSetupFinished=!1,this.canControl=!1,this.ready=!1,this._debugCamPosition=new er,this._debugCamPositionAxes=new qv(20),this._debugCamTargetHelper=new er,this._debug=!1,this.vectorsUtils=new dg}render(){this.renderer&&this.renderer.render(this.scene,this.camera)}setup(e=(()=>{})){this.renderer.setSize(window.innerWidth,window.innerHeight),this.initCameraSetup(),this.initModelSetup(e),this.render()}updateViewport(){this.renderer.setSize(window.innerWidth,window.innerHeight),this.updateCameraAspectRatio(),this.render()}initCameraSetup(){this.camera.position.set(0,0,2),this.camera.fov=50,this.updateCameraAspectRatio(),this.orbitControls.enabled=!1,this.orbitControls.enablePan=!1,this.orbitControls.maxPolarAngle=1,this.orbitControls.minPolarAngle=1,this.orbitControls.minDistance=70,this.orbitControls.maxDistance=170}updateCameraAspectRatio(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()}initModelSetup(e){(new Gb).load("assets/models/office.glb",n=>{const o=n.scene.children.find(f=>"EmptiesGroup"==f.name)?.children;this.markers=o.map((f,p)=>p?f.position:new V(1e-10,0,0));const l=(new yl).load("assets/img/3D-shading-color-gradient.png");l.minFilter=ti,l.magFilter=ti;const c=(new yl).load("assets/models/Room_Tex.png");n.scene.traverse(f=>{if(f.isMesh){const p=f;if(p.material=new Qd({gradientMap:l,map:c,color:"Room"==p.name?15202047:13758463}),"Floor"!=p.name)return;const y=(new yl).load("assets/models/Floor_Tex.png");p.material=new Qd({gradientMap:l,map:y,color:14807551})}}),this.scene.add(n.scene);const u=new qf(16777215,.3);this.scene.add(u);const d=new $f(16777215,.3,200);d.position.set(0,10,0),this.scene.add(d);const h=new $f(16777215,.3,140);h.position.set(.4,3,.4),this.scene.add(h),this.setDebugModelSetup(),this.ready=!0,e()})}setCamPosition(e){this.markerTracker.position.set(e.x,e.y,e.z),this.camera.position.set(e.x,e.y,e.z),this._debug&&(this._debugCamPosition.position.set(e.x,e.y,e.z),this._debugCamPositionAxes.position.set(e.x,e.y,e.z))}trackMarker(e){this.markerTrackLerpFromPos=this.vectorsUtils.copyPosition(this.markerTrackLerp),this.targetMarkers.prev=this.targetMarkers.next,this.targetMarkers.next=this.markers[e]}getSteppedRotation(e){return this.markerTrackLerp.lerpVectors(this.markerTrackLerpFromPos,this.nextMarker,e),this._debug&&this._debugCamTargetHelper.position.set(this.markerTrackLerp.x,this.markerTrackLerp.y,this.markerTrackLerp.z),this.markerTrackLerp}setDebugModelSetup(){this._debug&&(this.markers.forEach(e=>{const t=new qv(1);t.position.set(e.x,e.y,e.z),t.material.depthTest=!1,t.material.depthWrite=!1;const n=new Da(.1);new er(n,new Br({color:16711680,depthTest:!1,depthWrite:!1})).position.set(e.x,e.y,e.z),this.scene.add(t)}),this._debugCamPosition.geometry=new Da(.1),this._debugCamPosition.material=new Br({color:16776960,depthTest:!1,depthWrite:!1}),this._debugCamTargetHelper.geometry=new Da(.1),this._debugCamTargetHelper.material=new Br({color:255,depthTest:!1,depthWrite:!1}),this.scene.add(this._debugCamTargetHelper))}}var bl=U(5447);(0,Y.oB)({transform:"translate(0, -50%) rotate(180deg)",opacity:1}),(0,Y.oB)({transform:"translate(-20rem, -50%) rotate(180deg)",opacity:0});const yg=(0,Y.X$)("bgDomAnimations",[(0,Y.eR)("* => left",(0,Y.IO)("arrow-button.left",[bl.TR,bl.hg],{optional:!0})),(0,Y.eR)("left => *",(0,Y.IO)("arrow-button.left",[bl.ht,bl._G],{optional:!0})),(0,Y.eR)("* => right",(0,Y.IO)("arrow-button.right",[bl.TR,bl.hg],{optional:!0})),(0,Y.eR)("right => *",(0,Y.IO)("arrow-button.right",[bl.ht,bl._G],{optional:!0}))]);class BS{constructor(e){this.name="unnamed",this.scene=e}onEnter(){}onAnimation(){}onExit(){}}class Ml extends BS{get getDestCamPosition(){return this.destCamPosition}get getTargetIndex(){return this.targetIndex}get timeIsRunning(){return this.totalTime<=this.duration}get isTransitioning(){return this.factor<1}constructor(e){super(e),this.duration=1e3,this.factor=0,this.baseFOV=50,this.isHomeState=!1,this.initCamPosition=new V,this.destCamPosition=new V,this.targetIndex=0,this.deltaTime=0,this.initTime=0,this.totalTime=0,this._debug=!1,this.vectorsUtils=new dg}onEnter(){this.deltaTime=0,this.totalTime=0,this.initTime=0,this.factor=0,this.scene.trackMarker(this.targetIndex),this.initCamPosition=this.vectorsUtils.copyPosition(this.scene.camera.position),this.scene.canControl=!1,this.scene.orbitControls.enabled=!1}onAnimation(){1==this.factor||(this.factor=Math.min(this.totalTime/this.duration,1),this.setCameraPosition(),this.setCameraTarget(),this.setTime(),this.isHomeState)||(this.scene.camera.fov<this.baseFOV?this.scene.camera.fov+=(this.baseFOV-this.scene.camera.fov)*this.factor*.9:this.scene.camera.fov=50,this.scene.camera.updateProjectionMatrix())}onExit(){}setTime(){0!=this.initTime&&(this.deltaTime=(new Date).valueOf()-this.initTime),this.initTime=(new Date).valueOf(),this.totalTime+=this.deltaTime}setCameraPosition(){if(this.scene.prevMarkerIsValid)return void this.scene.camera.position.lerpVectors(this.initCamPosition,this.destCamPosition,this.factor);const{x:e,y:t,z:n}=this.destCamPosition;this.scene.camera.position.set(e,t,n)}setCameraTarget(){const e=this.scene.getSteppedRotation(this.scene.prevMarkerIsValid?this.factor:1);this.scene.camera.lookAt(e)}}class ip extends Ml{constructor(e){super(e),super.name="/home",super.targetIndex=0,super.isHomeState=!0}onEnter(){super.destCamPosition=this.scene.lastOrbitPosition?this.vectorsUtils.copyPosition(this.scene.lastOrbitPosition):new V(-75.45200245539156,67.18014334339586,72.48295059870483),super.onEnter(),setTimeout(()=>this.scene.canControl=!0,this.duration),this.scene.orbitControls.enabled=!0,this.scene.camera.updateProjectionMatrix()}onAnimation(){super.onAnimation(),this.scene.camera.fov>25?this.scene.camera.fov-=(this.scene.camera.fov-25)*this.factor*.9:this.scene.camera.fov=25,this.scene.camera.updateProjectionMatrix()}onExit(){this.scene.lastOrbitPosition=this.vectorsUtils.copyPosition(this.scene.camera.position)}}class tM extends ip{constructor(e){super(e),super.name="/"}}class w_ extends Ml{constructor(e){super(e),super.name="/about-me/summary",super.destCamPosition=new V(-.39498,4.59093,-8.12091),super.targetIndex=1}}class US extends Ml{constructor(e){super(e),super.name="/about-me/history",super.destCamPosition=new V(-7.5844,6.98064,1.79739),super.targetIndex=2}}class zS extends Ml{constructor(e){super(e),super.name="/portfolio",super.destCamPosition=new V(-7.7157,6.5708,.143393),super.targetIndex=4}}class nM extends Ml{constructor(e){super(e),super.name="sample4",super.destCamPosition=new V(-9.57811,14.9787,-18.9113),super.targetIndex=5}}class iM extends Ml{constructor(e){super(e),super.name="/skillset",super.destCamPosition=new V(0,12,-11),super.targetIndex=6}}class rM extends w_{constructor(e){super(e),super.name="/about-me"}}class HS extends Ml{constructor(e){super(e),super.name="/work-experience",super.destCamPosition=new V(-5.8,4.7,-3.7),super.targetIndex=3}}let VS=(()=>{class i{constructor(){this.scene=null,this.states=[]}get(t){return this.scene&&this.states.find(n=>n.name===t)||null}setup(t){this.scene=t,this.states=[new ip(t),new tM(t),new w_(t),new rM(t),new US(t),new iM(t),new HS(t),new zS(t),new nM(t)]}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=O.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var GS=U(8026);const WS=["container"];let sM=(()=>{class i{get panningDirection(){return this.cameraOrbitSpeed?this.cameraOrbitSpeed>0?"right":"left":""}constructor(t,n,r,o){this.renderer=t,this.statesFactory=n,this.router=r,this.camAngleService=o,this.paused=!1,this.scene=new x_,this.currentState=null,this.cameraOrbitSpeed=0}ngOnInit(){this.router.events.pipe((0,Uo.h)(t=>t instanceof Ki.m2)).subscribe(t=>this.setRouteActions(t.url))}ngAfterViewInit(){this.scene.setup(()=>{this.setup(),this.paused||this.animate()})}animate(){this.scene.isReady&&(this.paused||requestAnimationFrame(()=>this.animate()),this.currentState?.onAnimation(),this.scene.render(),this.camAngleService.updateAngle(this.scene.camera.rotation.z))}setState(t){if(this.currentState?.name===t)return;const n=this.statesFactory.get(t);n&&(this.currentState?.onExit(),this.currentState=n,this.currentState.onEnter())}clearState(){this.currentState?.onExit(),this.currentState=null}setup(){this.statesFactory.setup(this.scene),this.renderer.appendChild(this.container.nativeElement,this.scene.renderer.domElement),this.setState(this.router.url)}updateViewport(){this.scene.updateViewport()}setRouteActions(t){this.setState(t)}setMousePosition(t){if(!this.scene.canControl)return void(this.cameraOrbitSpeed=0);const r=.2*window.innerWidth,o=.1*window.innerHeight,c=window.innerWidth-r,d=t.clientY<=window.innerHeight-o&&t.clientY>=o;this.cameraOrbitSpeed=t.clientX<=r&&d?-1*(1-t.clientX/r)*.3:t.clientX>=c&&d?(t.clientX-c)/r*.3:0}stopCameraRotation(){this.cameraOrbitSpeed=0}}return i.\u0275fac=function(t){return new(t||i)(O.Y36(O.Qsj),O.Y36(VS),O.Y36(Ki.F0),O.Y36(GS.B))},i.\u0275cmp=O.Xpm({type:i,selectors:[["app-bg"]],viewQuery:function(t,n){if(1&t&&O.Gf(WS,5),2&t){let r;O.iGM(r=O.CRH())&&(n.container=r.first)}},hostBindings:function(t,n){1&t&&O.NdJ("resize",function(){return n.updateViewport()},!1,O.Jf7)("mouseleave",function(){return n.stopCameraRotation()})},inputs:{paused:"paused"},decls:2,vars:1,consts:[["container",""]],template:function(t,n){1&t&&O._UZ(0,"div",null,0),2&t&&O.Q6J("@bgDomAnimations",n.panningDirection)},styles:["canvas[_ngcontent-%COMP%]{position:fixed;width:100%;height:100%}canvas[_ngcontent-%COMP%]{background-color:#293459;z-index:1}.arrow-container[_ngcontent-%COMP%]{position:fixed;top:50%;left:6rem;transform:translateY(-50%);z-index:1}.arrow-container.right[_ngcontent-%COMP%]{transform:translateY(-50%) scaleX(-1);right:6rem;left:auto}.arrow-container[_ngcontent-%COMP%]   arrow-button[_ngcontent-%COMP%]{position:absolute}"],data:{animation:[yg]}}),i})();const jS=function(i){return{"can-control":i}};let $S=(()=>{class i{constructor(t,n,r){this.cd=t,this.router=n,this.currentRoute=r,this.title="David Fuentes :: CV",this.bgPaused=!1,this.canControl=!1,this._debug=!0}ngOnInit(){this.currentRoute.setRoute(this.router.url),this.router.events.pipe((0,Uo.h)(t=>t instanceof Ki.m2)).subscribe(t=>{this.currentRoute.setRoute(t.url),this.canControl=!1,"home"==this.currentRoute.segment&&setTimeout(()=>this.canControl=!0,700)})}ngAfterViewChecked(){this.cd.detectChanges()}}return i.\u0275fac=function(t){return new(t||i)(O.Y36(O.sBO),O.Y36(Ki.F0),O.Y36(Nr.V))},i.\u0275cmp=O.Xpm({type:i,selectors:[["app-root"]],decls:4,vars:5,consts:[[3,"paused"],[3,"ngClass"],["id","router-outlet-container"]],template:function(t,n){1&t&&(O._UZ(0,"app-bg",0),O.TgZ(1,"app-layout",1)(2,"div",2),O._UZ(3,"router-outlet"),O.qZA()()),2&t&&(O.Q6J("paused",n.bgPaused),O.xp6(1),O.Q6J("ngClass",O.VKq(3,jS,n.canControl)),O.xp6(1),O.Q6J("@routeAnimations",void 0))},dependencies:[Mi.mk,Ki.lC,Wc,sM],styles:["app-bg[_ngcontent-%COMP%]{position:fixed;top:0;left:0;z-index:0}app-layout[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;z-index:1;display:block}app-layout.can-control[_ngcontent-%COMP%]{height:auto}#router-outlet-container[_ngcontent-%COMP%]{height:100%}"],data:{animation:[Kr]}}),i})();var qS=U(3875);let YS=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=O.oAB({type:i}),i.\u0275inj=O.cJS({imports:[Mi.ez,qS.c,Ki.Bz]}),i})(),XS=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=O.oAB({type:i}),i.\u0275inj=O.cJS({imports:[Mi.ez]}),i})(),ZS=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=O.oAB({type:i}),i.\u0275inj=O.cJS({imports:[Mi.ez,YS,XS]}),i})();var s=U(6722);let a=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=O.oAB({type:i,bootstrap:[$S]}),i.\u0275inj=O.cJS({imports:[C.b2,ld,Vi,ZS,s.u]}),i})();C.q6().bootstrapModule(a).catch(i=>console.error(i))},9751:(Vt,Be,U)=>{U.d(Be,{y:()=>wt});var C=U(2961),O=U(727),Y=U(8822),Q=U(9635),we=U(2416),je=U(576),Ye=U(2806);let wt=(()=>{class oe{constructor(Xe){Xe&&(this._subscribe=Xe)}lift(Xe){const Ct=new oe;return Ct.source=this,Ct.operator=Xe,Ct}subscribe(Xe,Ct,ot){const at=function be(oe){return oe&&oe instanceof C.Lv||function ae(oe){return oe&&(0,je.m)(oe.next)&&(0,je.m)(oe.error)&&(0,je.m)(oe.complete)}(oe)&&(0,O.Nn)(oe)}(Xe)?Xe:new C.Hp(Xe,Ct,ot);return(0,Ye.x)(()=>{const{operator:Kt,source:Pn}=this;at.add(Kt?Kt.call(at,Pn):Pn?this._subscribe(at):this._trySubscribe(at))}),at}_trySubscribe(Xe){try{return this._subscribe(Xe)}catch(Ct){Xe.error(Ct)}}forEach(Xe,Ct){return new(Ct=it(Ct))((ot,at)=>{const Kt=new C.Hp({next:Pn=>{try{Xe(Pn)}catch(yt){at(yt),Kt.unsubscribe()}},error:at,complete:ot});this.subscribe(Kt)})}_subscribe(Xe){var Ct;return null===(Ct=this.source)||void 0===Ct?void 0:Ct.subscribe(Xe)}[Y.L](){return this}pipe(...Xe){return(0,Q.U)(Xe)(this)}toPromise(Xe){return new(Xe=it(Xe))((Ct,ot)=>{let at;this.subscribe(Kt=>at=Kt,Kt=>ot(Kt),()=>Ct(at))})}}return oe.create=Lt=>new oe(Lt),oe})();function it(oe){var Lt;return null!==(Lt=oe??we.v.Promise)&&void 0!==Lt?Lt:Promise}},7579:(Vt,Be,U)=>{U.d(Be,{x:()=>Ye});var C=U(9751),O=U(727);const Q=(0,U(3888).d)(it=>function(){it(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var we=U(8737),je=U(2806);let Ye=(()=>{class it extends C.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(be){const oe=new wt(this,this);return oe.operator=be,oe}_throwIfClosed(){if(this.closed)throw new Q}next(be){(0,je.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const oe of this.currentObservers)oe.next(be)}})}error(be){(0,je.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=be;const{observers:oe}=this;for(;oe.length;)oe.shift().error(be)}})}complete(){(0,je.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:be}=this;for(;be.length;)be.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var be;return(null===(be=this.observers)||void 0===be?void 0:be.length)>0}_trySubscribe(be){return this._throwIfClosed(),super._trySubscribe(be)}_subscribe(be){return this._throwIfClosed(),this._checkFinalizedStatuses(be),this._innerSubscribe(be)}_innerSubscribe(be){const{hasError:oe,isStopped:Lt,observers:Xe}=this;return oe||Lt?O.Lc:(this.currentObservers=null,Xe.push(be),new O.w0(()=>{this.currentObservers=null,(0,we.P)(Xe,be)}))}_checkFinalizedStatuses(be){const{hasError:oe,thrownError:Lt,isStopped:Xe}=this;oe?be.error(Lt):Xe&&be.complete()}asObservable(){const be=new C.y;return be.source=this,be}}return it.create=(ae,be)=>new wt(ae,be),it})();class wt extends Ye{constructor(ae,be){super(),this.destination=ae,this.source=be}next(ae){var be,oe;null===(oe=null===(be=this.destination)||void 0===be?void 0:be.next)||void 0===oe||oe.call(be,ae)}error(ae){var be,oe;null===(oe=null===(be=this.destination)||void 0===be?void 0:be.error)||void 0===oe||oe.call(be,ae)}complete(){var ae,be;null===(be=null===(ae=this.destination)||void 0===ae?void 0:ae.complete)||void 0===be||be.call(ae)}_subscribe(ae){var be,oe;return null!==(oe=null===(be=this.source)||void 0===be?void 0:be.subscribe(ae))&&void 0!==oe?oe:O.Lc}}},2961:(Vt,Be,U)=>{U.d(Be,{Hp:()=>ot,Lv:()=>oe});var C=U(576),O=U(727),Y=U(2416),Q=U(7849);function we(){}const je=it("C",void 0,void 0);function it(Ge,ie,qe){return{kind:Ge,value:ie,error:qe}}var ae=U(3410),be=U(2806);class oe extends O.w0{constructor(ie){super(),this.isStopped=!1,ie?(this.destination=ie,(0,O.Nn)(ie)&&ie.add(this)):this.destination=yt}static create(ie,qe,Pt){return new ot(ie,qe,Pt)}next(ie){this.isStopped?Pn(function wt(Ge){return it("N",Ge,void 0)}(ie),this):this._next(ie)}error(ie){this.isStopped?Pn(function Ye(Ge){return it("E",void 0,Ge)}(ie),this):(this.isStopped=!0,this._error(ie))}complete(){this.isStopped?Pn(je,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(ie){this.destination.next(ie)}_error(ie){try{this.destination.error(ie)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Lt=Function.prototype.bind;function Xe(Ge,ie){return Lt.call(Ge,ie)}class Ct{constructor(ie){this.partialObserver=ie}next(ie){const{partialObserver:qe}=this;if(qe.next)try{qe.next(ie)}catch(Pt){at(Pt)}}error(ie){const{partialObserver:qe}=this;if(qe.error)try{qe.error(ie)}catch(Pt){at(Pt)}else at(ie)}complete(){const{partialObserver:ie}=this;if(ie.complete)try{ie.complete()}catch(qe){at(qe)}}}class ot extends oe{constructor(ie,qe,Pt){let xe;if(super(),(0,C.m)(ie)||!ie)xe={next:ie??void 0,error:qe??void 0,complete:Pt??void 0};else{let Qe;this&&Y.v.useDeprecatedNextContext?(Qe=Object.create(ie),Qe.unsubscribe=()=>this.unsubscribe(),xe={next:ie.next&&Xe(ie.next,Qe),error:ie.error&&Xe(ie.error,Qe),complete:ie.complete&&Xe(ie.complete,Qe)}):xe=ie}this.destination=new Ct(xe)}}function at(Ge){Y.v.useDeprecatedSynchronousErrorHandling?(0,be.O)(Ge):(0,Q.h)(Ge)}function Pn(Ge,ie){const{onStoppedNotification:qe}=Y.v;qe&&ae.z.setTimeout(()=>qe(Ge,ie))}const yt={closed:!0,next:we,error:function Kt(Ge){throw Ge},complete:we}},727:(Vt,Be,U)=>{U.d(Be,{Lc:()=>je,w0:()=>we,Nn:()=>Ye});var C=U(576);const Y=(0,U(3888).d)(it=>function(be){it(this),this.message=be?`${be.length} errors occurred during unsubscription:\n${be.map((oe,Lt)=>`${Lt+1}) ${oe.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=be});var Q=U(8737);class we{constructor(ae){this.initialTeardown=ae,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let ae;if(!this.closed){this.closed=!0;const{_parentage:be}=this;if(be)if(this._parentage=null,Array.isArray(be))for(const Xe of be)Xe.remove(this);else be.remove(this);const{initialTeardown:oe}=this;if((0,C.m)(oe))try{oe()}catch(Xe){ae=Xe instanceof Y?Xe.errors:[Xe]}const{_finalizers:Lt}=this;if(Lt){this._finalizers=null;for(const Xe of Lt)try{wt(Xe)}catch(Ct){ae=ae??[],Ct instanceof Y?ae=[...ae,...Ct.errors]:ae.push(Ct)}}if(ae)throw new Y(ae)}}add(ae){var be;if(ae&&ae!==this)if(this.closed)wt(ae);else{if(ae instanceof we){if(ae.closed||ae._hasParent(this))return;ae._addParent(this)}(this._finalizers=null!==(be=this._finalizers)&&void 0!==be?be:[]).push(ae)}}_hasParent(ae){const{_parentage:be}=this;return be===ae||Array.isArray(be)&&be.includes(ae)}_addParent(ae){const{_parentage:be}=this;this._parentage=Array.isArray(be)?(be.push(ae),be):be?[be,ae]:ae}_removeParent(ae){const{_parentage:be}=this;be===ae?this._parentage=null:Array.isArray(be)&&(0,Q.P)(be,ae)}remove(ae){const{_finalizers:be}=this;be&&(0,Q.P)(be,ae),ae instanceof we&&ae._removeParent(this)}}we.EMPTY=(()=>{const it=new we;return it.closed=!0,it})();const je=we.EMPTY;function Ye(it){return it instanceof we||it&&"closed"in it&&(0,C.m)(it.remove)&&(0,C.m)(it.add)&&(0,C.m)(it.unsubscribe)}function wt(it){(0,C.m)(it)?it():it.unsubscribe()}},2416:(Vt,Be,U)=>{U.d(Be,{v:()=>C});const C={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(Vt,Be,U)=>{U.d(Be,{E:()=>O});const O=new(U(9751).y)(we=>we.complete())},2076:(Vt,Be,U)=>{U.d(Be,{D:()=>Pt});var C=U(8421),O=U(9672),Y=U(4482),Q=U(5403);function we(xe,Qe=0){return(0,Y.e)((Fe,Je)=>{Fe.subscribe((0,Q.x)(Je,Ft=>(0,O.f)(Je,xe,()=>Je.next(Ft),Qe),()=>(0,O.f)(Je,xe,()=>Je.complete(),Qe),Ft=>(0,O.f)(Je,xe,()=>Je.error(Ft),Qe)))})}function je(xe,Qe=0){return(0,Y.e)((Fe,Je)=>{Je.add(xe.schedule(()=>Fe.subscribe(Je),Qe))})}var it=U(9751),be=U(2202),oe=U(576);function Xe(xe,Qe){if(!xe)throw new Error("Iterable cannot be null");return new it.y(Fe=>{(0,O.f)(Fe,Qe,()=>{const Je=xe[Symbol.asyncIterator]();(0,O.f)(Fe,Qe,()=>{Je.next().then(Ft=>{Ft.done?Fe.complete():Fe.next(Ft.value)})},0,!0)})})}var Ct=U(3670),ot=U(8239),at=U(1144),Kt=U(6495),Pn=U(2206),yt=U(4532),Ge=U(3260);function Pt(xe,Qe){return Qe?function qe(xe,Qe){if(null!=xe){if((0,Ct.c)(xe))return function Ye(xe,Qe){return(0,C.Xf)(xe).pipe(je(Qe),we(Qe))}(xe,Qe);if((0,at.z)(xe))return function ae(xe,Qe){return new it.y(Fe=>{let Je=0;return Qe.schedule(function(){Je===xe.length?Fe.complete():(Fe.next(xe[Je++]),Fe.closed||this.schedule())})})}(xe,Qe);if((0,ot.t)(xe))return function wt(xe,Qe){return(0,C.Xf)(xe).pipe(je(Qe),we(Qe))}(xe,Qe);if((0,Pn.D)(xe))return Xe(xe,Qe);if((0,Kt.T)(xe))return function Lt(xe,Qe){return new it.y(Fe=>{let Je;return(0,O.f)(Fe,Qe,()=>{Je=xe[be.h](),(0,O.f)(Fe,Qe,()=>{let Ft,An;try{({value:Ft,done:An}=Je.next())}catch(Tt){return void Fe.error(Tt)}An?Fe.complete():Fe.next(Ft)},0,!0)}),()=>(0,oe.m)(Je?.return)&&Je.return()})}(xe,Qe);if((0,Ge.L)(xe))return function ie(xe,Qe){return Xe((0,Ge.Q)(xe),Qe)}(xe,Qe)}throw(0,yt.z)(xe)}(xe,Qe):(0,C.Xf)(xe)}},8421:(Vt,Be,U)=>{U.d(Be,{Xf:()=>Lt});var C=U(655),O=U(1144),Y=U(8239),Q=U(9751),we=U(3670),je=U(2206),Ye=U(4532),wt=U(6495),it=U(3260),ae=U(576),be=U(7849),oe=U(8822);function Lt(Ge){if(Ge instanceof Q.y)return Ge;if(null!=Ge){if((0,we.c)(Ge))return function Xe(Ge){return new Q.y(ie=>{const qe=Ge[oe.L]();if((0,ae.m)(qe.subscribe))return qe.subscribe(ie);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ge);if((0,O.z)(Ge))return function Ct(Ge){return new Q.y(ie=>{for(let qe=0;qe<Ge.length&&!ie.closed;qe++)ie.next(Ge[qe]);ie.complete()})}(Ge);if((0,Y.t)(Ge))return function ot(Ge){return new Q.y(ie=>{Ge.then(qe=>{ie.closed||(ie.next(qe),ie.complete())},qe=>ie.error(qe)).then(null,be.h)})}(Ge);if((0,je.D)(Ge))return Kt(Ge);if((0,wt.T)(Ge))return function at(Ge){return new Q.y(ie=>{for(const qe of Ge)if(ie.next(qe),ie.closed)return;ie.complete()})}(Ge);if((0,it.L)(Ge))return function Pn(Ge){return Kt((0,it.Q)(Ge))}(Ge)}throw(0,Ye.z)(Ge)}function Kt(Ge){return new Q.y(ie=>{(function yt(Ge,ie){var qe,Pt,xe,Qe;return(0,C.mG)(this,void 0,void 0,function*(){try{for(qe=(0,C.KL)(Ge);!(Pt=yield qe.next()).done;)if(ie.next(Pt.value),ie.closed)return}catch(Fe){xe={error:Fe}}finally{try{Pt&&!Pt.done&&(Qe=qe.return)&&(yield Qe.call(qe))}finally{if(xe)throw xe.error}}ie.complete()})})(Ge,ie).catch(qe=>ie.error(qe))})}},5403:(Vt,Be,U)=>{U.d(Be,{x:()=>O});var C=U(2961);function O(Q,we,je,Ye,wt){return new Y(Q,we,je,Ye,wt)}class Y extends C.Lv{constructor(we,je,Ye,wt,it,ae){super(we),this.onFinalize=it,this.shouldUnsubscribe=ae,this._next=je?function(be){try{je(be)}catch(oe){we.error(oe)}}:super._next,this._error=wt?function(be){try{wt(be)}catch(oe){we.error(oe)}finally{this.unsubscribe()}}:super._error,this._complete=Ye?function(){try{Ye()}catch(be){we.error(be)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var we;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:je}=this;super.unsubscribe(),!je&&(null===(we=this.onFinalize)||void 0===we||we.call(this))}}}},9300:(Vt,Be,U)=>{U.d(Be,{h:()=>Y});var C=U(4482),O=U(5403);function Y(Q,we){return(0,C.e)((je,Ye)=>{let wt=0;je.subscribe((0,O.x)(Ye,it=>Q.call(we,it,wt++)&&Ye.next(it)))})}},4004:(Vt,Be,U)=>{U.d(Be,{U:()=>Y});var C=U(4482),O=U(5403);function Y(Q,we){return(0,C.e)((je,Ye)=>{let wt=0;je.subscribe((0,O.x)(Ye,it=>{Ye.next(Q.call(we,it,wt++))}))})}},8189:(Vt,Be,U)=>{U.d(Be,{J:()=>Y});var C=U(5577),O=U(4671);function Y(Q=1/0){return(0,C.z)(O.y,Q)}},5577:(Vt,Be,U)=>{U.d(Be,{z:()=>wt});var C=U(4004),O=U(8421),Y=U(4482),Q=U(9672),we=U(5403),Ye=U(576);function wt(it,ae,be=1/0){return(0,Ye.m)(ae)?wt((oe,Lt)=>(0,C.U)((Xe,Ct)=>ae(oe,Xe,Lt,Ct))((0,O.Xf)(it(oe,Lt))),be):("number"==typeof ae&&(be=ae),(0,Y.e)((oe,Lt)=>function je(it,ae,be,oe,Lt,Xe,Ct,ot){const at=[];let Kt=0,Pn=0,yt=!1;const Ge=()=>{yt&&!at.length&&!Kt&&ae.complete()},ie=Pt=>Kt<oe?qe(Pt):at.push(Pt),qe=Pt=>{Xe&&ae.next(Pt),Kt++;let xe=!1;(0,O.Xf)(be(Pt,Pn++)).subscribe((0,we.x)(ae,Qe=>{Lt?.(Qe),Xe?ie(Qe):ae.next(Qe)},()=>{xe=!0},void 0,()=>{if(xe)try{for(Kt--;at.length&&Kt<oe;){const Qe=at.shift();Ct?(0,Q.f)(ae,Ct,()=>qe(Qe)):qe(Qe)}Ge()}catch(Qe){ae.error(Qe)}}))};return it.subscribe((0,we.x)(ae,ie,()=>{yt=!0,Ge()})),()=>{ot?.()}}(oe,Lt,it,be)))}},3410:(Vt,Be,U)=>{U.d(Be,{z:()=>C});const C={setTimeout(O,Y,...Q){const{delegate:we}=C;return we?.setTimeout?we.setTimeout(O,Y,...Q):setTimeout(O,Y,...Q)},clearTimeout(O){const{delegate:Y}=C;return(Y?.clearTimeout||clearTimeout)(O)},delegate:void 0}},2202:(Vt,Be,U)=>{U.d(Be,{h:()=>O});const O=function C(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Vt,Be,U)=>{U.d(Be,{L:()=>C});const C="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(Vt,Be,U)=>{U.d(Be,{_6:()=>je,jO:()=>Q,yG:()=>we});var C=U(576);function Y(Ye){return Ye[Ye.length-1]}function Q(Ye){return(0,C.m)(Y(Ye))?Ye.pop():void 0}function we(Ye){return function O(Ye){return Ye&&(0,C.m)(Ye.schedule)}(Y(Ye))?Ye.pop():void 0}function je(Ye,wt){return"number"==typeof Y(Ye)?Ye.pop():wt}},8737:(Vt,Be,U)=>{function C(O,Y){if(O){const Q=O.indexOf(Y);0<=Q&&O.splice(Q,1)}}U.d(Be,{P:()=>C})},3888:(Vt,Be,U)=>{function C(O){const Q=O(we=>{Error.call(we),we.stack=(new Error).stack});return Q.prototype=Object.create(Error.prototype),Q.prototype.constructor=Q,Q}U.d(Be,{d:()=>C})},2806:(Vt,Be,U)=>{U.d(Be,{O:()=>Q,x:()=>Y});var C=U(2416);let O=null;function Y(we){if(C.v.useDeprecatedSynchronousErrorHandling){const je=!O;if(je&&(O={errorThrown:!1,error:null}),we(),je){const{errorThrown:Ye,error:wt}=O;if(O=null,Ye)throw wt}}else we()}function Q(we){C.v.useDeprecatedSynchronousErrorHandling&&O&&(O.errorThrown=!0,O.error=we)}},9672:(Vt,Be,U)=>{function C(O,Y,Q,we=0,je=!1){const Ye=Y.schedule(function(){Q(),je?O.add(this.schedule(null,we)):this.unsubscribe()},we);if(O.add(Ye),!je)return Ye}U.d(Be,{f:()=>C})},4671:(Vt,Be,U)=>{function C(O){return O}U.d(Be,{y:()=>C})},1144:(Vt,Be,U)=>{U.d(Be,{z:()=>C});const C=O=>O&&"number"==typeof O.length&&"function"!=typeof O},2206:(Vt,Be,U)=>{U.d(Be,{D:()=>O});var C=U(576);function O(Y){return Symbol.asyncIterator&&(0,C.m)(Y?.[Symbol.asyncIterator])}},576:(Vt,Be,U)=>{function C(O){return"function"==typeof O}U.d(Be,{m:()=>C})},3670:(Vt,Be,U)=>{U.d(Be,{c:()=>Y});var C=U(8822),O=U(576);function Y(Q){return(0,O.m)(Q[C.L])}},6495:(Vt,Be,U)=>{U.d(Be,{T:()=>Y});var C=U(2202),O=U(576);function Y(Q){return(0,O.m)(Q?.[C.h])}},8239:(Vt,Be,U)=>{U.d(Be,{t:()=>O});var C=U(576);function O(Y){return(0,C.m)(Y?.then)}},3260:(Vt,Be,U)=>{U.d(Be,{L:()=>Q,Q:()=>Y});var C=U(655),O=U(576);function Y(we){return(0,C.FC)(this,arguments,function*(){const Ye=we.getReader();try{for(;;){const{value:wt,done:it}=yield(0,C.qq)(Ye.read());if(it)return yield(0,C.qq)(void 0);yield yield(0,C.qq)(wt)}}finally{Ye.releaseLock()}})}function Q(we){return(0,O.m)(we?.getReader)}},4482:(Vt,Be,U)=>{U.d(Be,{A:()=>O,e:()=>Y});var C=U(576);function O(Q){return(0,C.m)(Q?.lift)}function Y(Q){return we=>{if(O(we))return we.lift(function(je){try{return Q(je,this)}catch(Ye){this.error(Ye)}});throw new TypeError("Unable to lift unknown Observable type")}}},9635:(Vt,Be,U)=>{U.d(Be,{U:()=>Y,z:()=>O});var C=U(4671);function O(...Q){return Y(Q)}function Y(Q){return 0===Q.length?C.y:1===Q.length?Q[0]:function(je){return Q.reduce((Ye,wt)=>wt(Ye),je)}}},7849:(Vt,Be,U)=>{U.d(Be,{h:()=>Y});var C=U(2416),O=U(3410);function Y(Q){O.z.setTimeout(()=>{const{onUnhandledError:we}=C.v;if(!we)throw Q;we(Q)})}},4532:(Vt,Be,U)=>{function C(O){return new TypeError(`You provided ${null!==O&&"object"==typeof O?"an invalid object":`'${O}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}U.d(Be,{z:()=>C})},655:(Vt,Be,U)=>{function oe(Te,Se,Le,Ue){return new(Le||(Le=Promise))(function(He,Wt){function Rn(Sn){try{Dt(Ue.next(Sn))}catch(En){Wt(En)}}function zn(Sn){try{Dt(Ue.throw(Sn))}catch(En){Wt(En)}}function Dt(Sn){Sn.done?He(Sn.value):function lt(He){return He instanceof Le?He:new Le(function(Wt){Wt(He)})}(Sn.value).then(Rn,zn)}Dt((Ue=Ue.apply(Te,Se||[])).next())})}function Ge(Te){return this instanceof Ge?(this.v=Te,this):new Ge(Te)}function ie(Te,Se,Le){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var lt,Ue=Le.apply(Te,Se||[]),He=[];return lt={},Wt("next"),Wt("throw"),Wt("return"),lt[Symbol.asyncIterator]=function(){return this},lt;function Wt(rn){Ue[rn]&&(lt[rn]=function(qn){return new Promise(function(Yn,Jt){He.push([rn,qn,Yn,Jt])>1||Rn(rn,qn)})})}function Rn(rn,qn){try{!function zn(rn){rn.value instanceof Ge?Promise.resolve(rn.value.v).then(Dt,Sn):En(He[0][2],rn)}(Ue[rn](qn))}catch(Yn){En(He[0][3],Yn)}}function Dt(rn){Rn("next",rn)}function Sn(rn){Rn("throw",rn)}function En(rn,qn){rn(qn),He.shift(),He.length&&Rn(He[0][0],He[0][1])}}function Pt(Te){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Le,Se=Te[Symbol.asyncIterator];return Se?Se.call(Te):(Te=function ot(Te){var Se="function"==typeof Symbol&&Symbol.iterator,Le=Se&&Te[Se],Ue=0;if(Le)return Le.call(Te);if(Te&&"number"==typeof Te.length)return{next:function(){return Te&&Ue>=Te.length&&(Te=void 0),{value:Te&&Te[Ue++],done:!Te}}};throw new TypeError(Se?"Object is not iterable.":"Symbol.iterator is not defined.")}(Te),Le={},Ue("next"),Ue("throw"),Ue("return"),Le[Symbol.asyncIterator]=function(){return this},Le);function Ue(He){Le[He]=Te[He]&&function(Wt){return new Promise(function(Rn,zn){!function lt(He,Wt,Rn,zn){Promise.resolve(zn).then(function(Dt){He({value:Dt,done:Rn})},Wt)}(Rn,zn,(Wt=Te[He](Wt)).done,Wt.value)})}}}U.d(Be,{FC:()=>ie,KL:()=>Pt,mG:()=>oe,qq:()=>Ge})},7340:(Vt,Be,U)=>{U.d(Be,{EY:()=>ot,F4:()=>ae,IO:()=>Ct,LC:()=>O,X$:()=>Q,ZE:()=>Pn,ZN:()=>Kt,_7:()=>Xe,_j:()=>C,eR:()=>be,jt:()=>we,k1:()=>yt,l3:()=>Y,oB:()=>wt,oQ:()=>oe,pV:()=>Lt,ru:()=>je,vP:()=>Ye});class C{}class O{}const Y="*";function Q(Ge,ie){return{type:7,name:Ge,definitions:ie,options:{}}}function we(Ge,ie=null){return{type:4,styles:ie,timings:Ge}}function je(Ge,ie=null){return{type:3,steps:Ge,options:ie}}function Ye(Ge,ie=null){return{type:2,steps:Ge,options:ie}}function wt(Ge){return{type:6,styles:Ge,offset:null}}function ae(Ge){return{type:5,steps:Ge}}function be(Ge,ie,qe=null){return{type:1,expr:Ge,animation:ie,options:qe}}function oe(Ge,ie=null){return{type:8,animation:Ge,options:ie}}function Lt(Ge=null){return{type:9,options:Ge}}function Xe(Ge,ie=null){return{type:10,animation:Ge,options:ie}}function Ct(Ge,ie,qe=null){return{type:11,selector:Ge,animation:ie,options:qe}}function ot(Ge,ie){return{type:12,timings:Ge,animation:ie}}function at(Ge){Promise.resolve().then(Ge)}class Kt{constructor(ie=0,qe=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=ie+qe}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(ie=>ie()),this._onDoneFns=[])}onStart(ie){this._originalOnStartFns.push(ie),this._onStartFns.push(ie)}onDone(ie){this._originalOnDoneFns.push(ie),this._onDoneFns.push(ie)}onDestroy(ie){this._onDestroyFns.push(ie)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){at(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(ie=>ie()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(ie=>ie()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(ie){this._position=this.totalTime?ie*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(ie){const qe="start"==ie?this._onStartFns:this._onDoneFns;qe.forEach(Pt=>Pt()),qe.length=0}}class Pn{constructor(ie){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=ie;let qe=0,Pt=0,xe=0;const Qe=this.players.length;0==Qe?at(()=>this._onFinish()):this.players.forEach(Fe=>{Fe.onDone(()=>{++qe==Qe&&this._onFinish()}),Fe.onDestroy(()=>{++Pt==Qe&&this._onDestroy()}),Fe.onStart(()=>{++xe==Qe&&this._onStart()})}),this.totalTime=this.players.reduce((Fe,Je)=>Math.max(Fe,Je.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(ie=>ie()),this._onDoneFns=[])}init(){this.players.forEach(ie=>ie.init())}onStart(ie){this._onStartFns.push(ie)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(ie=>ie()),this._onStartFns=[])}onDone(ie){this._onDoneFns.push(ie)}onDestroy(ie){this._onDestroyFns.push(ie)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(ie=>ie.play())}pause(){this.players.forEach(ie=>ie.pause())}restart(){this.players.forEach(ie=>ie.restart())}finish(){this._onFinish(),this.players.forEach(ie=>ie.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(ie=>ie.destroy()),this._onDestroyFns.forEach(ie=>ie()),this._onDestroyFns=[])}reset(){this.players.forEach(ie=>ie.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(ie){const qe=ie*this.totalTime;this.players.forEach(Pt=>{const xe=Pt.totalTime?Math.min(1,qe/Pt.totalTime):1;Pt.setPosition(xe)})}getPosition(){const ie=this.players.reduce((qe,Pt)=>null===qe||Pt.totalTime>qe.totalTime?Pt:qe,null);return null!=ie?ie.getPosition():0}beforeDestroy(){this.players.forEach(ie=>{ie.beforeDestroy&&ie.beforeDestroy()})}triggerCallback(ie){const qe="start"==ie?this._onStartFns:this._onDoneFns;qe.forEach(Pt=>Pt()),qe.length=0}}const yt="!"},6895:(Vt,Be,U)=>{U.d(Be,{Do:()=>Pn,EM:()=>nd,HT:()=>Q,JF:()=>Lo,K0:()=>je,Mx:()=>Qo,O5:()=>fr,PC:()=>Il,S$:()=>ot,V_:()=>it,Ye:()=>yt,b0:()=>Kt,bD:()=>cs,ez:()=>Nc,mk:()=>di,q:()=>Y,sg:()=>pt,w_:()=>we});var C=U(8256);let O=null;function Y(){return O}function Q(M){O||(O=M)}class we{}const je=new C.OlP("DocumentToken");let Ye=(()=>{class M{historyGo(E){throw new Error("Not implemented")}}return M.\u0275fac=function(E){return new(E||M)},M.\u0275prov=C.Yz7({token:M,factory:function(){return function wt(){return(0,C.LFG)(ae)}()},providedIn:"platform"}),M})();const it=new C.OlP("Location Initialized");let ae=(()=>{class M extends Ye{constructor(E){super(),this._doc=E,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Y().getBaseHref(this._doc)}onPopState(E){const N=Y().getGlobalEventTarget(this._doc,"window");return N.addEventListener("popstate",E,!1),()=>N.removeEventListener("popstate",E)}onHashChange(E){const N=Y().getGlobalEventTarget(this._doc,"window");return N.addEventListener("hashchange",E,!1),()=>N.removeEventListener("hashchange",E)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(E){this._location.pathname=E}pushState(E,N,q){be()?this._history.pushState(E,N,q):this._location.hash=q}replaceState(E,N,q){be()?this._history.replaceState(E,N,q):this._location.hash=q}forward(){this._history.forward()}back(){this._history.back()}historyGo(E=0){this._history.go(E)}getState(){return this._history.state}}return M.\u0275fac=function(E){return new(E||M)(C.LFG(je))},M.\u0275prov=C.Yz7({token:M,factory:function(){return function oe(){return new ae((0,C.LFG)(je))}()},providedIn:"platform"}),M})();function be(){return!!window.history.pushState}function Lt(M,I){if(0==M.length)return I;if(0==I.length)return M;let E=0;return M.endsWith("/")&&E++,I.startsWith("/")&&E++,2==E?M+I.substring(1):1==E?M+I:M+"/"+I}function Xe(M){const I=M.match(/#|\?|$/),E=I&&I.index||M.length;return M.slice(0,E-("/"===M[E-1]?1:0))+M.slice(E)}function Ct(M){return M&&"?"!==M[0]?"?"+M:M}let ot=(()=>{class M{historyGo(E){throw new Error("Not implemented")}}return M.\u0275fac=function(E){return new(E||M)},M.\u0275prov=C.Yz7({token:M,factory:function(){return(0,C.f3M)(Kt)},providedIn:"root"}),M})();const at=new C.OlP("appBaseHref");let Kt=(()=>{class M extends ot{constructor(E,N){super(),this._platformLocation=E,this._removeListenerFns=[],this._baseHref=N??this._platformLocation.getBaseHrefFromDOM()??(0,C.f3M)(je).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(E){this._removeListenerFns.push(this._platformLocation.onPopState(E),this._platformLocation.onHashChange(E))}getBaseHref(){return this._baseHref}prepareExternalUrl(E){return Lt(this._baseHref,E)}path(E=!1){const N=this._platformLocation.pathname+Ct(this._platformLocation.search),q=this._platformLocation.hash;return q&&E?`${N}${q}`:N}pushState(E,N,q,fe){const De=this.prepareExternalUrl(q+Ct(fe));this._platformLocation.pushState(E,N,De)}replaceState(E,N,q,fe){const De=this.prepareExternalUrl(q+Ct(fe));this._platformLocation.replaceState(E,N,De)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(E=0){this._platformLocation.historyGo?.(E)}}return M.\u0275fac=function(E){return new(E||M)(C.LFG(Ye),C.LFG(at,8))},M.\u0275prov=C.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Pn=(()=>{class M extends ot{constructor(E,N){super(),this._platformLocation=E,this._baseHref="",this._removeListenerFns=[],null!=N&&(this._baseHref=N)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(E){this._removeListenerFns.push(this._platformLocation.onPopState(E),this._platformLocation.onHashChange(E))}getBaseHref(){return this._baseHref}path(E=!1){let N=this._platformLocation.hash;return null==N&&(N="#"),N.length>0?N.substring(1):N}prepareExternalUrl(E){const N=Lt(this._baseHref,E);return N.length>0?"#"+N:N}pushState(E,N,q,fe){let De=this.prepareExternalUrl(q+Ct(fe));0==De.length&&(De=this._platformLocation.pathname),this._platformLocation.pushState(E,N,De)}replaceState(E,N,q,fe){let De=this.prepareExternalUrl(q+Ct(fe));0==De.length&&(De=this._platformLocation.pathname),this._platformLocation.replaceState(E,N,De)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(E=0){this._platformLocation.historyGo?.(E)}}return M.\u0275fac=function(E){return new(E||M)(C.LFG(Ye),C.LFG(at,8))},M.\u0275prov=C.Yz7({token:M,factory:M.\u0275fac}),M})(),yt=(()=>{class M{constructor(E){this._subject=new C.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=E;const N=this._locationStrategy.getBaseHref();this._basePath=function Pt(M){if(new RegExp("^(https?:)?//").test(M)){const[,E]=M.split(/\/\/[^\/]+/);return E}return M}(Xe(qe(N))),this._locationStrategy.onPopState(q=>{this._subject.emit({url:this.path(!0),pop:!0,state:q.state,type:q.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(E=!1){return this.normalize(this._locationStrategy.path(E))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(E,N=""){return this.path()==this.normalize(E+Ct(N))}normalize(E){return M.stripTrailingSlash(function ie(M,I){if(!M||!I.startsWith(M))return I;const E=I.substring(M.length);return""===E||["/",";","?","#"].includes(E[0])?E:I}(this._basePath,qe(E)))}prepareExternalUrl(E){return E&&"/"!==E[0]&&(E="/"+E),this._locationStrategy.prepareExternalUrl(E)}go(E,N="",q=null){this._locationStrategy.pushState(q,"",E,N),this._notifyUrlChangeListeners(this.prepareExternalUrl(E+Ct(N)),q)}replaceState(E,N="",q=null){this._locationStrategy.replaceState(q,"",E,N),this._notifyUrlChangeListeners(this.prepareExternalUrl(E+Ct(N)),q)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(E=0){this._locationStrategy.historyGo?.(E)}onUrlChange(E){return this._urlChangeListeners.push(E),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(N=>{this._notifyUrlChangeListeners(N.url,N.state)})),()=>{const N=this._urlChangeListeners.indexOf(E);this._urlChangeListeners.splice(N,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(E="",N){this._urlChangeListeners.forEach(q=>q(E,N))}subscribe(E,N,q){return this._subject.subscribe({next:E,error:N,complete:q})}}return M.normalizeQueryParams=Ct,M.joinWithSlash=Lt,M.stripTrailingSlash=Xe,M.\u0275fac=function(E){return new(E||M)(C.LFG(ot))},M.\u0275prov=C.Yz7({token:M,factory:function(){return function Ge(){return new yt((0,C.LFG)(ot))}()},providedIn:"root"}),M})();function qe(M){return M.replace(/\/index.html$/,"")}function Qo(M,I){I=encodeURIComponent(I);for(const E of M.split(";")){const N=E.indexOf("="),[q,fe]=-1==N?[E,""]:[E.slice(0,N),E.slice(N+1)];if(q.trim()===I)return decodeURIComponent(fe)}return null}const Vs=/\s+/,ln=[];let di=(()=>{class M{constructor(E,N,q,fe){this._iterableDiffers=E,this._keyValueDiffers=N,this._ngEl=q,this._renderer=fe,this.initialClasses=ln,this.stateMap=new Map}set klass(E){this.initialClasses=null!=E?E.trim().split(Vs):ln}set ngClass(E){this.rawClass="string"==typeof E?E.trim().split(Vs):E}ngDoCheck(){for(const N of this.initialClasses)this._updateState(N,!0);const E=this.rawClass;if(Array.isArray(E)||E instanceof Set)for(const N of E)this._updateState(N,!0);else if(null!=E)for(const N of Object.keys(E))this._updateState(N,Boolean(E[N]));this._applyStateDiff()}_updateState(E,N){const q=this.stateMap.get(E);void 0!==q?(q.enabled!==N&&(q.changed=!0,q.enabled=N),q.touched=!0):this.stateMap.set(E,{enabled:N,changed:!0,touched:!0})}_applyStateDiff(){for(const E of this.stateMap){const N=E[0],q=E[1];q.changed?(this._toggleClass(N,q.enabled),q.changed=!1):q.touched||(q.enabled&&this._toggleClass(N,!1),this.stateMap.delete(N)),q.touched=!1}}_toggleClass(E,N){(E=E.trim()).length>0&&E.split(Vs).forEach(q=>{N?this._renderer.addClass(this._ngEl.nativeElement,q):this._renderer.removeClass(this._ngEl.nativeElement,q)})}}return M.\u0275fac=function(E){return new(E||M)(C.Y36(C.ZZ4),C.Y36(C.aQg),C.Y36(C.SBq),C.Y36(C.Qsj))},M.\u0275dir=C.lG2({type:M,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),M})();class $r{constructor(I,E,N,q){this.$implicit=I,this.ngForOf=E,this.index=N,this.count=q}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let pt=(()=>{class M{set ngForOf(E){this._ngForOf=E,this._ngForOfDirty=!0}set ngForTrackBy(E){this._trackByFn=E}get ngForTrackBy(){return this._trackByFn}constructor(E,N,q){this._viewContainer=E,this._template=N,this._differs=q,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(E){E&&(this._template=E)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const E=this._ngForOf;!this._differ&&E&&(this._differ=this._differs.find(E).create(this.ngForTrackBy))}if(this._differ){const E=this._differ.diff(this._ngForOf);E&&this._applyChanges(E)}}_applyChanges(E){const N=this._viewContainer;E.forEachOperation((q,fe,De)=>{if(null==q.previousIndex)N.createEmbeddedView(this._template,new $r(q.item,this._ngForOf,-1,-1),null===De?void 0:De);else if(null==De)N.remove(null===fe?void 0:fe);else if(null!==fe){const St=N.get(fe);N.move(St,De),Zt(St,q)}});for(let q=0,fe=N.length;q<fe;q++){const St=N.get(q).context;St.index=q,St.count=fe,St.ngForOf=this._ngForOf}E.forEachIdentityChange(q=>{Zt(N.get(q.currentIndex),q)})}static ngTemplateContextGuard(E,N){return!0}}return M.\u0275fac=function(E){return new(E||M)(C.Y36(C.s_b),C.Y36(C.Rgc),C.Y36(C.ZZ4))},M.\u0275dir=C.lG2({type:M,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),M})();function Zt(M,I){M.context.$implicit=I.item}let fr=(()=>{class M{constructor(E,N){this._viewContainer=E,this._context=new Cs,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=N}set ngIf(E){this._context.$implicit=this._context.ngIf=E,this._updateView()}set ngIfThen(E){bi("ngIfThen",E),this._thenTemplateRef=E,this._thenViewRef=null,this._updateView()}set ngIfElse(E){bi("ngIfElse",E),this._elseTemplateRef=E,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(E,N){return!0}}return M.\u0275fac=function(E){return new(E||M)(C.Y36(C.s_b),C.Y36(C.Rgc))},M.\u0275dir=C.lG2({type:M,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),M})();class Cs{constructor(){this.$implicit=null,this.ngIf=null}}function bi(M,I){if(I&&!I.createEmbeddedView)throw new Error(`${M} must be a TemplateRef, but received '${(0,C.AaK)(I)}'.`)}let Il=(()=>{class M{constructor(E,N,q){this._ngEl=E,this._differs=N,this._renderer=q,this._ngStyle=null,this._differ=null}set ngStyle(E){this._ngStyle=E,!this._differ&&E&&(this._differ=this._differs.find(E).create())}ngDoCheck(){if(this._differ){const E=this._differ.diff(this._ngStyle);E&&this._applyChanges(E)}}_setStyle(E,N){const[q,fe]=E.split("."),De=-1===q.indexOf("-")?void 0:C.JOm.DashCase;null!=N?this._renderer.setStyle(this._ngEl.nativeElement,q,fe?`${N}${fe}`:N,De):this._renderer.removeStyle(this._ngEl.nativeElement,q,De)}_applyChanges(E){E.forEachRemovedItem(N=>this._setStyle(N.key,null)),E.forEachAddedItem(N=>this._setStyle(N.key,N.currentValue)),E.forEachChangedItem(N=>this._setStyle(N.key,N.currentValue))}}return M.\u0275fac=function(E){return new(E||M)(C.Y36(C.SBq),C.Y36(C.aQg),C.Y36(C.Qsj))},M.\u0275dir=C.lG2({type:M,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),M})(),Nc=(()=>{class M{}return M.\u0275fac=function(E){return new(E||M)},M.\u0275mod=C.oAB({type:M}),M.\u0275inj=C.cJS({}),M})();const cs="browser";let nd=(()=>{class M{}return M.\u0275prov=(0,C.Yz7)({token:M,providedIn:"root",factory:()=>new Bc((0,C.LFG)(je),window)}),M})();class Bc{constructor(I,E){this.document=I,this.window=E,this.offset=()=>[0,0]}setOffset(I){this.offset=Array.isArray(I)?()=>I:I}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(I){this.supportsScrolling()&&this.window.scrollTo(I[0],I[1])}scrollToAnchor(I){if(!this.supportsScrolling())return;const E=function us(M,I){const E=M.getElementById(I)||M.getElementsByName(I)[0];if(E)return E;if("function"==typeof M.createTreeWalker&&M.body&&(M.body.createShadowRoot||M.body.attachShadow)){const N=M.createTreeWalker(M.body,NodeFilter.SHOW_ELEMENT);let q=N.currentNode;for(;q;){const fe=q.shadowRoot;if(fe){const De=fe.getElementById(I)||fe.querySelector(`[name="${I}"]`);if(De)return De}q=N.nextNode()}}return null}(this.document,I);E&&(this.scrollToElement(E),E.focus())}setHistoryScrollRestoration(I){if(this.supportScrollRestoration()){const E=this.window.history;E&&E.scrollRestoration&&(E.scrollRestoration=I)}}scrollToElement(I){const E=I.getBoundingClientRect(),N=E.left+this.window.pageXOffset,q=E.top+this.window.pageYOffset,fe=this.offset();this.window.scrollTo(N-fe[0],q-fe[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const I=Ha(this.window.history)||Ha(Object.getPrototypeOf(this.window.history));return!(!I||!I.writable&&!I.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Ha(M){return Object.getOwnPropertyDescriptor(M,"scrollRestoration")}class Lo{}},8256:(Vt,Be,U)=>{U.d(Be,{QbO:()=>$v,tb:()=>Vb,AFp:()=>xi,ip1:()=>Ib,CZH:()=>Dc,hGG:()=>iM,z2F:()=>ep,sBO:()=>Xb,Sil:()=>Ob,_Vd:()=>Dd,EJc:()=>qv,Xts:()=>Qg,SBq:()=>nc,lqb:()=>oo,qLn:()=>al,vpe:()=>Bs,XFs:()=>$e,OlP:()=>Fn,zs3:()=>sc,ZZ4:()=>yg,aQg:()=>ip,soG:()=>Jf,YKP:()=>zf,h0i:()=>ml,PXZ:()=>CS,R0b:()=>yo,FiY:()=>F,Lbi:()=>gS,g9A:()=>Rb,Qsj:()=>vu,FYo:()=>ic,JOm:()=>ms,tp0:()=>me,Rgc:()=>Ec,dDg:()=>TS,eoX:()=>zb,GfV:()=>ny,s_b:()=>$u,ifc:()=>$t,MMx:()=>Gu,Lck:()=>eb,eFA:()=>t_,f3M:()=>Ts,$WT:()=>As,_c5:()=>nM,c2e:()=>Qf,zSh:()=>Fs,wAp:()=>jt,vHH:()=>xe,lri:()=>dg,rWj:()=>Ub,D6c:()=>rM,cg1:()=>Cf,kL8:()=>zd,dqk:()=>ni,Z0I:()=>zs,eJc:()=>Ra,CqO:()=>d0,QGY:()=>om,F4k:()=>u0,RDi:()=>bd,AaK:()=>ot,TTD:()=>Lo,jDz:()=>_v,xp6:()=>dy,uIk:()=>Ni,Tol:()=>hm,Suo:()=>db,Xpm:()=>Ao,lG2:()=>Qo,Yz7:()=>yn,cJS:()=>wo,oAB:()=>Hs,Yjl:()=>Vs,Y36:()=>wu,_UZ:()=>sm,BQk:()=>gf,ynx:()=>mf,qZA:()=>pf,TgZ:()=>ff,EpF:()=>c0,n5z:()=>lp,LFG:()=>mn,$8M:()=>eu,$Z:()=>Sy,NdJ:()=>am,CRH:()=>hb,kcU:()=>hs,O4$:()=>wr,oxw:()=>g0,Hsn:()=>lm,F$t:()=>yf,Q6J:()=>im,DdM:()=>Cv,VKq:()=>go,WLB:()=>bc,iGM:()=>ih,KtG:()=>gh,Jf7:()=>ry,CHM:()=>ld,P3R:()=>Td,YNc:()=>a0,_uU:()=>wf,Oqu:()=>bf,hij:()=>Nu,Gf:()=>Km});var C=U(7579),O=U(727),Y=U(9751),Q=U(8189),we=U(8421),je=U(515),Ye=U(7669),wt=U(2076),ae=U(2961),be=U(4482);function Lt(s,a,...i){if(!0===a)return void s();if(!1===a)return;const e=new ae.Hp({next:()=>{e.unsubscribe(),s()}});return(0,we.Xf)(a(...i)).subscribe(e)}function Xe(s){for(let a in s)if(s[a]===Xe)return a;throw Error("Could not find renamed property on target object.")}function ot(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(ot).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const a=s.toString();if(null==a)return""+a;const i=a.indexOf("\n");return-1===i?a:a.substring(0,i)}function at(s,a){return null==s||""===s?null===a?"":a:null==a||""===a?s:s+" "+a}const Kt=Xe({__forward_ref__:Xe});function Pn(s){return s.__forward_ref__=Pn,s.toString=function(){return ot(this())},s}function yt(s){return Ge(s)?s():s}function Ge(s){return"function"==typeof s&&s.hasOwnProperty(Kt)&&s.__forward_ref__===Pn}function ie(s){return s&&!!s.\u0275providers}const Pt="https://g.co/ng/security#xss";class xe extends Error{constructor(a,i){super(Qe(a,i)),this.code=a}}function Qe(s,a){return`NG0${Math.abs(s)}${a?": "+a.trim():""}`}function Fe(s){return"string"==typeof s?s:null==s?"":String(s)}function Te(s,a){throw new xe(-201,!1)}function Yn(s,a){null==s&&function Jt(s,a,i,e){throw new Error(`ASSERTION ERROR: ${s}`+(null==e?"":` [Expected=> ${i} ${e} ${a} <=Actual]`))}(a,s,null,"!=")}function yn(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function wo(s){return{providers:s.providers||[],imports:s.imports||[]}}function oi(s){return bo(s,Ms)||bo(s,On)}function zs(s){return null!==oi(s)}function bo(s,a){return s.hasOwnProperty(a)?s[a]:null}function Mo(s){return s&&(s.hasOwnProperty(Xt)||s.hasOwnProperty(kt))?s[Xt]:null}const Ms=Xe({\u0275prov:Xe}),Xt=Xe({\u0275inj:Xe}),On=Xe({ngInjectableDef:Xe}),kt=Xe({ngInjectorDef:Xe});var $e=(()=>(($e=$e||{})[$e.Default=0]="Default",$e[$e.Host=1]="Host",$e[$e.Self=2]="Self",$e[$e.SkipSelf=4]="SkipSelf",$e[$e.Optional=8]="Optional",$e))();let So;function wn(s){const a=So;return So=s,a}function Vr(s,a,i){const e=oi(s);return e&&"root"==e.providedIn?void 0===e.value?e.value=e.factory():e.value:i&$e.Optional?null:void 0!==a?a:void Te(ot(s))}const ni=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Gr={},os="__NG_DI_FLAG__",ir="ngTempTokenPath",Es="ngTokenPath",Eo=/\n/gm,Fa="\u0275",as="__source";let Rr;function Wr(s){const a=Rr;return Rr=s,a}function To(s,a=$e.Default){if(void 0===Rr)throw new xe(-203,!1);return null===Rr?Vr(s,void 0,a):Rr.get(s,a&$e.Optional?null:void 0,a)}function mn(s,a=$e.Default){return(function Ss(){return So}()||To)(yt(s),a)}function Ts(s,a=$e.Default){return mn(s,Yi(a))}function Yi(s){return typeof s>"u"||"number"==typeof s?s:0|(s.optional&&8)|(s.host&&1)|(s.self&&2)|(s.skipSelf&&4)}function Fi(s){const a=[];for(let i=0;i<s.length;i++){const e=yt(s[i]);if(Array.isArray(e)){if(0===e.length)throw new xe(900,!1);let t,n=$e.Default;for(let r=0;r<e.length;r++){const o=e[r],l=J(o);"number"==typeof l?-1===l?t=o.token:n|=l:t=o}a.push(mn(t,n))}else a.push(mn(e))}return a}function ce(s,a){return s[os]=a,s.prototype[os]=a,s}function J(s){return s[os]}function Ae(s){return{toString:s}.toString()}var nt=(()=>((nt=nt||{})[nt.OnPush=0]="OnPush",nt[nt.Default=1]="Default",nt))(),$t=(()=>{return(s=$t||($t={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",$t;var s})();const vn={},qt=[],ls=Xe({\u0275cmp:Xe}),Lr=Xe({\u0275dir:Xe}),ki=Xe({\u0275pipe:Xe}),ka=Xe({\u0275mod:Xe}),xr=Xe({\u0275fac:Xe}),jr=Xe({__NG_ELEMENT_ID__:Xe});let Ku=0;function Ao(s){return Ae(()=>{const i=!0===s.standalone,e={},t={type:s.type,providersResolver:null,decls:s.decls,vars:s.vars,factory:null,template:s.template||null,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:s.exportAs||null,onPush:s.changeDetection===nt.OnPush,directiveDefs:null,pipeDefs:null,standalone:i,dependencies:i&&s.dependencies||null,getStandaloneInjector:null,selectors:s.selectors||qt,viewQuery:s.viewQuery||null,features:s.features||null,data:s.data||{},encapsulation:s.encapsulation||$t.Emulated,id:"c"+Ku++,styles:s.styles||qt,_:null,setInput:null,schemas:s.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},n=s.dependencies,r=s.features;return t.inputs=Dl(s.inputs,e),t.outputs=Dl(s.outputs),r&&r.forEach(o=>o(t)),t.directiveDefs=n?()=>("function"==typeof n?n():n).map(Al).filter(Cl):null,t.pipeDefs=n?()=>("function"==typeof n?n():n).map(Xi).filter(Cl):null,t})}function Al(s){return ln(s)||di(s)}function Cl(s){return null!==s}function Hs(s){return Ae(()=>({type:s.type,bootstrap:s.bootstrap||qt,declarations:s.declarations||qt,imports:s.imports||qt,exports:s.exports||qt,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null}))}function Dl(s,a){if(null==s)return vn;const i={};for(const e in s)if(s.hasOwnProperty(e)){let t=s[e],n=t;Array.isArray(t)&&(n=t[1],t=t[0]),i[t]=e,a&&(a[t]=n)}return i}const Qo=Ao;function Vs(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,standalone:!0===s.standalone,onDestroy:s.type.prototype.ngOnDestroy||null}}function ln(s){return s[ls]||null}function di(s){return s[Lr]||null}function Xi(s){return s[ki]||null}function As(s){const a=ln(s)||di(s)||Xi(s);return null!==a&&a.standalone}function Ai(s,a){const i=s[ka]||null;if(!i&&!0===a)throw new Error(`Type ${ot(s)} does not have '\u0275mod' property.`);return i}const $r=0,pt=1,Zt=2,Vn=3,fr=4,Cs=5,bi=6,pi=7,Kn=8,Co=9,Ds=10,dn=11,Do=12,qr=13,Il=14,Gs=15,Ci=16,Bi=17,Yr=18,Ui=19,Di=20,Ba=21,bn=22,Jo=1,Io=2,Rl=7,Ua=8,Po=9,zi=10;function rr(s){return Array.isArray(s)&&"object"==typeof s[Jo]}function Xr(s){return Array.isArray(s)&&!0===s[Jo]}function Ll(s){return 0!=(4&s.flags)}function ea(s){return s.componentOffset>-1}function za(s){return 1==(1&s.flags)}function Or(s){return null!==s.template}function Ol(s){return 0!=(256&s[Zt])}function us(s,a){return s.hasOwnProperty(xr)?s[xr]:null}class Uc{constructor(a,i,e){this.previousValue=a,this.currentValue=i,this.firstChange=e}isFirstChange(){return this.firstChange}}function Lo(){return ia}function ia(s){return s.type.prototype.ngOnChanges&&(s.setInput=id),Va}function Va(){const s=sr(this),a=s?.current;if(a){const i=s.previous;if(i===vn)s.previous=a;else for(let e in a)i[e]=a[e];s.current=null,this.ngOnChanges(a)}}function id(s,a,i,e){const t=this.declaredInputs[i],n=sr(s)||function Ws(s,a){return s[ra]=a}(s,{previous:vn,current:null}),r=n.current||(n.current={}),o=n.previous,l=o[t];r[t]=new Uc(l&&l.currentValue,a,o===vn),s[e]=a}Lo.ngInherit=!0;const ra="__ngSimpleChanges__";function sr(s){return s[ra]||null}const Hi=function(s,a,i){},Oo="svg";function li(s){for(;Array.isArray(s);)s=s[$r];return s}function Ga(s,a){return li(a[s])}function Ii(s,a){return li(a[s.index])}function sd(s,a){return s.data[a]}function Mi(s,a){const i=a[s];return rr(i)?i:i[$r]}function Fo(s){return 64==(64&s[Zt])}function ds(s,a){return null==a?null:s[a]}function oa(s){s[Yr]=0}function ko(s,a){s[Cs]+=a;let i=s,e=s[Vn];for(;null!==e&&(1===a&&1===i[Cs]||-1===a&&0===i[Cs]);)e[Cs]+=a,i=e,e=e[Vn]}const Rt={lFrame:la(null),bindingsEnabled:!0};function ja(){return Rt.bindingsEnabled}function Pe(){return Rt.lFrame.lView}function hn(){return Rt.lFrame.tView}function ld(s){return Rt.lFrame.contextLView=s,s[Kn]}function gh(s){return Rt.lFrame.contextLView=null,s}function mi(){let s=Bo();for(;null!==s&&64===s.type;)s=s.parent;return s}function Bo(){return Rt.lFrame.currentTNode}function Zr(s,a){const i=Rt.lFrame;i.currentTNode=s,i.isParent=a}function aa(){return Rt.lFrame.isParent}function $s(){Rt.lFrame.isParent=!1}function Vi(){const s=Rt.lFrame;let a=s.bindingRootIndex;return-1===a&&(a=s.bindingRootIndex=s.tView.bindingStartIndex),a}function Nr(){return Rt.lFrame.bindingIndex++}function _h(s,a){const i=Rt.lFrame;i.bindingIndex=i.bindingRootIndex=s,Gc(a)}function Gc(s){Rt.lFrame.currentDirectiveIndex=s}function jc(){return Rt.lFrame.currentQueryIndex}function $c(s){Rt.lFrame.currentQueryIndex=s}function Bl(s){const a=s[pt];return 2===a.type?a.declTNode:1===a.type?s[bi]:null}function zo(s,a,i){if(i&$e.SkipSelf){let t=a,n=s;for(;!(t=t.parent,null!==t||i&$e.Host||(t=Bl(n),null===t||(n=n[Gs],10&t.type))););if(null===t)return!1;a=t,s=n}const e=Rt.lFrame=qc();return e.currentTNode=a,e.lView=s,!0}function Jr(s){const a=qc(),i=s[pt];Rt.lFrame=a,a.currentTNode=i.firstChild,a.lView=s,a.tView=i,a.contextLView=s,a.bindingIndex=i.bindingStartIndex,a.inI18n=!1}function qc(){const s=Rt.lFrame,a=null===s?null:s.child;return null===a?la(s):a}function la(s){const a={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=a),a}function ca(){const s=Rt.lFrame;return Rt.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const wh=ca;function ud(){const s=ca();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function ui(){return Rt.lFrame.selectedIndex}function Qi(s){Rt.lFrame.selectedIndex=s}function _n(){const s=Rt.lFrame;return sd(s.tView,s.selectedIndex)}function wr(){Rt.lFrame.currentNamespace=Oo}function hs(){!function M(){Rt.lFrame.currentNamespace=null}()}function N(s,a){for(let i=a.directiveStart,e=a.directiveEnd;i<e;i++){const n=s.data[i].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:o,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=n;r&&(s.contentHooks||(s.contentHooks=[])).push(-i,r),o&&((s.contentHooks||(s.contentHooks=[])).push(i,o),(s.contentCheckHooks||(s.contentCheckHooks=[])).push(i,o)),l&&(s.viewHooks||(s.viewHooks=[])).push(-i,l),c&&((s.viewHooks||(s.viewHooks=[])).push(i,c),(s.viewCheckHooks||(s.viewCheckHooks=[])).push(i,c)),null!=u&&(s.destroyHooks||(s.destroyHooks=[])).push(i,u)}}function q(s,a,i){St(s,a,3,i)}function fe(s,a,i,e){(3&s[Zt])===i&&St(s,a,i,e)}function De(s,a){let i=s[Zt];(3&i)===a&&(i&=2047,i+=1,s[Zt]=i)}function St(s,a,i,e){const n=e??-1,r=a.length-1;let o=0;for(let l=void 0!==e?65535&s[Yr]:0;l<r;l++)if("number"==typeof a[l+1]){if(o=a[l],null!=e&&o>=e)break}else a[l]<0&&(s[Yr]+=65536),(o<n||-1==n)&&(Cn(s,i,a,l),s[Yr]=(4294901760&s[Yr])+l+2),l++}function Cn(s,a,i,e){const t=i[e]<0,n=i[e+1],o=s[t?-i[e]:i[e]];if(t){if(s[Zt]>>11<s[Yr]>>16&&(3&s[Zt])===a){s[Zt]+=2048,Hi(4,o,n);try{n.call(o)}finally{Hi(5,o,n)}}}else{Hi(4,o,n);try{n.call(o)}finally{Hi(5,o,n)}}}const gn=-1;class Mn{constructor(a,i,e){this.factory=a,this.resolving=!1,this.canSeeViewProviders=i,this.injectImpl=e}}function ua(s,a,i){let e=0;for(;e<i.length;){const t=i[e];if("number"==typeof t){if(0!==t)break;e++;const n=i[e++],r=i[e++],o=i[e++];s.setAttribute(a,r,o,n)}else{const n=t,r=i[++e];$a(n)?s.setProperty(a,n,r):s.setAttribute(a,n,r),e++}}return e}function da(s){return 3===s||4===s||6===s}function $a(s){return 64===s.charCodeAt(0)}function Ul(s,a){if(null!==a&&0!==a.length)if(null===s||0===s.length)s=a.slice();else{let i=-1;for(let e=0;e<a.length;e++){const t=a[e];"number"==typeof t?i=t:0===i||Mh(s,i,t,null,-1===i||2===i?a[++e]:null)}}return s}function Mh(s,a,i,e,t){let n=0,r=s.length;if(-1===a)r=-1;else for(;n<s.length;){const o=s[n++];if("number"==typeof o){if(o===a){r=-1;break}if(o>a){r=n-1;break}}}for(;n<s.length;){const o=s[n];if("number"==typeof o)break;if(o===i){if(null===e)return void(null!==t&&(s[n+1]=t));if(e===s[n+1])return void(s[n+2]=t)}n++,null!==e&&n++,null!==t&&n++}-1!==r&&(s.splice(r,0,a),n=r+1),s.splice(n++,0,i),null!==e&&s.splice(n++,0,e),null!==t&&s.splice(n++,0,t)}function Xc(s){return s!==gn}function Zc(s){return 32767&s}function Kc(s,a){let i=function op(s){return s>>16}(s),e=a;for(;i>0;)e=e[Gs],i--;return e}let Qc=!0;function Ys(s){const a=Qc;return Qc=s,a}const hd=255,pr=5;let fd=0;const Ps={};function ha(s,a){const i=zl(s,a);if(-1!==i)return i;const e=a[pt];e.firstCreatePass&&(s.injectorIndex=a.length,qa(e.data,s),qa(a,null),qa(e.blueprint,null));const t=Rs(s,a),n=s.injectorIndex;if(Xc(t)){const r=Zc(t),o=Kc(t,a),l=o[pt].data;for(let c=0;c<8;c++)a[n+c]=o[r+c]|l[r+c]}return a[n+8]=t,n}function qa(s,a){s.push(0,0,0,0,0,0,0,0,a)}function zl(s,a){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===a[s.injectorIndex+8]?-1:s.injectorIndex}function Rs(s,a){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let i=0,e=null,t=a;for(;null!==t;){if(e=Vo(t),null===e)return gn;if(i++,t=t[Gs],-1!==e.injectorIndex)return e.injectorIndex|i<<16}return gn}function Xs(s,a,i){!function Sh(s,a,i){let e;"string"==typeof i?e=i.charCodeAt(0)||0:i.hasOwnProperty(jr)&&(e=i[jr]),null==e&&(e=i[jr]=fd++);const t=e&hd;a.data[s+(t>>pr)]|=1<<t}(s,a,i)}function Hl(s,a,i){if(i&$e.Optional||void 0!==s)return s;Te()}function Ya(s,a,i,e){if(i&$e.Optional&&void 0===e&&(e=null),!(i&($e.Self|$e.Host))){const t=s[Co],n=wn(void 0);try{return t?t.get(a,e,i&$e.Optional):Vr(a,e,i&$e.Optional)}finally{wn(n)}}return Hl(e,0,i)}function Ho(s,a,i,e=$e.Default,t){if(null!==s){if(1024&a[Zt]){const r=function wg(s,a,i,e,t){let n=s,r=a;for(;null!==n&&null!==r&&1024&r[Zt]&&!(256&r[Zt]);){const o=Ei(n,r,i,e|$e.Self,Ps);if(o!==Ps)return o;let l=n.parent;if(!l){const c=r[Ba];if(c){const u=c.get(i,Ps,e);if(u!==Ps)return u}l=Vo(r),r=r[Gs]}n=l}return t}(s,a,i,e,Ps);if(r!==Ps)return r}const n=Ei(s,a,i,e,Ps);if(n!==Ps)return n}return Ya(a,i,e,t)}function Ei(s,a,i,e,t){const n=function xg(s){if("string"==typeof s)return s.charCodeAt(0)||0;const a=s.hasOwnProperty(jr)?s[jr]:void 0;return"number"==typeof a?a>=0?a&hd:or:a}(i);if("function"==typeof n){if(!zo(a,s,e))return e&$e.Host?Hl(t,0,e):Ya(a,i,e,t);try{const r=n(e);if(null!=r||e&$e.Optional)return r;Te()}finally{wh()}}else if("number"==typeof n){let r=null,o=zl(s,a),l=gn,c=e&$e.Host?a[Ci][bi]:null;for((-1===o||e&$e.SkipSelf)&&(l=-1===o?Rs(s,a):a[o+8],l!==gn&&ap(e,!1)?(r=a[pt],o=Zc(l),a=Kc(l,a)):o=-1);-1!==o;){const u=a[pt];if(Xa(n,o,u.data)){const d=Vl(o,a,i,r,e,c);if(d!==Ps)return d}l=a[o+8],l!==gn&&ap(e,a[pt].data[o+8]===c)&&Xa(n,o,a)?(r=u,o=Zc(l),a=Kc(l,a)):o=-1}}return t}function Vl(s,a,i,e,t,n){const r=a[pt],o=r.data[s+8],u=ti(o,r,i,null==e?ea(o)&&Qc:e!=r&&0!=(3&o.type),t&$e.Host&&n===o);return null!==u?ts(a,r,u,o):Ps}function ti(s,a,i,e,t){const n=s.providerIndexes,r=a.data,o=1048575&n,l=s.directiveStart,u=n>>20,h=t?o+u:s.directiveEnd;for(let f=e?o:o+u;f<h;f++){const p=r[f];if(f<l&&i===p||f>=l&&p.type===i)return f}if(t){const f=r[l];if(f&&Or(f)&&f.type===i)return l}return null}function ts(s,a,i,e){let t=s[i];const n=a.data;if(function xn(s){return s instanceof Mn}(t)){const r=t;r.resolving&&function Ft(s,a){const i=a?`. Dependency path: ${a.join(" > ")} > ${s}`:"";throw new xe(-200,`Circular dependency in DI detected for ${s}${i}`)}(function Je(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():Fe(s)}(n[i]));const o=Ys(r.canSeeViewProviders);r.resolving=!0;const l=r.injectImpl?wn(r.injectImpl):null;zo(s,e,$e.Default);try{t=s[i]=r.factory(void 0,n,s,e),a.firstCreatePass&&i>=e.directiveStart&&function E(s,a,i){const{ngOnChanges:e,ngOnInit:t,ngDoCheck:n}=a.type.prototype;if(e){const r=ia(a);(i.preOrderHooks||(i.preOrderHooks=[])).push(s,r),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(s,r)}t&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-s,t),n&&((i.preOrderHooks||(i.preOrderHooks=[])).push(s,n),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(s,n))}(i,n[i],a)}finally{null!==l&&wn(l),Ys(o),r.resolving=!1,wh()}}return t}function Xa(s,a,i){return!!(i[a+(s>>pr)]&1<<s)}function ap(s,a){return!(s&$e.Self||s&$e.Host&&a)}class Qn{constructor(a,i){this._tNode=a,this._lView=i}get(a,i,e){return Ho(this._tNode,this._lView,a,Yi(e),i)}}function or(){return new Qn(mi(),Pe())}function lp(s){return Ae(()=>{const a=s.prototype.constructor,i=a[xr]||br(a),e=Object.prototype;let t=Object.getPrototypeOf(s.prototype).constructor;for(;t&&t!==e;){const n=t[xr]||br(t);if(n&&n!==i)return n;t=Object.getPrototypeOf(t)}return n=>new n})}function br(s){return Ge(s)?()=>{const a=br(yt(s));return a&&a()}:us(s)}function Vo(s){const a=s[pt],i=a.type;return 2===i?a.declTNode:1===i?s[bi]:null}function eu(s){return function Jc(s,a){if("class"===a)return s.classes;if("style"===a)return s.styles;const i=s.attrs;if(i){const e=i.length;let t=0;for(;t<e;){const n=i[t];if(da(n))break;if(0===n)t+=2;else if("number"==typeof n)for(t++;t<e&&"string"==typeof i[t];)t++;else{if(n===a)return i[t+1];t+=2}}}return null}(mi(),s)}const Za="__parameters__";function hi(s,a,i){return Ae(()=>{const e=function ps(s){return function(...i){if(s){const e=s(...i);for(const t in e)this[t]=e[t]}}}(a);function t(...n){if(this instanceof t)return e.apply(this,n),this;const r=new t(...n);return o.annotation=r,o;function o(l,c,u){const d=l.hasOwnProperty(Za)?l[Za]:Object.defineProperty(l,Za,{value:[]})[Za];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(r),l}}return i&&(t.prototype=Object.create(i.prototype)),t.prototype.ngMetadataName=s,t.annotationCls=t,t})}class Fn{constructor(a,i){this._desc=a,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof i?this.__NG_ELEMENT_ID__=i:void 0!==i&&(this.\u0275prov=yn({token:this,providedIn:i.providedIn||"root",factory:i.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function fa(s,a){s.forEach(i=>Array.isArray(i)?fa(i,a):a(i))}function Ah(s,a,i){a>=s.length?s.push(i):s.splice(a,0,i)}function Zs(s,a){return a>=s.length-1?s.pop():s.splice(a,1)[0]}function $l(s,a){const i=[];for(let e=0;e<s;e++)i.push(a);return i}function Mr(s,a,i){let e=pa(s,a);return e>=0?s[1|e]=i:(e=~e,function Dh(s,a,i,e){let t=s.length;if(t==a)s.push(i,e);else if(1===t)s.push(e,s[0]),s[0]=i;else{for(t--,s.push(s[t-1],s[t]);t>a;)s[t]=s[t-2],t--;s[a]=i,s[a+1]=e}}(s,e,a,i)),e}function nu(s,a){const i=pa(s,a);if(i>=0)return s[1|i]}function pa(s,a){return function md(s,a,i){let e=0,t=s.length>>i;for(;t!==e;){const n=e+(t-e>>1),r=s[n<<i];if(a===r)return n<<i;r>a?t=n:e=n+1}return~(t<<i)}(s,a,1)}const F=ce(hi("Optional"),8),me=ce(hi("SkipSelf"),4);var ms=(()=>((ms=ms||{})[ms.Important=1]="Important",ms[ms.DashCase=2]="DashCase",ms))();const Pg=new Map;let mM=0;const ma="__ngContext__";function ji(s,a){rr(a)?(s[ma]=a[Di],function yM(s){Pg.set(s[Di],s)}(a)):s[ma]=a}let _p;function xp(s,a){return _p(s,a)}function _d(s){const a=s[Vn];return Xr(a)?a[Vn]:a}function Nh(s){return Fg(s[qr])}function Fh(s){return Fg(s[fr])}function Fg(s){for(;null!==s&&!Xr(s);)s=s[fr];return s}function ns(s,a,i,e,t){if(null!=e){let n,r=!1;Xr(e)?n=e:rr(e)&&(r=!0,e=e[$r]);const o=li(e);0===s&&null!==i?null==t?zg(a,i,o):Xl(a,i,o,t||null,!0):1===s&&null!==i?Xl(a,i,o,t||null,!0):2===s?function Wg(s,a,i){const e=ya(s,a);e&&function k_(s,a,i,e){s.removeChild(a,i,e)}(s,e,a,i)}(a,o,r):3===s&&a.destroyNode(o),null!=n&&function Ep(s,a,i,e,t){const n=i[Rl];n!==li(i)&&ns(a,s,e,n,t);for(let o=zi;o<i.length;o++){const l=i[o];eo(l[pt],l,s,a,e,n)}}(a,s,n,i,t)}}function lr(s,a,i){return s.createElement(a,i)}function V(s,a){const i=s[Po],e=i.indexOf(a),t=a[Vn];512&a[Zt]&&(a[Zt]&=-513,ko(t,-1)),i.splice(e,1)}function wd(s,a){if(s.length<=zi)return;const i=zi+a,e=s[i];if(e){const t=e[Bi];null!==t&&t!==s&&V(t,e),a>0&&(s[i-1][fr]=e[fr]);const n=Zs(s,zi+a);!function bp(s,a){eo(s,a,a[dn],2,null,null),a[$r]=null,a[bi]=null}(e[pt],e);const r=n[Ui];null!==r&&r.detachView(n[pt]),e[Vn]=null,e[fr]=null,e[Zt]&=-65}return e}function Mp(s,a){if(!(128&a[Zt])){const i=a[dn];i.destroyNode&&eo(s,a,i,3,null,null),function iu(s){let a=s[qr];if(!a)return tl(s[pt],s);for(;a;){let i=null;if(rr(a))i=a[qr];else{const e=a[zi];e&&(i=e)}if(!i){for(;a&&!a[fr]&&a!==s;)rr(a)&&tl(a[pt],a),a=a[Vn];null===a&&(a=s),rr(a)&&tl(a[pt],a),i=a&&a[fr]}a=i}}(a)}}function tl(s,a){if(!(128&a[Zt])){a[Zt]&=-65,a[Zt]|=128,function F_(s,a){let i;if(null!=s&&null!=(i=s.destroyHooks))for(let e=0;e<i.length;e+=2){const t=a[i[e]];if(!(t instanceof Mn)){const n=i[e+1];if(Array.isArray(n))for(let r=0;r<n.length;r+=2){const o=t[n[r]],l=n[r+1];Hi(4,o,l);try{l.call(o)}finally{Hi(5,o,l)}}else{Hi(4,t,n);try{n.call(t)}finally{Hi(5,t,n)}}}}}(s,a),function Sp(s,a){const i=s.cleanup,e=a[pi];let t=-1;if(null!==i)for(let n=0;n<i.length-1;n+=2)if("string"==typeof i[n]){const r=i[n+3];r>=0?e[t=r]():e[t=-r].unsubscribe(),n+=2}else{const r=e[t=i[n+1]];i[n].call(r)}if(null!==e){for(let n=t+1;n<e.length;n++)(0,e[n])();a[pi]=null}}(s,a),1===a[pt].type&&a[dn].destroy();const i=a[Bi];if(null!==i&&Xr(a[Vn])){i!==a[Vn]&&V(i,a);const e=a[Ui];null!==e&&e.detachView(s)}!function Rg(s){Pg.delete(s[Di])}(a)}}function Ug(s,a,i){return function ga(s,a,i){let e=a;for(;null!==e&&40&e.type;)e=(a=e).parent;if(null===e)return i[$r];{const{componentOffset:t}=e;if(t>-1){const{encapsulation:n}=s.data[e.directiveStart+t];if(n===$t.None||n===$t.Emulated)return null}return Ii(e,i)}}(s,a.parent,i)}function Xl(s,a,i,e,t){s.insertBefore(a,i,e,t)}function zg(s,a,i){s.appendChild(a,i)}function Hg(s,a,i,e,t){null!==e?Xl(s,a,i,e,t):zg(s,a,i)}function ya(s,a){return s.parentNode(a)}function Zl(s,a,i){return Gg(s,a,i)}let gs,Ap,$o,Gg=function kh(s,a,i){return 40&s.type?Ii(s,i):null};function Wo(s,a,i,e){const t=Ug(s,e,a),n=a[dn],o=Zl(e.parent||a[bi],e,a);if(null!=t)if(Array.isArray(i))for(let l=0;l<i.length;l++)Hg(n,t,i[l],o,!1);else Hg(n,t,i,o,!1);void 0!==gs&&gs(n,e,a,i,t)}function ru(s,a){if(null!==a){const i=a.type;if(3&i)return Ii(a,s);if(4&i)return Bh(-1,s[a.index]);if(8&i){const e=a.child;if(null!==e)return ru(s,e);{const t=s[a.index];return Xr(t)?Bh(-1,t):li(t)}}if(32&i)return xp(a,s)()||li(s[a.index]);{const e=B_(s,a);return null!==e?Array.isArray(e)?e[0]:ru(_d(s[Ci]),e):ru(s,a.next)}}return null}function B_(s,a){return null!==a?s[Ci][bi].projection[a.projection]:null}function Bh(s,a){const i=zi+s+1;if(i<a.length){const e=a[i],t=e[pt].firstChild;if(null!==t)return ru(e,t)}return a[Rl]}function jg(s,a,i,e,t,n,r){for(;null!=i;){const o=e[i.index],l=i.type;if(r&&0===a&&(o&&ji(li(o),e),i.flags|=2),32!=(32&i.flags))if(8&l)jg(s,a,i.child,e,t,n,!1),ns(a,s,t,o,n);else if(32&l){const c=xp(i,e);let u;for(;u=c();)ns(a,s,t,u,n);ns(a,s,t,o,n)}else 16&l?nl(s,a,e,i,t,n):ns(a,s,t,o,n);i=r?i.projectionNext:i.next}}function eo(s,a,i,e,t,n){jg(i,e,s.firstChild,a,t,n,!1)}function nl(s,a,i,e,t,n){const r=i[Ci],l=r[bi].projection[e.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)ns(a,s,t,l[c],n);else jg(s,a,l,r[Vn],t,n,!0)}function Kl(s,a,i){""===i?s.removeAttribute(a,"class"):s.setAttribute(a,"class",i)}function _a(s,a,i){const{mergedAttrs:e,classes:t,styles:n}=i;null!==e&&ua(s,a,e),null!==t&&Kl(s,a,t),null!==n&&function ou(s,a,i){s.setAttribute(a,"style",i)}(s,a,n)}function bd(s){Ap=s}function wa(s){return function no(){if(void 0===$o&&($o=null,ni.trustedTypes))try{$o=ni.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:s=>s,createScript:s=>s,createScriptURL:s=>s})}catch{}return $o}()?.createScriptURL(s)||s}class Gh{constructor(a){this.changingThisBreaksApplicationSecurity=a}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Pt})`}}function cr(s){return s instanceof Gh?s.changingThisBreaksApplicationSecurity:s}function Sd(s,a){const i=function U_(s){return s instanceof Gh&&s.getTypeName()||null}(s);if(null!=i&&i!==a){if("ResourceURL"===i&&"URL"===a)return!0;throw new Error(`Required a safe ${a}, got a ${i} (see ${Pt})`)}return i===a}const cu=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;var Gn=(()=>((Gn=Gn||{})[Gn.NONE=0]="NONE",Gn[Gn.HTML=1]="HTML",Gn[Gn.STYLE=2]="STYLE",Gn[Gn.SCRIPT=3]="SCRIPT",Gn[Gn.URL=4]="URL",Gn[Gn.RESOURCE_URL=5]="RESOURCE_URL",Gn))();function Ed(s){const a=Zh();return a?a.sanitize(Gn.URL,s)||"":Sd(s,"URL")?cr(s):function io(s){return(s=String(s)).match(cu)?s:"unsafe:"+s}(Fe(s))}function Xh(s){const a=Zh();if(a)return wa(a.sanitize(Gn.RESOURCE_URL,s)||"");if(Sd(s,"ResourceURL"))return wa(cr(s));throw new xe(904,!1)}function Td(s,a,i){return function $i(s,a){return"src"===a&&("embed"===s||"frame"===s||"iframe"===s||"media"===s||"script"===s)||"href"===a&&("base"===s||"link"===s)?Xh:Ed}(a,i)(s)}function Zh(){const s=Pe();return s&&s[Do]}const Qg=new Fn("ENVIRONMENT_INITIALIZER"),$_=new Fn("INJECTOR",-1),Lp=new Fn("INJECTOR_DEF_TYPES");class q_{get(a,i=Gr){if(i===Gr){const e=new Error(`NullInjectorError: No provider for ${ot(a)}!`);throw e.name="NullInjectorError",e}return i}}function _M(...s){return{\u0275providers:It(0,s),\u0275fromNgModule:!0}}function It(s,...a){const i=[],e=new Set;let t;return fa(a,n=>{const r=n;Op(r,i,[],e)&&(t||(t=[]),t.push(r))}),void 0!==t&&X_(t,i),i}function X_(s,a){for(let i=0;i<s.length;i++){const{providers:t}=s[i];Ad(t,n=>{a.push(n)})}}function Op(s,a,i,e){if(!(s=yt(s)))return!1;let t=null,n=Mo(s);const r=!n&&ln(s);if(n||r){if(r&&!r.standalone)return!1;t=s}else{const l=s.ngModule;if(n=Mo(l),!n)return!1;t=l}const o=e.has(t);if(r){if(o)return!1;if(e.add(t),r.dependencies){const l="function"==typeof r.dependencies?r.dependencies():r.dependencies;for(const c of l)Op(c,a,i,e)}}else{if(!n)return!1;{if(null!=n.imports&&!o){let c;e.add(t);try{fa(n.imports,u=>{Op(u,a,i,e)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&X_(c,a)}if(!o){const c=us(t)||(()=>new t);a.push({provide:t,useFactory:c,deps:qt},{provide:Lp,useValue:t,multi:!0},{provide:Qg,useValue:()=>mn(t),multi:!0})}const l=n.providers;null==l||o||Ad(l,u=>{a.push(u)})}}return t!==s&&void 0!==s.providers}function Ad(s,a){for(let i of s)ie(i)&&(i=i.\u0275providers),Array.isArray(i)?Ad(i,a):a(i)}const fu=Xe({provide:String,useValue:Xe});function Ur(s){return null!==s&&"object"==typeof s&&fu in s}function cn(s){return"function"==typeof s}const Fs=new Fn("Set Injector scope."),Jl={},ey={};let ec;function rl(){return void 0===ec&&(ec=new q_),ec}class oo{}class Kh extends oo{get destroyed(){return this._destroyed}constructor(a,i,e,t){super(),this.parent=i,this.source=e,this.scopes=t,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,gu(a,r=>this.processProvider(r)),this.records.set($_,sl(void 0,this)),t.has("environment")&&this.records.set(oo,sl(void 0,this));const n=this.records.get(Fs);null!=n&&"string"==typeof n.value&&this.scopes.add(n.value),this.injectorDefTypes=new Set(this.get(Lp.multi,qt,$e.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const a of this._ngOnDestroyHooks)a.ngOnDestroy();for(const a of this._onDestroyHooks)a()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(a){this._onDestroyHooks.push(a)}runInContext(a){this.assertNotDestroyed();const i=Wr(this),e=wn(void 0);try{return a()}finally{Wr(i),wn(e)}}get(a,i=Gr,e=$e.Default){this.assertNotDestroyed(),e=Yi(e);const t=Wr(this),n=wn(void 0);try{if(!(e&$e.SkipSelf)){let o=this.records.get(a);if(void 0===o){const l=function Z_(s){return"function"==typeof s||"object"==typeof s&&s instanceof Fn}(a)&&oi(a);o=l&&this.injectableDefInScope(l)?sl(mu(a),Jl):null,this.records.set(a,o)}if(null!=o)return this.hydrate(a,o)}return(e&$e.Self?rl():this.parent).get(a,i=e&$e.Optional&&i===Gr?null:i)}catch(r){if("NullInjectorError"===r.name){if((r[ir]=r[ir]||[]).unshift(ot(a)),t)throw r;return function j(s,a,i,e){const t=s[ir];throw a[as]&&t.unshift(a[as]),s.message=function he(s,a,i,e=null){s=s&&"\n"===s.charAt(0)&&s.charAt(1)==Fa?s.slice(2):s;let t=ot(a);if(Array.isArray(a))t=a.map(ot).join(" -> ");else if("object"==typeof a){let n=[];for(let r in a)if(a.hasOwnProperty(r)){let o=a[r];n.push(r+":"+("string"==typeof o?JSON.stringify(o):ot(o)))}t=`{${n.join(", ")}}`}return`${i}${e?"("+e+")":""}[${t}]: ${s.replace(Eo,"\n  ")}`}("\n"+s.message,t,i,e),s[Es]=t,s[ir]=null,s}(r,a,"R3InjectorError",this.source)}throw r}finally{wn(n),Wr(t)}}resolveInjectorInitializers(){const a=Wr(this),i=wn(void 0);try{const e=this.get(Qg.multi,qt,$e.Self);for(const t of e)t()}finally{Wr(a),wn(i)}}toString(){const a=[],i=this.records;for(const e of i.keys())a.push(ot(e));return`R3Injector[${a.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new xe(205,!1)}processProvider(a){let i=cn(a=yt(a))?a:yt(a&&a.provide);const e=function Jh(s){return Ur(s)?sl(void 0,s.useValue):sl(function Cd(s,a,i){let e;if(cn(s)){const t=yt(s);return us(t)||mu(t)}if(Ur(s))e=()=>yt(s.useValue);else if(function Ji(s){return!(!s||!s.useFactory)}(s))e=()=>s.useFactory(...Fi(s.deps||[]));else if(function pu(s){return!(!s||!s.useExisting)}(s))e=()=>mn(yt(s.useExisting));else{const t=yt(s&&(s.useClass||s.provide));if(!function ef(s){return!!s.deps}(s))return us(t)||mu(t);e=()=>new t(...Fi(s.deps))}return e}(s),Jl)}(a);if(cn(a)||!0!==a.multi)this.records.get(i);else{let t=this.records.get(i);t||(t=sl(void 0,Jl,!0),t.factory=()=>Fi(t.multi),this.records.set(i,t)),i=a,t.multi.push(a)}this.records.set(i,e)}hydrate(a,i){return i.value===Jl&&(i.value=ey,i.value=i.factory()),"object"==typeof i.value&&i.value&&function er(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(i.value)&&this._ngOnDestroyHooks.add(i.value),i.value}injectableDefInScope(a){if(!a.providedIn)return!1;const i=yt(a.providedIn);return"string"==typeof i?"any"===i||this.scopes.has(i):this.injectorDefTypes.has(i)}}function mu(s){const a=oi(s),i=null!==a?a.factory:us(s);if(null!==i)return i;if(s instanceof Fn)throw new xe(204,!1);if(s instanceof Function)return function Qh(s){const a=s.length;if(a>0)throw $l(a,"?"),new xe(204,!1);const i=function ss(s){const a=s&&(s[Ms]||s[On]);return a?(function Tl(s){if(s.hasOwnProperty("name"))return s.name;(""+s).match(/^function\s*([^\s(]+)/)}(s),a):null}(s);return null!==i?()=>i.factory(s):()=>new s}(s);throw new xe(204,!1)}function sl(s,a,i=!1){return{factory:s,value:a,multi:i?[]:void 0}}function gu(s,a){for(const i of s)Array.isArray(i)?gu(i,a):i&&ie(i)?gu(i.\u0275providers,a):a(i)}class yu{}class tc{}class Q_{resolveComponentFactory(a){throw function zr(s){const a=Error(`No component factory found for ${ot(s)}. Did you add it to @NgModule.entryComponents?`);return a.ngComponent=s,a}(a)}}let Dd=(()=>{class s{}return s.NULL=new Q_,s})();function J_(){return vs(mi(),Pe())}function vs(s,a){return new nc(Ii(s,a))}let nc=(()=>{class s{constructor(i){this.nativeElement=i}}return s.__NG_ELEMENT_ID__=J_,s})();function ur(s){return s instanceof nc?s.nativeElement:s}class ic{}let vu=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function ex(){const s=Pe(),i=Mi(mi().index,s);return(rr(i)?i:s)[dn]}(),s})(),tf=(()=>{class s{}return s.\u0275prov=yn({token:s,providedIn:"root",factory:()=>null}),s})();class ny{constructor(a){this.full=a,this.major=a.split(".")[0],this.minor=a.split(".")[1],this.patch=a.split(".").slice(2).join(".")}}const Np=new ny("15.2.2"),Fp={},kp="ngOriginalError";function ol(s){return s[kp]}class al{constructor(){this._console=console}handleError(a){const i=this._findOriginalError(a);this._console.error("ERROR",a),i&&this._console.error("ORIGINAL ERROR",i)}_findOriginalError(a){let i=a&&ol(a);for(;i&&ol(i);)i=ol(i);return i||null}}function ry(s){return s.ownerDocument.defaultView}function Sa(s){return s instanceof Function?s():s}function oy(s,a,i){let e=s.length;for(;;){const t=s.indexOf(a,i);if(-1===t)return t;if(0===t||s.charCodeAt(t-1)<=32){const n=a.length;if(t+n===e||s.charCodeAt(t+n)<=32)return t}i=t+1}}const ay="ng-template";function ox(s,a,i){let e=0;for(;e<s.length;){let t=s[e++];if(i&&"class"===t){if(t=s[e],-1!==oy(t.toLowerCase(),a,0))return!0}else if(1===t){for(;e<s.length&&"string"==typeof(t=s[e++]);)if(t.toLowerCase()===a)return!0;return!1}}return!1}function ly(s){return 4===s.type&&s.value!==ay}function ax(s,a,i){return a===(4!==s.type||i?s.value:ay)}function lx(s,a,i){let e=4;const t=s.attrs||[],n=function dx(s){for(let a=0;a<s.length;a++)if(da(s[a]))return a;return s.length}(t);let r=!1;for(let o=0;o<a.length;o++){const l=a[o];if("number"!=typeof l){if(!r)if(4&e){if(e=2|1&e,""!==l&&!ax(s,l,i)||""===l&&1===a.length){if(ao(e))return!1;r=!0}}else{const c=8&e?l:a[++o];if(8&e&&null!==s.attrs){if(!ox(s.attrs,c,i)){if(ao(e))return!1;r=!0}continue}const d=cx(8&e?"class":l,t,ly(s),i);if(-1===d){if(ao(e))return!1;r=!0;continue}if(""!==c){let h;h=d>n?"":t[d+1].toLowerCase();const f=8&e?h:null;if(f&&-1!==oy(f,c,0)||2&e&&c!==h){if(ao(e))return!1;r=!0}}}}else{if(!r&&!ao(e)&&!ao(l))return!1;if(r&&ao(l))continue;r=!1,e=l|1&e}}return ao(e)||r}function ao(s){return 0==(1&s)}function cx(s,a,i,e){if(null===a)return-1;let t=0;if(e||!i){let n=!1;for(;t<a.length;){const r=a[t];if(r===s)return t;if(3===r||6===r)n=!0;else{if(1===r||2===r){let o=a[++t];for(;"string"==typeof o;)o=a[++t];continue}if(4===r)break;if(0===r){t+=4;continue}}t+=n?1:2}return-1}return function hx(s,a){let i=s.indexOf(4);if(i>-1)for(i++;i<s.length;){const e=s[i];if("number"==typeof e)return-1;if(e===a)return i;i++}return-1}(a,s)}function cy(s,a,i=!1){for(let e=0;e<a.length;e++)if(lx(s,a[e],i))return!0;return!1}function fx(s,a){e:for(let i=0;i<a.length;i++){const e=a[i];if(s.length===e.length){for(let t=0;t<s.length;t++)if(s[t]!==e[t])continue e;return!0}}return!1}function uy(s,a){return s?":not("+a.trim()+")":a}function px(s){let a=s[0],i=1,e=2,t="",n=!1;for(;i<s.length;){let r=s[i];if("string"==typeof r)if(2&e){const o=s[++i];t+="["+r+(o.length>0?'="'+o+'"':"")+"]"}else 8&e?t+="."+r:4&e&&(t+=" "+r);else""!==t&&!ao(r)&&(a+=uy(n,t),t=""),e=r,n=n||!ao(e);i++}return""!==t&&(a+=uy(n,t)),a}const un={};function dy(s){hy(hn(),Pe(),ui()+s,!1)}function hy(s,a,i,e){if(!e)if(3==(3&a[Zt])){const n=s.preOrderCheckHooks;null!==n&&q(a,n,i)}else{const n=s.preOrderHooks;null!==n&&fe(a,n,0,i)}Qi(i)}function gy(s,a=null,i=null,e){const t=yy(s,a,i,e);return t.resolveInjectorInitializers(),t}function yy(s,a=null,i=null,e,t=new Set){const n=[i||qt,_M(s)];return e=e||("object"==typeof s?void 0:ot(s)),new Kh(n,a||rl(),e||null,t)}let sc=(()=>{class s{static create(i,e){if(Array.isArray(i))return gy({name:""},e,i,"");{const t=i.name??"";return gy({name:t},i.parent,i.providers,t)}}}return s.THROW_IF_NOT_FOUND=Gr,s.NULL=new q_,s.\u0275prov=yn({token:s,providedIn:"any",factory:()=>mn($_)}),s.__NG_ELEMENT_ID__=-1,s})();function wu(s,a=$e.Default){const i=Pe();return null===i?mn(s,a):Ho(mi(),i,yt(s),a)}function Sy(){throw new Error("invalid")}function Ey(s,a){const i=s.contentQueries;if(null!==i)for(let e=0;e<i.length;e+=2){const n=i[e+1];if(-1!==n){const r=s.data[n];$c(i[e]),r.contentQueries(2,a[n],n)}}}function sf(s,a,i,e,t,n,r,o,l,c,u){const d=a.blueprint.slice();return d[$r]=t,d[Zt]=76|e,(null!==u||s&&1024&s[Zt])&&(d[Zt]|=1024),oa(d),d[Vn]=d[Gs]=s,d[Kn]=i,d[Ds]=r||s&&s[Ds],d[dn]=o||s&&s[dn],d[Do]=l||s&&s[Do]||null,d[Co]=c||s&&s[Co]||null,d[bi]=n,d[Di]=function gM(){return mM++}(),d[Ba]=u,d[Ci]=2==a.type?s[Ci]:d,d}function bu(s,a,i,e,t){let n=s.data[a];if(null===n)n=function Gp(s,a,i,e,t){const n=Bo(),r=aa(),l=s.data[a]=function zx(s,a,i,e,t,n){return{type:i,index:e,insertBeforeIndex:null,injectorIndex:a?a.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:t,attrs:n,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:a,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,r?n:n&&n.parent,i,a,e,t);return null===s.firstChild&&(s.firstChild=l),null!==n&&(r?null==n.child&&null!==l.parent&&(n.child=l):null===n.next&&(n.next=l,l.prev=n)),l}(s,a,i,e,t),function vh(){return Rt.lFrame.inI18n}()&&(n.flags|=32);else if(64&n.type){n.type=i,n.value=e,n.attrs=t;const r=function Ki(){const s=Rt.lFrame,a=s.currentTNode;return s.isParent?a:a.parent}();n.injectorIndex=null===r?-1:r.injectorIndex}return Zr(n,!0),n}function Id(s,a,i,e){if(0===i)return-1;const t=a.length;for(let n=0;n<i;n++)a.push(e),s.blueprint.push(e),s.data.push(null);return t}function Wp(s,a,i){Jr(a);try{const e=s.viewQuery;null!==e&&ky(1,e,i);const t=s.template;null!==t&&Ty(s,a,t,1,i),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&Ey(s,a),s.staticViewQueries&&ky(2,s.viewQuery,i);const n=s.components;null!==n&&function kx(s,a){for(let i=0;i<a.length;i++)$M(s,a[i])}(a,n)}catch(e){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),e}finally{a[Zt]&=-5,ud()}}function af(s,a,i,e){const t=a[Zt];if(128!=(128&t)){Jr(a);try{oa(a),function Uo(s){return Rt.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==i&&Ty(s,a,i,2,e);const r=3==(3&t);if(r){const c=s.preOrderCheckHooks;null!==c&&q(a,c,null)}else{const c=s.preOrderHooks;null!==c&&fe(a,c,0,null),De(a,0)}if(function WM(s){for(let a=Nh(s);null!==a;a=Fh(a)){if(!a[Io])continue;const i=a[Po];for(let e=0;e<i.length;e++){const t=i[e];512&t[Zt]||ko(t[Vn],1),t[Zt]|=512}}}(a),function GM(s){for(let a=Nh(s);null!==a;a=Fh(a))for(let i=zi;i<a.length;i++){const e=a[i],t=e[pt];Fo(e)&&af(t,e,t.template,e[Kn])}}(a),null!==s.contentQueries&&Ey(s,a),r){const c=s.contentCheckHooks;null!==c&&q(a,c)}else{const c=s.contentHooks;null!==c&&fe(a,c,1),De(a,1)}!function Nx(s,a){const i=s.hostBindingOpCodes;if(null!==i)try{for(let e=0;e<i.length;e++){const t=i[e];if(t<0)Qi(~t);else{const n=t,r=i[++e],o=i[++e];_h(r,n),o(2,a[n])}}}finally{Qi(-1)}}(s,a);const o=s.components;null!==o&&function Fx(s,a){for(let i=0;i<a.length;i++)jM(s,a[i])}(a,o);const l=s.viewQuery;if(null!==l&&ky(2,l,e),r){const c=s.viewCheckHooks;null!==c&&q(a,c)}else{const c=s.viewHooks;null!==c&&fe(a,c,2),De(a,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),a[Zt]&=-41,512&a[Zt]&&(a[Zt]&=-513,ko(a[Vn],-1))}finally{ud()}}}function Ty(s,a,i,e,t){const n=ui(),r=2&e;try{Qi(-1),r&&a.length>bn&&hy(s,a,bn,!1),Hi(r?2:0,t),i(e,t)}finally{Qi(n),Hi(r?3:1,t)}}function jp(s,a,i){if(Ll(a)){const t=a.directiveEnd;for(let n=a.directiveStart;n<t;n++){const r=s.data[n];r.contentQueries&&r.contentQueries(1,i[n],n)}}}function $p(s,a,i){ja()&&(function LM(s,a,i,e){const t=i.directiveStart,n=i.directiveEnd;ea(i)&&function zM(s,a,i){const e=Ii(a,s),t=Ay(i),n=s[Ds],r=Zp(s,sf(s,t,null,i.onPush?32:16,e,a,n,n.createRenderer(e,i),null,null,null));s[a.index]=r}(a,i,s.data[t+i.componentOffset]),s.firstCreatePass||ha(i,a),ji(e,a);const r=i.initialInputs;for(let o=t;o<n;o++){const l=s.data[o],c=ts(a,s,o,i);ji(c,a),null!==r&&HM(0,o-t,c,l,0,r),Or(l)&&(Mi(i.index,a)[Kn]=ts(a,s,o,i))}}(s,a,i,Ii(i,a)),64==(64&i.flags)&&Wx(s,a,i))}function qp(s,a,i=Ii){const e=a.localNames;if(null!==e){let t=a.index+1;for(let n=0;n<e.length;n+=2){const r=e[n+1],o=-1===r?i(a,s):s[r];s[t++]=o}}}function Ay(s){const a=s.tView;return null===a||a.incompleteFirstPass?s.tView=Yp(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):a}function Yp(s,a,i,e,t,n,r,o,l,c){const u=bn+e,d=u+t,h=function Bx(s,a){const i=[];for(let e=0;e<a;e++)i.push(e<s?null:un);return i}(u,d),f="function"==typeof c?c():c;return h[pt]={type:s,blueprint:h,template:i,queries:null,viewQuery:o,declTNode:a,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof n?n():n,pipeRegistry:"function"==typeof r?r():r,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function Cy(s,a,i,e){const t=$x(a);null===i?t.push(e):(t.push(i),s.firstCreatePass&&qx(s).push(e,t.length-1))}function Dy(s,a,i,e){for(let t in s)if(s.hasOwnProperty(t)){i=null===i?{}:i;const n=s[t];null===e?Iy(i,a,t,n):e.hasOwnProperty(t)&&Iy(i,a,e[t],n)}return i}function Iy(s,a,i,e){s.hasOwnProperty(i)?s[i].push(a,e):s[i]=[a,e]}function Py(s,a){const i=Mi(a,s);16&i[Zt]||(i[Zt]|=32)}function Xp(s,a,i,e){if(ja()){const t=null===e?null:{"":-1},n=function NM(s,a){const i=s.directiveRegistry;let e=null,t=null;if(i)for(let n=0;n<i.length;n++){const r=i[n];if(cy(a,r.selectors,!1))if(e||(e=[]),Or(r))if(null!==r.findHostDirectiveDefs){const o=[];t=t||new Map,r.findHostDirectiveDefs(r,o,t),e.unshift(...o,r),Ly(s,a,o.length)}else e.unshift(r),Ly(s,a,0);else t=t||new Map,r.findHostDirectiveDefs?.(r,e,t),e.push(r)}return null===e?null:[e,t]}(s,i);let r,o;null===n?r=o=null:[r,o]=n,null!==r&&Ry(s,a,i,r,t,o),t&&function FM(s,a,i){if(a){const e=s.localNames=[];for(let t=0;t<a.length;t+=2){const n=i[a[t+1]];if(null==n)throw new xe(-301,!1);e.push(a[t],n)}}}(i,e,t)}i.mergedAttrs=Ul(i.mergedAttrs,i.attrs)}function Ry(s,a,i,e,t,n){for(let c=0;c<e.length;c++)Xs(ha(i,a),s,e[c].type);!function BM(s,a,i){s.flags|=1,s.directiveStart=a,s.directiveEnd=a+i,s.providerIndexes=a}(i,s.data.length,e.length);for(let c=0;c<e.length;c++){const u=e[c];u.providersResolver&&u.providersResolver(u)}let r=!1,o=!1,l=Id(s,a,e.length,null);for(let c=0;c<e.length;c++){const u=e[c];i.mergedAttrs=Ul(i.mergedAttrs,u.hostAttrs),UM(s,i,a,l,u),kM(l,u,t),null!==u.contentQueries&&(i.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(i.flags|=64);const d=u.type.prototype;!r&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((s.preOrderHooks||(s.preOrderHooks=[])).push(i.index),r=!0),!o&&(d.ngOnChanges||d.ngDoCheck)&&((s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(i.index),o=!0),l++}!function Hx(s,a,i){const t=a.directiveEnd,n=s.data,r=a.attrs,o=[];let l=null,c=null;for(let u=a.directiveStart;u<t;u++){const d=n[u],h=i?i.get(d):null,p=h?h.outputs:null;l=Dy(d.inputs,u,l,h?h.inputs:null),c=Dy(d.outputs,u,c,p);const y=null===l||null===r||ly(a)?null:VM(l,u,r);o.push(y)}null!==l&&(l.hasOwnProperty("class")&&(a.flags|=8),l.hasOwnProperty("style")&&(a.flags|=16)),a.initialInputs=o,a.inputs=l,a.outputs=c}(s,i,n)}function Wx(s,a,i){const e=i.directiveStart,t=i.directiveEnd,n=i.index,r=function xh(){return Rt.lFrame.currentDirectiveIndex}();try{Qi(n);for(let o=e;o<t;o++){const l=s.data[o],c=a[o];Gc(o),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&OM(l,c)}}finally{Qi(-1),Gc(r)}}function OM(s,a){null!==s.hostBindings&&s.hostBindings(1,a)}function Ly(s,a,i){a.componentOffset=i,(s.components||(s.components=[])).push(a.index)}function kM(s,a,i){if(i){if(a.exportAs)for(let e=0;e<a.exportAs.length;e++)i[a.exportAs[e]]=s;Or(a)&&(i[""]=s)}}function UM(s,a,i,e,t){s.data[e]=t;const n=t.factory||(t.factory=us(t.type)),r=new Mn(n,Or(t),wu);s.blueprint[e]=r,i[e]=r,function PM(s,a,i,e,t){const n=t.hostBindings;if(n){let r=s.hostBindingOpCodes;null===r&&(r=s.hostBindingOpCodes=[]);const o=~a.index;(function RM(s){let a=s.length;for(;a>0;){const i=s[--a];if("number"==typeof i&&i<0)return i}return 0})(r)!=o&&r.push(o),r.push(i,e,n)}}(s,a,e,Id(s,i,t.hostVars,un),t)}function Ea(s,a,i,e,t,n){const r=Ii(s,a);!function Oy(s,a,i,e,t,n,r){if(null==n)s.removeAttribute(a,t,i);else{const o=null==r?Fe(n):r(n,e||"",t);s.setAttribute(a,t,o,i)}}(a[dn],r,n,s.value,i,e,t)}function HM(s,a,i,e,t,n){const r=n[a];if(null!==r){const o=e.setInput;for(let l=0;l<r.length;){const c=r[l++],u=r[l++],d=r[l++];null!==o?e.setInput(i,d,c,u):i[u]=d}}}function VM(s,a,i){let e=null,t=0;for(;t<i.length;){const n=i[t];if(0!==n)if(5!==n){if("number"==typeof n)break;if(s.hasOwnProperty(n)){null===e&&(e=[]);const r=s[n];for(let o=0;o<r.length;o+=2)if(r[o]===a){e.push(n,r[o+1],i[t+1]);break}}t+=2}else t+=2;else t+=4}return e}function jx(s,a,i,e){return[s,!0,!1,a,null,0,e,i,null,null]}function jM(s,a){const i=Mi(a,s);if(Fo(i)){const e=i[pt];48&i[Zt]?af(e,i,e.template,i[Kn]):i[Cs]>0&&Ny(i)}}function Ny(s){for(let e=Nh(s);null!==e;e=Fh(e))for(let t=zi;t<e.length;t++){const n=e[t];if(Fo(n))if(512&n[Zt]){const r=n[pt];af(r,n,r.template,n[Kn])}else n[Cs]>0&&Ny(n)}const i=s[pt].components;if(null!==i)for(let e=0;e<i.length;e++){const t=Mi(i[e],s);Fo(t)&&t[Cs]>0&&Ny(t)}}function $M(s,a){const i=Mi(a,s),e=i[pt];(function qM(s,a){for(let i=a.length;i<s.blueprint.length;i++)a.push(s.blueprint[i])})(e,i),Wp(e,i,i[Kn])}function Zp(s,a){return s[qr]?s[Il][fr]=a:s[qr]=a,s[Il]=a,a}function Fy(s){for(;s;){s[Zt]|=32;const a=_d(s);if(Ol(s)&&!a)return s;s=a}return null}function Kp(s,a,i,e=!0){const t=a[Ds];t.begin&&t.begin();try{af(s,a,s.template,i)}catch(r){throw e&&Xx(a,r),r}finally{t.end&&t.end()}}function ky(s,a,i){$c(0),a(s,i)}function $x(s){return s[pi]||(s[pi]=[])}function qx(s){return s.cleanup||(s.cleanup=[])}function Xx(s,a){const i=s[Co],e=i?i.get(al,null):null;e&&e.handleError(a)}function By(s,a,i,e,t){for(let n=0;n<i.length;){const r=i[n++],o=i[n++],l=a[r],c=s.data[r];null!==c.setInput?c.setInput(l,t,e,o):l[o]=t}}function dt(s,a,i){let e=i?s.styles:null,t=i?s.classes:null,n=0;if(null!==a)for(let r=0;r<a.length;r++){const o=a[r];"number"==typeof o?n=o:1==n?t=at(t,o):2==n&&(e=at(e,o+": "+a[++r]+";"))}i?s.styles=e:s.stylesWithoutHost=e,i?s.classes=t:s.classesWithoutHost=t}function xs(s,a,i,e,t=!1){for(;null!==i;){const n=a[i.index];if(null!==n&&e.push(li(n)),Xr(n))for(let o=zi;o<n.length;o++){const l=n[o],c=l[pt].firstChild;null!==c&&xs(l[pt],l,c,e)}const r=i.type;if(8&r)xs(s,a,i.child,e);else if(32&r){const o=xp(i,a);let l;for(;l=o();)e.push(l)}else if(16&r){const o=B_(a,i);if(Array.isArray(o))e.push(...o);else{const l=_d(a[Ci]);xs(l[pt],l,o,e,!0)}}i=t?i.projectionNext:i.next}return e}class ll{get rootNodes(){const a=this._lView,i=a[pt];return xs(i,a,i.firstChild,[])}constructor(a,i){this._lView=a,this._cdRefInjectingView=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Kn]}set context(a){this._lView[Kn]=a}get destroyed(){return 128==(128&this._lView[Zt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const a=this._lView[Vn];if(Xr(a)){const i=a[Ua],e=i?i.indexOf(this):-1;e>-1&&(wd(a,e),Zs(i,e))}this._attachedToViewContainer=!1}Mp(this._lView[pt],this._lView)}onDestroy(a){Cy(this._lView[pt],this._lView,null,a)}markForCheck(){Fy(this._cdRefInjectingView||this._lView)}detach(){this._lView[Zt]&=-65}reattach(){this._lView[Zt]|=64}detectChanges(){Kp(this._lView[pt],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new xe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function N_(s,a){eo(s,a,a[dn],2,null,null)}(this._lView[pt],this._lView)}attachToAppRef(a){if(this._attachedToViewContainer)throw new xe(902,!1);this._appRef=a}}class Zx extends ll{constructor(a){super(a),this._view=a}detectChanges(){const a=this._view;Kp(a[pt],a,a[Kn],!1)}checkNoChanges(){}get context(){return null}}class Uy extends Dd{constructor(a){super(),this.ngModule=a}resolveComponentFactory(a){const i=ln(a);return new Pd(i,this.ngModule)}}function zy(s){const a=[];for(let i in s)s.hasOwnProperty(i)&&a.push({propName:s[i],templateName:i});return a}class Qx{constructor(a,i){this.injector=a,this.parentInjector=i}get(a,i,e){e=Yi(e);const t=this.injector.get(a,Fp,e);return t!==Fp||i===Fp?t:this.parentInjector.get(a,i,e)}}class Pd extends tc{get inputs(){return zy(this.componentDef.inputs)}get outputs(){return zy(this.componentDef.outputs)}constructor(a,i){super(),this.componentDef=a,this.ngModule=i,this.componentType=a.type,this.selector=function mx(s){return s.map(px).join(",")}(a.selectors),this.ngContentSelectors=a.ngContentSelectors?a.ngContentSelectors:[],this.isBoundToModule=!!i}create(a,i,e,t){let n=(t=t||this.ngModule)instanceof oo?t:t?.injector;n&&null!==this.componentDef.getStandaloneInjector&&(n=this.componentDef.getStandaloneInjector(n)||n);const r=n?new Qx(a,n):a,o=r.get(ic,null);if(null===o)throw new xe(407,!1);const l=r.get(tf,null),c=o.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",d=e?function Ux(s,a,i){return s.selectRootElement(a,i===$t.ShadowDom)}(c,e,this.componentDef.encapsulation):lr(c,u,function Kx(s){const a=s.toLowerCase();return"svg"===a?Oo:"math"===a?"math":null}(u)),h=this.componentDef.onPush?288:272,f=Yp(0,null,null,1,0,null,null,null,null,null),p=sf(null,f,null,h,null,null,o,c,l,r,null);let y,x;Jr(p);try{const _=this.componentDef;let w,S=null;_.findHostDirectiveDefs?(w=[],S=new Map,_.findHostDirectiveDefs(_,w,S),w.push(_)):w=[_];const D=function Hy(s,a){const i=s[pt],e=bn;return s[e]=a,bu(i,e,2,"#host",null)}(p,d),T=function oc(s,a,i,e,t,n,r,o){const l=t[pt];!function Qp(s,a,i,e){for(const t of s)a.mergedAttrs=Ul(a.mergedAttrs,t.hostAttrs);null!==a.mergedAttrs&&(dt(a,a.mergedAttrs,!0),null!==i&&_a(e,i,a))}(e,s,a,r);const c=n.createRenderer(a,i),u=sf(t,Ay(i),null,i.onPush?32:16,t[s.index],s,n,c,o||null,null,null);return l.firstCreatePass&&Ly(l,s,e.length-1),Zp(t,u),t[s.index]=u}(D,d,_,w,p,o,c);x=sd(f,bn),d&&function Jp(s,a,i,e){if(e)ua(s,i,["ng-version",Np.full]);else{const{attrs:t,classes:n}=function gx(s){const a=[],i=[];let e=1,t=2;for(;e<s.length;){let n=s[e];if("string"==typeof n)2===t?""!==n&&a.push(n,s[++e]):8===t&&i.push(n);else{if(!ao(t))break;t=n}e++}return{attrs:a,classes:i}}(a.selectors[0]);t&&ua(s,i,t),n&&n.length>0&&Kl(s,i,n.join(" "))}}(c,_,d,e),void 0!==i&&function ac(s,a,i){const e=s.projection=[];for(let t=0;t<a.length;t++){const n=i[t];e.push(null!=n?Array.from(n):null)}}(x,this.ngContentSelectors,i),y=function Vy(s,a,i,e,t,n){const r=mi(),o=t[pt],l=Ii(r,t);Ry(o,t,r,i,null,e);for(let u=0;u<i.length;u++)ji(ts(t,o,r.directiveStart+u,r),t);Wx(o,t,r),l&&ji(l,t);const c=ts(t,o,r.directiveStart+r.componentOffset,r);if(s[Kn]=t[Kn]=c,null!==n)for(const u of n)u(c,a);return jp(o,r,s),c}(T,_,w,S,p,[Mu]),Wp(f,p,null)}finally{ud()}return new lf(this.componentType,y,vs(x,p),p,x)}}class lf extends yu{constructor(a,i,e,t,n){super(),this.location=e,this._rootLView=t,this._tNode=n,this.instance=i,this.hostView=this.changeDetectorRef=new Zx(t),this.componentType=a}setInput(a,i){const e=this._tNode.inputs;let t;if(null!==e&&(t=e[a])){const n=this._rootLView;By(n[pt],n,t,a,i),Py(n,this._tNode.index)}}get injector(){return new Qn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(a){this.hostView.onDestroy(a)}}function Mu(){const s=mi();N(Pe()[pt],s)}function df(s){return!!hf(s)&&(Array.isArray(s)||!(s instanceof Map)&&Symbol.iterator in s)}function hf(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function lo(s,a,i){return s[a]=i}function yr(s,a,i){return!Object.is(s[a],i)&&(s[a]=i,!0)}function Ni(s,a,i,e){const t=Pe();return yr(t,Nr(),a)&&(hn(),Ea(_n(),t,s,a,i,e)),Ni}function a0(s,a,i,e,t,n,r,o){const l=Pe(),c=hn(),u=s+bn,d=c.firstCreatePass?function sw(s,a,i,e,t,n,r,o,l){const c=a.consts,u=bu(a,s,4,r||null,ds(c,o));Xp(a,i,u,ds(c,l)),N(a,u);const d=u.tView=Yp(2,u,e,t,n,a.directiveRegistry,a.pipeRegistry,null,a.schemas,c);return null!==a.queries&&(a.queries.template(a,u),d.queries=a.queries.embeddedTView(u)),u}(u,c,l,a,i,e,t,n,r):c.data[u];Zr(d,!1);const h=l[dn].createComment("");Wo(c,l,h,d),ji(h,l),Zp(l,l[u]=jx(h,l,h,d)),za(d)&&$p(c,l,d),null!=r&&qp(l,d,o)}function im(s,a,i){const e=Pe();return yr(e,Nr(),a)&&function _s(s,a,i,e,t,n,r,o){const l=Ii(a,i);let u,c=a.inputs;!o&&null!=c&&(u=c[e])?(By(s,i,u,e,t),ea(a)&&Py(i,a.index)):3&a.type&&(e=function Vx(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(e),t=null!=r?r(t,a.value||"",e):t,n.setProperty(l,e,t))}(hn(),_n(),e,s,a,e[dn],i,!1),im}function rm(s,a,i,e,t){const r=t?"class":"style";By(s,i,a.inputs[r],r,e)}function ff(s,a,i,e){const t=Pe(),n=hn(),r=bn+s,o=t[dn],l=n.firstCreatePass?function lw(s,a,i,e,t,n){const r=a.consts,l=bu(a,s,2,e,ds(r,t));return Xp(a,i,l,ds(r,n)),null!==l.attrs&&dt(l,l.attrs,!1),null!==l.mergedAttrs&&dt(l,l.mergedAttrs,!0),null!==a.queries&&a.queries.elementStart(a,l),l}(r,n,t,a,i,e):n.data[r],c=t[r]=lr(o,a,function I(){return Rt.lFrame.currentNamespace}()),u=za(l);return Zr(l,!0),_a(o,c,l),32!=(32&l.flags)&&Wo(n,t,c,l),0===function ci(){return Rt.lFrame.elementDepthCount}()&&ji(c,t),function ph(){Rt.lFrame.elementDepthCount++}(),u&&($p(n,t,l),jp(n,l,t)),null!==e&&qp(t,l),ff}function pf(){let s=mi();aa()?$s():(s=s.parent,Zr(s,!1));const a=s;!function od(){Rt.lFrame.elementDepthCount--}();const i=hn();return i.firstCreatePass&&(N(i,s),Ll(s)&&i.queries.elementEnd(s)),null!=a.classesWithoutHost&&function fs(s){return 0!=(8&s.flags)}(a)&&rm(i,a,Pe(),a.classesWithoutHost,!0),null!=a.stylesWithoutHost&&function es(s){return 0!=(16&s.flags)}(a)&&rm(i,a,Pe(),a.stylesWithoutHost,!1),pf}function sm(s,a,i,e){return ff(s,a,i,e),pf(),sm}function mf(s,a,i){const e=Pe(),t=hn(),n=s+bn,r=t.firstCreatePass?function cw(s,a,i,e,t){const n=a.consts,r=ds(n,e),o=bu(a,s,8,"ng-container",r);return null!==r&&dt(o,r,!0),Xp(a,i,o,ds(n,t)),null!==a.queries&&a.queries.elementStart(a,o),o}(n,t,e,a,i):t.data[n];Zr(r,!0);const o=e[n]=e[dn].createComment("");return Wo(t,e,o,r),ji(o,e),za(r)&&($p(t,e,r),jp(t,r,e)),null!=i&&qp(e,r),mf}function gf(){let s=mi();const a=hn();return aa()?$s():(s=s.parent,Zr(s,!1)),a.firstCreatePass&&(N(a,s),Ll(s)&&a.queries.elementEnd(s)),gf}function c0(){return Pe()}function om(s){return!!s&&"function"==typeof s.then}function u0(s){return!!s&&"function"==typeof s.subscribe}const d0=u0;function am(s,a,i,e){const t=Pe(),n=hn(),r=mi();return function f0(s,a,i,e,t,n,r){const o=za(e),c=s.firstCreatePass&&qx(s),u=a[Kn],d=$x(a);let h=!0;if(3&e.type||r){const y=Ii(e,a),x=r?r(y):y,_=d.length,w=r?D=>r(li(D[e.index])):e.index;let S=null;if(!r&&o&&(S=function uw(s,a,i,e){const t=s.cleanup;if(null!=t)for(let n=0;n<t.length-1;n+=2){const r=t[n];if(r===i&&t[n+1]===e){const o=a[pi],l=t[n+2];return o.length>l?o[l]:null}"string"==typeof r&&(n+=2)}return null}(s,a,t,e.index)),null!==S)(S.__ngLastListenerFn__||S).__ngNextListenerFn__=n,S.__ngLastListenerFn__=n,h=!1;else{n=m0(e,a,u,n,!1);const D=i.listen(x,t,n);d.push(n,D),c&&c.push(t,w,_,_+1)}}else n=m0(e,a,u,n,!1);const f=e.outputs;let p;if(h&&null!==f&&(p=f[t])){const y=p.length;if(y)for(let x=0;x<y;x+=2){const T=a[p[x]][p[x+1]].subscribe(n),P=d.length;d.push(n,T),c&&c.push(t,e.index,P,-(P+1))}}}(n,t,t[dn],r,s,a,e),am}function p0(s,a,i,e){try{return Hi(6,a,i),!1!==i(e)}catch(t){return Xx(s,t),!1}finally{Hi(7,a,i)}}function m0(s,a,i,e,t){return function n(r){if(r===Function)return e;Fy(s.componentOffset>-1?Mi(s.index,a):a);let l=p0(a,i,e,r),c=n.__ngNextListenerFn__;for(;c;)l=p0(a,i,c,r)&&l,c=c.__ngNextListenerFn__;return t&&!1===l&&(r.preventDefault(),r.returnValue=!1),l}}function g0(s=1){return function dd(s){return(Rt.lFrame.contextLView=function bh(s,a){for(;s>0;)a=a[Gs],s--;return a}(s,Rt.lFrame.contextLView))[Kn]}(s)}function dw(s,a){let i=null;const e=function ux(s){const a=s.attrs;if(null!=a){const i=a.indexOf(5);if(!(1&i))return a[i+1]}return null}(s);for(let t=0;t<a.length;t++){const n=a[t];if("*"!==n){if(null===e?cy(s,n,!0):fx(e,n))return t}else i=t}return i}function yf(s){const a=Pe()[Ci][bi];if(!a.projection){const e=a.projection=$l(s?s.length:1,null),t=e.slice();let n=a.child;for(;null!==n;){const r=s?dw(n,s):0;null!==r&&(t[r]?t[r].projectionNext=n:e[r]=n,t[r]=n),n=n.next}}}function lm(s,a=0,i){const e=Pe(),t=hn(),n=bu(t,bn+s,16,null,i||null);null===n.projection&&(n.projection=a),$s(),32!=(32&n.flags)&&function va(s,a,i){nl(a[dn],0,a,i,Ug(s,i,a),Zl(i.parent||a[bi],i,a))}(t,e,n)}function vf(s,a){return s<<17|a<<2}function ul(s){return s>>17&32767}function _f(s){return 2|s}function lc(s){return(131068&s)>>2}function Nd(s,a){return-131069&s|a<<2}function dm(s){return 1|s}function T0(s,a,i,e,t){const n=s[i+1],r=null===a;let o=e?ul(n):lc(n),l=!1;for(;0!==o&&(!1===l||r);){const u=s[o+1];mw(s[o],a)&&(l=!0,s[o+1]=e?dm(u):_f(u)),o=e?ul(u):lc(u)}l&&(s[i+1]=e?_f(n):dm(n))}function mw(s,a){return null===s||null==a||(Array.isArray(s)?s[1]:s)===a||!(!Array.isArray(s)||"string"!=typeof a)&&pa(s,a)>=0}const tr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function A0(s){return s.substring(tr.key,tr.keyEnd)}function C0(s,a){const i=tr.textEnd;return i===a?-1:(a=tr.keyEnd=function P0(s,a,i){for(;a<i&&s.charCodeAt(a)>32;)a++;return a}(s,tr.key=a,i),Lu(s,a,i))}function Lu(s,a,i){for(;a<i&&s.charCodeAt(a)<=32;)a++;return a}function hm(s){!function fo(s,a,i,e){const t=hn(),n=function Qr(s){const a=Rt.lFrame,i=a.bindingIndex;return a.bindingIndex=a.bindingIndex+s,i}(2);t.firstUpdatePass&&function B0(s,a,i,e){const t=s.data;if(null===t[i+1]){const n=t[ui()],r=k0(s,i);xf(n,e)&&null===a&&!r&&(a=!1),a=function ww(s,a,i,e){const t=function Wc(s){const a=Rt.lFrame.currentDirectiveIndex;return-1===a?null:s[a]}(s);let n=e?a.residualClasses:a.residualStyles;if(null===t)0===(e?a.classBindings:a.styleBindings)&&(i=cc(i=fm(null,s,a,i,e),a.attrs,e),n=null);else{const r=a.directiveStylingLast;if(-1===r||s[r]!==t)if(i=fm(t,s,a,i,e),null===n){let l=function bw(s,a,i){const e=i?a.classBindings:a.styleBindings;if(0!==lc(e))return s[ul(e)]}(s,a,e);void 0!==l&&Array.isArray(l)&&(l=fm(null,s,a,l[1],e),l=cc(l,a.attrs,e),function Mw(s,a,i,e){s[ul(i?a.classBindings:a.styleBindings)]=e}(s,a,e,l))}else n=function dl(s,a,i){let e;const t=a.directiveEnd;for(let n=1+a.directiveStylingLast;n<t;n++)e=cc(e,s[n].hostAttrs,i);return cc(e,a.attrs,i)}(s,a,e)}return void 0!==n&&(e?a.residualClasses=n:a.residualStyles=n),i}(t,n,a,e),function E0(s,a,i,e,t,n){let r=n?a.classBindings:a.styleBindings,o=ul(r),l=lc(r);s[e]=i;let u,c=!1;if(Array.isArray(i)?(u=i[1],(null===u||pa(i,u)>0)&&(c=!0)):u=i,t)if(0!==l){const h=ul(s[o+1]);s[e+1]=vf(h,o),0!==h&&(s[h+1]=Nd(s[h+1],e)),s[o+1]=function S0(s,a){return 131071&s|a<<17}(s[o+1],e)}else s[e+1]=vf(o,0),0!==o&&(s[o+1]=Nd(s[o+1],e)),o=e;else s[e+1]=vf(l,0),0===o?o=e:s[l+1]=Nd(s[l+1],e),l=e;c&&(s[e+1]=_f(s[e+1])),T0(s,u,e,!0),T0(s,u,e,!1),function pw(s,a,i,e,t){const n=t?s.residualClasses:s.residualStyles;null!=n&&"string"==typeof a&&pa(n,a)>=0&&(i[e+1]=dm(i[e+1]))}(a,u,s,e,n),r=vf(o,l),n?a.classBindings=r:a.styleBindings=r}(t,n,a,i,r,e)}}(t,null,n,e);const r=Pe();if(i!==un&&yr(r,n,i)){const o=t.data[ui()];if(xf(o,e)&&!k0(t,n)){let l=e?o.classesWithoutHost:o.stylesWithoutHost;null!==l&&(i=at(l,i||"")),rm(t,o,r,i,e)}else!function Ew(s,a,i,e,t,n,r,o){t===un&&(t=qt);let l=0,c=0,u=0<t.length?t[0]:null,d=0<n.length?n[0]:null;for(;null!==u||null!==d;){const h=l<t.length?t[l+1]:void 0,f=c<n.length?n[c+1]:void 0;let y,p=null;u===d?(l+=2,c+=2,h!==f&&(p=d,y=f)):null===d||null!==u&&u<d?(l+=2,p=u):(c+=2,p=d,y=f),null!==p&&z0(s,a,i,e,p,y,r,o),u=l<t.length?t[l]:null,d=c<n.length?n[c]:null}}(t,o,r,r[dn],r[n+1],r[n+1]=function Sw(s,a,i){if(null==i||""===i)return qt;const e=[],t=cr(i);if(Array.isArray(t))for(let n=0;n<t.length;n++)s(e,t[n],!0);else if("object"==typeof t)for(const n in t)t.hasOwnProperty(n)&&s(e,n,t[n]);else"string"==typeof t&&a(e,t);return e}(s,a,i),e,n)}}(Mr,uo,s,!0)}function uo(s,a){for(let i=function yw(s){return function I0(s){tr.key=0,tr.keyEnd=0,tr.value=0,tr.valueEnd=0,tr.textEnd=s.length}(s),C0(s,Lu(s,0,tr.textEnd))}(a);i>=0;i=C0(a,i))Mr(s,A0(a),!0)}function k0(s,a){return a>=s.expandoStartIndex}function fm(s,a,i,e,t){let n=null;const r=i.directiveEnd;let o=i.directiveStylingLast;for(-1===o?o=i.directiveStart:o++;o<r&&(n=a[o],e=cc(e,n.hostAttrs,t),n!==s);)o++;return null!==s&&(i.directiveStylingLast=o),e}function cc(s,a,i){const e=i?1:2;let t=-1;if(null!==a)for(let n=0;n<a.length;n++){const r=a[n];"number"==typeof r?t=r:t===e&&(Array.isArray(s)||(s=void 0===s?[]:["",s]),Mr(s,r,!!i||a[++n]))}return void 0===s?null:s}function z0(s,a,i,e,t,n,r,o){if(!(3&a.type))return;const l=s.data,c=l[o+1],u=function hw(s){return 1==(1&s)}(c)?H0(l,a,i,t,lc(c),r):void 0;Ou(u)||(Ou(n)||function Od(s){return 2==(2&s)}(c)&&(n=H0(l,null,i,t,o,r)),function su(s,a,i,e,t){if(a)t?s.addClass(i,e):s.removeClass(i,e);else{let n=-1===e.indexOf("-")?void 0:ms.DashCase;null==t?s.removeStyle(i,e,n):("string"==typeof t&&t.endsWith("!important")&&(t=t.slice(0,-10),n|=ms.Important),s.setStyle(i,e,t,n))}}(e,r,Ga(ui(),i),t,n))}function H0(s,a,i,e,t,n){const r=null===a;let o;for(;t>0;){const l=s[t],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=i[t+1];h===un&&(h=d?qt:void 0);let f=d?nu(h,e):u===e?h:void 0;if(c&&!Ou(f)&&(f=nu(l,e)),Ou(f)&&(o=f,r))return o;const p=s[t+1];t=r?ul(p):lc(p)}if(null!==a){let l=n?a.residualClasses:a.residualStyles;null!=l&&(o=nu(l,e))}return o}function Ou(s){return void 0!==s}function xf(s,a){return 0!=(s.flags&(a?8:16))}function wf(s,a=""){const i=Pe(),e=hn(),t=s+bn,n=e.firstCreatePass?bu(e,t,1,a,null):e.data[t],r=i[t]=function Jn(s,a){return s.createText(a)}(i[dn],a);Wo(e,i,r,n),Zr(n,!1)}function bf(s){return Nu("",s,""),bf}function Nu(s,a,i){const e=Pe(),t=function Ta(s,a,i,e){return yr(s,Nr(),i)?a+Fe(i)+e:un}(e,s,a,i);return t!==un&&function en(s,a,i){const e=Ga(a,s);!function kg(s,a,i){s.setValue(a,i)}(s[dn],e,i)}(e,ui(),t),Nu}const po=void 0;var rs=["en",[["a","p"],["AM","PM"],po],[["AM","PM"],po,po],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],po,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],po,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",po,"{1} 'at' {0}",po],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Q0(s){const i=Math.floor(Math.abs(s)),e=s.toString().replace(/^[^.]*\.?/,"").length;return 1===i&&0===e?1:5}];let pc={};function Cf(s){const a=function Df(s){return s.toLowerCase().replace(/_/g,"-")}(s);let i=fl(a);if(i)return i;const e=a.split("-")[0];if(i=fl(e),i)return i;if("en"===e)return rs;throw new xe(701,!1)}function zd(s){return Cf(s)[jt.PluralCase]}function fl(s){return s in pc||(pc[s]=ni.ng&&ni.ng.common&&ni.ng.common.locales&&ni.ng.common.locales[s]),pc[s]}var jt=(()=>((jt=jt||{})[jt.LocaleId=0]="LocaleId",jt[jt.DayPeriodsFormat=1]="DayPeriodsFormat",jt[jt.DayPeriodsStandalone=2]="DayPeriodsStandalone",jt[jt.DaysFormat=3]="DaysFormat",jt[jt.DaysStandalone=4]="DaysStandalone",jt[jt.MonthsFormat=5]="MonthsFormat",jt[jt.MonthsStandalone=6]="MonthsStandalone",jt[jt.Eras=7]="Eras",jt[jt.FirstDayOfWeek=8]="FirstDayOfWeek",jt[jt.WeekendRange=9]="WeekendRange",jt[jt.DateFormat=10]="DateFormat",jt[jt.TimeFormat=11]="TimeFormat",jt[jt.DateTimeFormat=12]="DateTimeFormat",jt[jt.NumberSymbols=13]="NumberSymbols",jt[jt.NumberFormats=14]="NumberFormats",jt[jt.CurrencyCode=15]="CurrencyCode",jt[jt.CurrencySymbol=16]="CurrencySymbol",jt[jt.CurrencyName=17]="CurrencyName",jt[jt.Currencies=18]="Currencies",jt[jt.Directionality=19]="Directionality",jt[jt.PluralCase=20]="PluralCase",jt[jt.ExtraData=21]="ExtraData",jt))();const mc="en-US";let Lw=mc;class ml{}class zf{}function eb(s,a){return new zm(s,a??null)}class zm extends ml{constructor(a,i){super(),this._parent=i,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Uy(this);const e=Ai(a);this._bootstrapComponents=Sa(e.bootstrap),this._r3Injector=yy(a,i,[{provide:ml,useValue:this},{provide:Dd,useValue:this.componentFactoryResolver}],ot(a),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(a)}get injector(){return this._r3Injector}destroy(){const a=this._r3Injector;!a.destroyed&&a.destroy(),this.destroyCbs.forEach(i=>i()),this.destroyCbs=null}onDestroy(a){this.destroyCbs.push(a)}}class Hm extends zf{constructor(a){super(),this.moduleType=a}create(a){return new zm(this.moduleType,a)}}class nb extends ml{constructor(a,i,e){super(),this.componentFactoryResolver=new Uy(this),this.instance=null;const t=new Kh([...a,{provide:ml,useValue:this},{provide:Dd,useValue:this.componentFactoryResolver}],i||rl(),e,new Set(["environment"]));this.injector=t,t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(a){this.injector.onDestroy(a)}}function Gu(s,a,i=null){return new nb(s,a,i).injector}let gl=(()=>{class s{constructor(i){this._injector=i,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(i){if(!i.standalone)return null;if(!this.cachedInjectors.has(i.id)){const e=It(0,i.type),t=e.length>0?Gu([e],this._injector,`Standalone[${i.type.name}]`):null;this.cachedInjectors.set(i.id,t)}return this.cachedInjectors.get(i.id)}ngOnDestroy(){try{for(const i of this.cachedInjectors.values())null!==i&&i.destroy()}finally{this.cachedInjectors.clear()}}}return s.\u0275prov=yn({token:s,providedIn:"environment",factory:()=>new s(mn(oo))}),s})();function _v(s){s.getStandaloneInjector=a=>a.get(gl).getOrCreateStandaloneInjector(s)}function Cv(s,a,i){const e=Vi()+s,t=Pe();return t[e]===un?lo(t,e,i?a.call(i):a()):function Su(s,a){return s[a]}(t,e)}function go(s,a,i,e){return function Iv(s,a,i,e,t,n){const r=a+i;return yr(s,r,t)?lo(s,r+1,n?e.call(n,t):e(t)):nh(s,r+1)}(Pe(),Vi(),s,a,i,e)}function bc(s,a,i,e,t){return function Sc(s,a,i,e,t,n,r){const o=a+i;return function cl(s,a,i,e){const t=yr(s,a,i);return yr(s,a+1,e)||t}(s,o,t,n)?lo(s,o+2,r?e.call(r,t,n):e(t,n)):nh(s,o+2)}(Pe(),Vi(),s,a,i,e,t)}function nh(s,a){const i=s[a];return i===un?void 0:i}function Wm(s){return a=>{setTimeout(s,void 0,a)}}const Bs=class Wf extends C.x{constructor(a=!1){super(),this.__isAsync=a}emit(a){super.next(a)}subscribe(a,i,e){let t=a,n=i||(()=>null),r=e;if(a&&"object"==typeof a){const l=a;t=l.next?.bind(l),n=l.error?.bind(l),r=l.complete?.bind(l)}this.__isAsync&&(n=Wm(n),t&&(t=Wm(t)),r&&(r=Wm(r)));const o=super.subscribe({next:t,error:n,complete:r});return a instanceof O.w0&&a.add(o),o}};function Rv(){return this._results[Symbol.iterator]()}class jf{get changes(){return this._changes||(this._changes=new Bs)}constructor(a=!1){this._emitDistinctChangesOnly=a,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const i=jf.prototype;i[Symbol.iterator]||(i[Symbol.iterator]=Rv)}get(a){return this._results[a]}map(a){return this._results.map(a)}filter(a){return this._results.filter(a)}find(a){return this._results.find(a)}reduce(a,i){return this._results.reduce(a,i)}forEach(a){this._results.forEach(a)}some(a){return this._results.some(a)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(a,i){const e=this;e.dirty=!1;const t=function Fr(s){return s.flat(Number.POSITIVE_INFINITY)}(a);(this._changesDetected=!function pd(s,a,i){if(s.length!==a.length)return!1;for(let e=0;e<s.length;e++){let t=s[e],n=a[e];if(i&&(t=i(t),n=i(n)),n!==t)return!1}return!0}(e._results,t,i))&&(e._results=t,e.length=t.length,e.last=t[this.length-1],e.first=t[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Ec=(()=>{class s{}return s.__NG_ELEMENT_ID__=Ov,s})();const ab=Ec,Lv=class extends ab{constructor(a,i,e){super(),this._declarationLView=a,this._declarationTContainer=i,this.elementRef=e}createEmbeddedView(a,i){const e=this._declarationTContainer.tView,t=sf(this._declarationLView,e,a,16,null,e.declTNode,null,null,null,null,i||null);t[Bi]=this._declarationLView[this._declarationTContainer.index];const r=this._declarationLView[Ui];return null!==r&&(t[Ui]=r.createEmbeddedView(e)),Wp(e,t,a),new ll(t)}};function Ov(){return vl(mi(),Pe())}function vl(s,a){return 4&s.type?new Lv(a,s,vs(s,a)):null}let $u=(()=>{class s{}return s.__NG_ELEMENT_ID__=lb,s})();function lb(){return Fv(mi(),Pe())}const $f=$u,Nv=class extends $f{constructor(a,i,e){super(),this._lContainer=a,this._hostTNode=i,this._hostLView=e}get element(){return vs(this._hostTNode,this._hostLView)}get injector(){return new Qn(this._hostTNode,this._hostLView)}get parentInjector(){const a=Rs(this._hostTNode,this._hostLView);if(Xc(a)){const i=Kc(a,this._hostLView),e=Zc(a);return new Qn(i[pt].data[e+8],i)}return new Qn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(a){const i=jm(this._lContainer);return null!==i&&i[a]||null}get length(){return this._lContainer.length-zi}createEmbeddedView(a,i,e){let t,n;"number"==typeof e?t=e:null!=e&&(t=e.index,n=e.injector);const r=a.createEmbeddedView(i||{},n);return this.insert(r,t),r}createComponent(a,i,e,t,n){const r=a&&!function Go(s){return"function"==typeof s}(a);let o;if(r)o=i;else{const d=i||{};o=d.index,e=d.injector,t=d.projectableNodes,n=d.environmentInjector||d.ngModuleRef}const l=r?a:new Pd(ln(a)),c=e||this.parentInjector;if(!n&&null==l.ngModule){const h=(r?c:this.parentInjector).get(oo,null);h&&(n=h)}const u=l.create(c,t,void 0,n);return this.insert(u.hostView,o),u}insert(a,i){const e=a._lView,t=e[pt];if(function fh(s){return Xr(s[Vn])}(e)){const u=this.indexOf(a);if(-1!==u)this.detach(u);else{const d=e[Vn],h=new Nv(d,d[bi],d[Vn]);h.detach(h.indexOf(a))}}const n=this._adjustIndex(i),r=this._lContainer;!function xd(s,a,i,e){const t=zi+e,n=i.length;e>0&&(i[t-1][fr]=a),e<n-zi?(a[fr]=i[t],Ah(i,zi+e,a)):(i.push(a),a[fr]=null),a[Vn]=i;const r=a[Bi];null!==r&&i!==r&&function gr(s,a){const i=s[Po];a[Ci]!==a[Vn][Vn][Ci]&&(s[Io]=!0),null===i?s[Po]=[a]:i.push(a)}(r,a);const o=a[Ui];null!==o&&o.insertView(s),a[Zt]|=64}(t,e,r,n);const o=Bh(n,r),l=e[dn],c=ya(l,r[Rl]);return null!==c&&function Bg(s,a,i,e,t,n){e[$r]=t,e[bi]=a,eo(s,e,i,1,t,n)}(t,r[bi],l,e,c,o),a.attachToViewContainerRef(),Ah(qf(r),n,a),a}move(a,i){return this.insert(a,i)}indexOf(a){const i=jm(this._lContainer);return null!==i?i.indexOf(a):-1}remove(a){const i=this._adjustIndex(a,-1),e=wd(this._lContainer,i);e&&(Zs(qf(this._lContainer),i),Mp(e[pt],e))}detach(a){const i=this._adjustIndex(a,-1),e=wd(this._lContainer,i);return e&&null!=Zs(qf(this._lContainer),i)?new ll(e):null}_adjustIndex(a,i=0){return a??this.length+i}};function jm(s){return s[Ua]}function qf(s){return s[Ua]||(s[Ua]=[])}function Fv(s,a){let i;const e=a[s.index];if(Xr(e))i=e;else{let t;if(8&s.type)t=li(e);else{const n=a[dn];t=n.createComment("");const r=Ii(s,a);Xl(n,ya(n,r),t,function Vg(s,a){return s.nextSibling(a)}(n,r),!1)}a[s.index]=i=jx(e,a,t,s),Zp(a,i)}return new Nv(i,s,a)}class $m{constructor(a){this.queryList=a,this.matches=null}clone(){return new $m(this.queryList)}setDirty(){this.queryList.setDirty()}}class qm{constructor(a=[]){this.queries=a}createEmbeddedView(a){const i=a.queries;if(null!==i){const e=null!==a.contentQueries?a.contentQueries[0]:i.length,t=[];for(let n=0;n<e;n++){const r=i.getByIndex(n);t.push(this.queries[r.indexInDeclarationView].clone())}return new qm(t)}return null}insertView(a){this.dirtyQueriesWithMatches(a)}detachView(a){this.dirtyQueriesWithMatches(a)}dirtyQueriesWithMatches(a){for(let i=0;i<this.queries.length;i++)null!==fb(a,i).matches&&this.queries[i].setDirty()}}class Yf{constructor(a,i,e=null){this.predicate=a,this.flags=i,this.read=e}}class Tc{constructor(a=[]){this.queries=a}elementStart(a,i){for(let e=0;e<this.queries.length;e++)this.queries[e].elementStart(a,i)}elementEnd(a){for(let i=0;i<this.queries.length;i++)this.queries[i].elementEnd(a)}embeddedTView(a){let i=null;for(let e=0;e<this.length;e++){const t=null!==i?i.length:0,n=this.getByIndex(e).embeddedTView(a,t);n&&(n.indexInDeclarationView=e,null!==i?i.push(n):i=[n])}return null!==i?new Tc(i):null}template(a,i){for(let e=0;e<this.queries.length;e++)this.queries[e].template(a,i)}getByIndex(a){return this.queries[a]}get length(){return this.queries.length}track(a){this.queries.push(a)}}class Ym{constructor(a,i=-1){this.metadata=a,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=i}elementStart(a,i){this.isApplyingToNode(i)&&this.matchTNode(a,i)}elementEnd(a){this._declarationNodeIndex===a.index&&(this._appliesToNextNode=!1)}template(a,i){this.elementStart(a,i)}embeddedTView(a,i){return this.isApplyingToNode(a)?(this.crossesNgTemplate=!0,this.addMatch(-a.index,i),new Ym(this.metadata)):null}isApplyingToNode(a){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const i=this._declarationNodeIndex;let e=a.parent;for(;null!==e&&8&e.type&&e.index!==i;)e=e.parent;return i===(null!==e?e.index:-1)}return this._appliesToNextNode}matchTNode(a,i){const e=this.metadata.predicate;if(Array.isArray(e))for(let t=0;t<e.length;t++){const n=e[t];this.matchTNodeWithReadOption(a,i,cb(i,n)),this.matchTNodeWithReadOption(a,i,ti(i,a,n,!1,!1))}else e===Ec?4&i.type&&this.matchTNodeWithReadOption(a,i,-1):this.matchTNodeWithReadOption(a,i,ti(i,a,e,!1,!1))}matchTNodeWithReadOption(a,i,e){if(null!==e){const t=this.metadata.read;if(null!==t)if(t===nc||t===$u||t===Ec&&4&i.type)this.addMatch(i.index,-2);else{const n=ti(i,a,t,!1,!1);null!==n&&this.addMatch(i.index,n)}else this.addMatch(i.index,e)}}addMatch(a,i){null===this.matches?this.matches=[a,i]:this.matches.push(a,i)}}function cb(s,a){const i=s.localNames;if(null!==i)for(let e=0;e<i.length;e+=2)if(i[e]===a)return i[e+1];return null}function ub(s,a,i,e){return-1===i?function sS(s,a){return 11&s.type?vs(s,a):4&s.type?vl(s,a):null}(a,s):-2===i?function kv(s,a,i){return i===nc?vs(a,s):i===Ec?vl(a,s):i===$u?Fv(a,s):void 0}(s,a,e):ts(s,s[pt],i,a)}function Xm(s,a,i,e){const t=a[Ui].queries[e];if(null===t.matches){const n=s.data,r=i.matches,o=[];for(let l=0;l<r.length;l+=2){const c=r[l];o.push(c<0?null:ub(a,n[c],r[l+1],i.metadata.read))}t.matches=o}return t.matches}function Zm(s,a,i,e){const t=s.queries.getByIndex(i),n=t.matches;if(null!==n){const r=Xm(s,a,t,i);for(let o=0;o<n.length;o+=2){const l=n[o];if(l>0)e.push(r[o/2]);else{const c=n[o+1],u=a[-l];for(let d=zi;d<u.length;d++){const h=u[d];h[Bi]===h[Vn]&&Zm(h[pt],h,c,e)}if(null!==u[Po]){const d=u[Po];for(let h=0;h<d.length;h++){const f=d[h];Zm(f[pt],f,c,e)}}}}}return e}function ih(s){const a=Pe(),i=hn(),e=jc();$c(e+1);const t=fb(i,e);if(s.dirty&&function hh(s){return 4==(4&s[Zt])}(a)===(2==(2&t.metadata.flags))){if(null===t.matches)s.reset([]);else{const n=t.crossesNgTemplate?Zm(i,a,e,[]):Xm(i,a,t,e);s.reset(n,ur),s.notifyOnChanges()}return!0}return!1}function Km(s,a,i){const e=hn();e.firstCreatePass&&(Jm(e,new Yf(s,a,i),-1),2==(2&a)&&(e.staticViewQueries=!0)),Qm(e,Pe(),a)}function db(s,a,i,e){const t=hn();if(t.firstCreatePass){const n=mi();Jm(t,new Yf(a,i,e),n.index),function Ac(s,a){const i=s.contentQueries||(s.contentQueries=[]);a!==(i.length?i[i.length-1]:-1)&&i.push(s.queries.length-1,a)}(t,s),2==(2&i)&&(t.staticContentQueries=!0)}Qm(t,Pe(),i)}function hb(){return function oS(s,a){return s[Ui].queries[a].queryList}(Pe(),jc())}function Qm(s,a,i){const e=new jf(4==(4&i));Cy(s,a,e,e.destroy),null===a[Ui]&&(a[Ui]=new qm),a[Ui].queries.push(new $m(e))}function Jm(s,a,i){null===s.queries&&(s.queries=new Tc),s.queries.track(new Ym(a,i))}function fb(s,a){return s.queries.getByIndex(a)}function Ra(s){return!!Ai(s)}function Cc(...s){}const Ib=new Fn("Application Initializer");let Dc=(()=>{class s{constructor(i){this.appInits=i,this.resolve=Cc,this.reject=Cc,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const i=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let t=0;t<this.appInits.length;t++){const n=this.appInits[t]();if(om(n))i.push(n);else if(d0(n)){const r=new Promise((o,l)=>{n.subscribe({complete:o,error:l})});i.push(r)}}Promise.all(i).then(()=>{e()}).catch(t=>{this.reject(t)}),0===i.length&&e(),this.initialized=!0}}return s.\u0275fac=function(i){return new(i||s)(mn(Ib,8))},s.\u0275prov=yn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const xi=new Fn("AppId",{providedIn:"root",factory:function Pb(){return`${Xu()}${Xu()}${Xu()}`}});function Xu(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Rb=new Fn("Platform Initializer"),gS=new Fn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),$v=new Fn("AnimationModuleType");let Qf=(()=>{class s{log(i){console.log(i)}warn(i){console.warn(i)}}return s.\u0275fac=function(i){return new(i||s)},s.\u0275prov=yn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const Jf=new Fn("LocaleId",{providedIn:"root",factory:()=>Ts(Jf,$e.Optional|$e.SkipSelf)||function ug(){return typeof $localize<"u"&&$localize.locale||mc}()}),qv=new Fn("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Lb{constructor(a,i){this.ngModuleFactory=a,this.componentFactories=i}}let Ob=(()=>{class s{compileModuleSync(i){return new Hm(i)}compileModuleAsync(i){return Promise.resolve(this.compileModuleSync(i))}compileModuleAndAllComponentsSync(i){const e=this.compileModuleSync(i),n=Sa(Ai(i).declarations).reduce((r,o)=>{const l=ln(o);return l&&r.push(new Pd(l)),r},[]);return new Lb(e,n)}compileModuleAndAllComponentsAsync(i){return Promise.resolve(this.compileModuleAndAllComponentsSync(i))}clearCache(){}clearCacheFor(i){}getModuleId(i){}}return s.\u0275fac=function(i){return new(i||s)},s.\u0275prov=yn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const xS=(()=>Promise.resolve(0))();function Yv(s){typeof Zone>"u"?xS.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class yo{constructor({enableLongStackTrace:a=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Bs(!1),this.onMicrotaskEmpty=new Bs(!1),this.onStable=new Bs(!1),this.onError=new Bs(!1),typeof Zone>"u")throw new xe(908,!1);Zone.assertZonePatched();const t=this;t._nesting=0,t._outer=t._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(t._inner=t._inner.fork(new Zone.TaskTrackingZoneSpec)),a&&Zone.longStackTraceZoneSpec&&(t._inner=t._inner.fork(Zone.longStackTraceZoneSpec)),t.shouldCoalesceEventChangeDetection=!e&&i,t.shouldCoalesceRunChangeDetection=e,t.lastRequestAnimationFrameId=-1,t.nativeRequestAnimationFrame=function wS(){let s=ni.requestAnimationFrame,a=ni.cancelAnimationFrame;if(typeof Zone<"u"&&s&&a){const i=s[Zone.__symbol__("OriginalDelegate")];i&&(s=i);const e=a[Zone.__symbol__("OriginalDelegate")];e&&(a=e)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:a}}().nativeRequestAnimationFrame,function SS(s){const a=()=>{!function MS(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(ni,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,Zv(s),s.isCheckStableRunning=!0,Xv(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),Zv(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(i,e,t,n,r,o)=>{try{return kb(s),i.invokeTask(t,n,r,o)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===n.type||s.shouldCoalesceRunChangeDetection)&&a(),Bb(s)}},onInvoke:(i,e,t,n,r,o,l)=>{try{return kb(s),i.invoke(t,n,r,o,l)}finally{s.shouldCoalesceRunChangeDetection&&a(),Bb(s)}},onHasTask:(i,e,t,n)=>{i.hasTask(t,n),e===t&&("microTask"==n.change?(s._hasPendingMicrotasks=n.microTask,Zv(s),Xv(s)):"macroTask"==n.change&&(s.hasPendingMacrotasks=n.macroTask))},onHandleError:(i,e,t,n)=>(i.handleError(t,n),s.runOutsideAngular(()=>s.onError.emit(n)),!1)})}(t)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!yo.isInAngularZone())throw new xe(909,!1)}static assertNotInAngularZone(){if(yo.isInAngularZone())throw new xe(909,!1)}run(a,i,e){return this._inner.run(a,i,e)}runTask(a,i,e,t){const n=this._inner,r=n.scheduleEventTask("NgZoneEvent: "+t,a,bS,Cc,Cc);try{return n.runTask(r,i,e)}finally{n.cancelTask(r)}}runGuarded(a,i,e){return this._inner.runGuarded(a,i,e)}runOutsideAngular(a){return this._outer.run(a)}}const bS={};function Xv(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function Zv(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function kb(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function Bb(s){s._nesting--,Xv(s)}class ES{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Bs,this.onMicrotaskEmpty=new Bs,this.onStable=new Bs,this.onError=new Bs}run(a,i,e){return a.apply(i,e)}runGuarded(a,i,e){return a.apply(i,e)}runOutsideAngular(a){return a()}runTask(a,i,e,t){return a.apply(i,e)}}const dg=new Fn(""),Ub=new Fn("");let Qv,TS=(()=>{class s{constructor(i,e,t){this._ngZone=i,this.registry=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Qv||(function Kv(s){Qv=s}(t),t.addToWindow(e)),this._watchAngularEvents(),i.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{yo.assertNotInAngularZone(),Yv(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Yv(()=>{for(;0!==this._callbacks.length;){let i=this._callbacks.pop();clearTimeout(i.timeoutId),i.doneCb(this._didWork)}this._didWork=!1});else{let i=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(i)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(i=>({source:i.source,creationLocation:i.creationLocation,data:i.data})):[]}addCallback(i,e,t){let n=-1;e&&e>0&&(n=setTimeout(()=>{this._callbacks=this._callbacks.filter(r=>r.timeoutId!==n),i(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:i,timeoutId:n,updateCb:t})}whenStable(i,e,t){if(t&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(i,e,t),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(i){this.registry.registerApplication(i,this)}unregisterApplication(i){this.registry.unregisterApplication(i)}findProviders(i,e,t){return[]}}return s.\u0275fac=function(i){return new(i||s)(mn(yo),mn(zb),mn(Ub))},s.\u0275prov=yn({token:s,factory:s.\u0275fac}),s})(),zb=(()=>{class s{constructor(){this._applications=new Map}registerApplication(i,e){this._applications.set(i,e)}unregisterApplication(i){this._applications.delete(i)}unregisterAllApplications(){this._applications.clear()}getTestability(i){return this._applications.get(i)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(i,e=!0){return Qv?.findTestabilityInTree(this,i,e)??null}}return s.\u0275fac=function(i){return new(i||s)},s.\u0275prov=yn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const xl=!1;let Xo=null;const Hb=new Fn("AllowMultipleToken"),Jv=new Fn("PlatformDestroyListeners"),Vb=new Fn("appBootstrapListener");class CS{constructor(a,i){this.name=a,this.token=i}}function t_(s,a,i=[]){const e=`Platform: ${a}`,t=new Fn(e);return(n=[])=>{let r=hg();if(!r||r.injector.get(Hb,!1)){const o=[...i,...n,{provide:t,useValue:!0}];s?s(o):function Gb(s){if(Xo&&!Xo.get(Hb,!1))throw new xe(400,!1);Xo=s;const a=s.get(i_);(function Dn(s){const a=s.get(Rb,null);a&&a.forEach(i=>i())})(s)}(function n_(s=[],a){return sc.create({name:a,providers:[{provide:Fs,useValue:"platform"},{provide:Jv,useValue:new Set([()=>Xo=null])},...s]})}(o,e))}return function jb(s){const a=hg();if(!a)throw new xe(401,!1);return a}()}}function hg(){return Xo?.get(i_)??null}let i_=(()=>{class s{constructor(i){this._injector=i,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(i,e){const t=function s_(s,a){let i;return i="noop"===s?new ES:("zone.js"===s?void 0:s)||new yo(a),i}(e?.ngZone,function r_(s){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!s||!s.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!s||!s.ngZoneRunCoalescing)||!1}}(e)),n=[{provide:yo,useValue:t}];return t.run(()=>{const r=sc.create({providers:n,parent:this.injector,name:i.moduleType.name}),o=i.create(r),l=o.injector.get(al,null);if(!l)throw new xe(402,!1);return t.runOutsideAngular(()=>{const c=t.onError.subscribe({next:u=>{l.handleError(u)}});o.onDestroy(()=>{tp(this._modules,o),c.unsubscribe()})}),function o_(s,a,i){try{const e=i();return om(e)?e.catch(t=>{throw a.runOutsideAngular(()=>s.handleError(t)),t}):e}catch(e){throw a.runOutsideAngular(()=>s.handleError(e)),e}}(l,t,()=>{const c=o.injector.get(Dc);return c.runInitializers(),c.donePromise.then(()=>(function Ow(s){Yn(s,"Expected localeId to be defined"),"string"==typeof s&&(Lw=s.toLowerCase().replace(/_/g,"-"))}(o.injector.get(Jf,mc)||mc),this._moduleDoBootstrap(o),o))})})}bootstrapModule(i,e=[]){const t=a_({},e);return function e_(s,a,i){const e=new Hm(i);return Promise.resolve(e)}(0,0,i).then(n=>this.bootstrapModuleFactory(n,t))}_moduleDoBootstrap(i){const e=i.injector.get(ep);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!i.instance.ngDoBootstrap)throw new xe(-403,!1);i.instance.ngDoBootstrap(e)}this._modules.push(i)}onDestroy(i){this._destroyListeners.push(i)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new xe(404,!1);this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e());const i=this._injector.get(Jv,null);i&&(i.forEach(e=>e()),i.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(i){return new(i||s)(mn(sc))},s.\u0275prov=yn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function a_(s,a){return Array.isArray(a)?a.reduce(a_,s):{...s,...a}}let ep=(()=>{class s{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(i,e,t){this._zone=i,this._injector=e,this._exceptionHandler=t,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const n=new Y.y(o=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{o.next(this._stable),o.complete()})}),r=new Y.y(o=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{yo.assertNotInAngularZone(),Yv(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,o.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{yo.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{o.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=function it(...s){const a=(0,Ye.yG)(s),i=(0,Ye._6)(s,1/0),e=s;return e.length?1===e.length?(0,we.Xf)(e[0]):(0,Q.J)(i)((0,wt.D)(e,a)):je.E}(n,r.pipe(function oe(s={}){const{connector:a=(()=>new C.x),resetOnError:i=!0,resetOnComplete:e=!0,resetOnRefCountZero:t=!0}=s;return n=>{let r,o,l,c=0,u=!1,d=!1;const h=()=>{o?.unsubscribe(),o=void 0},f=()=>{h(),r=l=void 0,u=d=!1},p=()=>{const y=r;f(),y?.unsubscribe()};return(0,be.e)((y,x)=>{c++,!d&&!u&&h();const _=l=l??a();x.add(()=>{c--,0===c&&!d&&!u&&(o=Lt(p,t))}),_.subscribe(x),!r&&c>0&&(r=new ae.Hp({next:w=>_.next(w),error:w=>{d=!0,h(),o=Lt(f,i,w),_.error(w)},complete:()=>{u=!0,h(),o=Lt(f,e),_.complete()}}),(0,we.Xf)(y).subscribe(r))})(n)}}()))}bootstrap(i,e){const t=i instanceof tc;if(!this._injector.get(Dc).done){!t&&As(i);throw new xe(405,xl)}let r;r=t?i:this._injector.get(Dd).resolveComponentFactory(i),this.componentTypes.push(r.componentType);const o=function AS(s){return s.isBoundToModule}(r)?void 0:this._injector.get(ml),c=r.create(sc.NULL,[],e||r.selector,o),u=c.location.nativeElement,d=c.injector.get(dg,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),tp(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new xe(101,!1);try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(i))}finally{this._runningTick=!1}}attachView(i){const e=i;this._views.push(e),e.attachToAppRef(this)}detachView(i){const e=i;tp(this._views,e),e.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i);const e=this._injector.get(Vb,[]);e.push(...this._bootstrapListeners),e.forEach(t=>t(i))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(i=>i()),this._views.slice().forEach(i=>i.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(i){return this._destroyListeners.push(i),()=>tp(this._destroyListeners,i)}destroy(){if(this._destroyed)throw new xe(406,!1);const i=this._injector;i.destroy&&!i.destroyed&&i.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return s.\u0275fac=function(i){return new(i||s)(mn(yo),mn(oo),mn(al))},s.\u0275prov=yn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function tp(s,a){const i=s.indexOf(a);i>-1&&s.splice(i,1)}let Xb=(()=>{class s{}return s.__NG_ELEMENT_ID__=Zb,s})();function Zb(s){return function u_(s,a,i){if(ea(s)&&!i){const e=Mi(s.index,a);return new ll(e,e)}return 47&s.type?new ll(a[Ci],a):null}(mi(),Pe(),16==(16&s))}class m_{constructor(){}supports(a){return df(a)}create(a){return new y_(a)}}const g_=(s,a)=>a;class y_{constructor(a){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=a||g_}forEachItem(a){let i;for(i=this._itHead;null!==i;i=i._next)a(i)}forEachOperation(a){let i=this._itHead,e=this._removalsHead,t=0,n=null;for(;i||e;){const r=!e||i&&i.currentIndex<Jb(e,t,n)?i:e,o=Jb(r,t,n),l=r.currentIndex;if(r===e)t--,e=e._nextRemoved;else if(i=i._next,null==r.previousIndex)t++;else{n||(n=[]);const c=o-t,u=l-t;if(c!=u){for(let h=0;h<c;h++){const f=h<n.length?n[h]:n[h]=0,p=f+h;u<=p&&p<c&&(n[h]=f+1)}n[r.previousIndex]=u-c}}o!==l&&a(r,o,l)}}forEachPreviousItem(a){let i;for(i=this._previousItHead;null!==i;i=i._nextPrevious)a(i)}forEachAddedItem(a){let i;for(i=this._additionsHead;null!==i;i=i._nextAdded)a(i)}forEachMovedItem(a){let i;for(i=this._movesHead;null!==i;i=i._nextMoved)a(i)}forEachRemovedItem(a){let i;for(i=this._removalsHead;null!==i;i=i._nextRemoved)a(i)}forEachIdentityChange(a){let i;for(i=this._identityChangesHead;null!==i;i=i._nextIdentityChange)a(i)}diff(a){if(null==a&&(a=[]),!df(a))throw new xe(900,!1);return this.check(a)?this:null}onDestroy(){}check(a){this._reset();let t,n,r,i=this._itHead,e=!1;if(Array.isArray(a)){this.length=a.length;for(let o=0;o<this.length;o++)n=a[o],r=this._trackByFn(o,n),null!==i&&Object.is(i.trackById,r)?(e&&(i=this._verifyReinsertion(i,n,r,o)),Object.is(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,o),e=!0),i=i._next}else t=0,function Xy(s,a){if(Array.isArray(s))for(let i=0;i<s.length;i++)a(s[i]);else{const i=s[Symbol.iterator]();let e;for(;!(e=i.next()).done;)a(e.value)}}(a,o=>{r=this._trackByFn(t,o),null!==i&&Object.is(i.trackById,r)?(e&&(i=this._verifyReinsertion(i,o,r,t)),Object.is(i.item,o)||this._addIdentityChange(i,o)):(i=this._mismatch(i,o,r,t),e=!0),i=i._next,t++}),this.length=t;return this._truncate(i),this.collection=a,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let a;for(a=this._previousItHead=this._itHead;null!==a;a=a._next)a._nextPrevious=a._next;for(a=this._additionsHead;null!==a;a=a._nextAdded)a.previousIndex=a.currentIndex;for(this._additionsHead=this._additionsTail=null,a=this._movesHead;null!==a;a=a._nextMoved)a.previousIndex=a.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(a,i,e,t){let n;return null===a?n=this._itTail:(n=a._prev,this._remove(a)),null!==(a=null===this._unlinkedRecords?null:this._unlinkedRecords.get(e,null))?(Object.is(a.item,i)||this._addIdentityChange(a,i),this._reinsertAfter(a,n,t)):null!==(a=null===this._linkedRecords?null:this._linkedRecords.get(e,t))?(Object.is(a.item,i)||this._addIdentityChange(a,i),this._moveAfter(a,n,t)):a=this._addAfter(new gg(i,e),n,t),a}_verifyReinsertion(a,i,e,t){let n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(e,null);return null!==n?a=this._reinsertAfter(n,a._prev,t):a.currentIndex!=t&&(a.currentIndex=t,this._addToMoves(a,t)),a}_truncate(a){for(;null!==a;){const i=a._next;this._addToRemovals(this._unlink(a)),a=i}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(a,i,e){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(a);const t=a._prevRemoved,n=a._nextRemoved;return null===t?this._removalsHead=n:t._nextRemoved=n,null===n?this._removalsTail=t:n._prevRemoved=t,this._insertAfter(a,i,e),this._addToMoves(a,e),a}_moveAfter(a,i,e){return this._unlink(a),this._insertAfter(a,i,e),this._addToMoves(a,e),a}_addAfter(a,i,e){return this._insertAfter(a,i,e),this._additionsTail=null===this._additionsTail?this._additionsHead=a:this._additionsTail._nextAdded=a,a}_insertAfter(a,i,e){const t=null===i?this._itHead:i._next;return a._next=t,a._prev=i,null===t?this._itTail=a:t._prev=a,null===i?this._itHead=a:i._next=a,null===this._linkedRecords&&(this._linkedRecords=new __),this._linkedRecords.put(a),a.currentIndex=e,a}_remove(a){return this._addToRemovals(this._unlink(a))}_unlink(a){null!==this._linkedRecords&&this._linkedRecords.remove(a);const i=a._prev,e=a._next;return null===i?this._itHead=e:i._next=e,null===e?this._itTail=i:e._prev=i,a}_addToMoves(a,i){return a.previousIndex===i||(this._movesTail=null===this._movesTail?this._movesHead=a:this._movesTail._nextMoved=a),a}_addToRemovals(a){return null===this._unlinkedRecords&&(this._unlinkedRecords=new __),this._unlinkedRecords.put(a),a.currentIndex=null,a._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=a,a._prevRemoved=null):(a._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=a),a}_addIdentityChange(a,i){return a.item=i,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=a:this._identityChangesTail._nextIdentityChange=a,a}}class gg{constructor(a,i){this.item=a,this.trackById=i,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class v_{constructor(){this._head=null,this._tail=null}add(a){null===this._head?(this._head=this._tail=a,a._nextDup=null,a._prevDup=null):(this._tail._nextDup=a,a._prevDup=this._tail,a._nextDup=null,this._tail=a)}get(a,i){let e;for(e=this._head;null!==e;e=e._nextDup)if((null===i||i<=e.currentIndex)&&Object.is(e.trackById,a))return e;return null}remove(a){const i=a._prevDup,e=a._nextDup;return null===i?this._head=e:i._nextDup=e,null===e?this._tail=i:e._prevDup=i,null===this._head}}class __{constructor(){this.map=new Map}put(a){const i=a.trackById;let e=this.map.get(i);e||(e=new v_,this.map.set(i,e)),e.add(a)}get(a,i){const t=this.map.get(a);return t?t.get(a,i):null}remove(a){const i=a.trackById;return this.map.get(i).remove(a)&&this.map.delete(i),a}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Jb(s,a,i){const e=s.previousIndex;if(null===e)return e;let t=0;return i&&e<i.length&&(t=i[e]),e+a+t}class x_{constructor(){}supports(a){return a instanceof Map||hf(a)}create(){return new bl}}class bl{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(a){let i;for(i=this._mapHead;null!==i;i=i._next)a(i)}forEachPreviousItem(a){let i;for(i=this._previousMapHead;null!==i;i=i._nextPrevious)a(i)}forEachChangedItem(a){let i;for(i=this._changesHead;null!==i;i=i._nextChanged)a(i)}forEachAddedItem(a){let i;for(i=this._additionsHead;null!==i;i=i._nextAdded)a(i)}forEachRemovedItem(a){let i;for(i=this._removalsHead;null!==i;i=i._nextRemoved)a(i)}diff(a){if(a){if(!(a instanceof Map||hf(a)))throw new xe(900,!1)}else a=new Map;return this.check(a)?this:null}onDestroy(){}check(a){this._reset();let i=this._mapHead;if(this._appendAfter=null,this._forEach(a,(e,t)=>{if(i&&i.key===t)this._maybeAddToChanges(i,e),this._appendAfter=i,i=i._next;else{const n=this._getOrCreateRecordForKey(t,e);i=this._insertBeforeOrAppend(i,n)}}),i){i._prev&&(i._prev._next=null),this._removalsHead=i;for(let e=i;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(a,i){if(a){const e=a._prev;return i._next=a,i._prev=e,a._prev=i,e&&(e._next=i),a===this._mapHead&&(this._mapHead=i),this._appendAfter=a,a}return this._appendAfter?(this._appendAfter._next=i,i._prev=this._appendAfter):this._mapHead=i,this._appendAfter=i,null}_getOrCreateRecordForKey(a,i){if(this._records.has(a)){const t=this._records.get(a);this._maybeAddToChanges(t,i);const n=t._prev,r=t._next;return n&&(n._next=r),r&&(r._prev=n),t._next=null,t._prev=null,t}const e=new kS(a);return this._records.set(a,e),e.currentValue=i,this._addToAdditions(e),e}_reset(){if(this.isDirty){let a;for(this._previousMapHead=this._mapHead,a=this._previousMapHead;null!==a;a=a._next)a._nextPrevious=a._next;for(a=this._changesHead;null!==a;a=a._nextChanged)a.previousValue=a.currentValue;for(a=this._additionsHead;null!=a;a=a._nextAdded)a.previousValue=a.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(a,i){Object.is(i,a.currentValue)||(a.previousValue=a.currentValue,a.currentValue=i,this._addToChanges(a))}_addToAdditions(a){null===this._additionsHead?this._additionsHead=this._additionsTail=a:(this._additionsTail._nextAdded=a,this._additionsTail=a)}_addToChanges(a){null===this._changesHead?this._changesHead=this._changesTail=a:(this._changesTail._nextChanged=a,this._changesTail=a)}_forEach(a,i){a instanceof Map?a.forEach(i):Object.keys(a).forEach(e=>i(a[e],e))}}class kS{constructor(a){this.key=a,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function eM(){return new yg([new m_])}let yg=(()=>{class s{constructor(i){this.factories=i}static create(i,e){if(null!=e){const t=e.factories.slice();i=i.concat(t)}return new s(i)}static extend(i){return{provide:s,useFactory:e=>s.create(i,e||eM()),deps:[[s,new me,new F]]}}find(i){const e=this.factories.find(t=>t.supports(i));if(null!=e)return e;throw new xe(901,!1)}}return s.\u0275prov=yn({token:s,providedIn:"root",factory:eM}),s})();function Ml(){return new ip([new x_])}let ip=(()=>{class s{constructor(i){this.factories=i}static create(i,e){if(e){const t=e.factories.slice();i=i.concat(t)}return new s(i)}static extend(i){return{provide:s,useFactory:e=>s.create(i,e||Ml()),deps:[[s,new me,new F]]}}find(i){const e=this.factories.find(t=>t.supports(i));if(e)return e;throw new xe(901,!1)}}return s.\u0275prov=yn({token:s,providedIn:"root",factory:Ml}),s})();const nM=t_(null,"core",[]);let iM=(()=>{class s{constructor(i){}}return s.\u0275fac=function(i){return new(i||s)(mn(ep))},s.\u0275mod=Hs({type:s}),s.\u0275inj=wo({}),s})();function rM(s){return"boolean"==typeof s?s:null!=s&&"false"!==s}},1481:(Vt,Be,U)=>{U.d(Be,{Dx:()=>On,b2:()=>ss,q6:()=>wo,se:()=>Tt});var C=U(6895),O=U(8256);class Y extends C.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Q extends Y{static makeCurrent(){(0,C.HT)(new Q)}onAndCancel(J,j,he){return J.addEventListener(j,he,!1),()=>{J.removeEventListener(j,he,!1)}}dispatchEvent(J,j){J.dispatchEvent(j)}remove(J){J.parentNode&&J.parentNode.removeChild(J)}createElement(J,j){return(j=j||this.getDefaultDocument()).createElement(J)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(J){return J.nodeType===Node.ELEMENT_NODE}isShadowRoot(J){return J instanceof DocumentFragment}getGlobalEventTarget(J,j){return"window"===j?window:"document"===j?J:"body"===j?J.body:null}getBaseHref(J){const j=function je(){return we=we||document.querySelector("base"),we?we.getAttribute("href"):null}();return null==j?null:function wt(ce){Ye=Ye||document.createElement("a"),Ye.setAttribute("href",ce);const J=Ye.pathname;return"/"===J.charAt(0)?J:`/${J}`}(j)}resetBaseElement(){we=null}getUserAgent(){return window.navigator.userAgent}getCookie(J){return(0,C.Mx)(document.cookie,J)}}let Ye,we=null;const it=new O.OlP("TRANSITION_ID"),be=[{provide:O.ip1,useFactory:function ae(ce,J,j){return()=>{j.get(O.CZH).donePromise.then(()=>{const he=(0,C.q)(),Ae=J.querySelectorAll(`style[ng-transition="${ce}"]`);for(let nt=0;nt<Ae.length;nt++)he.remove(Ae[nt])})}},deps:[it,C.K0,O.zs3],multi:!0}];let Lt=(()=>{class ce{build(){return new XMLHttpRequest}}return ce.\u0275fac=function(j){return new(j||ce)},ce.\u0275prov=O.Yz7({token:ce,factory:ce.\u0275fac}),ce})();const Xe=new O.OlP("EventManagerPlugins");let Ct=(()=>{class ce{constructor(j,he){this._zone=he,this._eventNameToPlugin=new Map,j.forEach(Ae=>{Ae.manager=this}),this._plugins=j.slice().reverse()}addEventListener(j,he,Ae){return this._findPluginFor(he).addEventListener(j,he,Ae)}addGlobalEventListener(j,he,Ae){return this._findPluginFor(he).addGlobalEventListener(j,he,Ae)}getZone(){return this._zone}_findPluginFor(j){const he=this._eventNameToPlugin.get(j);if(he)return he;const Ae=this._plugins;for(let nt=0;nt<Ae.length;nt++){const $t=Ae[nt];if($t.supports(j))return this._eventNameToPlugin.set(j,$t),$t}throw new Error(`No event manager plugin found for event ${j}`)}}return ce.\u0275fac=function(j){return new(j||ce)(O.LFG(Xe),O.LFG(O.R0b))},ce.\u0275prov=O.Yz7({token:ce,factory:ce.\u0275fac}),ce})();class ot{constructor(J){this._doc=J}addGlobalEventListener(J,j,he){const Ae=(0,C.q)().getGlobalEventTarget(this._doc,J);if(!Ae)throw new Error(`Unsupported event target ${Ae} for event ${j}`);return this.addEventListener(Ae,j,he)}}let at=(()=>{class ce{constructor(){this.usageCount=new Map}addStyles(j){for(const he of j)1===this.changeUsageCount(he,1)&&this.onStyleAdded(he)}removeStyles(j){for(const he of j)0===this.changeUsageCount(he,-1)&&this.onStyleRemoved(he)}onStyleRemoved(j){}onStyleAdded(j){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(j,he){const Ae=this.usageCount;let nt=Ae.get(j)??0;return nt+=he,nt>0?Ae.set(j,nt):Ae.delete(j),nt}ngOnDestroy(){for(const j of this.getAllStyles())this.onStyleRemoved(j);this.usageCount.clear()}}return ce.\u0275fac=function(j){return new(j||ce)},ce.\u0275prov=O.Yz7({token:ce,factory:ce.\u0275fac}),ce})(),Kt=(()=>{class ce extends at{constructor(j){super(),this.doc=j,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(j){for(const he of this.hostNodes)this.addStyleToHost(he,j)}onStyleRemoved(j){const he=this.styleRef;he.get(j)?.forEach(nt=>nt.remove()),he.delete(j)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(j){this.hostNodes.add(j);for(const he of this.getAllStyles())this.addStyleToHost(j,he)}removeHost(j){this.hostNodes.delete(j)}addStyleToHost(j,he){const Ae=this.doc.createElement("style");Ae.textContent=he,j.appendChild(Ae);const nt=this.styleRef.get(he);nt?nt.push(Ae):this.styleRef.set(he,[Ae])}resetHostNodes(){const j=this.hostNodes;j.clear(),j.add(this.doc.head)}}return ce.\u0275fac=function(j){return new(j||ce)(O.LFG(C.K0))},ce.\u0275prov=O.Yz7({token:ce,factory:ce.\u0275fac}),ce})();const Pn={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},yt=/%COMP%/g,Qe=new O.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function Ft(ce,J){return J.flat(100).map(j=>j.replace(yt,ce))}function An(ce){return J=>{if("__ngUnwrap__"===J)return ce;!1===ce(J)&&(J.preventDefault(),J.returnValue=!1)}}let Tt=(()=>{class ce{constructor(j,he,Ae,nt){this.eventManager=j,this.sharedStylesHost=he,this.appId=Ae,this.removeStylesOnCompDestory=nt,this.rendererByCompId=new Map,this.defaultRenderer=new Te(j)}createRenderer(j,he){if(!j||!he)return this.defaultRenderer;const Ae=this.getOrCreateRenderer(j,he);return Ae instanceof Wt?Ae.applyToHost(j):Ae instanceof He&&Ae.applyStyles(),Ae}getOrCreateRenderer(j,he){const Ae=this.rendererByCompId;let nt=Ae.get(he.id);if(!nt){const $t=this.eventManager,vn=this.sharedStylesHost,qt=this.removeStylesOnCompDestory;switch(he.encapsulation){case O.ifc.Emulated:nt=new Wt($t,vn,he,this.appId,qt);break;case O.ifc.ShadowDom:return new lt($t,vn,j,he);default:nt=new He($t,vn,he,qt)}nt.onDestroy=()=>Ae.delete(he.id),Ae.set(he.id,nt)}return nt}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return ce.\u0275fac=function(j){return new(j||ce)(O.LFG(Ct),O.LFG(Kt),O.LFG(O.AFp),O.LFG(Qe))},ce.\u0275prov=O.Yz7({token:ce,factory:ce.\u0275fac}),ce})();class Te{constructor(J){this.eventManager=J,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(J,j){return j?document.createElementNS(Pn[j]||j,J):document.createElement(J)}createComment(J){return document.createComment(J)}createText(J){return document.createTextNode(J)}appendChild(J,j){(Ue(J)?J.content:J).appendChild(j)}insertBefore(J,j,he){J&&(Ue(J)?J.content:J).insertBefore(j,he)}removeChild(J,j){J&&J.removeChild(j)}selectRootElement(J,j){let he="string"==typeof J?document.querySelector(J):J;if(!he)throw new Error(`The selector "${J}" did not match any elements`);return j||(he.textContent=""),he}parentNode(J){return J.parentNode}nextSibling(J){return J.nextSibling}setAttribute(J,j,he,Ae){if(Ae){j=Ae+":"+j;const nt=Pn[Ae];nt?J.setAttributeNS(nt,j,he):J.setAttribute(j,he)}else J.setAttribute(j,he)}removeAttribute(J,j,he){if(he){const Ae=Pn[he];Ae?J.removeAttributeNS(Ae,j):J.removeAttribute(`${he}:${j}`)}else J.removeAttribute(j)}addClass(J,j){J.classList.add(j)}removeClass(J,j){J.classList.remove(j)}setStyle(J,j,he,Ae){Ae&(O.JOm.DashCase|O.JOm.Important)?J.style.setProperty(j,he,Ae&O.JOm.Important?"important":""):J.style[j]=he}removeStyle(J,j,he){he&O.JOm.DashCase?J.style.removeProperty(j):J.style[j]=""}setProperty(J,j,he){J[j]=he}setValue(J,j){J.nodeValue=j}listen(J,j,he){return"string"==typeof J?this.eventManager.addGlobalEventListener(J,j,An(he)):this.eventManager.addEventListener(J,j,An(he))}}function Ue(ce){return"TEMPLATE"===ce.tagName&&void 0!==ce.content}class lt extends Te{constructor(J,j,he,Ae){super(J),this.sharedStylesHost=j,this.hostEl=he,this.shadowRoot=he.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const nt=Ft(Ae.id,Ae.styles);for(const $t of nt){const vn=document.createElement("style");vn.textContent=$t,this.shadowRoot.appendChild(vn)}}nodeOrShadowRoot(J){return J===this.hostEl?this.shadowRoot:J}appendChild(J,j){return super.appendChild(this.nodeOrShadowRoot(J),j)}insertBefore(J,j,he){return super.insertBefore(this.nodeOrShadowRoot(J),j,he)}removeChild(J,j){return super.removeChild(this.nodeOrShadowRoot(J),j)}parentNode(J){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(J)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class He extends Te{constructor(J,j,he,Ae,nt=he.id){super(J),this.sharedStylesHost=j,this.removeStylesOnCompDestory=Ae,this.rendererUsageCount=0,this.styles=Ft(nt,he.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class Wt extends He{constructor(J,j,he,Ae,nt){const $t=Ae+"-"+he.id;super(J,j,he,nt,$t),this.contentAttr=function Fe(ce){return"_ngcontent-%COMP%".replace(yt,ce)}($t),this.hostAttr=function Je(ce){return"_nghost-%COMP%".replace(yt,ce)}($t)}applyToHost(J){this.applyStyles(),this.setAttribute(J,this.hostAttr,"")}createElement(J,j){const he=super.createElement(J,j);return super.setAttribute(he,this.contentAttr,""),he}}let Rn=(()=>{class ce extends ot{constructor(j){super(j)}supports(j){return!0}addEventListener(j,he,Ae){return j.addEventListener(he,Ae,!1),()=>this.removeEventListener(j,he,Ae)}removeEventListener(j,he,Ae){return j.removeEventListener(he,Ae)}}return ce.\u0275fac=function(j){return new(j||ce)(O.LFG(C.K0))},ce.\u0275prov=O.Yz7({token:ce,factory:ce.\u0275fac}),ce})();const zn=["alt","control","meta","shift"],Dt={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Sn={alt:ce=>ce.altKey,control:ce=>ce.ctrlKey,meta:ce=>ce.metaKey,shift:ce=>ce.shiftKey};let En=(()=>{class ce extends ot{constructor(j){super(j)}supports(j){return null!=ce.parseEventName(j)}addEventListener(j,he,Ae){const nt=ce.parseEventName(he),$t=ce.eventCallback(nt.fullKey,Ae,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,C.q)().onAndCancel(j,nt.domEventName,$t))}static parseEventName(j){const he=j.toLowerCase().split("."),Ae=he.shift();if(0===he.length||"keydown"!==Ae&&"keyup"!==Ae)return null;const nt=ce._normalizeKey(he.pop());let $t="",vn=he.indexOf("code");if(vn>-1&&(he.splice(vn,1),$t="code."),zn.forEach(ls=>{const Lr=he.indexOf(ls);Lr>-1&&(he.splice(Lr,1),$t+=ls+".")}),$t+=nt,0!=he.length||0===nt.length)return null;const qt={};return qt.domEventName=Ae,qt.fullKey=$t,qt}static matchEventFullKeyCode(j,he){let Ae=Dt[j.key]||j.key,nt="";return he.indexOf("code.")>-1&&(Ae=j.code,nt="code."),!(null==Ae||!Ae)&&(Ae=Ae.toLowerCase()," "===Ae?Ae="space":"."===Ae&&(Ae="dot"),zn.forEach($t=>{$t!==Ae&&(0,Sn[$t])(j)&&(nt+=$t+".")}),nt+=Ae,nt===he)}static eventCallback(j,he,Ae){return nt=>{ce.matchEventFullKeyCode(nt,j)&&Ae.runGuarded(()=>he(nt))}}static _normalizeKey(j){return"esc"===j?"escape":j}}return ce.\u0275fac=function(j){return new(j||ce)(O.LFG(C.K0))},ce.\u0275prov=O.Yz7({token:ce,factory:ce.\u0275fac}),ce})();const wo=(0,O.eFA)(O._c5,"browser",[{provide:O.Lbi,useValue:C.bD},{provide:O.g9A,useValue:function Hn(){Q.makeCurrent()},multi:!0},{provide:C.K0,useFactory:function yn(){return(0,O.RDi)(document),document},deps:[]}]),oi=new O.OlP(""),zs=[{provide:O.rWj,useClass:class oe{addToWindow(J){O.dqk.getAngularTestability=(he,Ae=!0)=>{const nt=J.findTestabilityInTree(he,Ae);if(null==nt)throw new Error("Could not find testability for element.");return nt},O.dqk.getAllAngularTestabilities=()=>J.getAllTestabilities(),O.dqk.getAllAngularRootElements=()=>J.getAllRootElements(),O.dqk.frameworkStabilizers||(O.dqk.frameworkStabilizers=[]),O.dqk.frameworkStabilizers.push(he=>{const Ae=O.dqk.getAllAngularTestabilities();let nt=Ae.length,$t=!1;const vn=function(qt){$t=$t||qt,nt--,0==nt&&he($t)};Ae.forEach(function(qt){qt.whenStable(vn)})})}findTestabilityInTree(J,j,he){return null==j?null:J.getTestability(j)??(he?(0,C.q)().isShadowRoot(j)?this.findTestabilityInTree(J,j.host,!0):this.findTestabilityInTree(J,j.parentElement,!0):null)}},deps:[]},{provide:O.lri,useClass:O.dDg,deps:[O.R0b,O.eoX,O.rWj]},{provide:O.dDg,useClass:O.dDg,deps:[O.R0b,O.eoX,O.rWj]}],bo=[{provide:O.zSh,useValue:"root"},{provide:O.qLn,useFactory:function Hr(){return new O.qLn},deps:[]},{provide:Xe,useClass:Rn,multi:!0,deps:[C.K0,O.R0b,O.Lbi]},{provide:Xe,useClass:En,multi:!0,deps:[C.K0]},{provide:Tt,useClass:Tt,deps:[Ct,Kt,O.AFp,Qe]},{provide:O.FYo,useExisting:Tt},{provide:at,useExisting:Kt},{provide:Kt,useClass:Kt,deps:[C.K0]},{provide:Ct,useClass:Ct,deps:[Xe,O.R0b]},{provide:C.JF,useClass:Lt,deps:[]},[]];let ss=(()=>{class ce{constructor(j){}static withServerTransition(j){return{ngModule:ce,providers:[{provide:O.AFp,useValue:j.appId},{provide:it,useExisting:O.AFp},be]}}}return ce.\u0275fac=function(j){return new(j||ce)(O.LFG(oi,12))},ce.\u0275mod=O.oAB({type:ce}),ce.\u0275inj=O.cJS({providers:[...bo,...zs],imports:[C.ez,O.hGG]}),ce})(),On=(()=>{class ce{constructor(j){this._doc=j}getTitle(){return this._doc.title}setTitle(j){this._doc.title=j||""}}return ce.\u0275fac=function(j){return new(j||ce)(O.LFG(C.K0))},ce.\u0275prov=O.Yz7({token:ce,factory:function(j){let he=null;return he=j?new j:function Xt(){return new On((0,O.LFG)(C.K0))}(),he},providedIn:"root"}),ce})();typeof window<"u"&&window},521:(Vt,Be,U)=>{U.d(Be,{m2:()=>bn,F0:()=>or,rH:()=>br,Bz:()=>hp,lC:()=>li});var C=U(8256),O=U(2076),Y=U(7669);function Q(...g){const v=(0,Y.yG)(g);return(0,O.D)(g,v)}var we=U(7579);class je extends we.x{constructor(v){super(),this._value=v}get value(){return this.getValue()}_subscribe(v){const m=super._subscribe(v);return!m.closed&&v.next(this._value),m}getValue(){const{hasError:v,thrownError:m,_value:b}=this;if(v)throw m;return this._throwIfClosed(),b}next(v){super.next(this._value=v)}}const wt=(0,U(3888).d)(g=>function(){g(this),this.name="EmptyError",this.message="no elements in sequence"});var it=U(9751);const{isArray:ae}=Array,{getPrototypeOf:be,prototype:oe,keys:Lt}=Object;var ot=U(4671),at=U(4004);const{isArray:Kt}=Array;var ie=U(5403),qe=U(9672);function Pt(...g){const v=(0,Y.yG)(g),m=(0,Y.jO)(g),{args:b,keys:A}=function Xe(g){if(1===g.length){const v=g[0];if(ae(v))return{args:v,keys:null};if(function Ct(g){return g&&"object"==typeof g&&be(g)===oe}(v)){const m=Lt(v);return{args:m.map(b=>v[b]),keys:m}}}return{args:g,keys:null}}(g);if(0===b.length)return(0,O.D)([],v);const L=new it.y(function xe(g,v,m=ot.y){return b=>{Qe(v,()=>{const{length:A}=g,L=new Array(A);let F=A,K=A;for(let me=0;me<A;me++)Qe(v,()=>{const Ke=(0,O.D)(g[me],v);let ct=!1;Ke.subscribe((0,ie.x)(b,on=>{L[me]=on,ct||(ct=!0,K--),K||b.next(m(L.slice()))},()=>{--F||b.complete()}))},b)},b)}}(b,v,A?F=>function Ge(g,v){return g.reduce((m,b,A)=>(m[b]=v[A],m),{})}(A,F):ot.y));return m?L.pipe(function yt(g){return(0,at.U)(v=>function Pn(g,v){return Kt(v)?g(...v):g(v)}(g,v))}(m)):L}function Qe(g,v,m){g?(0,qe.f)(m,g,v):v()}var Fe=U(8189);function Ft(...g){return function Je(){return(0,Fe.J)(1)}()((0,O.D)(g,(0,Y.yG)(g)))}var An=U(8421);function Tt(g){return new it.y(v=>{(0,An.Xf)(g()).subscribe(v)})}var Te=U(9635),Se=U(576);function Le(g,v){const m=(0,Se.m)(g)?g:()=>g,b=A=>A.error(m());return new it.y(v?A=>v.schedule(b,0,A):b)}var Ue=U(515),lt=U(727),He=U(4482);function Wt(){return(0,He.e)((g,v)=>{let m=null;g._refCount++;const b=(0,ie.x)(v,void 0,void 0,void 0,()=>{if(!g||g._refCount<=0||0<--g._refCount)return void(m=null);const A=g._connection,L=m;m=null,A&&(!L||A===L)&&A.unsubscribe(),v.unsubscribe()});g.subscribe(b),b.closed||(m=g.connect())})}class Rn extends it.y{constructor(v,m){super(),this.source=v,this.subjectFactory=m,this._subject=null,this._refCount=0,this._connection=null,(0,He.A)(v)&&(this.lift=v.lift)}_subscribe(v){return this.getSubject().subscribe(v)}getSubject(){const v=this._subject;return(!v||v.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:v}=this;this._subject=this._connection=null,v?.unsubscribe()}connect(){let v=this._connection;if(!v){v=this._connection=new lt.w0;const m=this.getSubject();v.add(this.source.subscribe((0,ie.x)(m,void 0,()=>{this._teardown(),m.complete()},b=>{this._teardown(),m.error(b)},()=>this._teardown()))),v.closed&&(this._connection=null,v=lt.w0.EMPTY)}return v}refCount(){return Wt()(this)}}var zn=U(6895);function Dt(g,v){return(0,He.e)((m,b)=>{let A=null,L=0,F=!1;const K=()=>F&&!A&&b.complete();m.subscribe((0,ie.x)(b,me=>{A?.unsubscribe();let Ke=0;const ct=L++;(0,An.Xf)(g(me,ct)).subscribe(A=(0,ie.x)(b,on=>b.next(v?v(me,on,ct,Ke++):on),()=>{A=null,K()}))},()=>{F=!0,K()}))})}function Sn(g){return g<=0?()=>Ue.E:(0,He.e)((v,m)=>{let b=0;v.subscribe((0,ie.x)(m,A=>{++b<=g&&(m.next(A),g<=b&&m.complete())}))})}var rn=U(9300),qn=U(5577);function Yn(g){return(0,He.e)((v,m)=>{let b=!1;v.subscribe((0,ie.x)(m,A=>{b=!0,m.next(A)},()=>{b||m.next(g),m.complete()}))})}function Jt(g=Ir){return(0,He.e)((v,m)=>{let b=!1;v.subscribe((0,ie.x)(m,A=>{b=!0,m.next(A)},()=>b?m.complete():m.error(g())))})}function Ir(){return new wt}function Hn(g,v){const m=arguments.length>=2;return b=>b.pipe(g?(0,rn.h)((A,L)=>g(A,L,b)):ot.y,Sn(1),m?Yn(v):Jt(()=>new wt))}function Hr(g,v){return(0,Se.m)(v)?(0,qn.z)(g,v,1):(0,qn.z)(g,1)}function yn(g,v,m){const b=(0,Se.m)(g)||v||m?{next:g,error:v,complete:m}:g;return b?(0,He.e)((A,L)=>{var F;null===(F=b.subscribe)||void 0===F||F.call(b);let K=!0;A.subscribe((0,ie.x)(L,me=>{var Ke;null===(Ke=b.next)||void 0===Ke||Ke.call(b,me),L.next(me)},()=>{var me;K=!1,null===(me=b.complete)||void 0===me||me.call(b),L.complete()},me=>{var Ke;K=!1,null===(Ke=b.error)||void 0===Ke||Ke.call(b,me),L.error(me)},()=>{var me,Ke;K&&(null===(me=b.unsubscribe)||void 0===me||me.call(b)),null===(Ke=b.finalize)||void 0===Ke||Ke.call(b)}))}):ot.y}function Pr(g){return(0,He.e)((v,m)=>{let L,b=null,A=!1;b=v.subscribe((0,ie.x)(m,void 0,void 0,F=>{L=(0,An.Xf)(g(F,Pr(g)(v))),b?(b.unsubscribe(),b=null,L.subscribe(m)):A=!0})),A&&(b.unsubscribe(),b=null,L.subscribe(m))})}function oi(g,v){return(0,He.e)(function wo(g,v,m,b,A){return(L,F)=>{let K=m,me=v,Ke=0;L.subscribe((0,ie.x)(F,ct=>{const on=Ke++;me=K?g(me,ct,on):(K=!0,ct),b&&F.next(me)},A&&(()=>{K&&F.next(me),F.complete()})))}}(g,v,arguments.length>=2,!0))}function zs(g){return g<=0?()=>Ue.E:(0,He.e)((v,m)=>{let b=[];v.subscribe((0,ie.x)(m,A=>{b.push(A),g<b.length&&b.shift()},()=>{for(const A of b)m.next(A);m.complete()},void 0,()=>{b=null}))})}function bo(g,v){const m=arguments.length>=2;return b=>b.pipe(g?(0,rn.h)((A,L)=>g(A,L,b)):ot.y,zs(1),m?Yn(v):Jt(()=>new wt))}function Mo(g){return(0,He.e)((v,m)=>{try{v.subscribe(m)}finally{m.add(g)}})}var Ms=U(1481);const Xt="primary",On=Symbol("RouteTitle");class kt{constructor(v){this.params=v||{}}has(v){return Object.prototype.hasOwnProperty.call(this.params,v)}get(v){if(this.has(v)){const m=this.params[v];return Array.isArray(m)?m[0]:m}return null}getAll(v){if(this.has(v)){const m=this.params[v];return Array.isArray(m)?m:[m]}return[]}get keys(){return Object.keys(this.params)}}function $e(g){return new kt(g)}function So(g,v,m){const b=m.path.split("/");if(b.length>g.length||"full"===m.pathMatch&&(v.hasChildren()||b.length<g.length))return null;const A={};for(let L=0;L<b.length;L++){const F=b[L],K=g[L];if(F.startsWith(":"))A[F.substring(1)]=K;else if(F!==K.path)return null}return{consumed:g.slice(0,b.length),posParams:A}}function wn(g,v){const m=g?Object.keys(g):void 0,b=v?Object.keys(v):void 0;if(!m||!b||m.length!=b.length)return!1;let A;for(let L=0;L<m.length;L++)if(A=m[L],!Vr(g[A],v[A]))return!1;return!0}function Vr(g,v){if(Array.isArray(g)&&Array.isArray(v)){if(g.length!==v.length)return!1;const m=[...g].sort(),b=[...v].sort();return m.every((A,L)=>b[L]===A)}return g===v}function _r(g){return Array.prototype.concat.apply([],g)}function ni(g){return g.length>0?g[g.length-1]:null}function ai(g,v){for(const m in g)g.hasOwnProperty(m)&&v(g[m],m)}function pn(g){return(0,C.CqO)(g)?g:(0,C.QGY)(g)?(0,O.D)(Promise.resolve(g)):Q(g)}const Gr=!1,os={exact:function Fa(g,v,m){if(!Fi(g.segments,v.segments)||!To(g.segments,v.segments,m)||g.numberOfChildren!==v.numberOfChildren)return!1;for(const b in v.children)if(!g.children[b]||!Fa(g.children[b],v.children[b],m))return!1;return!0},subset:Rr},ir={exact:function Eo(g,v){return wn(g,v)},subset:function as(g,v){return Object.keys(v).length<=Object.keys(g).length&&Object.keys(v).every(m=>Vr(g[m],v[m]))},ignored:()=>!0};function Es(g,v,m){return os[m.paths](g.root,v.root,m.matrixParams)&&ir[m.queryParams](g.queryParams,v.queryParams)&&!("exact"===m.fragment&&g.fragment!==v.fragment)}function Rr(g,v,m){return Wr(g,v,v.segments,m)}function Wr(g,v,m,b){if(g.segments.length>m.length){const A=g.segments.slice(0,m.length);return!(!Fi(A,m)||v.hasChildren()||!To(A,m,b))}if(g.segments.length===m.length){if(!Fi(g.segments,m)||!To(g.segments,m,b))return!1;for(const A in v.children)if(!g.children[A]||!Rr(g.children[A],v.children[A],b))return!1;return!0}{const A=m.slice(0,g.segments.length),L=m.slice(g.segments.length);return!!(Fi(g.segments,A)&&To(g.segments,A,b)&&g.children[Xt])&&Wr(g.children[Xt],v,L,b)}}function To(g,v,m){return v.every((b,A)=>ir[m](g[A].parameters,b.parameters))}class mn{constructor(v=new sn([],{}),m={},b=null){this.root=v,this.queryParams=m,this.fragment=b}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=$e(this.queryParams)),this._queryParamMap}toString(){return he.serialize(this)}}class sn{constructor(v,m){this.segments=v,this.children=m,this.parent=null,ai(m,(b,A)=>b.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ae(this)}}class Ts{constructor(v,m){this.path=v,this.parameters=m}get parameterMap(){return this._parameterMap||(this._parameterMap=$e(this.parameters)),this._parameterMap}toString(){return ka(this)}}function Fi(g,v){return g.length===v.length&&g.every((m,b)=>m.path===v[b].path)}let J=(()=>{class g{}return g.\u0275fac=function(m){return new(m||g)},g.\u0275prov=C.Yz7({token:g,factory:function(){return new j},providedIn:"root"}),g})();class j{parse(v){const m=new Ju(v);return new mn(m.parseRootSegment(),m.parseQueryParams(),m.parseFragment())}serialize(v){const m=`/${nt(v.root,!0)}`,b=function jr(g){const v=Object.keys(g).map(m=>{const b=g[m];return Array.isArray(b)?b.map(A=>`${vn(m)}=${vn(A)}`).join("&"):`${vn(m)}=${vn(b)}`}).filter(m=>!!m);return v.length?`?${v.join("&")}`:""}(v.queryParams);return`${m}${b}${"string"==typeof v.fragment?`#${function qt(g){return encodeURI(g)}(v.fragment)}`:""}`}}const he=new j;function Ae(g){return g.segments.map(v=>ka(v)).join("/")}function nt(g,v){if(!g.hasChildren())return Ae(g);if(v){const m=g.children[Xt]?nt(g.children[Xt],!1):"",b=[];return ai(g.children,(A,L)=>{L!==Xt&&b.push(`${L}:${nt(A,!1)}`)}),b.length>0?`${m}(${b.join("//")})`:m}{const m=function ce(g,v){let m=[];return ai(g.children,(b,A)=>{A===Xt&&(m=m.concat(v(b,A)))}),ai(g.children,(b,A)=>{A!==Xt&&(m=m.concat(v(b,A)))}),m}(g,(b,A)=>A===Xt?[nt(g.children[Xt],!1)]:[`${A}:${nt(b,!1)}`]);return 1===Object.keys(g.children).length&&null!=g.children[Xt]?`${Ae(g)}/${m[0]}`:`${Ae(g)}/(${m.join("//")})`}}function $t(g){return encodeURIComponent(g).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function vn(g){return $t(g).replace(/%3B/gi,";")}function ls(g){return $t(g).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Lr(g){return decodeURIComponent(g)}function ki(g){return Lr(g.replace(/\+/g,"%20"))}function ka(g){return`${ls(g.path)}${function xr(g){return Object.keys(g).map(v=>`;${ls(v)}=${ls(g[v])}`).join("")}(g.parameters)}`}const Ku=/^[^\/()?;=#]+/;function Ao(g){const v=g.match(Ku);return v?v[0]:""}const Qu=/^[^=?&#]+/,Cl=/^[^&#]+/;class Ju{constructor(v){this.url=v,this.remaining=v}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new sn([],{}):new sn([],this.parseChildren())}parseQueryParams(){const v={};if(this.consumeOptional("?"))do{this.parseQueryParam(v)}while(this.consumeOptional("&"));return v}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const v=[];for(this.peekStartsWith("(")||v.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),v.push(this.parseSegment());let m={};this.peekStartsWith("/(")&&(this.capture("/"),m=this.parseParens(!0));let b={};return this.peekStartsWith("(")&&(b=this.parseParens(!1)),(v.length>0||Object.keys(m).length>0)&&(b[Xt]=new sn(v,m)),b}parseSegment(){const v=Ao(this.remaining);if(""===v&&this.peekStartsWith(";"))throw new C.vHH(4009,Gr);return this.capture(v),new Ts(Lr(v),this.parseMatrixParams())}parseMatrixParams(){const v={};for(;this.consumeOptional(";");)this.parseParam(v);return v}parseParam(v){const m=Ao(this.remaining);if(!m)return;this.capture(m);let b="";if(this.consumeOptional("=")){const A=Ao(this.remaining);A&&(b=A,this.capture(b))}v[Lr(m)]=Lr(b)}parseQueryParam(v){const m=function Al(g){const v=g.match(Qu);return v?v[0]:""}(this.remaining);if(!m)return;this.capture(m);let b="";if(this.consumeOptional("=")){const F=function Hs(g){const v=g.match(Cl);return v?v[0]:""}(this.remaining);F&&(b=F,this.capture(b))}const A=ki(m),L=ki(b);if(v.hasOwnProperty(A)){let F=v[A];Array.isArray(F)||(F=[F],v[A]=F),F.push(L)}else v[A]=L}parseParens(v){const m={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const b=Ao(this.remaining),A=this.remaining[b.length];if("/"!==A&&")"!==A&&";"!==A)throw new C.vHH(4010,Gr);let L;b.indexOf(":")>-1?(L=b.slice(0,b.indexOf(":")),this.capture(L),this.capture(":")):v&&(L=Xt);const F=this.parseChildren();m[L]=1===Object.keys(F).length?F[Xt]:new sn([],F),this.consumeOptional("//")}return m}peekStartsWith(v){return this.remaining.startsWith(v)}consumeOptional(v){return!!this.peekStartsWith(v)&&(this.remaining=this.remaining.substring(v.length),!0)}capture(v){if(!this.consumeOptional(v))throw new C.vHH(4011,Gr)}}function Dl(g){return g.segments.length>0?new sn([],{[Xt]:g}):g}function Qo(g){const v={};for(const b of Object.keys(g.children)){const L=Qo(g.children[b]);(L.segments.length>0||L.hasChildren())&&(v[b]=L)}return function Vs(g){if(1===g.numberOfChildren&&g.children[Xt]){const v=g.children[Xt];return new sn(g.segments.concat(v.segments),v.children)}return g}(new sn(g.segments,v))}function ln(g){return g instanceof mn}const di=!1;function $r(g,v,m,b,A){if(0===m.length)return Vn(v.root,v.root,v.root,b,A);const L=function bi(g){if("string"==typeof g[0]&&1===g.length&&"/"===g[0])return new Cs(!0,0,g);let v=0,m=!1;const b=g.reduce((A,L,F)=>{if("object"==typeof L&&null!=L){if(L.outlets){const K={};return ai(L.outlets,(me,Ke)=>{K[Ke]="string"==typeof me?me.split("/"):me}),[...A,{outlets:K}]}if(L.segmentPath)return[...A,L.segmentPath]}return"string"!=typeof L?[...A,L]:0===F?(L.split("/").forEach((K,me)=>{0==me&&"."===K||(0==me&&""===K?m=!0:".."===K?v++:""!=K&&A.push(K))}),A):[...A,L]},[]);return new Cs(m,v,b)}(m);return L.toRoot()?Vn(v.root,v.root,new sn([],{}),b,A):function F(me){const Ke=function Co(g,v,m,b){if(g.isAbsolute)return new pi(v.root,!0,0);if(-1===b)return new pi(m,m===v.root,0);return function Ds(g,v,m){let b=g,A=v,L=m;for(;L>A;){if(L-=A,b=b.parent,!b)throw new C.vHH(4005,di&&"Invalid number of '../'");A=b.segments.length}return new pi(b,!1,A-L)}(m,b+(pt(g.commands[0])?0:1),g.numberOfDoubleDots)}(L,v,g.snapshot?._urlSegment,me),ct=Ke.processChildren?qr(Ke.segmentGroup,Ke.index,L.commands):Do(Ke.segmentGroup,Ke.index,L.commands);return Vn(v.root,Ke.segmentGroup,ct,b,A)}(g.snapshot?._lastPathIndex)}function pt(g){return"object"==typeof g&&null!=g&&!g.outlets&&!g.segmentPath}function Zt(g){return"object"==typeof g&&null!=g&&g.outlets}function Vn(g,v,m,b,A){let F,L={};b&&ai(b,(me,Ke)=>{L[Ke]=Array.isArray(me)?me.map(ct=>`${ct}`):`${me}`}),F=g===v?m:fr(g,v,m);const K=Dl(Qo(F));return new mn(K,L,A)}function fr(g,v,m){const b={};return ai(g.children,(A,L)=>{b[L]=A===v?m:fr(A,v,m)}),new sn(g.segments,b)}class Cs{constructor(v,m,b){if(this.isAbsolute=v,this.numberOfDoubleDots=m,this.commands=b,v&&b.length>0&&pt(b[0]))throw new C.vHH(4003,di&&"Root segment cannot have matrix parameters");const A=b.find(Zt);if(A&&A!==ni(b))throw new C.vHH(4004,di&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class pi{constructor(v,m,b){this.segmentGroup=v,this.processChildren=m,this.index=b}}function Do(g,v,m){if(g||(g=new sn([],{})),0===g.segments.length&&g.hasChildren())return qr(g,v,m);const b=function Il(g,v,m){let b=0,A=v;const L={match:!1,pathIndex:0,commandIndex:0};for(;A<g.segments.length;){if(b>=m.length)return L;const F=g.segments[A],K=m[b];if(Zt(K))break;const me=`${K}`,Ke=b<m.length-1?m[b+1]:null;if(A>0&&void 0===me)break;if(me&&Ke&&"object"==typeof Ke&&void 0===Ke.outlets){if(!Yr(me,Ke,F))return L;b+=2}else{if(!Yr(me,{},F))return L;b++}A++}return{match:!0,pathIndex:A,commandIndex:b}}(g,v,m),A=m.slice(b.commandIndex);if(b.match&&b.pathIndex<g.segments.length){const L=new sn(g.segments.slice(0,b.pathIndex),{});return L.children[Xt]=new sn(g.segments.slice(b.pathIndex),g.children),qr(L,0,A)}return b.match&&0===A.length?new sn(g.segments,{}):b.match&&!g.hasChildren()?Gs(g,v,m):b.match?qr(g,0,A):Gs(g,v,m)}function qr(g,v,m){if(0===m.length)return new sn(g.segments,{});{const b=function dn(g){return Zt(g[0])?g[0].outlets:{[Xt]:g}}(m),A={};return!b[Xt]&&g.children[Xt]&&1===g.numberOfChildren&&0===g.children[Xt].segments.length?qr(g.children[Xt],v,m):(ai(b,(L,F)=>{"string"==typeof L&&(L=[L]),null!==L&&(A[F]=Do(g.children[F],v,L))}),ai(g.children,(L,F)=>{void 0===b[F]&&(A[F]=L)}),new sn(g.segments,A))}}function Gs(g,v,m){const b=g.segments.slice(0,v);let A=0;for(;A<m.length;){const L=m[A];if(Zt(L)){const me=Ci(L.outlets);return new sn(b,me)}if(0===A&&pt(m[0])){b.push(new Ts(g.segments[v].path,Bi(m[0]))),A++;continue}const F=Zt(L)?L.outlets[Xt]:`${L}`,K=A<m.length-1?m[A+1]:null;F&&K&&pt(K)?(b.push(new Ts(F,Bi(K))),A+=2):(b.push(new Ts(F,{})),A++)}return new sn(b,{})}function Ci(g){const v={};return ai(g,(m,b)=>{"string"==typeof m&&(m=[m]),null!==m&&(v[b]=Gs(new sn([],{}),0,m))}),v}function Bi(g){const v={};return ai(g,(m,b)=>v[b]=`${m}`),v}function Yr(g,v,m){return g==m.path&&wn(v,m.parameters)}const Ui="imperative";class Di{constructor(v,m){this.id=v,this.url=m}}class Ba extends Di{constructor(v,m,b="imperative",A=null){super(v,m),this.type=0,this.navigationTrigger=b,this.restoredState=A}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class bn extends Di{constructor(v,m,b){super(v,m),this.urlAfterRedirects=b,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Pl extends Di{constructor(v,m,b,A){super(v,m),this.reason=b,this.code=A,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Jo extends Di{constructor(v,m,b,A){super(v,m),this.reason=b,this.code=A,this.type=16}}class Io extends Di{constructor(v,m,b,A){super(v,m),this.error=b,this.target=A,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Rl extends Di{constructor(v,m,b,A){super(v,m),this.urlAfterRedirects=b,this.state=A,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ua extends Di{constructor(v,m,b,A){super(v,m),this.urlAfterRedirects=b,this.state=A,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Po extends Di{constructor(v,m,b,A,L){super(v,m),this.urlAfterRedirects=b,this.state=A,this.shouldActivate=L,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class zi extends Di{constructor(v,m,b,A){super(v,m),this.urlAfterRedirects=b,this.state=A,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Rc extends Di{constructor(v,m,b,A){super(v,m),this.urlAfterRedirects=b,this.state=A,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class rr{constructor(v){this.route=v,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Xr{constructor(v){this.route=v,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Ll{constructor(v){this.snapshot=v,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ea{constructor(v){this.snapshot=v,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class za{constructor(v){this.snapshot=v,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Or{constructor(v){this.snapshot=v,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ol{constructor(v,m,b){this.routerEvent=v,this.position=m,this.anchor=b,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let ed=(()=>{class g{createUrlTree(m,b,A,L,F,K){return $r(m||b.root,A,L,F,K)}}return g.\u0275fac=function(m){return new(m||g)},g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac}),g})(),Nl=(()=>{class g{}return g.\u0275fac=function(m){return new(m||g)},g.\u0275prov=C.Yz7({token:g,factory:function(v){return ed.\u0275fac(v)},providedIn:"root"}),g})();class dh{constructor(v){this._root=v}get root(){return this._root.value}parent(v){const m=this.pathFromRoot(v);return m.length>1?m[m.length-2]:null}children(v){const m=Fl(v,this._root);return m?m.children.map(b=>b.value):[]}firstChild(v){const m=Fl(v,this._root);return m&&m.children.length>0?m.children[0].value:null}siblings(v){const m=Nc(v,this._root);return m.length<2?[]:m[m.length-2].children.map(A=>A.value).filter(A=>A!==v)}pathFromRoot(v){return Nc(v,this._root).map(m=>m.value)}}function Fl(g,v){if(g===v.value)return v;for(const m of v.children){const b=Fl(g,m);if(b)return b}return null}function Nc(g,v){if(g===v.value)return[v];for(const m of v.children){const b=Nc(g,m);if(b.length)return b.unshift(v),b}return[]}class cs{constructor(v,m){this.value=v,this.children=m}toString(){return`TreeNode(${this.value})`}}function ta(g){const v={};return g&&g.children.forEach(m=>v[m.value.outlet]=m),v}class td extends dh{constructor(v,m){super(v),this.snapshot=m,Bc(this,v)}toString(){return this.snapshot.toString()}}function Fc(g,v){const m=function rp(g,v){const F=new Ro([],{},{},"",{},Xt,v,null,g.root,-1,{});return new nd("",new cs(F,[]))}(g,v),b=new je([new Ts("",{})]),A=new je({}),L=new je({}),F=new je({}),K=new je(""),me=new Zi(b,A,F,K,L,Xt,v,m.root);return me.snapshot=m.root,new td(new cs(me,[]),m)}class Zi{constructor(v,m,b,A,L,F,K,me){this.url=v,this.params=m,this.queryParams=b,this.fragment=A,this.data=L,this.outlet=F,this.component=K,this.title=this.data?.pipe((0,at.U)(Ke=>Ke[On]))??Q(void 0),this._futureSnapshot=me}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,at.U)(v=>$e(v)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,at.U)(v=>$e(v)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function kc(g,v="emptyOnly"){const m=g.pathFromRoot;let b=0;if("always"!==v)for(b=m.length-1;b>=1;){const A=m[b],L=m[b-1];if(A.routeConfig&&""===A.routeConfig.path)b--;else{if(L.component)break;b--}}return function na(g){return g.reduce((v,m)=>({params:{...v.params,...m.params},data:{...v.data,...m.data},resolve:{...m.data,...v.resolve,...m.routeConfig?.data,...m._resolvedData}}),{params:{},data:{},resolve:{}})}(m.slice(b))}class Ro{get title(){return this.data?.[On]}constructor(v,m,b,A,L,F,K,me,Ke,ct,on){this.url=v,this.params=m,this.queryParams=b,this.fragment=A,this.data=L,this.outlet=F,this.component=K,this.routeConfig=me,this._urlSegment=Ke,this._lastPathIndex=ct,this._resolve=on}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=$e(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=$e(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(b=>b.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class nd extends dh{constructor(v,m){super(m),this.url=v,Bc(this,m)}toString(){return Ha(this._root)}}function Bc(g,v){v.value._routerState=g,v.children.forEach(m=>Bc(g,m))}function Ha(g){const v=g.children.length>0?` { ${g.children.map(Ha).join(", ")} } `:"";return`${g.value}${v}`}function us(g){if(g.snapshot){const v=g.snapshot,m=g._futureSnapshot;g.snapshot=m,wn(v.queryParams,m.queryParams)||g.queryParams.next(m.queryParams),v.fragment!==m.fragment&&g.fragment.next(m.fragment),wn(v.params,m.params)||g.params.next(m.params),function Ss(g,v){if(g.length!==v.length)return!1;for(let m=0;m<g.length;++m)if(!wn(g[m],v[m]))return!1;return!0}(v.url,m.url)||g.url.next(m.url),wn(v.data,m.data)||g.data.next(m.data)}else g.snapshot=g._futureSnapshot,g.data.next(g._futureSnapshot.data)}function Uc(g,v){const m=wn(g.params,v.params)&&function Yi(g,v){return Fi(g,v)&&g.every((m,b)=>wn(m.parameters,v[b].parameters))}(g.url,v.url);return m&&!(!g.parent!=!v.parent)&&(!g.parent||Uc(g.parent,v.parent))}function ia(g,v,m){if(m&&g.shouldReuseRoute(v.value,m.value.snapshot)){const b=m.value;b._futureSnapshot=v.value;const A=function Va(g,v,m){return v.children.map(b=>{for(const A of m.children)if(g.shouldReuseRoute(b.value,A.value.snapshot))return ia(g,b,A);return ia(g,b)})}(g,v,m);return new cs(b,A)}{if(g.shouldAttach(v.value)){const L=g.retrieve(v.value);if(null!==L){const F=L.route;return F.value._futureSnapshot=v.value,F.children=v.children.map(K=>ia(g,K)),F}}const b=function id(g){return new Zi(new je(g.url),new je(g.params),new je(g.queryParams),new je(g.fragment),new je(g.data),g.outlet,g.component,g)}(v.value),A=v.children.map(L=>ia(g,L));return new cs(b,A)}}const ra="ngNavigationCancelingError";function sr(g,v){const{redirectTo:m,navigationBehaviorOptions:b}=ln(v)?{redirectTo:v,navigationBehaviorOptions:void 0}:v,A=Ws(!1,0,v);return A.url=m,A.navigationBehaviorOptions=b,A}function Ws(g,v,m){const b=new Error("NavigationCancelingError: "+(g||""));return b[ra]=!0,b.cancellationCode=v,m&&(b.url=m),b}function js(g){return zc(g)&&ln(g.url)}function zc(g){return g&&g[ra]}class Hi{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Oo,this.attachRef=null}}let Oo=(()=>{class g{constructor(){this.contexts=new Map}onChildOutletCreated(m,b){const A=this.getOrCreateContext(m);A.outlet=b,this.contexts.set(m,A)}onChildOutletDestroyed(m){const b=this.getContext(m);b&&(b.outlet=null,b.attachRef=null)}onOutletDeactivated(){const m=this.contexts;return this.contexts=new Map,m}onOutletReAttached(m){this.contexts=m}getOrCreateContext(m){let b=this.getContext(m);return b||(b=new Hi,this.contexts.set(m,b)),b}getContext(m){return this.contexts.get(m)||null}}return g.\u0275fac=function(m){return new(m||g)},g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();const No=!1;let li=(()=>{class g{constructor(){this.activated=null,this._activatedRoute=null,this.name=Xt,this.activateEvents=new C.vpe,this.deactivateEvents=new C.vpe,this.attachEvents=new C.vpe,this.detachEvents=new C.vpe,this.parentContexts=(0,C.f3M)(Oo),this.location=(0,C.f3M)(C.s_b),this.changeDetector=(0,C.f3M)(C.sBO),this.environmentInjector=(0,C.f3M)(C.lqb)}ngOnChanges(m){if(m.name){const{firstChange:b,previousValue:A}=m.name;if(b)return;this.isTrackedInParentContexts(A)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(A)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(m){return this.parentContexts.getContext(m)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const m=this.parentContexts.getContext(this.name);m?.route&&(m.attachRef?this.attach(m.attachRef,m.route):this.activateWith(m.route,m.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new C.vHH(4012,No);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new C.vHH(4012,No);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new C.vHH(4012,No);this.location.detach();const m=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(m.instance),m}attach(m,b){this.activated=m,this._activatedRoute=b,this.location.insert(m.hostView),this.attachEvents.emit(m.instance)}deactivate(){if(this.activated){const m=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(m)}}activateWith(m,b){if(this.isActivated)throw new C.vHH(4013,No);this._activatedRoute=m;const A=this.location,F=m.snapshot.component,K=this.parentContexts.getOrCreateContext(this.name).children,me=new rd(m,K,A.injector);if(b&&function Ga(g){return!!g.resolveComponentFactory}(b)){const Ke=b.resolveComponentFactory(F);this.activated=A.createComponent(Ke,A.length,me)}else this.activated=A.createComponent(F,{index:A.length,injector:me,environmentInjector:b??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return g.\u0275fac=function(m){return new(m||g)},g.\u0275dir=C.lG2({type:g,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[C.TTD]}),g})();class rd{constructor(v,m,b){this.route=v,this.childContexts=m,this.parent=b}get(v,m){return v===Zi?this.route:v===Oo?this.childContexts:this.parent.get(v,m)}}let Ii=(()=>{class g{}return g.\u0275fac=function(m){return new(m||g)},g.\u0275cmp=C.Xpm({type:g,selectors:[["ng-component"]],standalone:!0,features:[C.jDz],decls:1,vars:0,template:function(m,b){1&m&&C._UZ(0,"router-outlet")},dependencies:[li],encapsulation:2}),g})();function Hc(g,v){return g.providers&&!g._injector&&(g._injector=(0,C.MMx)(g.providers,v,`Route: ${g.path}`)),g._injector??v}function ko(g){const v=g.children&&g.children.map(ko),m=v?{...g,children:v}:{...g};return!m.component&&!m.loadComponent&&(v||m.loadChildren)&&m.outlet&&m.outlet!==Xt&&(m.component=Ii),m}function Rt(g){return g.outlet||Xt}function kl(g,v){const m=g.filter(b=>Rt(b)===v);return m.push(...g.filter(b=>Rt(b)!==v)),m}function Wa(g){if(!g)return null;if(g.routeConfig?._injector)return g.routeConfig._injector;for(let v=g.parent;v;v=v.parent){const m=v.routeConfig;if(m?._loadedInjector)return m._loadedInjector;if(m?._injector)return m._injector}return null}class ph{constructor(v,m,b,A){this.routeReuseStrategy=v,this.futureState=m,this.currState=b,this.forwardEvent=A}activate(v){const m=this.futureState._root,b=this.currState?this.currState._root:null;this.deactivateChildRoutes(m,b,v),us(this.futureState.root),this.activateChildRoutes(m,b,v)}deactivateChildRoutes(v,m,b){const A=ta(m);v.children.forEach(L=>{const F=L.value.outlet;this.deactivateRoutes(L,A[F],b),delete A[F]}),ai(A,(L,F)=>{this.deactivateRouteAndItsChildren(L,b)})}deactivateRoutes(v,m,b){const A=v.value,L=m?m.value:null;if(A===L)if(A.component){const F=b.getContext(A.outlet);F&&this.deactivateChildRoutes(v,m,F.children)}else this.deactivateChildRoutes(v,m,b);else L&&this.deactivateRouteAndItsChildren(m,b)}deactivateRouteAndItsChildren(v,m){v.value.component&&this.routeReuseStrategy.shouldDetach(v.value.snapshot)?this.detachAndStoreRouteSubtree(v,m):this.deactivateRouteAndOutlet(v,m)}detachAndStoreRouteSubtree(v,m){const b=m.getContext(v.value.outlet),A=b&&v.value.component?b.children:m,L=ta(v);for(const F of Object.keys(L))this.deactivateRouteAndItsChildren(L[F],A);if(b&&b.outlet){const F=b.outlet.detach(),K=b.children.onOutletDeactivated();this.routeReuseStrategy.store(v.value.snapshot,{componentRef:F,route:v,contexts:K})}}deactivateRouteAndOutlet(v,m){const b=m.getContext(v.value.outlet),A=b&&v.value.component?b.children:m,L=ta(v);for(const F of Object.keys(L))this.deactivateRouteAndItsChildren(L[F],A);b&&b.outlet&&(b.outlet.deactivate(),b.children.onOutletDeactivated(),b.attachRef=null,b.resolver=null,b.route=null)}activateChildRoutes(v,m,b){const A=ta(m);v.children.forEach(L=>{this.activateRoutes(L,A[L.value.outlet],b),this.forwardEvent(new Or(L.value.snapshot))}),v.children.length&&this.forwardEvent(new ea(v.value.snapshot))}activateRoutes(v,m,b){const A=v.value,L=m?m.value:null;if(us(A),A===L)if(A.component){const F=b.getOrCreateContext(A.outlet);this.activateChildRoutes(v,m,F.children)}else this.activateChildRoutes(v,m,b);else if(A.component){const F=b.getOrCreateContext(A.outlet);if(this.routeReuseStrategy.shouldAttach(A.snapshot)){const K=this.routeReuseStrategy.retrieve(A.snapshot);this.routeReuseStrategy.store(A.snapshot,null),F.children.onOutletReAttached(K.contexts),F.attachRef=K.componentRef,F.route=K.route.value,F.outlet&&F.outlet.attach(K.componentRef,K.route.value),us(K.route.value),this.activateChildRoutes(v,null,F.children)}else{const K=Wa(A.snapshot),me=K?.get(C._Vd)??null;F.attachRef=null,F.route=A,F.resolver=me,F.injector=K,F.outlet&&F.outlet.activateWith(A,F.injector),this.activateChildRoutes(v,null,F.children)}}else this.activateChildRoutes(v,null,b)}}class od{constructor(v){this.path=v,this.route=this.path[this.path.length-1]}}class ja{constructor(v,m){this.component=v,this.route=m}}function mh(g,v,m){const b=g._root;return hn(b,v?v._root:null,m,[b.value])}function Pe(g,v){const m=Symbol(),b=v.get(g,m);return b===m?"function"!=typeof g||(0,C.Z0I)(g)?v.get(g):g:b}function hn(g,v,m,b,A={canDeactivateChecks:[],canActivateChecks:[]}){const L=ta(v);return g.children.forEach(F=>{(function ld(g,v,m,b,A={canDeactivateChecks:[],canActivateChecks:[]}){const L=g.value,F=v?v.value:null,K=m?m.getContext(g.value.outlet):null;if(F&&L.routeConfig===F.routeConfig){const me=function gh(g,v,m){if("function"==typeof m)return m(g,v);switch(m){case"pathParamsChange":return!Fi(g.url,v.url);case"pathParamsOrQueryParamsChange":return!Fi(g.url,v.url)||!wn(g.queryParams,v.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Uc(g,v)||!wn(g.queryParams,v.queryParams);default:return!Uc(g,v)}}(F,L,L.routeConfig.runGuardsAndResolvers);me?A.canActivateChecks.push(new od(b)):(L.data=F.data,L._resolvedData=F._resolvedData),hn(g,v,L.component?K?K.children:null:m,b,A),me&&K&&K.outlet&&K.outlet.isActivated&&A.canDeactivateChecks.push(new ja(K.outlet.component,F))}else F&&mi(v,K,A),A.canActivateChecks.push(new od(b)),hn(g,null,L.component?K?K.children:null:m,b,A)})(F,L[F.value.outlet],m,b.concat([F.value]),A),delete L[F.value.outlet]}),ai(L,(F,K)=>mi(F,m.getContext(K),A)),A}function mi(g,v,m){const b=ta(g),A=g.value;ai(b,(L,F)=>{mi(L,A.component?v?v.children.getContext(F):null:v,m)}),m.canDeactivateChecks.push(new ja(A.component&&v&&v.outlet&&v.outlet.isActivated?v.outlet.component:null,A))}function Bo(g){return"function"==typeof g}function Kr(g){return g instanceof wt||"EmptyError"===g?.name}const Uo=Symbol("INITIAL_VALUE");function Nr(){return Dt(g=>Pt(g.map(v=>v.pipe(Sn(1),function En(...g){const v=(0,Y.yG)(g);return(0,He.e)((m,b)=>{(v?Ft(g,m,v):Ft(g,m)).subscribe(b)})}(Uo)))).pipe((0,at.U)(v=>{for(const m of v)if(!0!==m){if(m===Uo)return Uo;if(!1===m||m instanceof mn)return m}return!0}),(0,rn.h)(v=>v!==Uo),Sn(1)))}function Bl(g){return(0,Te.z)(yn(v=>{if(ln(v))throw sr(0,v)}),(0,at.U)(v=>!0===v))}const Jr={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function qc(g,v,m,b,A){const L=la(g,v,m);return L.matched?function zo(g,v,m,b){const A=v.canMatch;return A&&0!==A.length?Q(A.map(F=>{const K=Pe(F,g);return pn(function sp(g){return g&&Bo(g.canMatch)}(K)?K.canMatch(v,m):g.runInContext(()=>K(v,m)))})).pipe(Nr(),Bl()):Q(!0)}(b=Hc(v,b),v,m).pipe((0,at.U)(F=>!0===F?L:{...Jr})):Q(L)}function la(g,v,m){if(""===v.path)return"full"===v.pathMatch&&(g.hasChildren()||m.length>0)?{...Jr}:{matched:!0,consumedSegments:[],remainingSegments:m,parameters:{},positionalParamSegments:{}};const A=(v.matcher||So)(m,g,v);if(!A)return{...Jr};const L={};ai(A.posParams,(K,me)=>{L[me]=K.path});const F=A.consumed.length>0?{...L,...A.consumed[A.consumed.length-1].parameters}:L;return{matched:!0,consumedSegments:A.consumed,remainingSegments:m.slice(A.consumed.length),parameters:F,positionalParamSegments:A.posParams??{}}}function ca(g,v,m,b){if(m.length>0&&function dd(g,v,m){return m.some(b=>ui(g,v,b)&&Rt(b)!==Xt)}(g,m,b)){const L=new sn(v,function ud(g,v,m,b){const A={};A[Xt]=b,b._sourceSegment=g,b._segmentIndexShift=v.length;for(const L of m)if(""===L.path&&Rt(L)!==Xt){const F=new sn([],{});F._sourceSegment=g,F._segmentIndexShift=v.length,A[Rt(L)]=F}return A}(g,v,b,new sn(m,g.children)));return L._sourceSegment=g,L._segmentIndexShift=v.length,{segmentGroup:L,slicedSegments:[]}}if(0===m.length&&function bh(g,v,m){return m.some(b=>ui(g,v,b))}(g,m,b)){const L=new sn(g.segments,function wh(g,v,m,b,A){const L={};for(const F of b)if(ui(g,m,F)&&!A[Rt(F)]){const K=new sn([],{});K._sourceSegment=g,K._segmentIndexShift=v.length,L[Rt(F)]=K}return{...A,...L}}(g,v,m,b,g.children));return L._sourceSegment=g,L._segmentIndexShift=v.length,{segmentGroup:L,slicedSegments:m}}const A=new sn(g.segments,g.children);return A._sourceSegment=g,A._segmentIndexShift=v.length,{segmentGroup:A,slicedSegments:m}}function ui(g,v,m){return(!(g.hasChildren()||v.length>0)||"full"!==m.pathMatch)&&""===m.path}function Qi(g,v,m,b){return!!(Rt(g)===b||b!==Xt&&ui(v,m,g))&&("**"===g.path||la(v,g,m).matched)}function _n(g,v,m){return 0===v.length&&!g.children[m]}const wr=!1;class Yc{constructor(v){this.segmentGroup=v||null}}class hs{constructor(v){this.urlTree=v}}function M(g){return Le(new Yc(g))}function I(g){return Le(new hs(g))}class fe{constructor(v,m,b,A,L){this.injector=v,this.configLoader=m,this.urlSerializer=b,this.urlTree=A,this.config=L,this.allowRedirects=!0}apply(){const v=ca(this.urlTree.root,[],[],this.config).segmentGroup,m=new sn(v.segments,v.children);return this.expandSegmentGroup(this.injector,this.config,m,Xt).pipe((0,at.U)(L=>this.createUrlTree(Qo(L),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Pr(L=>{if(L instanceof hs)return this.allowRedirects=!1,this.match(L.urlTree);throw L instanceof Yc?this.noMatchError(L):L}))}match(v){return this.expandSegmentGroup(this.injector,this.config,v.root,Xt).pipe((0,at.U)(A=>this.createUrlTree(Qo(A),v.queryParams,v.fragment))).pipe(Pr(A=>{throw A instanceof Yc?this.noMatchError(A):A}))}noMatchError(v){return new C.vHH(4002,wr)}createUrlTree(v,m,b){const A=Dl(v);return new mn(A,m,b)}expandSegmentGroup(v,m,b,A){return 0===b.segments.length&&b.hasChildren()?this.expandChildren(v,m,b).pipe((0,at.U)(L=>new sn([],L))):this.expandSegment(v,b,m,b.segments,A,!0)}expandChildren(v,m,b){const A=[];for(const L of Object.keys(b.children))"primary"===L?A.unshift(L):A.push(L);return(0,O.D)(A).pipe(Hr(L=>{const F=b.children[L],K=kl(m,L);return this.expandSegmentGroup(v,K,F,L).pipe((0,at.U)(me=>({segment:me,outlet:L})))}),oi((L,F)=>(L[F.outlet]=F.segment,L),{}),bo())}expandSegment(v,m,b,A,L,F){return(0,O.D)(b).pipe(Hr(K=>this.expandSegmentAgainstRoute(v,m,b,K,A,L,F).pipe(Pr(Ke=>{if(Ke instanceof Yc)return Q(null);throw Ke}))),Hn(K=>!!K),Pr((K,me)=>{if(Kr(K))return _n(m,A,L)?Q(new sn([],{})):M(m);throw K}))}expandSegmentAgainstRoute(v,m,b,A,L,F,K){return Qi(A,m,L,F)?void 0===A.redirectTo?this.matchSegmentAgainstRoute(v,m,A,L,F):K&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(v,m,b,A,L,F):M(m):M(m)}expandSegmentAgainstRouteUsingRedirect(v,m,b,A,L,F){return"**"===A.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(v,b,A,F):this.expandRegularSegmentAgainstRouteUsingRedirect(v,m,b,A,L,F)}expandWildCardWithParamsAgainstRouteUsingRedirect(v,m,b,A){const L=this.applyRedirectCommands([],b.redirectTo,{});return b.redirectTo.startsWith("/")?I(L):this.lineralizeSegments(b,L).pipe((0,qn.z)(F=>{const K=new sn(F,{});return this.expandSegment(v,K,m,F,A,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(v,m,b,A,L,F){const{matched:K,consumedSegments:me,remainingSegments:Ke,positionalParamSegments:ct}=la(m,A,L);if(!K)return M(m);const on=this.applyRedirectCommands(me,A.redirectTo,ct);return A.redirectTo.startsWith("/")?I(on):this.lineralizeSegments(A,on).pipe((0,qn.z)(gi=>this.expandSegment(v,m,b,gi.concat(Ke),F,!1)))}matchSegmentAgainstRoute(v,m,b,A,L){return"**"===b.path?(v=Hc(b,v),b.loadChildren?(b._loadedRoutes?Q({routes:b._loadedRoutes,injector:b._loadedInjector}):this.configLoader.loadChildren(v,b)).pipe((0,at.U)(K=>(b._loadedRoutes=K.routes,b._loadedInjector=K.injector,new sn(A,{})))):Q(new sn(A,{}))):qc(m,b,A,v).pipe(Dt(({matched:F,consumedSegments:K,remainingSegments:me})=>F?this.getChildConfig(v=b._injector??v,b,A).pipe((0,qn.z)(ct=>{const on=ct.injector??v,gi=ct.routes,{segmentGroup:kr,slicedSegments:Sr}=ca(m,K,me,gi),Ks=new sn(kr.segments,kr.children);if(0===Sr.length&&Ks.hasChildren())return this.expandChildren(on,gi,Ks).pipe((0,at.U)(Ph=>new sn(K,Ph)));if(0===gi.length&&0===Sr.length)return Q(new sn(K,{}));const yi=Rt(b)===L;return this.expandSegment(on,Ks,gi,Sr,yi?Xt:L,!0).pipe((0,at.U)(el=>new sn(K.concat(el.segments),el.children)))})):M(m)))}getChildConfig(v,m,b){return m.children?Q({routes:m.children,injector:v}):m.loadChildren?void 0!==m._loadedRoutes?Q({routes:m._loadedRoutes,injector:m._loadedInjector}):function $c(g,v,m,b){const A=v.canLoad;return void 0===A||0===A.length?Q(!0):Q(A.map(F=>{const K=Pe(F,g);return pn(function Zr(g){return g&&Bo(g.canLoad)}(K)?K.canLoad(v,m):g.runInContext(()=>K(v,m)))})).pipe(Nr(),Bl())}(v,m,b).pipe((0,qn.z)(A=>A?this.configLoader.loadChildren(v,m).pipe(yn(L=>{m._loadedRoutes=L.routes,m._loadedInjector=L.injector})):function N(g){return Le(Ws(wr,3))}())):Q({routes:[],injector:v})}lineralizeSegments(v,m){let b=[],A=m.root;for(;;){if(b=b.concat(A.segments),0===A.numberOfChildren)return Q(b);if(A.numberOfChildren>1||!A.children[Xt])return v.redirectTo,Le(new C.vHH(4e3,wr));A=A.children[Xt]}}applyRedirectCommands(v,m,b){return this.applyRedirectCreateUrlTree(m,this.urlSerializer.parse(m),v,b)}applyRedirectCreateUrlTree(v,m,b,A){const L=this.createSegmentGroup(v,m.root,b,A);return new mn(L,this.createQueryParams(m.queryParams,this.urlTree.queryParams),m.fragment)}createQueryParams(v,m){const b={};return ai(v,(A,L)=>{if("string"==typeof A&&A.startsWith(":")){const K=A.substring(1);b[L]=m[K]}else b[L]=A}),b}createSegmentGroup(v,m,b,A){const L=this.createSegments(v,m.segments,b,A);let F={};return ai(m.children,(K,me)=>{F[me]=this.createSegmentGroup(v,K,b,A)}),new sn(L,F)}createSegments(v,m,b,A){return m.map(L=>L.path.startsWith(":")?this.findPosParam(v,L,A):this.findOrReturn(L,b))}findPosParam(v,m,b){const A=b[m.path.substring(1)];if(!A)throw new C.vHH(4001,wr);return A}findOrReturn(v,m){let b=0;for(const A of m){if(A.path===v.path)return m.splice(b),A;b++}return v}}class Cn{}class xn{constructor(v,m,b,A,L,F,K){this.injector=v,this.rootComponentType=m,this.config=b,this.urlTree=A,this.url=L,this.paramsInheritanceStrategy=F,this.urlSerializer=K}recognize(){const v=ca(this.urlTree.root,[],[],this.config.filter(m=>void 0===m.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,v,Xt).pipe((0,at.U)(m=>{if(null===m)return null;const b=new Ro([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Xt,this.rootComponentType,null,this.urlTree.root,-1,{}),A=new cs(b,m),L=new nd(this.url,A);return this.inheritParamsAndData(L._root),L}))}inheritParamsAndData(v){const m=v.value,b=kc(m,this.paramsInheritanceStrategy);m.params=Object.freeze(b.params),m.data=Object.freeze(b.data),v.children.forEach(A=>this.inheritParamsAndData(A))}processSegmentGroup(v,m,b,A){return 0===b.segments.length&&b.hasChildren()?this.processChildren(v,m,b):this.processSegment(v,m,b,b.segments,A)}processChildren(v,m,b){return(0,O.D)(Object.keys(b.children)).pipe(Hr(A=>{const L=b.children[A],F=kl(m,A);return this.processSegmentGroup(v,F,L,A)}),oi((A,L)=>A&&L?(A.push(...L),A):null),function ss(g,v=!1){return(0,He.e)((m,b)=>{let A=0;m.subscribe((0,ie.x)(b,L=>{const F=g(L,A++);(F||v)&&b.next(L),!F&&b.complete()}))})}(A=>null!==A),Yn(null),bo(),(0,at.U)(A=>{if(null===A)return null;const L=fs(A);return function Si(g){g.sort((v,m)=>v.value.outlet===Xt?-1:m.value.outlet===Xt?1:v.value.outlet.localeCompare(m.value.outlet))}(L),L}))}processSegment(v,m,b,A,L){return(0,O.D)(m).pipe(Hr(F=>this.processSegmentAgainstRoute(F._injector??v,F,b,A,L)),Hn(F=>!!F),Pr(F=>{if(Kr(F))return _n(b,A,L)?Q([]):Q(null);throw F}))}processSegmentAgainstRoute(v,m,b,A,L){if(m.redirectTo||!Qi(m,b,A,L))return Q(null);let F;if("**"===m.path){const K=A.length>0?ni(A).parameters:{},me=Is(b)+A.length;F=Q({snapshot:new Ro(A,K,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,da(m),Rt(m),m.component??m._loadedComponent??null,m,qs(b),me,$a(m)),consumedSegments:[],remainingSegments:[]})}else F=qc(b,m,A,v).pipe((0,at.U)(({matched:K,consumedSegments:me,remainingSegments:Ke,parameters:ct})=>{if(!K)return null;const on=Is(b)+me.length;return{snapshot:new Ro(me,ct,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,da(m),Rt(m),m.component??m._loadedComponent??null,m,qs(b),on,$a(m)),consumedSegments:me,remainingSegments:Ke}}));return F.pipe(Dt(K=>{if(null===K)return Q(null);const{snapshot:me,consumedSegments:Ke,remainingSegments:ct}=K;v=m._injector??v;const on=m._loadedInjector??v,gi=function Nn(g){return g.children?g.children:g.loadChildren?g._loadedRoutes:[]}(m),{segmentGroup:kr,slicedSegments:Sr}=ca(b,Ke,ct,gi.filter(yi=>void 0===yi.redirectTo));if(0===Sr.length&&kr.hasChildren())return this.processChildren(on,gi,kr).pipe((0,at.U)(yi=>null===yi?null:[new cs(me,yi)]));if(0===gi.length&&0===Sr.length)return Q([new cs(me,[])]);const Ks=Rt(m)===L;return this.processSegment(on,gi,kr,Sr,Ks?Xt:L).pipe((0,at.U)(yi=>null===yi?null:[new cs(me,yi)]))}))}}function Pi(g){const v=g.value.routeConfig;return v&&""===v.path&&void 0===v.redirectTo}function fs(g){const v=[],m=new Set;for(const b of g){if(!Pi(b)){v.push(b);continue}const A=v.find(L=>b.value.routeConfig===L.value.routeConfig);void 0!==A?(A.children.push(...b.children),m.add(A)):v.push(b)}for(const b of m){const A=fs(b.children);v.push(new cs(b.value,A))}return v.filter(b=>!m.has(b))}function qs(g){let v=g;for(;v._sourceSegment;)v=v._sourceSegment;return v}function Is(g){let v=g,m=v._segmentIndexShift??0;for(;v._sourceSegment;)v=v._sourceSegment,m+=v._segmentIndexShift??0;return m-1}function da(g){return g.data||{}}function $a(g){return g.resolve||{}}function Qc(g){return"string"==typeof g.title||null===g.title}function Ys(g){return Dt(v=>{const m=g(v);return m?(0,O.D)(m).pipe((0,at.U)(()=>v)):Q(v)})}const pr=new C.OlP("ROUTES");let fd=(()=>{class g{constructor(m,b){this.injector=m,this.compiler=b,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(m){if(this.componentLoaders.get(m))return this.componentLoaders.get(m);if(m._loadedComponent)return Q(m._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(m);const b=pn(m.loadComponent()).pipe((0,at.U)(Sh),yn(L=>{this.onLoadEndListener&&this.onLoadEndListener(m),m._loadedComponent=L}),Mo(()=>{this.componentLoaders.delete(m)})),A=new Rn(b,()=>new we.x).pipe(Wt());return this.componentLoaders.set(m,A),A}loadChildren(m,b){if(this.childrenLoaders.get(b))return this.childrenLoaders.get(b);if(b._loadedRoutes)return Q({routes:b._loadedRoutes,injector:b._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(b);const L=this.loadModuleFactoryOrRoutes(b.loadChildren).pipe((0,at.U)(K=>{this.onLoadEndListener&&this.onLoadEndListener(b);let me,Ke,ct=!1;Array.isArray(K)?Ke=K:(me=K.create(m).injector,Ke=_r(me.get(pr,[],C.XFs.Self|C.XFs.Optional)));return{routes:Ke.map(ko),injector:me}}),Mo(()=>{this.childrenLoaders.delete(b)})),F=new Rn(L,()=>new we.x).pipe(Wt());return this.childrenLoaders.set(b,F),F}loadModuleFactoryOrRoutes(m){return pn(m()).pipe((0,at.U)(Sh),(0,qn.z)(A=>A instanceof C.YKP||Array.isArray(A)?Q(A):(0,O.D)(this.compiler.compileModuleAsync(A))))}}return g.\u0275fac=function(m){return new(m||g)(C.LFG(C.zs3),C.LFG(C.Sil))},g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();function Sh(g){return function Ps(g){return g&&"object"==typeof g&&"default"in g}(g)?g.default:g}let qa=(()=>{class g{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new we.x,this.configLoader=(0,C.f3M)(fd),this.environmentInjector=(0,C.f3M)(C.lqb),this.urlSerializer=(0,C.f3M)(J),this.rootContexts=(0,C.f3M)(Oo),this.navigationId=0,this.afterPreactivation=()=>Q(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=A=>this.events.next(new Xr(A)),this.configLoader.onLoadStartListener=A=>this.events.next(new rr(A))}complete(){this.transitions?.complete()}handleNavigationRequest(m){const b=++this.navigationId;this.transitions?.next({...this.transitions.value,...m,id:b})}setupNavigations(m){return this.transitions=new je({id:0,targetPageId:0,currentUrlTree:m.currentUrlTree,currentRawUrl:m.currentUrlTree,extractedUrl:m.urlHandlingStrategy.extract(m.currentUrlTree),urlAfterRedirects:m.urlHandlingStrategy.extract(m.currentUrlTree),rawUrl:m.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ui,restoredState:null,currentSnapshot:m.routerState.snapshot,targetSnapshot:null,currentRouterState:m.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,rn.h)(b=>0!==b.id),(0,at.U)(b=>({...b,extractedUrl:m.urlHandlingStrategy.extract(b.rawUrl)})),Dt(b=>{let A=!1,L=!1;return Q(b).pipe(yn(F=>{this.currentNavigation={id:F.id,initialUrl:F.rawUrl,extractedUrl:F.extractedUrl,trigger:F.source,extras:F.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Dt(F=>{const K=m.browserUrlTree.toString(),me=!m.navigated||F.extractedUrl.toString()!==K||K!==m.currentUrlTree.toString();if(!me&&"reload"!==(F.extras.onSameUrlNavigation??m.onSameUrlNavigation)){const ct="";return this.events.next(new Jo(F.id,m.serializeUrl(b.rawUrl),ct,0)),m.rawUrlTree=F.rawUrl,F.resolve(null),Ue.E}if(m.urlHandlingStrategy.shouldProcessUrl(F.rawUrl))return zl(F.source)&&(m.browserUrlTree=F.extractedUrl),Q(F).pipe(Dt(ct=>{const on=this.transitions?.getValue();return this.events.next(new Ba(ct.id,this.urlSerializer.serialize(ct.extractedUrl),ct.source,ct.restoredState)),on!==this.transitions?.getValue()?Ue.E:Promise.resolve(ct)}),function De(g,v,m,b){return Dt(A=>function q(g,v,m,b,A){return new fe(g,v,m,b,A).apply()}(g,v,m,A.extractedUrl,b).pipe((0,at.U)(L=>({...A,urlAfterRedirects:L}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,m.config),yn(ct=>{this.currentNavigation={...this.currentNavigation,finalUrl:ct.urlAfterRedirects},b.urlAfterRedirects=ct.urlAfterRedirects}),function Ul(g,v,m,b,A){return(0,qn.z)(L=>function Mn(g,v,m,b,A,L,F="emptyOnly"){return new xn(g,v,m,b,A,F,L).recognize().pipe(Dt(K=>null===K?function gn(g){return new it.y(v=>v.error(g))}(new Cn):Q(K)))}(g,v,m,L.urlAfterRedirects,b.serialize(L.urlAfterRedirects),b,A).pipe((0,at.U)(F=>({...L,targetSnapshot:F}))))}(this.environmentInjector,this.rootComponentType,m.config,this.urlSerializer,m.paramsInheritanceStrategy),yn(ct=>{if(b.targetSnapshot=ct.targetSnapshot,"eager"===m.urlUpdateStrategy){if(!ct.extras.skipLocationChange){const gi=m.urlHandlingStrategy.merge(ct.urlAfterRedirects,ct.rawUrl);m.setBrowserUrl(gi,ct)}m.browserUrlTree=ct.urlAfterRedirects}const on=new Rl(ct.id,this.urlSerializer.serialize(ct.extractedUrl),this.urlSerializer.serialize(ct.urlAfterRedirects),ct.targetSnapshot);this.events.next(on)}));if(me&&m.urlHandlingStrategy.shouldProcessUrl(m.rawUrlTree)){const{id:ct,extractedUrl:on,source:gi,restoredState:kr,extras:Sr}=F,Ks=new Ba(ct,this.urlSerializer.serialize(on),gi,kr);this.events.next(Ks);const yi=Fc(on,this.rootComponentType).snapshot;return Q(b={...F,targetSnapshot:yi,urlAfterRedirects:on,extras:{...Sr,skipLocationChange:!1,replaceUrl:!1}})}{const ct="";return this.events.next(new Jo(F.id,m.serializeUrl(b.extractedUrl),ct,1)),m.rawUrlTree=F.rawUrl,F.resolve(null),Ue.E}}),yn(F=>{const K=new Ua(F.id,this.urlSerializer.serialize(F.extractedUrl),this.urlSerializer.serialize(F.urlAfterRedirects),F.targetSnapshot);this.events.next(K)}),(0,at.U)(F=>b={...F,guards:mh(F.targetSnapshot,F.currentSnapshot,this.rootContexts)}),function Qr(g,v){return(0,qn.z)(m=>{const{targetSnapshot:b,currentSnapshot:A,guards:{canActivateChecks:L,canDeactivateChecks:F}}=m;return 0===F.length&&0===L.length?Q({...m,guardsResult:!0}):function vh(g,v,m,b){return(0,O.D)(g).pipe((0,qn.z)(A=>function jc(g,v,m,b,A){const L=v&&v.routeConfig?v.routeConfig.canDeactivate:null;return L&&0!==L.length?Q(L.map(K=>{const me=Wa(v)??A,Ke=Pe(K,me);return pn(function yh(g){return g&&Bo(g.canDeactivate)}(Ke)?Ke.canDeactivate(g,v,m,b):me.runInContext(()=>Ke(g,v,m,b))).pipe(Hn())})).pipe(Nr()):Q(!0)}(A.component,A.route,m,v,b)),Hn(A=>!0!==A,!0))}(F,b,A,g).pipe((0,qn.z)(K=>K&&function Ki(g){return"boolean"==typeof g}(K)?function cd(g,v,m,b){return(0,O.D)(v).pipe(Hr(A=>Ft(function xh(g,v){return null!==g&&v&&v(new Ll(g)),Q(!0)}(A.route.parent,b),function _h(g,v){return null!==g&&v&&v(new za(g)),Q(!0)}(A.route,b),function Wc(g,v,m){const b=v[v.length-1],L=v.slice(0,v.length-1).reverse().map(F=>function ad(g){const v=g.routeConfig?g.routeConfig.canActivateChild:null;return v&&0!==v.length?{node:g,guards:v}:null}(F)).filter(F=>null!==F).map(F=>Tt(()=>Q(F.guards.map(me=>{const Ke=Wa(F.node)??m,ct=Pe(me,Ke);return pn(function $s(g){return g&&Bo(g.canActivateChild)}(ct)?ct.canActivateChild(b,g):Ke.runInContext(()=>ct(b,g))).pipe(Hn())})).pipe(Nr())));return Q(L).pipe(Nr())}(g,A.path,m),function Gc(g,v,m){const b=v.routeConfig?v.routeConfig.canActivate:null;if(!b||0===b.length)return Q(!0);const A=b.map(L=>Tt(()=>{const F=Wa(v)??m,K=Pe(L,F);return pn(function aa(g){return g&&Bo(g.canActivate)}(K)?K.canActivate(v,g):F.runInContext(()=>K(v,g))).pipe(Hn())}));return Q(A).pipe(Nr())}(g,A.route,m))),Hn(A=>!0!==A,!0))}(b,L,g,v):Q(K)),(0,at.U)(K=>({...m,guardsResult:K})))})}(this.environmentInjector,F=>this.events.next(F)),yn(F=>{if(b.guardsResult=F.guardsResult,ln(F.guardsResult))throw sr(0,F.guardsResult);const K=new Po(F.id,this.urlSerializer.serialize(F.extractedUrl),this.urlSerializer.serialize(F.urlAfterRedirects),F.targetSnapshot,!!F.guardsResult);this.events.next(K)}),(0,rn.h)(F=>!!F.guardsResult||(m.restoreHistory(F),this.cancelNavigationTransition(F,"",3),!1)),Ys(F=>{if(F.guards.canActivateChecks.length)return Q(F).pipe(yn(K=>{const me=new zi(K.id,this.urlSerializer.serialize(K.extractedUrl),this.urlSerializer.serialize(K.urlAfterRedirects),K.targetSnapshot);this.events.next(me)}),Dt(K=>{let me=!1;return Q(K).pipe(function Mh(g,v){return(0,qn.z)(m=>{const{targetSnapshot:b,guards:{canActivateChecks:A}}=m;if(!A.length)return Q(m);let L=0;return(0,O.D)(A).pipe(Hr(F=>function Xc(g,v,m,b){const A=g.routeConfig,L=g._resolve;return void 0!==A?.title&&!Qc(A)&&(L[On]=A.title),function Zc(g,v,m,b){const A=function op(g){return[...Object.keys(g),...Object.getOwnPropertySymbols(g)]}(g);if(0===A.length)return Q({});const L={};return(0,O.D)(A).pipe((0,qn.z)(F=>function Kc(g,v,m,b){const A=Wa(v)??b,L=Pe(g,A);return pn(L.resolve?L.resolve(v,m):A.runInContext(()=>L(v,m)))}(g[F],v,m,b).pipe(Hn(),yn(K=>{L[F]=K}))),zs(1),function Tl(g){return(0,at.U)(()=>g)}(L),Pr(F=>Kr(F)?Ue.E:Le(F)))}(L,g,v,b).pipe((0,at.U)(F=>(g._resolvedData=F,g.data=kc(g,m).resolve,A&&Qc(A)&&(g.data[On]=A.title),null)))}(F.route,b,g,v)),yn(()=>L++),zs(1),(0,qn.z)(F=>L===A.length?Q(m):Ue.E))})}(m.paramsInheritanceStrategy,this.environmentInjector),yn({next:()=>me=!0,complete:()=>{me||(m.restoreHistory(K),this.cancelNavigationTransition(K,"",2))}}))}),yn(K=>{const me=new Rc(K.id,this.urlSerializer.serialize(K.extractedUrl),this.urlSerializer.serialize(K.urlAfterRedirects),K.targetSnapshot);this.events.next(me)}))}),Ys(F=>{const K=me=>{const Ke=[];me.routeConfig?.loadComponent&&!me.routeConfig._loadedComponent&&Ke.push(this.configLoader.loadComponent(me.routeConfig).pipe(yn(ct=>{me.component=ct}),(0,at.U)(()=>{})));for(const ct of me.children)Ke.push(...K(ct));return Ke};return Pt(K(F.targetSnapshot.root)).pipe(Yn(),Sn(1))}),Ys(()=>this.afterPreactivation()),(0,at.U)(F=>{const K=function Lo(g,v,m){const b=ia(g,v._root,m?m._root:void 0);return new td(b,v)}(m.routeReuseStrategy,F.targetSnapshot,F.currentRouterState);return b={...F,targetRouterState:K}}),yn(F=>{m.currentUrlTree=F.urlAfterRedirects,m.rawUrlTree=m.urlHandlingStrategy.merge(F.urlAfterRedirects,F.rawUrl),m.routerState=F.targetRouterState,"deferred"===m.urlUpdateStrategy&&(F.extras.skipLocationChange||m.setBrowserUrl(m.rawUrlTree,F),m.browserUrlTree=F.urlAfterRedirects)}),((g,v,m)=>(0,at.U)(b=>(new ph(v,b.targetRouterState,b.currentRouterState,m).activate(g),b)))(this.rootContexts,m.routeReuseStrategy,F=>this.events.next(F)),yn({next:F=>{A=!0,this.lastSuccessfulNavigation=this.currentNavigation,m.navigated=!0,this.events.next(new bn(F.id,this.urlSerializer.serialize(F.extractedUrl),this.urlSerializer.serialize(m.currentUrlTree))),m.titleStrategy?.updateTitle(F.targetRouterState.snapshot),F.resolve(!0)},complete:()=>{A=!0}}),Mo(()=>{A||L||this.cancelNavigationTransition(b,"",1),this.currentNavigation?.id===b.id&&(this.currentNavigation=null)}),Pr(F=>{if(L=!0,zc(F)){js(F)||(m.navigated=!0,m.restoreHistory(b,!0));const K=new Pl(b.id,this.urlSerializer.serialize(b.extractedUrl),F.message,F.cancellationCode);if(this.events.next(K),js(F)){const me=m.urlHandlingStrategy.merge(F.url,m.rawUrlTree),Ke={skipLocationChange:b.extras.skipLocationChange,replaceUrl:"eager"===m.urlUpdateStrategy||zl(b.source)};m.scheduleNavigation(me,Ui,null,Ke,{resolve:b.resolve,reject:b.reject,promise:b.promise})}else b.resolve(!1)}else{m.restoreHistory(b,!0);const K=new Io(b.id,this.urlSerializer.serialize(b.extractedUrl),F,b.targetSnapshot??void 0);this.events.next(K);try{b.resolve(m.errorHandler(F))}catch(me){b.reject(me)}}return Ue.E}))}))}cancelNavigationTransition(m,b,A){const L=new Pl(m.id,this.urlSerializer.serialize(m.extractedUrl),b,A);this.events.next(L),m.resolve(!1)}}return g.\u0275fac=function(m){return new(m||g)},g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();function zl(g){return g!==Ui}let Rs=(()=>{class g{buildTitle(m){let b,A=m.root;for(;void 0!==A;)b=this.getResolvedTitleForRoute(A)??b,A=A.children.find(L=>L.outlet===Xt);return b}getResolvedTitleForRoute(m){return m.data[On]}}return g.\u0275fac=function(m){return new(m||g)},g.\u0275prov=C.Yz7({token:g,factory:function(){return(0,C.f3M)(Xs)},providedIn:"root"}),g})(),Xs=(()=>{class g extends Rs{constructor(m){super(),this.title=m}updateTitle(m){const b=this.buildTitle(m);void 0!==b&&this.title.setTitle(b)}}return g.\u0275fac=function(m){return new(m||g)(C.LFG(Ms.Dx))},g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})(),Jc=(()=>{class g{}return g.\u0275fac=function(m){return new(m||g)},g.\u0275prov=C.Yz7({token:g,factory:function(){return(0,C.f3M)(Ya)},providedIn:"root"}),g})();class Hl{shouldDetach(v){return!1}store(v,m){}shouldAttach(v){return!1}retrieve(v){return null}shouldReuseRoute(v,m){return v.routeConfig===m.routeConfig}}let Ya=(()=>{class g extends Hl{}return g.\u0275fac=function(){let v;return function(b){return(v||(v=C.n5z(g)))(b||g)}}(),g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();const Ei=new C.OlP("",{providedIn:"root",factory:()=>({})});let Vl=(()=>{class g{}return g.\u0275fac=function(m){return new(m||g)},g.\u0275prov=C.Yz7({token:g,factory:function(){return(0,C.f3M)(ti)},providedIn:"root"}),g})(),ti=(()=>{class g{shouldProcessUrl(m){return!0}extract(m){return m}merge(m,b){return m}}return g.\u0275fac=function(m){return new(m||g)},g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();function xg(g){throw g}function Xa(g,v,m){return v.parse("/")}const ap={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Qn={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let or=(()=>{class g{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,C.f3M)(C.c2e),this.isNgZoneEnabled=!1,this.options=(0,C.f3M)(Ei,{optional:!0})||{},this.errorHandler=this.options.errorHandler||xg,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Xa,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,C.f3M)(Vl),this.routeReuseStrategy=(0,C.f3M)(Jc),this.urlCreationStrategy=(0,C.f3M)(Nl),this.titleStrategy=(0,C.f3M)(Rs),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=_r((0,C.f3M)(pr,{optional:!0})??[]),this.navigationTransitions=(0,C.f3M)(qa),this.urlSerializer=(0,C.f3M)(J),this.location=(0,C.f3M)(zn.Ye),this.isNgZoneEnabled=(0,C.f3M)(C.R0b)instanceof C.R0b&&C.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new mn,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Fc(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(m=>{this.lastSuccessfulId=m.id,this.currentPageId=m.targetPageId},m=>{this.console.warn(`Unhandled Navigation Error: ${m}`)})}resetRootComponentType(m){this.routerState.root.component=m,this.navigationTransitions.rootComponentType=m}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const m=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Ui,m)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(m=>{const b="popstate"===m.type?"popstate":"hashchange";"popstate"===b&&setTimeout(()=>{this.navigateToSyncWithBrowser(m.url,b,m.state)},0)}))}navigateToSyncWithBrowser(m,b,A){const L={replaceUrl:!0},F=A?.navigationId?A:null;if(A){const me={...A};delete me.navigationId,delete me.\u0275routerPageId,0!==Object.keys(me).length&&(L.state=me)}const K=this.parseUrl(m);this.scheduleNavigation(K,b,F,L)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(m){this.config=m.map(ko),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(m,b={}){const{relativeTo:A,queryParams:L,fragment:F,queryParamsHandling:K,preserveFragment:me}=b,Ke=me?this.currentUrlTree.fragment:F;let ct=null;switch(K){case"merge":ct={...this.currentUrlTree.queryParams,...L};break;case"preserve":ct=this.currentUrlTree.queryParams;break;default:ct=L||null}return null!==ct&&(ct=this.removeEmptyProps(ct)),this.urlCreationStrategy.createUrlTree(A,this.routerState,this.currentUrlTree,m,ct,Ke??null)}navigateByUrl(m,b={skipLocationChange:!1}){const A=ln(m)?m:this.parseUrl(m),L=this.urlHandlingStrategy.merge(A,this.rawUrlTree);return this.scheduleNavigation(L,Ui,null,b)}navigate(m,b={skipLocationChange:!1}){return function lp(g){for(let v=0;v<g.length;v++){const m=g[v];if(null==m)throw new C.vHH(4008,false)}}(m),this.navigateByUrl(this.createUrlTree(m,b),b)}serializeUrl(m){return this.urlSerializer.serialize(m)}parseUrl(m){let b;try{b=this.urlSerializer.parse(m)}catch(A){b=this.malformedUriErrorHandler(A,this.urlSerializer,m)}return b}isActive(m,b){let A;if(A=!0===b?{...ap}:!1===b?{...Qn}:b,ln(m))return Es(this.currentUrlTree,m,A);const L=this.parseUrl(m);return Es(this.currentUrlTree,L,A)}removeEmptyProps(m){return Object.keys(m).reduce((b,A)=>{const L=m[A];return null!=L&&(b[A]=L),b},{})}scheduleNavigation(m,b,A,L,F){if(this.disposed)return Promise.resolve(!1);let K,me,Ke,ct;return F?(K=F.resolve,me=F.reject,Ke=F.promise):Ke=new Promise((on,gi)=>{K=on,me=gi}),ct="computed"===this.canceledNavigationResolution?A&&A.\u0275routerPageId?A.\u0275routerPageId:L.replaceUrl||L.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:ct,source:b,restoredState:A,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:m,extras:L,resolve:K,reject:me,promise:Ke,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ke.catch(on=>Promise.reject(on))}setBrowserUrl(m,b){const A=this.urlSerializer.serialize(m),L={...b.extras.state,...this.generateNgRouterState(b.id,b.targetPageId)};this.location.isCurrentPathEqualTo(A)||b.extras.replaceUrl?this.location.replaceState(A,"",L):this.location.go(A,"",L)}restoreHistory(m,b=!1){if("computed"===this.canceledNavigationResolution){const A=this.currentPageId-m.targetPageId;"popstate"!==m.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===A?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===A&&(this.resetState(m),this.browserUrlTree=m.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(A)}else"replace"===this.canceledNavigationResolution&&(b&&this.resetState(m),this.resetUrlToCurrentUrlTree())}resetState(m){this.routerState=m.currentRouterState,this.currentUrlTree=m.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,m.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(m,b){return"computed"===this.canceledNavigationResolution?{navigationId:m,\u0275routerPageId:b}:{navigationId:m}}}return g.\u0275fac=function(m){return new(m||g)},g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})(),br=(()=>{class g{constructor(m,b,A,L,F,K){this.router=m,this.route=b,this.tabIndexAttribute=A,this.renderer=L,this.el=F,this.locationStrategy=K,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new we.x;const me=F.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===me||"area"===me,this.isAnchorElement?this.subscription=m.events.subscribe(Ke=>{Ke instanceof bn&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(m){this._preserveFragment=(0,C.D6c)(m)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(m){this._skipLocationChange=(0,C.D6c)(m)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(m){this._replaceUrl=(0,C.D6c)(m)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(m){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",m)}ngOnChanges(m){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(m){null!=m?(this.commands=Array.isArray(m)?m:[m],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(m,b,A,L,F){return!!(null===this.urlTree||this.isAnchorElement&&(0!==m||b||A||L||F||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const m=null===this.href?null:(0,C.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",m)}applyAttributeValue(m,b){const A=this.renderer,L=this.el.nativeElement;null!==b?A.setAttribute(L,m,b):A.removeAttribute(L,m)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return g.\u0275fac=function(m){return new(m||g)(C.Y36(or),C.Y36(Zi),C.$8M("tabindex"),C.Y36(C.Qsj),C.Y36(C.SBq),C.Y36(zn.S$))},g.\u0275dir=C.lG2({type:g,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(m,b){1&m&&C.NdJ("click",function(L){return b.onClick(L.button,L.ctrlKey,L.shiftKey,L.altKey,L.metaKey)}),2&m&&C.uIk("target",b.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[C.TTD]}),g})();class eu{}let Ka=(()=>{class g{constructor(m,b,A,L,F){this.router=m,this.injector=A,this.preloadingStrategy=L,this.loader=F}setUpPreloading(){this.subscription=this.router.events.pipe((0,rn.h)(m=>m instanceof bn),Hr(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(m,b){const A=[];for(const L of b){L.providers&&!L._injector&&(L._injector=(0,C.MMx)(L.providers,m,`Route: ${L.path}`));const F=L._injector??m,K=L._loadedInjector??F;L.loadChildren&&!L._loadedRoutes&&void 0===L.canLoad||L.loadComponent&&!L._loadedComponent?A.push(this.preloadConfig(F,L)):(L.children||L._loadedRoutes)&&A.push(this.processRoutes(K,L.children??L._loadedRoutes))}return(0,O.D)(A).pipe((0,Fe.J)())}preloadConfig(m,b){return this.preloadingStrategy.preload(b,()=>{let A;A=b.loadChildren&&void 0===b.canLoad?this.loader.loadChildren(m,b):Q(null);const L=A.pipe((0,qn.z)(F=>null===F?Q(void 0):(b._loadedRoutes=F.routes,b._loadedInjector=F.injector,this.processRoutes(F.injector??m,F.routes))));if(b.loadComponent&&!b._loadedComponent){const F=this.loader.loadComponent(b);return(0,O.D)([L,F]).pipe((0,Fe.J)())}return L})}}return g.\u0275fac=function(m){return new(m||g)(C.LFG(or),C.LFG(C.Sil),C.LFG(C.lqb),C.LFG(eu),C.LFG(fd))},g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();const Ls=new C.OlP("");let ps=(()=>{class g{constructor(m,b,A,L,F={}){this.urlSerializer=m,this.transitions=b,this.viewportScroller=A,this.zone=L,this.options=F,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},F.scrollPositionRestoration=F.scrollPositionRestoration||"disabled",F.anchorScrolling=F.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(m=>{m instanceof Ba?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=m.navigationTrigger,this.restoredId=m.restoredState?m.restoredState.navigationId:0):m instanceof bn&&(this.lastId=m.id,this.scheduleScrollEvent(m,this.urlSerializer.parse(m.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(m=>{m instanceof Ol&&(m.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(m.position):m.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(m.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(m,b){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Ol(m,"popstate"===this.lastSource?this.store[this.restoredId]:null,b))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return g.\u0275fac=function(m){C.$Z()},g.\u0275prov=C.Yz7({token:g,factory:g.\u0275fac}),g})();var hi=(()=>((hi=hi||{})[hi.COMPLETE=0]="COMPLETE",hi[hi.FAILED=1]="FAILED",hi[hi.REDIRECTING=2]="REDIRECTING",hi))();const Qa=!1;function Gi(g,v){return{\u0275kind:g,\u0275providers:v}}const Eh=new C.OlP("",{providedIn:"root",factory:()=>!1});function up(){const g=(0,C.f3M)(C.zs3);return v=>{const m=g.get(C.z2F);if(v!==m.components[0])return;const b=g.get(or),A=g.get(Ja);1===g.get(Th)&&b.initialNavigation(),g.get(Go,null,C.XFs.Optional)?.setUpPreloading(),g.get(Ls,null,C.XFs.Optional)?.init(),b.resetRootComponentType(m.componentTypes[0]),A.closed||(A.next(),A.unsubscribe())}}const Ja=new C.OlP(Qa?"bootstrap done indicator":"",{factory:()=>new we.x}),Th=new C.OlP(Qa?"initial navigation":"",{providedIn:"root",factory:()=>1});function jl(){let g=[];return g=Qa?[{provide:C.Xts,multi:!0,useFactory:()=>{const v=(0,C.f3M)(or);return()=>v.events.subscribe(m=>{console.group?.(`Router Event: ${m.constructor.name}`),console.log(function uh(g){if(!("type"in g))return`Unknown Router Event: ${g.constructor.name}`;switch(g.type){case 14:return`ActivationEnd(path: '${g.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${g.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${g.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${g.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${g.id}, url: '${g.url}', urlAfterRedirects: '${g.urlAfterRedirects}', state: ${g.state}, shouldActivate: ${g.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${g.id}, url: '${g.url}', urlAfterRedirects: '${g.urlAfterRedirects}', state: ${g.state})`;case 2:return`NavigationCancel(id: ${g.id}, url: '${g.url}')`;case 16:return`NavigationSkipped(id: ${g.id}, url: '${g.url}')`;case 1:return`NavigationEnd(id: ${g.id}, url: '${g.url}', urlAfterRedirects: '${g.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${g.id}, url: '${g.url}', error: ${g.error})`;case 0:return`NavigationStart(id: ${g.id}, url: '${g.url}')`;case 6:return`ResolveEnd(id: ${g.id}, url: '${g.url}', urlAfterRedirects: '${g.urlAfterRedirects}', state: ${g.state})`;case 5:return`ResolveStart(id: ${g.id}, url: '${g.url}', urlAfterRedirects: '${g.urlAfterRedirects}', state: ${g.state})`;case 10:return`RouteConfigLoadEnd(path: ${g.route.path})`;case 9:return`RouteConfigLoadStart(path: ${g.route.path})`;case 4:return`RoutesRecognized(id: ${g.id}, url: '${g.url}', urlAfterRedirects: '${g.urlAfterRedirects}', state: ${g.state})`;case 15:return`Scroll(anchor: '${g.anchor}', position: '${g.position?`${g.position[0]}, ${g.position[1]}`:null}')`}}(m)),console.log(m),console.groupEnd?.()})}}]:[],Gi(1,g)}const Go=new C.OlP(Qa?"router preloader":"");function pd(g){return Gi(0,[{provide:Go,useExisting:Ka},{provide:eu,useExisting:g}])}const Zs=!1,Ch=new C.OlP(Zs?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),dp=[zn.Ye,{provide:J,useClass:j},or,Oo,{provide:Zi,useFactory:function cp(g){return g.routerState.root},deps:[or]},fd,Zs?{provide:Eh,useValue:!0}:[]];function Dh(){return new C.PXZ("Router",or)}let hp=(()=>{class g{constructor(m){}static forRoot(m,b){return{ngModule:g,providers:[dp,Zs&&b?.enableTracing?jl().\u0275providers:[],{provide:pr,multi:!0,useValue:m},{provide:Ch,useFactory:fp,deps:[[or,new C.FiY,new C.tp0]]},{provide:Ei,useValue:b||{}},b?.useHash?{provide:zn.S$,useClass:zn.Do}:{provide:zn.S$,useClass:zn.b0},{provide:Ls,useFactory:()=>{const g=(0,C.f3M)(zn.EM),v=(0,C.f3M)(C.R0b),m=(0,C.f3M)(Ei),b=(0,C.f3M)(qa),A=(0,C.f3M)(J);return m.scrollOffset&&g.setOffset(m.scrollOffset),new ps(A,b,g,v,m)}},b?.preloadingStrategy?pd(b.preloadingStrategy).\u0275providers:[],{provide:C.PXZ,multi:!0,useFactory:Dh},b?.initialNavigation?md(b):[],[{provide:gd,useFactory:up},{provide:C.tb,multi:!0,useExisting:gd}]]}}static forChild(m){return{ngModule:g,providers:[{provide:pr,multi:!0,useValue:m}]}}}return g.\u0275fac=function(m){return new(m||g)(C.LFG(Ch,8))},g.\u0275mod=C.oAB({type:g}),g.\u0275inj=C.cJS({imports:[Ii]}),g})();function fp(g){if(Zs&&g)throw new C.vHH(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function md(g){return["disabled"===g.initialNavigation?Gi(3,[{provide:C.ip1,multi:!0,useFactory:()=>{const v=(0,C.f3M)(or);return()=>{v.setUpLocationChangeListener()}}},{provide:Th,useValue:2}]).\u0275providers:[],"enabledBlocking"===g.initialNavigation?Gi(2,[{provide:Th,useValue:0},{provide:C.ip1,multi:!0,deps:[C.zs3],useFactory:v=>{const m=v.get(zn.V_,Promise.resolve());return()=>m.then(()=>new Promise(b=>{const A=v.get(or),L=v.get(Ja);(function bg(g,v){g.events.pipe((0,rn.h)(m=>m instanceof bn||m instanceof Pl||m instanceof Io||m instanceof Jo),(0,at.U)(m=>m instanceof bn||m instanceof Jo?hi.COMPLETE:m instanceof Pl&&(0===m.code||1===m.code)?hi.REDIRECTING:hi.FAILED),(0,rn.h)(m=>m!==hi.REDIRECTING),Sn(1)).subscribe(()=>{v()})})(A,()=>{b(!0)}),v.get(qa).afterPreactivation=()=>(b(!0),L.closed?Q(void 0):L),A.initialNavigation()}))}}]).\u0275providers:[]]}const gd=new C.OlP(Zs?"Router Initializer":"")}},Vt=>{Vt(Vt.s=2983)}]);